<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
 <head> 
  <title>Currency Converter in Excel VBA - EASY Excel Macros</title> 
  <meta name="keywords" content="currency converter, excel vba, userform, amount, array, list box, euro, us dollar, british pound"> 
  <meta name="description" content="Below we will look at a program in Excel VBA which creates a Userform that converts any amount from one currency into another."> 
  <meta http-equiv="content-type" content="text/html; charset=utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"> 
  <meta name="robots" content="index, follow"> 
  <meta content="EN-US" name="LANGUAGE"> 
  <meta property="og:title" content="Currency Converter in Excel VBA"> 
  <meta property="og:url" content="http://www.excel-easy.com/vba/examples/currency-converter.html"> 
  <meta property="og:type" content="article"> 
  <meta property="fb:admins" content="100003702321830"> 
  <meta property="og:description" content="Learn how to create a program in Excel VBA which creates a Userform that converts any amount from one currency into another."> 
  <meta property="og:image" content="http://www.excel-easy.com/ogi/vba/examples/currency-converter.png"> 
  <link rel="stylesheet" href="../../css/style.css"> 
  <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> 
  <script src="https://apis.google.com/js/platform.js" async defer>{lang: 'en-US'}</script> 
  <!--[if lte IE 8]><script src="../../js/html5shiv.js"></script><![endif]--> 
  <script src="../../js/jquery.min.js" type="text/javascript"></script> 
  <script src="../../js/skel.min.js" type="text/javascript"></script> 
  <script src="../../js/skel-layers.min.js" type="text/javascript"></script> 
  <script src="../../js/init.js" type="text/javascript"></script> 
  <style type="text/css">
.adslot { width: 336px; height: 280px; }
@media (min-width:320px) { .adslot { width: 300px; height: 250px; } }
@media (min-width:360px) and (orientation: portrait) { .adslot { width: 336px; height: 280px; } }
@media (min-width:604px) { .adslot { width: 336px; height: 280px; } }
</style> 
  <noscript> 
   <link rel="stylesheet" href="../../css/skel.css"> 
   <link rel="stylesheet" href="../../css/style.css"> 
   <link rel="stylesheet" href="../../css/adslot.css"> 
  </noscript> 
 </head> 
 <body> 
  <header id="header"> 
   <div class="container"> 
    <span class="notranslate"> 
     <div id="logo"> 
      <a href="http://www.excel-easy.com"><img src="../../layout/excel-tutorial.svg" onerror="this.src='../../layout/excel-tutorial.png'" border="0" alt="Excel Tutorial" title="Excel Tutorial" width="44" height="41"><h2>Excel</h2>&nbsp;&nbsp;<span class="easy">Easy</span></a> 
      <p>#1 <a href="http://www.excel-easy.com">Excel tutorial</a> on the net</p> 
     </div> 
     <nav id="nav"> 
      <ul> 
       <li><a href="http://www.excel-easy.com">Excel</a></li> 
       <li><a href="http://www.excel-easy.com/introduction.html">Introduction</a></li> 
       <li><a href="http://www.excel-easy.com/basics.html">Basics</a></li> 
       <li><a href="http://www.excel-easy.com/functions.html">Functions</a></li> 
       <li><a href="http://www.excel-easy.com/data-analysis.html">Data Analysis</a></li> 
       <li><a href="http://www.excel-easy.com/vba.html">VBA</a></li> 
       <li class="current_page_item"><a href="http://www.excel-easy.com/examples.html">300 Examples</a></li> 
       <li><a href="http://www.excel-easy.com/ask-us.html">Ask us</a></li> 
      </ul> 
     </nav> </span> 
   </div> 
  </header> 
  <!-- end #header --> 
  <div class="container"> 
   <div class="row 100%"> 
    <div class="8u 12u(medium)"> 
     <div class="post"> 
      <h1 class="title" style="float:left">Currency Converter</h1> 
      <table> 
       <tbody>
        <tr> 
         <td style="padding-left:8px; padding-top:4px">
          <div class="delmob">
           <div class="g-follow" data-annotation="bubble" data-height="24" data-href="https://plus.google.com/+ExcelEasy" data-rel="publisher"></div>
          </div></td> 
        </tr> 
       </tbody>
      </table> 
      <div style="clear: both;">
       &nbsp;
      </div> 
      <div class="entry"> 
       <p>Below we will look at a program in <strong>Excel VBA</strong> which creates a Userform that <strong>converts</strong> any amount from one <strong>currency</strong> into another.</p> 
       <p>The Userform we are going to create looks as follows:</p> 
       <p><img src="images/currency-converter/currency-converter-example.png" alt="Currency Converter in Excel VBA" title="Currency Converter in Excel VBA"></p> 
       <div class="ad">
        <!-- Excel Easy Pages Begin --> 
        <ins class="adsbygoogle adslot" style="display:inline-block;" data-ad-client="ca-pub-1987061359047735" data-ad-slot="2884421292"></ins> 
       </div> 
       <p>To create this Userform, execute the following steps.</p> 
       <p>1. Open the <a href="../create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>. If the Project Explorer is not visible, click View, Project Explorer.</p> 
       <p>2. Click Insert, Userform. If the Toolbox does not appear automatically, click View, Toolbox. Your screen should be set up as below.</p> 
       <p><img src="../images/userform/userform-screen-setup.png" alt="Userform Screen Setup in Excel VBA" title="Userform Screen Setup in Excel VBA"></p> 
       <p>3. Add the labels, list boxes (first at the left, the second at the right), text boxes (first at the left, the second at the right) and command button. Once this has been completed, the result should be consistent with the picture of the Userform shown earlier. For example, create a list box control by clicking on ListBox from the Toolbox. Next, you can drag a list box on the Userform.</p> 
       <p>4. You can change the names and the captions of the controls. Names are used in the Excel VBA code. Captions are those that appear on your screen. It is good practice to change the names of the controls, but it is not necessary here because we only have a few controls in this example. To change the caption of the Userform, command button and labels, click View, Properties Window and click on each control.</p> 
       <p>5. To show the Userform, place a <a href="../create-a-macro.html#command-button">command button</a> on your worksheet and add the following code line:</p> 
       <div class="code">
        <span class="predefined">Private</span> 
        <span class="predefined">Sub</span> CommandButton1_Click()
        <br>
        <br> UserForm1.Show
        <br>
        <br> 
        <span class="predefined">End</span> 
        <span class="predefined">Sub</span>
       </div> 
       <p>We are now going to create the Sub UserForm_Initialize. When you use the Show method for the Userform, this sub will automatically be executed.</p> 
       <div class="ad">
        <!-- Excel Easy Pages Middle --> 
        <ins class="adsbygoogle adslot" style="display:inline-block;" data-ad-client="ca-pub-1987061359047735" data-ad-slot="2529116896"></ins> 
       </div> 
       <p>6. Open the <a href="../create-a-macro.html#visual-basic-editor">Visual Basic Editor</a>.</p> 
       <p>7. In the Project Explorer, right click on UserForm1 and then click View Code.</p> 
       <p>8. Choose Userform from the left drop-down list. Choose Initialize from the right drop-down list.</p> 
       <p>9. Add the following code lines:</p> 
       <div class="code">
        <span class="predefined">Private</span> 
        <span class="predefined">Sub</span> UserForm_Initialize()
        <br>
        <br> 
        <span class="predefined">With</span> ListBox1
        <br> &nbsp;&nbsp;&nbsp;&nbsp;.AddItem "Euro"
        <br> &nbsp;&nbsp;&nbsp;&nbsp;.AddItem "Us Dollar"
        <br> &nbsp;&nbsp;&nbsp;&nbsp;.AddItem "British Pound"
        <br> 
        <span class="predefined">End</span> 
        <span class="predefined">With</span>
        <br>
        <br> 
        <span class="predefined">With</span> ListBox2
        <br> &nbsp;&nbsp;&nbsp;&nbsp;.AddItem "Euro"
        <br> &nbsp;&nbsp;&nbsp;&nbsp;.AddItem "Us Dollar"
        <br> &nbsp;&nbsp;&nbsp;&nbsp;.AddItem "British Pound"
        <br> 
        <span class="predefined">End</span> 
        <span class="predefined">With</span>
        <br>
        <br> ListBox1.ListIndex = 1
        <br> ListBox2.ListIndex = 0
        <br>
        <br> TextBox1.Value = 1
        <br> TextBox2.Value = 0.722152
        <br>
        <br> 
        <span class="predefined">End</span> 
        <span class="predefined">Sub</span>
       </div> 
       <p>Explanation: first, the two list boxes are filled. Next, The US Dollar currency is set as default in the first list box and the EURO currency&nbsp;is set as default in the second list box. Finally, the value 1 is entered in the first text box and the value 0.722152 is entered in the second text box.</p> 
       <p>We have now created the first part of the Userform. Although it looks neat already, nothing will happen yet when we click on the Go button.</p> 
       <p>10. In the Project Explorer, double click on UserForm1.</p> 
       <p>11. Double click on the Go button.</p> 
       <p>12. Add the following code lines:</p> 
       <div class="code">
        <span class="predefined">Private</span> 
        <span class="predefined">Sub</span> CommandButton1_Click()
        <br>
        <br> 
        <span class="predefined">Dim</span> rates(0 
        <span class="predefined">To</span> 2, 0 
        <span class="predefined">To</span> 2) 
        <span class="predefined">As</span> 
        <span class="predefined">Double</span>, i 
        <span class="predefined">As</span> 
        <span class="predefined">Integer</span>, j 
        <span class="predefined">As</span> 
        <span class="predefined">Integer</span>
        <br>
        <br> rates(0, 0) = 1
        <br> rates(0, 1) = 1.38475
        <br> rates(0, 2) = 0.87452
        <br> 
        <br> rates(1, 0) = 0.722152
        <br> rates(1, 1) = 1
        <br> rates(1, 2) = 0.63161
        <br> 
        <br> rates(2, 0) = 1.143484
        <br> rates(2, 1) = 1.583255
        <br> rates(2, 2) = 1
        <br> 
        <br> 
        <span class="predefined">For</span> i = 0 
        <span class="predefined">To</span> 2
        <br> &nbsp;&nbsp;&nbsp;&nbsp;
        <span class="predefined">For</span> j = 0 
        <span class="predefined">To</span> 2
        <br> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <span class="predefined">If</span> ListBox1.ListIndex = i 
        <span class="predefined">And</span> ListBox2.ListIndex = j 
        <span class="predefined">Then</span> TextBox2.Value = TextBox1.Value * rates(i, j)
        <br> &nbsp;&nbsp;&nbsp;&nbsp;
        <span class="predefined">Next</span> j
        <br> 
        <span class="predefined">Next</span> i
        <br>
        <br> 
        <span class="predefined">End</span> 
        <span class="predefined">Sub</span>
       </div> 
       <p>Explanation: first, we declare an array. The array has two dimensions. It consists of 3 rows and 3 columns. Next, we initialize each element of the array. For example, rates(1,0) is the currency rate from US Dollar to EURO. Next, we start a double loop. Depending on the selected currencies in the list boxes, Excel VBA converts the amount entered in the first text box and displays the result in the second text box.</p> 
       <p>Example: if i = 2 and j = 1 and we enter the value 2 in the first text box, Excel VBA places the value 2 * rates(2,1) = 2 * 1.583255&nbsp;= 3.16651 in the second text box.</p> 
       <p>13. Test the Userform.</p> 
       <p>Result:</p> 
       <p><img src="images/currency-converter/currency-converter-result.png" alt="Currency Converter Result" title="Currency Converter Result"></p> 
       <div class="ad">
        <!-- Excel Easy Pages End --> 
        <ins class="adsbygoogle adslot" style="display:inline-block;" data-ad-client="ca-pub-1987061359047735" data-ad-slot="4005850092"></ins> 
       </div> 
      </div> 
     </div> 
     <div class="post"> 
      <div class="entrysocial"> 
       <p class="appr"><span class="invmob">Do you like this free website? </span>Please follow us on Google+</p> 
       <p></p>
       <div style="height:24px">
        <div class="g-follow" data-annotation="bubble" data-height="24" data-href="https://plus.google.com/+ExcelEasy" data-rel="publisher"></div>
       </div>
       <p></p> 
      </div> 
     </div> 
     <span class="invtab">
      <div class="post"> 
       <div style="clear: both;"></div> 
       <div class="entrylearn"> 
        <p align="left"><span class="buttonp"> <a href="progress-indicator.html">3/11 Completed! Learn much more about userforms &gt;<br></a></span>Back to Top: <a href="#">Currency Converter</a>&nbsp;&nbsp;&nbsp;|&nbsp;&nbsp;&nbsp;Go to Next Chapter: <a href="../../introduction/range.html">Range</a> </p>
       </div> 
      </div></span> 
    </div> 
    <div class="4u 12u(medium)"> 
     <div id="search"> 
      <div class="cse-branding-right" style="background-color:#FFFFFF;color:#000000"> 
       <div class="cse-branding-form" style="margin-right:0px;"> 
        <form action="http://www.excel-easy.com/search.html" id="cse-search-box"> 
         <div> 
          <input type="hidden" name="cx" value="partner-pub-1987061359047735:3934495699"> 
          <input type="hidden" name="cof" value="FORID:10"> 
          <input type="hidden" name="ie" value="UTF-8"> 
          <input type="text" name="q" placeholder="Search Entire Site" class="field"> 
          <span class="notranslate"><input type="submit" name="sa" value="Go" class="button"></span> 
         </div> 
        </form> 
       </div> 
       <div class="cse-branding-logo"></div> 
       <div class="cse-branding-text"></div> 
      </div> 
     </div> 
     <div id="sidebar"> 
      <ul> 
       <li> <h3>Chapter&nbsp;<a class="previous" href="../activex-controls.html">&nbsp;&lt;&nbsp;</a>&nbsp;<a class="next" href="../../introduction/range.html">&nbsp;&gt;&nbsp;</a></h3> 
        <ul> 
         <li><a href="../userform.html">Userform</a></li> 
        </ul> </li> 
      </ul> 
     </div> 
     <div id="sidebar"> 
      <ul>
       <li> <h3><font color="#FF9900"><span class="notranslate">Learn more, it's easy</span></font></h3> </li> 
       <li>
        <ul> 
         <li><a href="userform-ranges.html">Userform and Ranges</a></li> 
         <li class="current_page_item"><a href="currency-converter.html">Currency Converter</a></li> 
         <li><a href="progress-indicator.html">Progress Indicator</a></li> 
         <li><a href="multiple-list-box-selections.html">Multiple List Box Selections</a></li> 
         <li><a href="multicolumn-combo-box.html">Multicolumn Combo Box</a></li> 
         <li><a href="dependent-combo-boxes.html">Dependent Combo Boxes</a></li> 
         <li><a href="loop-through-controls.html">Loop through Controls</a></li> 
         <li><a href="controls-collection.html">Controls Collection</a></li> 
         <li><a href="userform-with-multiple-pages.html">Userform with Multiple Pages</a></li> 
         <li><a href="interactive-userform.html">Interactive Userform</a></li> 
        </ul> </li> 
      </ul> 
     </div> 
     <div id="sidebar"> 
      <ul> 
       <li> <h3><span class="notranslate">Download Excel File</span></h3> 
        <ul> 
         <li><a href="excel-files/currency-converter.xls">currency-converter.xls</a></li> 
        </ul> </li>  
      </ul> 
     </div> 
     <div id="sidebar"> 
      <h3><span class="notranslate">Follow Excel Easy</span></h3> 
      <p style="padding-top:7px"><a href="http://plus.google.com/+ExcelEasy" target="blank" rel="nofollow"><img src="../../layout/google-plus-logo.png" onmouseover="this.src='../../layout/google-plus-logo-onmouseover.png'" onmouseout="this.src='../../layout/google-plus-logo.png'" width="30" height="30" border="0" alt="Excel Easy on Google+" title="Excel Easy on Google+"></a> <a href="http://www.facebook.com/ExcelEasy" target="blank" rel="nofollow"><img src="../../layout/facebook-logo.png" onmouseover="this.src='../../layout/facebook-logo-onmouseover.png'" onmouseout="this.src='../../layout/facebook-logo.png'" width="30" height="30" border="0" alt="Excel Easy on Facebook" title="Excel Easy on Facebook"></a> <a href="http://twitter.com/ExcelEasy" target="blank" rel="nofollow"><img src="../../layout/twitter-logo.png" onmouseover="this.src='../../layout/twitter-logo-onmouseover.png'" onmouseout="this.src='../../layout/twitter-logo.png'" width="30" height="30" border="0" alt="Excel Easy on Twitter" title="Excel Easy on Twitter"></a> <a href="http://www.pinterest.com/ExcelEasy/" target="blank" rel="nofollow"><img src="../../layout/pinterest-logo.png" onmouseover="this.src='../../layout/pinterest-logo-onmouseover.png'" onmouseout="this.src='../../layout/pinterest-logo.png'" width="30" height="30" border="0" alt="Excel Easy on Pinterest" title="Excel Easy on Pinterest"></a> <a href="https://www.linkedin.com/company/excel-easy" target="blank" rel="nofollow"><img src="../../layout/linkedin-logo.png" onmouseover="this.src='../../layout/linkedin-logo-onmouseover.png'" onmouseout="this.src='../../layout/linkedin-logo.png'" width="30" height="30" border="0" alt="Excel Easy on LinkedIn" title="Excel Easy on LinkedIn"></a></p> 
     </div> 
     <div id="sidebar"> 
      <ul> 
       <li> <h3><span class="notranslate">Randomly selected</span></h3> 
        <ul> 
         <li><script src="http://www.excel-easy.com/scripts/randomstmp.js"></script></li> 
        </ul> </li> 
      </ul> 
     </div> 
     <!-- end #sidebar --> 
     <div style="clear: both;">
      &nbsp;
     </div> 
    </div> 
   </div> 
  </div> 
  <!-- end #page -->  
  <div id="footer"> 
   <p>Excel Easy • Free Excel Help • Copyright (c) 2010-2017 • All rights reserved<br> <a href="http://www.excel-easy.com">Microsoft Excel Tutorial</a> | <a href="http://www.excel-easy.com/vba.html">How to use VBA</a> | <a href="http://www.excel-easy.com/introduction/formulas-functions.html">Excel Formulas</a> | <a href="http://www.excel-easy.com/examples/drop-down-list.html">Drop-down List</a></p> 
  </div> 
  <!-- end #footer --> 
  <script type="text/javascript">
  
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({}); });
  $(function() { (adsbygoogle = window.adsbygoogle || []).push({ google_ad_client: "ca-pub-1987061359047735", enable_page_level_ads: true }); });
  
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-15754101-9', 'auto');
  ga('send', 'pageview');

</script>   
 </body>
</html>