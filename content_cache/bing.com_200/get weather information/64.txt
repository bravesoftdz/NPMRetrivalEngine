<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
 <head> 
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8"> 
  <meta name="robots" content="index,nofollow"> 
  <title>TipsAndTricks/YumAndRPM - CentOS Wiki</title> 
  <script type="text/javascript" src="/wiki/common/js/common.js"></script> 
  <script type="text/javascript">
<!--// common functions

// We keep here the state of the search box
searchIsDisabled = false;

function searchChange(e) {
    // Update search buttons status according to search box content.
    // Ignore empty or whitespace search term.
    var value = e.value.replace(/\s+/, '');
    if (value == '' || searchIsDisabled) { 
        searchSetDisabled(true);
    } else {
        searchSetDisabled(false);
    }
}

function searchSetDisabled(flag) {
    // Enable or disable search
    document.getElementById('fullsearch').disabled = flag;
    document.getElementById('titlesearch').disabled = flag;
}

function searchFocus(e) {
    // Update search input content on focus
    if (e.value == 'Search') {
        e.value = '';
        e.className = '';
        searchIsDisabled = false;
    }
}

function searchBlur(e) {
    // Update search input content on blur
    if (e.value == '') {
        e.value = 'Search';
        e.className = 'disabled';
        searchIsDisabled = true;
    }
}

function actionsMenuInit(title) {
    // Initialize action menu
    for (i = 0; i < document.forms.length; i++) {
        var form = document.forms[i];
        if (form.className == 'actionsmenu') {
            // Check if this form needs update
            var div = form.getElementsByTagName('div')[0];
            var label = div.getElementsByTagName('label')[0];
            if (label) {
                // This is the first time: remove label and do buton.
                div.removeChild(label);
                var dobutton = div.getElementsByTagName('input')[0];
                div.removeChild(dobutton);
                // and add menu title
                var select = div.getElementsByTagName('select')[0];
                var item = document.createElement('option');
                item.appendChild(document.createTextNode(title));
                item.value = 'show';
                select.insertBefore(item, select.options[0]);
                select.selectedIndex = 0;
            }
        }
    }
}
//-->
</script> 
  <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/wiki/modern-CentOS/css/common.css"> 
  <link rel="stylesheet" type="text/css" charset="utf-8" media="screen" href="/wiki/modern-CentOS/css/screen.css"> 
  <link rel="stylesheet" type="text/css" charset="utf-8" media="print" href="/wiki/modern-CentOS/css/print.css"> 
  <link rel="stylesheet" type="text/css" charset="utf-8" media="projection" href="/wiki/modern-CentOS/css/projection.css"> 
  <!-- css only for MSIE browsers --> 
  <!--[if IE]>
   <link rel="stylesheet" type="text/css" charset="utf-8" media="all" href="/wiki/modern-CentOS/css/msie.css">
<![endif]--> 
  <link rel="Start" href="/FrontPage"> 
  <link rel="Alternate" title="Wiki Markup" href="/TipsAndTricks/YumAndRPM?action=raw"> 
  <link rel="Alternate" media="print" title="Print View" href="/TipsAndTricks/YumAndRPM?action=print"> 
  <link rel="Up" href="/TipsAndTricks"> 
  <link rel="Search" href="/FindPage"> 
  <link rel="Index" href="/TitleIndex"> 
  <link rel="Glossary" href="/WordIndex"> 
  <link rel="Help" href="/HelpOnFormatting"> 
 </head> 
 <body lang="en" dir="ltr"> 
  <div id="header"> 
   <div id="logo">
    <a href="/FrontPage"><img src="/wiki/common/modern-CentOS-logo.png" alt="CentOS"></a>
   </div> 
   <ul id="username">
    <li><a href="/TipsAndTricks/YumAndRPM?action=login" id="login">Login</a></li>
   </ul> 
   <ul class="navibar"> 
    <li class="wikilink"><a href="/FrontPage">FrontPage</a></li>
    <li class="wikilink"><a href="/Documentation">Help</a></li>
    <li class="wikilink"><a href="/TipsAndTricks">Tips and Tricks</a></li>
    <li class="wikilink"><a href="/HowTos">How To</a></li>
    <li class="wikilink"><a href="/FAQ">FAQs</a></li>
    <li class="wikilink"><a href="/Events">Events</a></li>
    <li class="wikilink"><a href="/Contribute">Contribute</a></li>
    <li class="wikilink"><a href="/RecentChanges">Changelog</a></li>
    <li class="current"><a href="/TipsAndTricks/YumAndRPM">TipsAndTricks/YumAndRPM</a></li> 
   </ul> 
   <div class="pageline">
    <hr style="display:none;">
   </div> 
  </div> 
  <div id="locationline"> 
   <form id="searchform" method="get" action=""> 
    <div> 
     <input type="hidden" name="action" value="fullsearch"> 
     <input type="hidden" name="context" value="180"> 
     <label for="searchinput">Search:</label> 
     <input id="searchinput" type="text" name="value" value="" size="20" onfocus="searchFocus(this)" onblur="searchBlur(this)" onkeyup="searchChange(this)" onchange="searchChange(this)" alt="Search"> 
     <input id="fullsearch" name="fullsearch" type="submit" value="Text" alt="Search Full Text"> 
     <input id="titlesearch" name="titlesearch" type="submit" value="Titles" alt="Search Titles"> 
    </div> 
   </form> 
   <script type="text/javascript">
<!--// Initialize search form
var f = document.getElementById('searchform');
f.getElementsByTagName('label')[0].style.display = 'none';
var e = document.getElementById('searchinput');
searchChange(e);
searchBlur(e);
//-->
</script> 
   <ul id="pagelocation"> 
    <li><a href="/TipsAndTricks">TipsAndTricks</a></li>
    <li><a class="backlink" title="Click to do a full-text search for this title" href="/TipsAndTricks/YumAndRPM?action=fullsearch&amp;value=linkto%3A%22TipsAndTricks/YumAndRPM%22&amp;context=180">YumAndRPM</a></li> 
   </ul> 
  </div> 
  <div id="page" lang="en" dir="ltr"> 
   <div dir="ltr" id="content" lang="en">
    <span class="anchor" id="top"></span> 
    <span class="anchor" id="line-3"></span>
    <p class="line867"> </p>
    <h1 id="head-7821c72337615d538bd5e985368c15f7be019bb5">Yum and RPM Tricks</h1> 
    <span class="anchor" id="line-4"></span>
    <p class="line867"></p>
    <div class="table-of-contents">
     <p class="table-of-contents-heading">Contents</p>
     <ol>
      <li><a href="#head-863c703185b8f37d716f15e2a25393813ccf155c">Getting rpm to display architecture</a></li>
      <li><a href="#head-0424f619b79e293fc743a39795b9805f1f73d249">Query packages not from CentOS</a></li>
      <li><a href="#head-20a3ecce3d0762b9cdd3307ef2632e0c274a2bfd">Reset File Permissions</a></li>
      <li><a href="#head-3154e5b76c48ac44a0243d3e846bd4b8ebea7a1f">View the Changelog</a>
       <ol>
        <li><a href="#head-ea2efdf3b138ef503c52ee5ffbbd6cb724fbae9b">Using RPM</a></li>
        <li><a href="#head-103e638fc379b3401ecf383b29c024a8b5cd6e20">Using YUM Changelog Plugin</a></li>
       </ol></li>
      <li><a href="#head-86c189bdfa040cb549e3e42bd464a3ea90197827">Where's the Documentation?</a></li>
      <li><a href="#head-4afe9f3225ffbbd88682be589ecaeb62eed5e93f">Package Origin</a></li>
      <li><a href="#head-543dc679c096239f65136d5958c448961176ecbc">Extract just one File</a></li>
      <li><a href="#head-d8f160a71ea9eb45259538954a39fa5f443fba04">Query Package Install Order and Dates</a></li>
      <li><a href="#head-61731905d2e34ac343baeef06e5dd296aeed67b9">Query Available Packages from a Repo</a></li>
      <li><a href="#head-9e4e8d0c8de8142cdfe2eb7e183bf51763a5cb3e">Search yum repositories for a string</a></li>
      <li><a href="#head-bb404b1209b337c94033c43ef80b1eb673fae448">Enable or Disable a Repo from the Command Line</a></li>
      <li><a href="#head-ea1fc5d78f578114f4843e57627ebae9cc4fcb5a">Using yum with a proxy server</a></li>
      <li><a href="#head-3c061f4a180e5bc90b7f599c4e0aebdb2d5fc7f6">Use yum to install a local package, automatically checking/satisfying dependencies</a></li>
      <li><a href="#head-0b576ad62c41cbd3283b1d05e8b1f9354cd84175">Get set up for rebuilding packages as yourself, not root</a>
       <ol>
        <li><a href="#head-6b8862fe7f05374f4b70b114f1962da2660b1257">Method A</a></li>
        <li><a href="#head-08573dc463108456ada593bfe8cb8df513150663">Method B</a></li>
       </ol></li>
      <li><a href="#head-2663cef0fc3da4067caf35d54abf2f57092585b9">Display priority scores for all repositories</a></li>
      <li><a href="#head-9e731ae3e79991e694365dcb6dbbf31b6c28aa5f">Show all installed GPG keys</a></li>
      <li><a href="#head-8d4b2b50bf89405814ef598b1f0954c042d5cd29">Package signing</a></li>
      <li><a href="#head-b3159dc0594ab59a5ae0c27d86c3815085064419">Yum Groups</a></li>
     </ol>
    </div> 
    <span class="anchor" id="line-5"></span>
    <span class="anchor" id="line-6"></span>
    <p class="line874">Yum and rpm are excellent package management tools, but they have several lesser known options and features that allow you to do some very interesting things. You probably won't need to use these with any frequency, but they come in handy when you need them. <span class="anchor" id="line-7"></span><span class="anchor" id="line-8"></span></p>
    <p class="line867"> </p>
    <h2 id="head-863c703185b8f37d716f15e2a25393813ccf155c">1. Getting rpm to display architecture</h2> 
    <span class="anchor" id="line-9"></span>
    <p class="line874">This one is a pretty simple tip, and very useful especially for people using x86_64 systems. Just one line in ~/.rpmmacros will save all sorts of trouble later. <span class="anchor" id="line-10"></span><span class="anchor" id="line-11"></span></p>
    <p class="line867"><span class="anchor" id="line-12"></span></p>
    <pre>echo "%_query_all_fmt %%{name}-%%{version}-%%{release}.%%{arch}" &gt;&gt; ~/.rpmmacros</pre>
    <span class="anchor" id="line-13"></span>
    <p class="line867"> </p>
    <h2 id="head-0424f619b79e293fc743a39795b9805f1f73d249">2. Query packages not from CentOS</h2> 
    <span class="anchor" id="line-14"></span>
    <p class="line874">Want to query all those packages installed from 3rd party repositories, not CentOS? <span class="anchor" id="line-15"></span><span class="anchor" id="line-16"></span></p>
    <p class="line867"><span class="anchor" id="line-17"></span></p>
    <pre>rpm -qa --qf '%{NAME} %{VENDOR}\n' | grep -v CentOS</pre>
    <span class="anchor" id="line-18"></span>
    <p class="line867"> </p>
    <h2 id="head-20a3ecce3d0762b9cdd3307ef2632e0c274a2bfd">3. Reset File Permissions</h2> 
    <span class="anchor" id="line-19"></span>
    <p class="line874">Have you managed to completely mess up file permissions for a given package? Not a problem, because RPM has you covered. <span class="anchor" id="line-20"></span><span class="anchor" id="line-21"></span></p>
    <p class="line867"><span class="anchor" id="line-22"></span></p>
    <pre>rpm --setperms &lt;packagename&gt;</pre>
    <span class="anchor" id="line-23"></span>
    <p class="line867"> </p>
    <h2 id="head-3154e5b76c48ac44a0243d3e846bd4b8ebea7a1f">4. View the Changelog</h2> 
    <span class="anchor" id="line-24"></span>
    <p class="line874">Because CentOS and the upstream vendor have backported security patches, the version numbers can often be misleading when you look for CVE fixes. Checking the changelog of a package is a good way to see if the fix has been implemented. <span class="anchor" id="line-25"></span><span class="anchor" id="line-26"></span></p>
    <p class="line867"> </p>
    <h3 id="head-ea2efdf3b138ef503c52ee5ffbbd6cb724fbae9b">4.1. Using RPM</h3> 
    <span class="anchor" id="line-27"></span>
    <p class="line867"><span class="anchor" id="line-28"></span></p>
    <pre>rpm -q --changelog &lt;packagename&gt; | less</pre>
    <span class="anchor" id="line-29"></span>
    <p class="line874">Using less isn't necessary, but for some packages like the kernel, the changelog can be quite long. Using less helps to make things more readable. <span class="anchor" id="line-30"></span><span class="anchor" id="line-31"></span></p>
    <p class="line874">It is also possible to display RPM changelogs for RPMs not presently installed. Such as manually downloaded RPMs or ones referenced via a URL. <span class="anchor" id="line-32"></span><span class="anchor" id="line-33"></span></p>
    <pre>rpm -q --changelog -p /home/my_user/somepackage.rpm | less
<span class="anchor" id="line-34"></span>rpm -q --changelog -p http://mirror.centos.org/centos/6/os/x86_64/Packages/qemu-kvm-0.12.1.2-2.445.el6.x86_64.rpm | less</pre>
    <span class="anchor" id="line-35"></span>
    <span class="anchor" id="line-36"></span>
    <p class="line867"> </p>
    <h3 id="head-103e638fc379b3401ecf383b29c024a8b5cd6e20">4.2. Using YUM Changelog Plugin</h3> 
    <span class="anchor" id="line-37"></span>
    <p class="line874">RPM is powerful, but YUM has its advantages too. <span class="anchor" id="line-38"></span>Specifically when the Changelog plugin is coupled with YUM, it is no longer necessary to locally download or reference an RPM via URL to view the changelog <strong><span class="u">prior</span></strong> to installing the package or update. <span class="anchor" id="line-39"></span><span class="anchor" id="line-40"></span></p>
    <p class="line874">Depending on installed version of CentOS, the YUM Changelog plugin package name can differ (as seen below). <span class="anchor" id="line-41"></span></p>
    <ul>
     <li><p class="line862">CentOS 5 has the package <strong>yum-changelog</strong> <span class="anchor" id="line-42"></span></p></li>
     <li><p class="line862">CentOS 6 has the package <strong>yum-plugin-changelog</strong> <span class="anchor" id="line-43"></span></p></li>
     <li><p class="line862">CentOS 7 has the package <strong>yum-plugin-changelog</strong> <span class="anchor" id="line-44"></span><span class="anchor" id="line-45"></span></p></li>
    </ul>
    <p class="line874">Run the below yum command if you'd like to review the details for the package. <span class="anchor" id="line-46"></span>This YUM plugin is in the CentOS Base repo, but not installed by default (per a CentOS 6 install). <span class="anchor" id="line-47"></span><span class="anchor" id="line-48"></span></p>
    <pre>yum info yum-plugin-changelog</pre>
    <span class="anchor" id="line-49"></span>
    <span class="anchor" id="line-50"></span>
    <p class="line874">Install the YUM Changelog plugin as you would any regular package. <span class="anchor" id="line-51"></span><span class="anchor" id="line-52"></span></p>
    <pre>yum install yum-plugin-changelog</pre>
    <span class="anchor" id="line-53"></span>
    <span class="anchor" id="line-54"></span>
    <p class="line874">Example usage that prints the last (most recent) changelog message for the tzdata package. <span class="anchor" id="line-55"></span>Changelog notes for updates that have not been installed yet are found in the "Available Packages" section instead of the "Installed Packages" section. <span class="anchor" id="line-56"></span><span class="anchor" id="line-57"></span></p>
    <pre>yum changelog 1 tzdata | less</pre>
    <span class="anchor" id="line-58"></span>
    <span class="anchor" id="line-59"></span>
    <p class="line867"> </p>
    <h2 id="head-86c189bdfa040cb549e3e42bd464a3ea90197827">5. Where's the Documentation?</h2> 
    <span class="anchor" id="line-60"></span>
    <p class="line874">To quickly list documentation relating to a package, you can use the following two options: <span class="anchor" id="line-61"></span><span class="anchor" id="line-62"></span></p>
    <p class="line867"><span class="anchor" id="line-63"></span></p>
    <pre>rpm -qd &lt;packagename&gt;</pre>
    <span class="anchor" id="line-64"></span>
    <ul>
     <li style="list-style-type:none">This will show you the documentation contained in that rpm, or if you only have a filename you can do: <span class="anchor" id="line-65"></span></li>
    </ul>
    <p class="line867"><span class="anchor" id="line-66"></span></p>
    <pre>rpm -qdf /path/to/file</pre>
    <span class="anchor" id="line-67"></span>
    <ul>
     <li style="list-style-type:none">and rpm will show you the documentation in the package that owns the file. <span class="anchor" id="line-68"></span></li>
    </ul>
    <p class="line867"> </p>
    <h2 id="head-4afe9f3225ffbbd88682be589ecaeb62eed5e93f">6. Package Origin</h2> 
    <span class="anchor" id="line-69"></span>
    <p class="line862">Occasionally it's nice to know where you got certain packages, or how many packages you have on your system from a particular repository or vendor. There are a couple of search options that you can use which are not in the rpm man pages to help you out here. While they're not 100% perfect, they certainly help out. Most package repositories tag their packages with an identifier in the Release string. For example <a class="http" href="http://rpmforge.net">rpmforge</a> uses <em>rf</em> as their identifier. You can use this to see what you have of theirs installed with <span class="anchor" id="line-70"></span><span class="anchor" id="line-71"></span></p>
    <p class="line867"><span class="anchor" id="line-72"></span></p>
    <pre>rpm -qa release="*rf*"</pre>
    <span class="anchor" id="line-73"></span>
    <ul>
     <li style="list-style-type:none"><p class="line862">or if you want to see just how many packages you have installed built by <a href="/JohnnyHughes">JohnnyHughes</a> you could use <span class="anchor" id="line-74"></span></p></li>
    </ul>
    <p class="line867"><span class="anchor" id="line-75"></span></p>
    <pre>rpm -qa packager="Johnny*"</pre>
    <span class="anchor" id="line-76"></span>
    <p class="line862">This trick works for most categories visible in <em>rpm -qi &lt;packagename&gt;</em>. <span class="anchor" id="line-77"></span><span class="anchor" id="line-78"></span></p>
    <p class="line862">Another approach is to use the <em>keychecker</em> package available in the <a class="http" href="http://fedoraproject.org/wiki/EPEL">EPEL repository</a>, which lists rpm packages based on the GPG key they were signed with. <span class="anchor" id="line-79"></span><span class="anchor" id="line-80"></span></p>
    <p class="line867"> </p>
    <h2 id="head-543dc679c096239f65136d5958c448961176ecbc">7. Extract just one File</h2> 
    <span class="anchor" id="line-81"></span>
    <p class="line874">If you need to extract just one file from an rpm without reinstalling the whole package, you can do this with rpm2cpio. For example, to extract just the config file from the logrotate rpm you would use the following statement: <span class="anchor" id="line-82"></span><span class="anchor" id="line-83"></span></p>
    <p class="line867"><span class="anchor" id="line-84"></span></p>
    <pre>rpm2cpio logrotate-1.0-1.i386.rpm |cpio -ivd etc/logrotate.conf</pre>
    <span class="anchor" id="line-85"></span>
    <p class="line867"> </p>
    <h2 id="head-d8f160a71ea9eb45259538954a39fa5f443fba04">8. Query Package Install Order and Dates</h2> 
    <span class="anchor" id="line-86"></span>
    <p class="line874">Useful after an upgrade to find old packages that were not upgraded. <span class="anchor" id="line-87"></span><span class="anchor" id="line-88"></span></p>
    <p class="line867"><span class="anchor" id="line-89"></span></p>
    <pre>rpm -qa --last &gt;~/RPMS_by_Install_Date</pre>
    <span class="anchor" id="line-90"></span>
    <p class="line874">Review the end of the output file in "less" to find all RPMS older than the install date. Can also grep for specific packages and see when they were installed. <span class="anchor" id="line-91"></span><span class="anchor" id="line-92"></span></p>
    <p class="line867"> </p>
    <h2 id="head-61731905d2e34ac343baeef06e5dd296aeed67b9">9. Query Available Packages from a Repo</h2> 
    <span class="anchor" id="line-93"></span>
    <p class="line874">Find all packages available from a specific repository, e.g. RPMforge. This does not show the already installed packages from this repository. <span class="anchor" id="line-94"></span><span class="anchor" id="line-95"></span></p>
    <p class="line867"><span class="anchor" id="line-96"></span></p>
    <pre>yum --disablerepo "*" --enablerepo "rpmforge" list available </pre>
    <span class="anchor" id="line-97"></span>
    <p class="line867"> </p>
    <h2 id="head-9e4e8d0c8de8142cdfe2eb7e183bf51763a5cb3e">10. Search yum repositories for a string</h2> 
    <span class="anchor" id="line-98"></span>
    <p class="line874">Find packages containing a string in package name or description. <span class="anchor" id="line-99"></span><span class="anchor" id="line-100"></span></p>
    <p class="line867"><span class="anchor" id="line-101"></span></p>
    <pre>yum search buildrpmtree | less </pre>
    <span class="anchor" id="line-102"></span>
    <p class="line867"> </p>
    <h2 id="head-bb404b1209b337c94033c43ef80b1eb673fae448">11. Enable or Disable a Repo from the Command Line</h2> 
    <span class="anchor" id="line-103"></span>
    <p class="line874">For CentOS-6 only - not available in CentOS-5. <span class="anchor" id="line-104"></span><span class="anchor" id="line-105"></span></p>
    <pre>yum-config-manager --enable c6-media</pre>
    <span class="anchor" id="line-106"></span>
    <p class="line867"><span class="anchor" id="line-107"></span></p>
    <pre>yum-config-manager --disable c6-media</pre>
    <span class="anchor" id="line-108"></span>
    <p class="line867"> </p>
    <h2 id="head-ea1fc5d78f578114f4843e57627ebae9cc4fcb5a">12. Using yum with a proxy server</h2> 
    <span class="anchor" id="line-109"></span>
    <p class="line874">To enable yum operations to use a proxy server you should first add the following parameter to /etc/yum.conf <span class="anchor" id="line-110"></span><span class="anchor" id="line-111"></span></p>
    <p class="line867"><span class="anchor" id="line-112"></span></p>
    <pre>proxy=http://yourproxy:8080/  </pre>
    <span class="anchor" id="line-113"></span>
    <p class="line862">where <em>yourproxy</em> is the name of the proxy server you want to access and <em>8080</em> is the proxy port. If the server requires authentication you can specify the login credentials like: <span class="anchor" id="line-114"></span><span class="anchor" id="line-115"></span></p>
    <p class="line867"><span class="anchor" id="line-116"></span></p>
    <pre>proxy=http://username:password@yourproxy:8080/ </pre>
    <span class="anchor" id="line-117"></span>
    <p class="line874">The rpm package manager makes use of the proxy environment variable. This can be set system wide in /etc/profile or user specific in ~/.bash_profile:: <span class="anchor" id="line-118"></span><span class="anchor" id="line-119"></span></p>
    <p class="line867"><span class="anchor" id="line-120"></span></p>
    <pre>export http_proxy=http://yourproxy:8080/ export ftp_proxy=http://yourproxy:8080/ </pre>
    <span class="anchor" id="line-121"></span>
    <p class="line874">To use wget throug a proxy server add the following lines to /etc/wgetrc <span class="anchor" id="line-122"></span><span class="anchor" id="line-123"></span></p>
    <p class="line867"><span class="anchor" id="line-124"></span></p>
    <pre>http_proxy = http://yourproxy:8080/  ftp_proxy = http://yourproxy:8080/  </pre>
    <span class="anchor" id="line-125"></span>
    <p class="line874">In both cases, login information can be set like in the example above. <span class="anchor" id="line-126"></span><span class="anchor" id="line-127"></span></p>
    <p class="line867"> </p>
    <h2 id="head-3c061f4a180e5bc90b7f599c4e0aebdb2d5fc7f6">13. Use yum to install a local package, automatically checking/satisfying dependencies</h2> 
    <span class="anchor" id="line-128"></span>
    <p class="line867"><span class="anchor" id="line-129"></span></p>
    <pre>yum --nogpgcheck localinstall packagename.arch.rpm </pre>
    <span class="anchor" id="line-130"></span>
    <span class="anchor" id="line-131"></span>
    <p class="line867"> </p>
    <h2 id="head-0b576ad62c41cbd3283b1d05e8b1f9354cd84175">14. Get set up for rebuilding packages as yourself, not root</h2> 
    <span class="anchor" id="line-132"></span>
    <p class="line862">Sometimes you just <strong>have</strong> to rebuild that package - maybe only to use some configuration option which just isn't there in the official package. Or because you have found some great package which you really cannot find in the repositories, but the site only gives you RPMs for another distribution. So you have to grab the src.rpm and rebuild it for yourself. But you really <strong>do not</strong> want to do it as root. So here's how to rebuild your packages in your home directory - with your own user account. <span class="anchor" id="line-133"></span><span class="anchor" id="line-134"></span></p>
    <p class="line867"> </p>
    <h3 id="head-6b8862fe7f05374f4b70b114f1962da2660b1257">14.1. Method A</h3> 
    <span class="anchor" id="line-135"></span>
    <p class="line862">First we setup the directory you want to be working in. Note the astounding similarity to the directory structure in <tt class="backtick">/usr/src/redhat</tt>: <span class="anchor" id="line-136"></span><span class="anchor" id="line-137"></span></p>
    <p class="line867"><span class="anchor" id="line-138"></span></p>
    <pre>[testuser@hostname ~]$ cd
<span class="anchor" id="line-139"></span>[testuser@hostname ~]$ mkdir -p rpmbuild/{BUILD,RPMS,SPECS,SOURCES,SRPMS}
<span class="anchor" id="line-140"></span>[testuser@hostname ~]$ ls rpmbuild/
<span class="anchor" id="line-141"></span>BUILD RPMS SOURCES SPECS SRPMS
<span class="anchor" id="line-142"></span>[testuser@hostname ~]$</pre>
    <span class="anchor" id="line-143"></span>
    <p class="line874">Then we fiddle with some rpm macros, so rpmbuild knows about you and where you want to build: <span class="anchor" id="line-144"></span><span class="anchor" id="line-145"></span></p>
    <p class="line867"><span class="anchor" id="line-146"></span></p>
    <pre>[testuser@hostname ~]$ echo "%_topdir /home/testuser/rpmbuild" &gt;&gt; ~/.rpmmacros
<span class="anchor" id="line-147"></span>[testuser@hostname ~]$ echo "%packager Test User &lt;testuser@example.com&gt;" &gt;&gt; ~/.rpmmacros
<span class="anchor" id="line-148"></span>[testuser@hostname ~]$ cat ~/.rpmmacros
<span class="anchor" id="line-149"></span>%_topdir /home/testuser/rpmbuild
<span class="anchor" id="line-150"></span>%packager Test User &lt;testuser@example.com&gt;
<span class="anchor" id="line-151"></span>[testuser@hostname ~]$</pre>
    <span class="anchor" id="line-152"></span>
    <p class="line862">That is it. The next time you issue <tt class="backtick">rpmbuild&nbsp;--rebuild&nbsp;foo.src.rpm</tt>, your results will be in <tt class="backtick">~/rpmbuild/RPMS/i386</tt> (or whichever architecture you just built your package for). Easy, isn't it? <span class="anchor" id="line-153"></span><span class="anchor" id="line-154"></span></p>
    <p class="line867"> </p>
    <h3 id="head-08573dc463108456ada593bfe8cb8df513150663">14.2. Method B</h3> 
    <span class="anchor" id="line-155"></span>
    <p class="line862">For CentOS-4, configure the kbs-Extras repo (optionally add kbs-Misc) from the <a href="/Repositories">Repositories</a> page and "yum install fedora-rpmdevtools" as root using "sudo" or "su -". As the build user (may want to use a special account for this to avoid problems in your normal user home directory) do "fedora-buildrpmtree" and an ~/rpmbuild/... directory tree and ~/.rpmmacros file will be automagically created. <span class="anchor" id="line-156"></span><span class="anchor" id="line-157"></span></p>
    <p class="line862">For CentOS-5 - A package for rpmdevtools is available in the EPEL repo from the <a href="/Repositories">Repositories</a> page. <span class="anchor" id="line-158"></span><span class="anchor" id="line-159"></span></p>
    <p class="line874">The following addition to the macros may be needed to get proper names for some packages (substitute appropriate distro version for "el4" as required): <span class="anchor" id="line-160"></span><span class="anchor" id="line-161"></span></p>
    <p class="line867"><span class="anchor" id="line-162"></span></p>
    <pre>[testuser@hostname ~]$ echo "%dist .el4" &gt;&gt; .rpmmacros </pre>
    <span class="anchor" id="line-163"></span>
    <span class="anchor" id="line-164"></span>
    <p class="line867"> </p>
    <h2 id="head-2663cef0fc3da4067caf35d54abf2f57092585b9">15. Display priority scores for all repositories</h2> 
    <span class="anchor" id="line-165"></span>
    <p class="line862">You can list all repositories set up on your system by a <strong>yum repolist all</strong>. However, this does not show priority scores. Here's a one liner for that. If no number is defined, the default is the lowest priority (99). <span class="anchor" id="line-166"></span><span class="anchor" id="line-167"></span></p>
    <p class="line867"><span class="anchor" id="line-168"></span></p>
    <pre>sed -n -e "/^\[/h; /priority *=/{ G; s/\n/ /; s/ity=/ity = /; p }" /etc/yum.repos.d/*.repo | sort -k3n </pre>
    <span class="anchor" id="line-169"></span>
    <span class="anchor" id="line-170"></span>
    <p class="line867"> </p>
    <h2 id="head-9e731ae3e79991e694365dcb6dbbf31b6c28aa5f">16. Show all installed GPG keys</h2> 
    <span class="anchor" id="line-171"></span>
    <span class="anchor" id="line-172"></span>
    <p class="line862">Thanks to forum user babo for this <a class="https" href="https://www.centos.org/forums/viewtopic.php?p=102879#p102879">one-liner</a> to show all GPG keys along with the corresponding repo information. <span class="anchor" id="line-173"></span><span class="anchor" id="line-174"></span></p>
    <pre>rpm -q gpg-pubkey --qf '%{name}-%{version}-%{release} --&gt; %{summary}\n' </pre>
    <span class="anchor" id="line-175"></span>
    <span class="anchor" id="line-176"></span>
    <p class="line867"> </p>
    <h2 id="head-8d4b2b50bf89405814ef598b1f0954c042d5cd29">17. Package signing</h2> 
    <span class="anchor" id="line-177"></span>
    <span class="anchor" id="line-178"></span>
    <p class="line862">If you want to sign your packages so that others can verify that the package really has been done by you, you can do that rather easily with rpm. Instead of reproducing the documentation here, the <a class="http" href="http://docs.fedoraproject.org/en-US/Fedora_Draft_Documentation/0.1/html/RPM_Guide/ch11s04.html">Fedora RPM packaging guide</a> (though still a draft) has a chapter on that. <span class="anchor" id="line-179"></span><span class="anchor" id="line-180"></span></p>
    <p class="line874">Be aware of a few caveats: <span class="anchor" id="line-181"></span><span class="anchor" id="line-182"></span></p>
    <p class="line874">For CentOS 4 and CentOS 5 it would be best if you use a DSA key for signing, there are no known issues with that. <span class="anchor" id="line-183"></span><span class="anchor" id="line-184"></span></p>
    <div>
     <table>
      <tbody>
       <tr> 
        <td class="lmimg red"><p class="line862"> <img class="attachment" src="/ArtWork/WikiDesign?action=AttachFile&amp;do=get&amp;target=icon-admonition-attention.png" title="attachment:ArtWork/WikiDesign/icon-admonition-attention.png"> </p></td> 
        <td class="lmtxt red" colspan="2" style="text-align: left"><p class="line862"> <strong>Warning:</strong> If you use RSA keys for signing, gpg will default to use version 4 signatures. The rpm in CentOS 4 and 5 cannot handle those when checking signatures. You can force rpm (or rather gpg) to do version 3 signatures. See <a class="https" href="https://bugzilla.redhat.com/show_bug.cgi?id=436812#c12">this Bugzilla entry</a> on how to put a macro doing that into your ~/.rpmmacros file. Please read the complete discussion to understand the issue </p></td> 
       </tr> 
      </tbody>
     </table>
    </div>
    <span class="anchor" id="line-185"></span>
    <span class="anchor" id="line-186"></span>
    <p class="line867"> </p>
    <h2 id="head-b3159dc0594ab59a5ae0c27d86c3815085064419">18. Yum Groups</h2> 
    <span class="anchor" id="line-187"></span>
    <span class="anchor" id="line-188"></span>
    <p class="line874">You can list yum groups with: <span class="anchor" id="line-189"></span><span class="anchor" id="line-190"></span></p>
    <pre>yum grouplist </pre>
    <span class="anchor" id="line-191"></span>
    <span class="anchor" id="line-192"></span>
    <p class="line874">and for more (hidden) groups including the group ids, try: <span class="anchor" id="line-193"></span><span class="anchor" id="line-194"></span></p>
    <pre>yum grouplist hidden ids </pre>
    <span class="anchor" id="line-195"></span>
    <span class="anchor" id="line-196"></span>
    <p class="line874">To install a group by it's group ID (for example, the "X Window System (x11)" group): <span class="anchor" id="line-197"></span><span class="anchor" id="line-198"></span></p>
    <pre>yum groupinstall x11 </pre>
    <span class="anchor" id="line-199"></span>
    <span class="anchor" id="bottom"></span>
   </div>
   <p id="pageinfo" class="info" lang="en" dir="ltr">TipsAndTricks/YumAndRPM (last edited 2015-05-07 22:44:18 by <span title="MichaelBear"><a class="mailto" href="mailto:silvertip257@gmail.com" title="MichaelBear">MichaelBear</a></span>)</p> 
   <div id="pagebottom"></div> 
  </div> 
  <div id="footer"> 
   <div class="pageline">
    <hr style="display:none;">
   </div> 
   <ul class="navibar"> 
    <li class="wikilink"><a href="/FrontPage">FrontPage</a></li>
    <li class="wikilink"><a href="/Documentation">Help</a></li>
    <li class="wikilink"><a href="/TipsAndTricks">Tips and Tricks</a></li>
    <li class="wikilink"><a href="/HowTos">How To</a></li>
    <li class="wikilink"><a href="/FAQ">FAQs</a></li>
    <li class="wikilink"><a href="/Events">Events</a></li>
    <li class="wikilink"><a href="/Contribute">Contribute</a></li>
    <li class="wikilink"><a href="/RecentChanges">Changelog</a></li>
    <li class="current"><a href="/TipsAndTricks/YumAndRPM">TipsAndTricks/YumAndRPM</a></li> 
   </ul> 
   <div id="credits"> 
    <strong><a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/"> <img alt="Creative Commons License" style="border-width:0" src="/wiki/common/cc-somerights20.png"> </a></strong> 
    <br>This wiki is licensed under a 
    <em> <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-Share Alike 3.0 Unported License</a></em>. 
   </div> 
  </div>  
 </body>
</html>