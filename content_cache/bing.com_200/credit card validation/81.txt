<!doctype html>
<!--[if lt IE 10]><html class="no-js ie8 oldie" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#"

  
    itemscope itemtype="http://schema.org/Book http://schema.org/ItemPage" data-offline-url="/"
data-url="/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html"
data-archive="9781449327453"
data-publishers="O&#39;Reilly Media, Inc."


  data-htmlfile-name="ch04s20.html"
  data-epub-title="Regular Expressions Cookbook, 2nd Edition"
  


data-debug="0" ><![endif]-->
<!--[if gt IE 9]><!-->
<html class="no-js" lang="en" prefix="og: http://ogp.me/ns/# og:book: http://ogp.me/ns/book# og:video: http://ogp.me/ns/video#" itemscope itemtype="http://schema.org/Book http://schema.org/ItemPage" data-offline-url="/" data-url="/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html" data-archive="9781449327453" data-publishers="O'Reilly Media, Inc." data-htmlfile-name="ch04s20.html" data-epub-title="Regular Expressions Cookbook, 2nd Edition" data-debug="0">
 <!--<![endif]-->
 <head> 
  <meta charset="UTF-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge"> 
  <title>4.20. Validate Credit Card Numbers - Regular Expressions Cookbook, 2nd Edition [Book]</title> 
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <link rel="stylesheet" href="/library/view/static/CACHE/css/263a54664f8a.css" type="text/css"> 
  <link href="//fonts.googleapis.com/css?family=Source+Sans+Pro" rel="stylesheet" type="text/css"> 
  <meta property="og:title" content="4.20. Validate Credit Card Numbers [Book]"> 
  <meta itemprop="isPartOf" content="/library/view/regular-expressions-cookbook/9781449327453/"> 
  <meta itemprop="name" content="4.20. Validate Credit Card Numbers"> 
  <meta property="og:url" itemprop="url" content="https://www.safaribooksonline.com/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html"> 
  <meta property="og:site_name" content="Safari"> 
  <meta property="og:image" itemprop="thumbnailUrl" content="https://www.safaribooksonline.com/library/cover/9781449327453/"> 
  <meta property="og:description" itemprop="description" name="description" content="4.20.&nbsp;Validate Credit Card Numbers Problem You’re given the job of implementing an order form for a company that accepts payment by credit card. Since the credit card ...  - Selection from Regular Expressions Cookbook, 2nd Edition [Book]"> 
  <meta itemprop="inLanguage" content="en"> 
  <meta itemprop="publisher" content="O'Reilly Media, Inc."> 
  <meta property="og:type" content="book"> 
  <meta property="og:book:isbn" itemprop="isbn" content="9781449319434"> 
  <meta property="og:book:author" itemprop="author" content="Steven Levithan"> 
  <meta property="og:book:author" itemprop="author" content="Jan Goyvaerts"> 
  <meta property="og:book:tag" itemprop="about" content="Information Technology/Operations"> 
  <meta name="twitter:card" content="summary"> 
  <meta name="twitter:site" content="@safari"> 
  <!-- Start Visual Website Optimizer Asynchronous Code --> 
  <script type="text/javascript">
var _vwo_code=(function(){
var account_id=291788,
settings_tolerance=2000,
library_tolerance=2500,
use_existing_jquery=false,
/* DO NOT EDIT BELOW THIS LINE */
f=false,d=document;return{use_existing_jquery:function(){return use_existing_jquery;},library_tolerance:function(){return library_tolerance;},finish:function(){if(!f){f=true;var a=d.getElementById('_vis_opt_path_hides');if(a)a.parentNode.removeChild(a);}},finished:function(){return f;},load:function(a){var b=d.createElement('script');b.src=a;b.type='text/javascript';b.innerText;b.onerror=function(){_vwo_code.finish();};d.getElementsByTagName('head')[0].appendChild(b);},init:function(){settings_timer=setTimeout('_vwo_code.finish()',settings_tolerance);var a=d.createElement('style'),b='body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}',h=d.getElementsByTagName('head')[0];a.setAttribute('id','_vis_opt_path_hides');a.setAttribute('type','text/css');if(a.styleSheet)a.styleSheet.cssText=b;else a.appendChild(d.createTextNode(b));h.appendChild(a);this.load('//dev.visualwebsiteoptimizer.com/j.php?a='+account_id+'&u='+encodeURIComponent(d.URL)+'&r='+Math.random());return settings_timer;}};}());_vwo_settings_timer=_vwo_code.init();
</script> 
  <!-- End Visual Website Optimizer Asynchronous Code --> 
  <link rel="shortcut icon" href="//www.safaribooksonline.com/favicon.ico" type="image/vnd.microsoft.icon"> 
  <link rel="apple-touch-icon" href="//www.safaribooksonline.com/static/corp/img/apple-touch-icon.png"> 
  <style type="text/css" title="ibis-book">
    @charset "utf-8";#sbo-rt-content html,#sbo-rt-content div,#sbo-rt-content div,#sbo-rt-content span,#sbo-rt-content applet,#sbo-rt-content object,#sbo-rt-content iframe,#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6,#sbo-rt-content p,#sbo-rt-content blockquote,#sbo-rt-content pre,#sbo-rt-content a,#sbo-rt-content abbr,#sbo-rt-content acronym,#sbo-rt-content address,#sbo-rt-content big,#sbo-rt-content cite,#sbo-rt-content code,#sbo-rt-content del,#sbo-rt-content dfn,#sbo-rt-content em,#sbo-rt-content font,#sbo-rt-content img,#sbo-rt-content ins,#sbo-rt-content kbd,#sbo-rt-content q,#sbo-rt-content s,#sbo-rt-content samp,#sbo-rt-content small,#sbo-rt-content strike,#sbo-rt-content strong,#sbo-rt-content sub,#sbo-rt-content sup,#sbo-rt-content tt,#sbo-rt-content var,#sbo-rt-content b,#sbo-rt-content u,#sbo-rt-content i,#sbo-rt-content center,#sbo-rt-content dl,#sbo-rt-content dt,#sbo-rt-content dd,#sbo-rt-content ol,#sbo-rt-content ul,#sbo-rt-content li,#sbo-rt-content fieldset,#sbo-rt-content form,#sbo-rt-content label,#sbo-rt-content legend,#sbo-rt-content table,#sbo-rt-content caption,#sbo-rt-content tdiv,#sbo-rt-content tfoot,#sbo-rt-content thead,#sbo-rt-content tr,#sbo-rt-content th,#sbo-rt-content td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}@page{margin:5px !important}#sbo-rt-content p{margin:8px 0 0}#sbo-rt-content span.bolditalic{font-weight:bold;font-style:italic}#sbo-rt-content strong,#sbo-rt-content span.bold{font-weight:bold;font-family:serif}#sbo-rt-content a.ulink,#sbo-rt-content a.xref,#sbo-rt-content a.email{text-decoration:none;color:#8e0012}#sbo-rt-content sup{font-size:x-small;vertical-align:super}#sbo-rt-content sub{font-size:smaller;vertical-align:sub}#sbo-rt-content span.lineannotation{font-style:italic;color:red;font-family:serif}#sbo-rt-content span.underline{text-decoration:underline}#sbo-rt-content span.strikethrough{text-decoration:line-through}#sbo-rt-content span.smallcaps{font-variant:small-caps}#sbo-rt-content span.cursor{background:#000;color:#FFF}#sbo-rt-content span.smaller{font-size:75%}#sbo-rt-content .boxedtext,#sbo-rt-content .keycap{border-style:solid;border-width:1px;border-color:#000;padding:1px}#sbo-rt-content span.gray50{color:#7F7F7F;}#sbo-rt-content .gray-background,#sbo-rt-content .reverse-video{background:#2E2E2E;color:#FFF}#sbo-rt-content .light-gray-background{background:#A0A0A0}#sbo-rt-content .preserve-whitespace{white-space:pre-wrap}#sbo-rt-content h1{font-size:1.5em;font-weight:bold;font-family:"Free Sans Bold",sans-serif;margin-top:20px !important}#sbo-rt-content h2{font-size:1.3em;font-weight:bold;font-family:"Free Sans Bold",sans-serif;color:#8e0012;margin:15px 0 8px 0 !important}#sbo-rt-content h3{font-size:1.1em;font-weight:bold;font-family:"Free Sans Bold",sans-serif;margin:10px 0 8px 0 !important}#sbo-rt-content h4{font-size:bold;font-weight:1em;font-family:"Free Sans Bold",sans-serif;color:#555;margin:9px 0 !important}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4{-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none;page-break-after:avoid}#sbo-rt-content div.titlepage{page-break-inside:avoid}#sbo-rt-content div.chapter>div.titlepage:first-child h1.title,#sbo-rt-content div.preface>div.titlepage:first-child h1.title,#sbo-rt-content div.appendix>div.titlepage:first-child h1.title{font-size:2em;line-height:1;margin-bottom:15px}#sbo-rt-content img{max-width:95%;margin:0 auto;padding:0}#sbo-rt-content div.figure{margin:10px 0 !important;text-align:center;-webkit-border-radius:5px;border-radius:5px;border:1px solid #000;background-color:transparent;padding:5px !important;page-break-inside:avoid}#sbo-rt-content div.figure p.title,#sbo-rt-content div.informalfigure div.caption{font-size:90%;text-align:center;font-weight:normal;font-style:italic;font-family:"Free Serif",serif;color:#000;padding:5px !important;page-break-before:avoid;page-break-after:avoid}#sbo-rt-content div.informalfigure{text-align:center;padding:5px 0 !important}#sbo-rt-content div.sidebar{margin:10px 0 !important;-webkit-border-radius:5px;border-radius:5px;border:1px solid #000;background-color:transparent;font-size:90%;padding:10px 8px !important;page-break-inside:avoid}#sbo-rt-content div.sidebar p.title{font:bold 1em;font-family:"Free Sans Bold",sans-serif;text-transform:uppercase;letter-spacing:1px;text-align:center;margin:4px 0 6px 0 !important;page-break-inside:avoid}#sbo-rt-content div.sidebar ol{margin-left:15px}#sbo-rt-content div.sidebar div.tip,#sbo-rt-content div.sidebar div.note,#sbo-rt-content div.sidebar div.warning,#sbo-rt-content div.sidebar div.caution,#sbo-rt-content div.sidebar div.important{margin:10px 12.5% !important;font-size:90%;padding:10px 5px !important;width:75%}#sbo-rt-content div.sidebar div.tip,#sbo-rt-content div.sidebar div.note{background-color:#f1f6fc;border:none}#sbo-rt-content div.sidebar div.warning,#sbo-rt-content div.sidebar div.caution{background-color:#fce5e8}#sbo-rt-content div.sidebar div.important{background-color:#FBEC5D}#sbo-rt-content div.sidebar div.figure{border:none}#sbo-rt-content pre{white-space:pre-wrap;font-family:"Ubuntu Mono",monospace;margin:10px 0 10px 20px;font-size:85%;display:block;-webkit-hyphens:none;hyphens:none;adobe-hyphenate:none}#sbo-rt-content code{font-family:"Ubuntu Mono",monospace}#sbo-rt-content code strong em,#sbo-rt-content code em strong,#sbo-rt-content pre em strong,#sbo-rt-content pre strong em,#sbo-rt-content strong code em code,#sbo-rt-content em code strong code,#sbo-rt-content span.bolditalic code{font-weight:bold;font-style:italic;font-family:"Ubuntu Mono BoldItal",monospace}#sbo-rt-content code em,#sbo-rt-content em code,#sbo-rt-content pre em,#sbo-rt-content em.replaceable{font-family:"Ubuntu Mono Ital",monospace;font-style:italic}#sbo-rt-content code strong,#sbo-rt-content strong code,#sbo-rt-content pre strong,#sbo-rt-content strong.userinput{font-family:"Ubuntu Mono Bold",monospace;font-weight:bold}#sbo-rt-content div.example{margin:10px 0 15px 0 !important}#sbo-rt-content div.example p.title{font-style:italic;font-weight:normal;font-family:"Free Serif",serif;margin:10px 0 5px 0 !important}#sbo-rt-content li pre.example{padding:10px 0 !important}#sbo-rt-content div.example-contents pre.programlisting,#sbo-rt-content div.example-contents pre.screen{margin:0}#sbo-rt-content div.book div.titlepage h1.title{font-size:3em;font-family:"Free Sans Bold",sans-serif;margin:50px 0 10px 0 !important;line-height:1;text-align:center}#sbo-rt-content div.book div.titlepage h2.subtitle{text-align:center;color:#000;margin:0 !important;font-style:italic;font-family:serif;font-size:1.5em}#sbo-rt-content div.book div.titlepage div.author h3{font-size:2em;font-family:"Free Sans Bold",sans-serif;color:#8e0012;margin:50px 0 !important;text-align:center}#sbo-rt-content div.book div.titlepage div.publishername{margin-top:60%;margin-bottom:20px;text-align:center;font-size:1.25em}#sbo-rt-content div.book div.titlepage div.locations p{margin:0;text-align:center}#sbo-rt-content div.book div.titlepage div.locations p.cities{font-size:80%;text-align:center;margin-top:5px}#sbo-rt-content div.preface[title="Dedication"]>div.titlepage h1.title{text-align:center;text-transform:uppercase;font-size:1.5em;margin-top:50px;margin-bottom:50px}#sbo-rt-content div.preface[title="Dedication"] p{font-style:italic;text-align:center}#sbo-rt-content div.colophon h1.title{font-size:1.3em;margin:0 !important;font-family:"Free serif",serif;font-weight:normal}#sbo-rt-content div.colophon h2.subtitle{margin:0 !important;color:#000;font-family:"Free serif",serif;font-size:1em;font-weight:normal}#sbo-rt-content div.colophon div.author h3.author{font-size:1.1em;font-family:"Free serif",serif;margin:10px 0 0 !important;font-weight:normal}#sbo-rt-content div.colophon div.editor h4,#sbo-rt-content div.colophon div.editor h3.editor{color:#000;font-size:.8em;margin:15px 0 0 !important;font-family:"Free serif",serif;font-weight:normal}#sbo-rt-content div.colophon div.editor h3.editor{font-size:.8em;margin:0 !important;font-family:"Free serif",serif;font-weight:normal}#sbo-rt-content div.colophon div.publisher{margin-top:10px}#sbo-rt-content div.colophon div.publisher p,#sbo-rt-content div.colophon div.publisher span.publishername{margin:0;font-size:.8em}#sbo-rt-content div.legalnotice p,#sbo-rt-content div.timestamp p{font-size:.8em}#sbo-rt-content div.timestamp p{margin-top:10pt}#sbo-rt-content div.colophon[title="About the Author"] h1.title,#sbo-rt-content div.colophon[title="Colophon"] h1.title{font-size:1.5em;margin:0 !important;font-family:"Free Sans",sans-serif;font-weight:bold}#sbo-rt-content div.attribution{margin:5px 0 0 50px !important}#sbo-rt-content h3.author span.orgname{display:none}#sbo-rt-content div.epigraph{margin:10px 0 10px 20px !important;page-break-inside:avoid;font-size:90%}#sbo-rt-content blockquote,#sbo-rt-content div.blockquote{margin:10px 0 10px 5px !important;page-break-inside:avoid;font-size:95%}#sbo-rt-content blockquote p,#sbo-rt-content div.blockquote p{font-style:italic;font-family:"Free Serif",serif}#sbo-rt-content blockquote div.attribution{margin:5px 0 0 30px !important;text-align:right;width:80%}#sbo-rt-content blockquote div.attribution p{font-style:normal}#sbo-rt-content p.right{text-align:right;margin:0}#sbo-rt-content div.footnote{font-size:90%}#sbo-rt-content div.refnamediv h2,#sbo-rt-content div.refnamediv h3,#sbo-rt-content div.refsynopsisdiv h2{font-size:1.1em;color:#000;margin-top:15px !important;margin-bottom:0 !important}#sbo-rt-content div.refentry div.refsect1 h2{font-size:1.1em;color:#000;margin-top:15px !important;margin-bottom:0 !important}#sbo-rt-content div.refsect2 h3{font-size:1em;color:#000;margin-top:10px !important;margin-bottom:0 !important}#sbo-rt-content div.refnamediv p{margin-left:15px !important}#sbo-rt-content dt{padding-top:10px !important;padding-bottom:0 !important}#sbo-rt-content dd{margin-left:1.5em !important}#sbo-rt-content ol{list-style-type:decimal;margin-top:8px !important;margin-bottom:8px !important;margin-left:20px !important;padding-left:25px !important}#sbo-rt-content ol ol{list-style-type:lower-alpha}#sbo-rt-content ol ol ol{list-style-type:lower-roman}#sbo-rt-content ul{list-style-type:square;margin-top:8px !important;margin-bottom:8px !important;margin-left:5px !important;padding-left:20px !important}#sbo-rt-content ul ul{list-style-type:none;padding-left:0 !important;margin-left:0 !important}#sbo-rt-content ul ul li p:before{content:"— "}#sbo-rt-content ul ul ul li p:before{content:""}#sbo-rt-content ul ul ul{list-style-type:square;margin-left:20px !important;padding-left:30px !important}#sbo-rt-content div.orderedlistalpha{list-style-type:upper-alpha}#sbo-rt-content table.simplelist{margin-left:20px !important;margin-bottom:10px}#sbo-rt-content table.simplelist td{border:none;font-size:90%}#sbo-rt-content table.simplelist tr{border-bottom:none}#sbo-rt-content table.simplelist tr:nth-of-type(even){background-color:transparent}#sbo-rt-content div.calloutlist p:first-child{margin-top:-25px !important}#sbo-rt-content div.calloutlist dd{padding-left:40px !important}#sbo-rt-content div.calloutlist img{padding:0}#sbo-rt-content a.co img{padding:0}#sbo-rt-content div.tip,#sbo-rt-content div.note,#sbo-rt-content div.warning,#sbo-rt-content div.caution,#sbo-rt-content div.important{margin:10px 0 !important;-webkit-border-radius:5px;border-radius:5px;font-size:90%;padding:10px 8px 20px 8px !important;page-break-inside:avoid}#sbo-rt-content div.tip,#sbo-rt-content div.note{border:1px solid #6cafd0;background-color:transparent}#sbo-rt-content div.warning,#sbo-rt-content div.caution{border:1px solid #8e0012;background-color:#fce5e8}#sbo-rt-content div.important{background-color:#FFF68F;border:1px solid #615E3F}#sbo-rt-content div.tip h3,#sbo-rt-content div.note h3,#sbo-rt-content div.warning h3,#sbo-rt-content div.caution h3,#sbo-rt-content div.important h3{font:bold 90%;font-family:"Free Sans Bold",sans-serif;text-transform:uppercase;letter-spacing:1px;text-align:center;margin:4px 0 6px !important;color:#000}#sbo-rt-content div.table,#sbo-rt-content table{margin:10px auto !important;max-width:95%;border-collapse:collapse;border-spacing:0}#sbo-rt-content div.table,#sbo-rt-content div.informaltable{page-break-inside:avoid}#sbo-rt-content tr{border-bottom:1px solid #c3c3c3}#sbo-rt-content tr th{border-bottom:#9d9d9d 2px solid !important;border-top:#9d9d9d 2px solid !important}#sbo-rt-content tr:nth-of-type(even){background-color:#f1f6fc}#sbo-rt-content th{font-family:"Free Sans Bold",sans-serif;color:#000;font-weight:bold}#sbo-rt-content td,#sbo-rt-content th{padding:.3em;text-align:left;vertical-align:baseline;font-size:80%}#sbo-rt-content div.informaltable table{margin:10px auto !important}#sbo-rt-content div.informaltable table tr{border-bottom:none}#sbo-rt-content div.informaltable table tr:nth-of-type(even){background-color:transparent}#sbo-rt-content div.informaltable td,#sbo-rt-content div.informaltable th{border:#9d9d9d 1px solid}#sbo-rt-content div.table p.title{font-weight:normal;font-style:italic;font-family:"Free Serif",serif;margin:20px 0 0 0 !important;text-align:center;padding:0}#sbo-rt-content table code{font-size:smaller}#sbo-rt-content div.equation p.title{font-weight:normal;font-style:italic;font-family:"Free Serif",serif;margin:20px 0 10px 0 !important;page-break-after:avoid}#sbo-rt-content div.equation-contents{margin-left:20px}#sbo-rt-content span.inlinemediaobject{height:.85em;display:inline-block;margin-bottom:.2em}#sbo-rt-content span.inlinemediaobject img{margin:0;height:.85em}#sbo-rt-content div.informalequation{margin:20px 0 20px 20px;width:75%}#sbo-rt-content div.informalequation img{width:75%}#sbo-rt-content code.boolean,#sbo-rt-content .navy{color:rgb(0,0,128);}#sbo-rt-content code.character,#sbo-rt-content .olive{color:rgb(128,128,0);}#sbo-rt-content code.comment,#sbo-rt-content .blue{color:rgb(0,0,255);}#sbo-rt-content code.conditional,#sbo-rt-content .limegreen{color:rgb(50,205,50);}#sbo-rt-content code.constant,#sbo-rt-content .darkorange{color:rgb(255,140,0);}#sbo-rt-content code.debug,#sbo-rt-content .darkred{color:rgb(139,0,0);}#sbo-rt-content code.define,#sbo-rt-content .darkgoldenrod,#sbo-rt-content .gold{color:rgb(184,134,11);}#sbo-rt-content code.delimiter,#sbo-rt-content .dimgray{color:rgb(105,105,105);}#sbo-rt-content code.error,#sbo-rt-content .red{color:rgb(255,0,0);}#sbo-rt-content code.exception,#sbo-rt-content .salmon{color:rgb(250,128,11);}#sbo-rt-content code.float,#sbo-rt-content .steelblue{color:rgb(70,130,180);}#sbo-rt-content code.function,#sbo-rt-content .green{color:rgb(0,128,0);}#sbo-rt-content code.identifier,#sbo-rt-content .royalblue{color:rgb(65,105,225);}#sbo-rt-content code.ignore,#sbo-rt-content .gray{color:rgb(128,128,128);}#sbo-rt-content code.include,#sbo-rt-content .purple{color:rgb(128,0,128);}#sbo-rt-content code.keyword,#sbo-rt-content .sienna{color:rgb(160,82,45);}#sbo-rt-content code.label,#sbo-rt-content .deeppink{color:rgb(255,20,147);}#sbo-rt-content code.macro,#sbo-rt-content .orangered{color:rgb(255,69,0);}#sbo-rt-content code.number,#sbo-rt-content .brown{color:rgb(165,42,42);}#sbo-rt-content code.operator,#sbo-rt-content .black{color:#000;}#sbo-rt-content code.preCondit,#sbo-rt-content .teal{color:rgb(0,128,128);}#sbo-rt-content code.preProc,#sbo-rt-content .fuschia{color:rgb(255,0,255);}#sbo-rt-content code.repeat,#sbo-rt-content .indigo{color:rgb(75,0,130);}#sbo-rt-content code.special,#sbo-rt-content .saddlebrown{color:rgb(139,69,19);}#sbo-rt-content code.specialchar,#sbo-rt-content .magenta{color:rgb(255,0,255);}#sbo-rt-content code.specialcomment,#sbo-rt-content .seagreen{color:rgb(46,139,87);}#sbo-rt-content code.statement,#sbo-rt-content .forestgreen{color:rgb(34,139,34);}#sbo-rt-content code.storageclass,#sbo-rt-content .plum{color:rgb(221,160,221);}#sbo-rt-content code.string,#sbo-rt-content .darkred{color:rgb(139,0,0);}#sbo-rt-content code.structure,#sbo-rt-content .chocolate{color:rgb(210,106,30);}#sbo-rt-content code.tag,#sbo-rt-content .darkcyan{color:rgb(0,139,139);}#sbo-rt-content code.todo,#sbo-rt-content .black{color:#000;}#sbo-rt-content code.type,#sbo-rt-content .mediumslateblue{color:rgb(123,104,238);}#sbo-rt-content code.typedef,#sbo-rt-content .darkgreen{color:rgb(0,100,0);}#sbo-rt-content code.underlined{text-decoration:underline;}#sbo-rt-content pre code.hll{background-color:#ffc}#sbo-rt-content pre code.c{color:#09F;font-style:italic}#sbo-rt-content pre code.err{color:#A00}#sbo-rt-content pre code.k{color:#069;font-weight:bold}#sbo-rt-content pre code.o{color:#555}#sbo-rt-content pre code.cm{color:#35586C;font-style:italic}#sbo-rt-content pre code.cp{color:#099}#sbo-rt-content pre code.c1{color:#35586C;font-style:italic}#sbo-rt-content pre code.cs{color:#35586C;font-weight:bold;font-style:italic}#sbo-rt-content pre code.gd{background-color:#FCC}#sbo-rt-content pre code.ge{font-style:italic}#sbo-rt-content pre code.gr{color:#F00}#sbo-rt-content pre code.gh{color:#030;font-weight:bold}#sbo-rt-content pre code.gi{background-color:#CFC}#sbo-rt-content pre code.go{color:#AAA}#sbo-rt-content pre code.gp{color:#009;font-weight:bold}#sbo-rt-content pre code.gs{font-weight:bold}#sbo-rt-content pre code.gu{color:#030;font-weight:bold}#sbo-rt-content pre code.gt{color:#9C6}#sbo-rt-content pre code.kc{color:#069;font-weight:bold}#sbo-rt-content pre code.kd{color:#069;font-weight:bold}#sbo-rt-content pre code.kn{color:#069;font-weight:bold}#sbo-rt-content pre code.kp{color:#069}#sbo-rt-content pre code.kr{color:#069;font-weight:bold}#sbo-rt-content pre code.kt{color:#078;font-weight:bold}#sbo-rt-content pre code.m{color:#F60}#sbo-rt-content pre code.s{color:#C30}#sbo-rt-content pre code.na{color:#309}#sbo-rt-content pre code.nb{color:#366}#sbo-rt-content pre code.nc{color:#0A8;font-weight:bold}#sbo-rt-content pre code.no{color:#360}#sbo-rt-content pre code.nd{color:#99F}#sbo-rt-content pre code.ni{color:#999;font-weight:bold}#sbo-rt-content pre code.ne{color:#C00;font-weight:bold}#sbo-rt-content pre code.nf{color:#C0F}#sbo-rt-content pre code.nl{color:#99F}#sbo-rt-content pre code.nn{color:#0CF;font-weight:bold}#sbo-rt-content pre code.nt{color:#309;font-weight:bold}#sbo-rt-content pre code.nv{color:#033}#sbo-rt-content pre code.ow{color:#000;font-weight:bold}#sbo-rt-content pre code.w{color:#bbb}#sbo-rt-content pre code.mf{color:#F60}#sbo-rt-content pre code.mh{color:#F60}#sbo-rt-content pre code.mi{color:#F60}#sbo-rt-content pre code.mo{color:#F60}#sbo-rt-content pre code.sb{color:#C30}#sbo-rt-content pre code.sc{color:#C30}#sbo-rt-content pre code.sd{color:#C30;font-style:italic}#sbo-rt-content pre code.s2{color:#C30}#sbo-rt-content pre code.se{color:#C30;font-weight:bold}#sbo-rt-content pre code.sh{color:#C30}#sbo-rt-content pre code.si{color:#A00}#sbo-rt-content pre code.sx{color:#C30}#sbo-rt-content pre code.sr{color:#3AA}#sbo-rt-content pre code.s1{color:#C30}#sbo-rt-content pre code.ss{color:#FC3}#sbo-rt-content pre code.bp{color:#366}#sbo-rt-content pre code.vc{color:#033}#sbo-rt-content pre code.vg{color:#033}#sbo-rt-content pre code.vi{color:#033}#sbo-rt-content pre code.il{color:#F60}#sbo-rt-content pre code.g{color:#050}#sbo-rt-content pre code.l{color:#C60}#sbo-rt-content pre code.l{color:#F90}#sbo-rt-content pre code.n{color:#008}#sbo-rt-content pre code.nx{color:#008}#sbo-rt-content pre code.py{color:#96F}#sbo-rt-content pre code.p{color:#000}#sbo-rt-content pre code.x{color:#F06}#sbo-rt-content div.blockquote_sampler_toc{width:95%;margin:5px 5px 5px 10px !important}#sbo-rt-content div{font-family:"Free Serif",serif}
    </style> 
  <style>
    header.global {
      top:26px;
    }
    .orm-topbar {
      width: 100%;
      height: 26px;
      padding: 0 17px;
      line-height: 26px;
      background: #d3002d;
      color: #fff;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 9;
      font-size: 13px;
    }
    .orm-topbar svg {
      width: 78px;
      height: 13px;
      fill: #fff;
      vertical-align: middle;
    }
    .orm-topbar span {
      vertical-align: middle;
      float: right;
      color: #fff;
      font-weight: bold;
    }
    .orm-topbar:hover span {
      text-decoration: underline;
    }
    </style> 
  <script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"VQQDUVVVGwIAUFFQBQMP"};window.NREUM||(NREUM={}),__nr_require=function(t,n,e){function r(e){if(!n[e]){var o=n[e]={exports:{}};t[e][0].call(o.exports,function(n){var o=t[e][1][n];return r(o||n)},o,o.exports)}return n[e].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<e.length;o++)r(e[o]);return r}({1:[function(t,n,e){function r(t){try{s.console&&console.log(t)}catch(n){}}var o,i=t("ee"),a=t(15),s={};try{o=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(s.console=!0,o.indexOf("dev")!==-1&&(s.dev=!0),o.indexOf("nr_dev")!==-1&&(s.nrDev=!0))}catch(c){}s.nrDev&&i.on("internal-error",function(t){r(t.stack)}),s.dev&&i.on("fn-err",function(t,n,e){r(e.stack)}),s.dev&&(r("NR AGENT IN DEVELOPMENT MODE"),r("flags: "+a(s,function(t,n){return t}).join(", ")))},{}],2:[function(t,n,e){function r(t,n,e,r,o){try{d?d-=1:i("err",[o||new UncaughtException(t,n,e)])}catch(s){try{i("ierr",[s,c.now(),!0])}catch(u){}}return"function"==typeof f&&f.apply(this,a(arguments))}function UncaughtException(t,n,e){this.message=t||"Uncaught error with no additional information",this.sourceURL=n,this.line=e}function o(t){i("err",[t,c.now()])}var i=t("handle"),a=t(16),s=t("ee"),c=t("loader"),f=window.onerror,u=!1,d=0;c.features.err=!0,t(1),window.onerror=r;try{throw new Error}catch(l){"stack"in l&&(t(8),t(7),"addEventListener"in window&&t(5),c.xhrWrappable&&t(9),u=!0)}s.on("fn-start",function(t,n,e){u&&(d+=1)}),s.on("fn-err",function(t,n,e){u&&(this.thrown=!0,o(e))}),s.on("fn-end",function(){u&&!this.thrown&&d>0&&(d-=1)}),s.on("internal-error",function(t){i("ierr",[t,c.now(),!0])})},{}],3:[function(t,n,e){t("loader").features.ins=!0},{}],4:[function(t,n,e){function r(t){}if(window.performance&&window.performance.timing&&window.performance.getEntriesByType){var o=t("ee"),i=t("handle"),a=t(8),s=t(7),c="learResourceTimings",f="addEventListener",u="resourcetimingbufferfull",d="bstResource",l="resource",p="-start",h="-end",m="fn"+p,w="fn"+h,v="bstTimer",y="pushState",g=t("loader");g.features.stn=!0,t(6);var b=NREUM.o.EV;o.on(m,function(t,n){var e=t[0];e instanceof b&&(this.bstStart=g.now())}),o.on(w,function(t,n){var e=t[0];e instanceof b&&i("bst",[e,n,this.bstStart,g.now()])}),a.on(m,function(t,n,e){this.bstStart=g.now(),this.bstType=e}),a.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),this.bstType])}),s.on(m,function(){this.bstStart=g.now()}),s.on(w,function(t,n){i(v,[n,this.bstStart,g.now(),"requestAnimationFrame"])}),o.on(y+p,function(t){this.time=g.now(),this.startPath=location.pathname+location.hash}),o.on(y+h,function(t){i("bstHist",[location.pathname+location.hash,this.startPath,this.time])}),f in window.performance&&(window.performance["c"+c]?window.performance[f](u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["c"+c]()},!1):window.performance[f]("webkit"+u,function(t){i(d,[window.performance.getEntriesByType(l)]),window.performance["webkitC"+c]()},!1)),document[f]("scroll",r,{passive:!0}),document[f]("keypress",r,!1),document[f]("click",r,!1)}},{}],5:[function(t,n,e){function r(t){for(var n=t;n&&!n.hasOwnProperty(u);)n=Object.getPrototypeOf(n);n&&o(n)}function o(t){s.inPlace(t,[u,d],"-",i)}function i(t,n){return t[1]}var a=t("ee").get("events"),s=t(18)(a,!0),c=t("gos"),f=XMLHttpRequest,u="addEventListener",d="removeEventListener";n.exports=a,"getPrototypeOf"in Object?(r(document),r(window),r(f.prototype)):f.prototype.hasOwnProperty(u)&&(o(window),o(f.prototype)),a.on(u+"-start",function(t,n){var e=t[1],r=c(e,"nr@wrapped",function(){function t(){if("function"==typeof e.handleEvent)return e.handleEvent.apply(e,arguments)}var n={object:t,"function":e}[typeof e];return n?s(n,"fn-",null,n.name||"anonymous"):e});this.wrapped=t[1]=r}),a.on(d+"-start",function(t){t[1]=this.wrapped||t[1]})},{}],6:[function(t,n,e){var r=t("ee").get("history"),o=t(18)(r);n.exports=r,o.inPlace(window.history,["pushState","replaceState"],"-")},{}],7:[function(t,n,e){var r=t("ee").get("raf"),o=t(18)(r),i="equestAnimationFrame";n.exports=r,o.inPlace(window,["r"+i,"mozR"+i,"webkitR"+i,"msR"+i],"raf-"),r.on("raf-start",function(t){t[0]=o(t[0],"fn-")})},{}],8:[function(t,n,e){function r(t,n,e){t[0]=a(t[0],"fn-",null,e)}function o(t,n,e){this.method=e,this.timerDuration=isNaN(t[1])?0:+t[1],t[0]=a(t[0],"fn-",this,e)}var i=t("ee").get("timer"),a=t(18)(i),s="setTimeout",c="setInterval",f="clearTimeout",u="-start",d="-";n.exports=i,a.inPlace(window,[s,"setImmediate"],s+d),a.inPlace(window,[c],c+d),a.inPlace(window,[f,"clearImmediate"],f+d),i.on(c+u,r),i.on(s+u,o)},{}],9:[function(t,n,e){function r(t,n){d.inPlace(n,["onreadystatechange"],"fn-",s)}function o(){var t=this,n=u.context(t);t.readyState>3&&!n.resolved&&(n.resolved=!0,u.emit("xhr-resolved",[],t)),d.inPlace(t,y,"fn-",s)}function i(t){g.push(t),h&&(x?x.then(a):w?w(a):(E=-E,O.data=E))}function a(){for(var t=0;t<g.length;t++)r([],g[t]);g.length&&(g=[])}function s(t,n){return n}function c(t,n){for(var e in t)n[e]=t[e];return n}t(5);var f=t("ee"),u=f.get("xhr"),d=t(18)(u),l=NREUM.o,p=l.XHR,h=l.MO,m=l.PR,w=l.SI,v="readystatechange",y=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"],g=[];n.exports=u;var b=window.XMLHttpRequest=function(t){var n=new p(t);try{u.emit("new-xhr",[n],n),n.addEventListener(v,o,!1)}catch(e){try{u.emit("internal-error",[e])}catch(r){}}return n};if(c(p,b),b.prototype=p.prototype,d.inPlace(b.prototype,["open","send"],"-xhr-",s),u.on("send-xhr-start",function(t,n){r(t,n),i(n)}),u.on("open-xhr-start",r),h){var x=m&&m.resolve();if(!w&&!m){var E=1,O=document.createTextNode(E);new h(a).observe(O,{characterData:!0})}}else f.on("fn-end",function(t){t[0]&&t[0].type===v||a()})},{}],10:[function(t,n,e){function r(t){var n=this.params,e=this.metrics;if(!this.ended){this.ended=!0;for(var r=0;r<d;r++)t.removeEventListener(u[r],this.listener,!1);if(!n.aborted){if(e.duration=a.now()-this.startTime,4===t.readyState){n.status=t.status;var i=o(t,this.lastSize);if(i&&(e.rxSize=i),this.sameOrigin){var c=t.getResponseHeader("X-NewRelic-App-Data");c&&(n.cat=c.split(", ").pop())}}else n.status=0;e.cbTime=this.cbTime,f.emit("xhr-done",[t],t),s("xhr",[n,e,this.startTime])}}}function o(t,n){var e=t.responseType;if("json"===e&&null!==n)return n;var r="arraybuffer"===e||"blob"===e||"json"===e?t.response:t.responseText;return h(r)}function i(t,n){var e=c(n),r=t.params;r.host=e.hostname+":"+e.port,r.pathname=e.pathname,t.sameOrigin=e.sameOrigin}var a=t("loader");if(a.xhrWrappable){var s=t("handle"),c=t(11),f=t("ee"),u=["load","error","abort","timeout"],d=u.length,l=t("id"),p=t(14),h=t(13),m=window.XMLHttpRequest;a.features.xhr=!0,t(9),f.on("new-xhr",function(t){var n=this;n.totalCbs=0,n.called=0,n.cbTime=0,n.end=r,n.ended=!1,n.xhrGuids={},n.lastSize=null,p&&(p>34||p<10)||window.opera||t.addEventListener("progress",function(t){n.lastSize=t.loaded},!1)}),f.on("open-xhr-start",function(t){this.params={method:t[0]},i(this,t[1]),this.metrics={}}),f.on("open-xhr-end",function(t,n){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&n.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),f.on("send-xhr-start",function(t,n){var e=this.metrics,r=t[0],o=this;if(e&&r){var i=h(r);i&&(e.txSize=i)}this.startTime=a.now(),this.listener=function(t){try{"abort"===t.type&&(o.params.aborted=!0),("load"!==t.type||o.called===o.totalCbs&&(o.onloadCalled||"function"!=typeof n.onload))&&o.end(n)}catch(e){try{f.emit("internal-error",[e])}catch(r){}}};for(var s=0;s<d;s++)n.addEventListener(u[s],this.listener,!1)}),f.on("xhr-cb-time",function(t,n,e){this.cbTime+=t,n?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof e.onload||this.end(e)}),f.on("xhr-load-added",function(t,n){var e=""+l(t)+!!n;this.xhrGuids&&!this.xhrGuids[e]&&(this.xhrGuids[e]=!0,this.totalCbs+=1)}),f.on("xhr-load-removed",function(t,n){var e=""+l(t)+!!n;this.xhrGuids&&this.xhrGuids[e]&&(delete this.xhrGuids[e],this.totalCbs-=1)}),f.on("addEventListener-end",function(t,n){n instanceof m&&"load"===t[0]&&f.emit("xhr-load-added",[t[1],t[2]],n)}),f.on("removeEventListener-end",function(t,n){n instanceof m&&"load"===t[0]&&f.emit("xhr-load-removed",[t[1],t[2]],n)}),f.on("fn-start",function(t,n,e){n instanceof m&&("onload"===e&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=a.now()))}),f.on("fn-end",function(t,n){this.xhrCbStart&&f.emit("xhr-cb-time",[a.now()-this.xhrCbStart,this.onload,n],n)})}},{}],11:[function(t,n,e){n.exports=function(t){var n=document.createElement("a"),e=window.location,r={};n.href=t,r.port=n.port;var o=n.href.split("://");!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=n.hostname||e.hostname,r.pathname=n.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname);var i=!n.protocol||":"===n.protocol||n.protocol===e.protocol,a=n.hostname===document.domain&&n.port===e.port;return r.sameOrigin=i&&(!n.hostname||a),r}},{}],12:[function(t,n,e){function r(){}function o(t,n,e){return function(){return i(t,[f.now()].concat(s(arguments)),n?null:this,e),n?void 0:this}}var i=t("handle"),a=t(15),s=t(16),c=t("ee").get("tracer"),f=t("loader"),u=NREUM;"undefined"==typeof window.newrelic&&(newrelic=u);var d=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],l="api-",p=l+"ixn-";a(d,function(t,n){u[n]=o(l+n,!0,"api")}),u.addPageAction=o(l+"addPageAction",!0),u.setCurrentRouteName=o(l+"routeName",!0),n.exports=newrelic,u.interaction=function(){return(new r).get()};var h=r.prototype={createTracer:function(t,n){var e={},r=this,o="function"==typeof n;return i(p+"tracer",[f.now(),t,e],r),function(){if(c.emit((o?"":"no-")+"fn-start",[f.now(),r,o],e),o)try{return n.apply(this,arguments)}finally{c.emit("fn-end",[f.now()],e)}}}};a("setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(t,n){h[n]=o(p+n)}),newrelic.noticeError=function(t){"string"==typeof t&&(t=new Error(t)),i("err",[t,f.now()])}},{}],13:[function(t,n,e){n.exports=function(t){if("string"==typeof t&&t.length)return t.length;if("object"==typeof t){if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if(!("undefined"!=typeof FormData&&t instanceof FormData))try{return JSON.stringify(t).length}catch(n){return}}}},{}],14:[function(t,n,e){var r=0,o=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);o&&(r=+o[1]),n.exports=r},{}],15:[function(t,n,e){function r(t,n){var e=[],r="",i=0;for(r in t)o.call(t,r)&&(e[i]=n(r,t[r]),i+=1);return e}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],16:[function(t,n,e){function r(t,n,e){n||(n=0),"undefined"==typeof e&&(e=t?t.length:0);for(var r=-1,o=e-n||0,i=Array(o<0?0:o);++r<o;)i[r]=t[n+r];return i}n.exports=r},{}],17:[function(t,n,e){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],18:[function(t,n,e){function r(t){return!(t&&t instanceof Function&&t.apply&&!t[a])}var o=t("ee"),i=t(16),a="nr@original",s=Object.prototype.hasOwnProperty,c=!1;n.exports=function(t,n){function e(t,n,e,o){function nrWrapper(){var r,a,s,c;try{a=this,r=i(arguments),s="function"==typeof e?e(r,a):e||{}}catch(f){l([f,"",[r,a,o],s])}u(n+"start",[r,a,o],s);try{return c=t.apply(a,r)}catch(d){throw u(n+"err",[r,a,d],s),d}finally{u(n+"end",[r,a,c],s)}}return r(t)?t:(n||(n=""),nrWrapper[a]=t,d(t,nrWrapper),nrWrapper)}function f(t,n,o,i){o||(o="");var a,s,c,f="-"===o.charAt(0);for(c=0;c<n.length;c++)s=n[c],a=t[s],r(a)||(t[s]=e(a,f?s+o:o,i,s))}function u(e,r,o){if(!c||n){var i=c;c=!0;try{t.emit(e,r,o,n)}catch(a){l([a,e,r,o])}c=i}}function d(t,n){if(Object.defineProperty&&Object.keys)try{var e=Object.keys(t);return e.forEach(function(e){Object.defineProperty(n,e,{get:function(){return t[e]},set:function(n){return t[e]=n,n}})}),n}catch(r){l([r])}for(var o in t)s.call(t,o)&&(n[o]=t[o]);return n}function l(n){try{t.emit("internal-error",n)}catch(e){}}return t||(t=o),e.inPlace=f,e.flag=a,e}},{}],ee:[function(t,n,e){function r(){}function o(t){function n(t){return t&&t instanceof r?t:t?c(t,s,i):i()}function e(e,r,o,i){if(!l.aborted||i){t&&t(e,r,o);for(var a=n(o),s=h(e),c=s.length,f=0;f<c;f++)s[f].apply(a,r);var d=u[y[e]];return d&&d.push([g,e,r,a]),a}}function p(t,n){v[t]=h(t).concat(n)}function h(t){return v[t]||[]}function m(t){return d[t]=d[t]||o(e)}function w(t,n){f(t,function(t,e){n=n||"feature",y[e]=n,n in u||(u[n]=[])})}var v={},y={},g={on:p,emit:e,get:m,listeners:h,context:n,buffer:w,abort:a,aborted:!1};return g}function i(){return new r}function a(){(u.api||u.feature)&&(l.aborted=!0,u=l.backlog={})}var s="nr@context",c=t("gos"),f=t(15),u={},d={},l=n.exports=o();l.backlog=u},{}],gos:[function(t,n,e){function r(t,n,e){if(o.call(t,n))return t[n];var r=e();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return t[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(t,n,e){function r(t,n,e,r){o.buffer([t],r),o.emit(t,n,e)}var o=t("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(t,n,e){function r(t){var n=typeof t;return!t||"object"!==n&&"function"!==n?-1:t===window?0:a(t,i,function(){return o++})}var o=1,i="nr@id",a=t("gos");n.exports=r},{}],loader:[function(t,n,e){function r(){if(!x++){var t=b.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(u.abort,3e4),!(t&&t.licenseKey&&t.applicationID&&n))return u.abort();f(y,function(n,e){t[n]||(t[n]=e)}),c("mark",["onload",a()+b.offset],null,"api");var e=l.createElement("script");e.src="https://"+t.agent,n.parentNode.insertBefore(e,n)}}function o(){"complete"===l.readyState&&i()}function i(){c("mark",["domContent",a()+b.offset],null,"api")}function a(){return E.exists&&performance.now?Math.round(performance.now()):(s=Math.max((new Date).getTime(),s))-b.offset}var s=(new Date).getTime(),c=t("handle"),f=t(15),u=t("ee"),d=window,l=d.document,p="addEventListener",h="attachEvent",m=d.XMLHttpRequest,w=m&&m.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:m,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var v=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1044.min.js"},g=m&&w&&w[p]&&!/CriOS/.test(navigator.userAgent),b=n.exports={offset:s,now:a,origin:v,features:{},xhrWrappable:g};t(12),l[p]?(l[p]("DOMContentLoaded",i,!1),d[p]("load",r,!1)):(l[h]("onreadystatechange",o),d[h]("onload",r)),c("mark",["firstbyte",s],null,"api");var x=0,E=t(17)},{}]},{},["loader",2,10,4,3]);</script> 
 </head> 
 <body class="js-preview-content  "> 
  <header class="global"> 
   <a href="//www.oreilly.com/go/oreilly" class="orm-topbar">
    <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 59.13 9.88">
     <desc>
      O'Reilly logo
     </desc>
     <polygon points="28.09 1.96 28.09 0.42 21.68 0.42 21.68 9.64 28.09 9.64 28.09 8.11 23.22 8.11 23.22 5.8 27.86 5.8 27.86 4.27 23.22 4.27 23.22 1.96 28.09 1.96" />
     <polygon points="32.85 9.64 32.85 0.42 34.39 0.42 34.39 8.11 38.82 8.11 38.82 9.64 32.85 9.64" />
     <polygon points="40.07 9.64 40.07 0.42 41.61 0.42 41.61 8.11 46.04 8.11 46.04 9.64 40.07 9.64" />
     <rect x="29.71" y="0.42" width="1.54" height="9.22" />
     <path d="M1.59,6.28a4.8,4.8,0,1,1,4.8,4.8,4.8,4.8,0,0,1-4.8-4.8M4.09,4A3.27,3.27,0,1,0,6.4,3,3.27,3.27,0,0,0,4.09,4" transform="translate(-1.59 -1.2)" />
     <path d="M19.82,6.89A2.69,2.69,0,0,0,19,1.62H14.41v9.22h1.54V7h2.14l2.32,3.84H22.2ZM15.95,5.47V3.16H19a1.15,1.15,0,0,1,0,2.31h-3.1Z" transform="translate(-1.59 -1.2)" />
     <path d="M13.32,2.61a1.13,1.13,0,1,1-1.13-1.13,1.13,1.13,0,0,1,1.13,1.13" transform="translate(-1.59 -1.2)" />
     <polygon points="52.9 0.42 51.03 0.42 48.66 3.85 46.3 0.42 44.43 0.42 47.89 5.44 47.89 9.64 49.43 9.64 49.43 5.44 52.9 0.42" />
     <path d="M58.31,1.2a2.41,2.41,0,1,0,2.41,2.42A2.42,2.42,0,0,0,58.31,1.2m0,4.44a2,2,0,1,1,2-2,2,2,0,0,1-2,2" transform="translate(-1.59 -1.2)" />
     <path d="M59.4,3.09a0.72,0.72,0,0,0-.72-0.72H57.32V4.83h0.41v-1h0.69l0.49,1h0.46l-0.51-1a0.71,0.71,0,0,0,.54-0.69m-1.67-.31h0.95a0.31,0.31,0,0,1,.31.31,0.31,0.31,0,0,1-.31.3H57.73V2.78Z" transform="translate(-1.59 -1.2)" />
    </svg></a> 
   <div class="header-top"> 
    <nav class="main-nav"> 
     <a href="/" class="logo">
      <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 125.46 36" class="home-logo">
       <desc>
        Safari Logo
       </desc>
       <path d="M27.85,7.25a1.4,1.4,0,1,1,2.75,0V15.6a1.44,1.44,0,0,1-1.4,1.71A1.49,1.49,0,0,1,28,16.64,13.56,13.56,0,0,1,27.54,14c-0.62-3.89-4.15-6.54-8.66-6.54S11,10.16,11,14c0,3,1.66,4.56,6.8,6.28l5.29,1.82c5.86,2,8.14,4.46,8.14,9,0,5.76-4.36,9.6-10.84,9.6-5,0-8.3-1.87-9.91-5.6v3.42a1.4,1.4,0,1,1-2.75,0V29.71A1.44,1.44,0,0,1,9.18,28c1,0,1.35.52,1.45,2A10.59,10.59,0,0,0,13,35.63a9.05,9.05,0,0,0,6.8,2.7c5,0,8.3-2.8,8.3-7a5.45,5.45,0,0,0-2.54-4.82,18.52,18.52,0,0,0-3.89-1.71l-4.51-1.56c-3.58-1.24-5.24-2-6.54-3a7.46,7.46,0,0,1-2.75-6c0-5.45,4.36-9.13,10.69-9.13,4.46,0,7.63,1.71,9.29,5.08V7.25Z" transform="translate(-7.78 -4.92)" />
       <path d="M51.81,35.11c-1.82,4.1-4.51,5.81-9.28,5.81-5.39,0-8.71-2.75-8.71-7.31A6.88,6.88,0,0,1,38.11,27c1.87-.83,4.62-1.19,8.92-1.19,0.93,0,2,0,2.8.05a7,7,0,0,0,.93.05,0.89,0.89,0,0,0,1-.88V24.84c0-3.37-.31-4.46-1.71-5.71-1.19-1.09-2.8-1.56-5.24-1.56-4.15,0-6.64,1.71-7.11,4.88a1.45,1.45,0,0,1-2.9-.16c0-2.13,1.82-4.67,4.15-5.81a13.94,13.94,0,0,1,6-1.09c3.63,0,6.22.88,7.83,2.75,1.4,1.56,1.82,3.16,1.82,6.64V37a0.89,0.89,0,0,0,1,1h1.76a1.08,1.08,0,1,1,0,2.13H53.05a1.06,1.06,0,0,1-1.24-1.24V35.11Zm-15-1.61c0,3.32,2.33,5.24,6.33,5.24,3.27,0,5.76-1.24,7.16-3.58a16.08,16.08,0,0,0,1.45-6.38A0.8,0.8,0,0,0,51.24,28a34,34,0,0,0-4.62-.21C39.93,27.79,36.76,29.66,36.76,33.5Z" transform="translate(-7.78 -4.92)" />
       <path d="M67.91,37a0.89,0.89,0,0,0,1,1H71.8a1.08,1.08,0,1,1,0,2.13H62a1.09,1.09,0,1,1,0-2.13h2.07a0.89,0.89,0,0,0,1-1V19.29a0.89,0.89,0,0,0-1-1H61.63a1.08,1.08,0,1,1,0-2.13h2.44a0.89,0.89,0,0,0,1-1V13.48c0-3.16.78-5.39,2.39-6.8a8.56,8.56,0,0,1,5.19-1.76,10.85,10.85,0,0,1,3.58.62,1.83,1.83,0,0,1,.52,1,1.23,1.23,0,0,1-.88,1,2.74,2.74,0,0,1-.67-0.1,12.61,12.61,0,0,0-2.28-.31,5.41,5.41,0,0,0-4,2c-0.73,1-1,2.18-1,4.56v1.35a0.89,0.89,0,0,0,1,1h3.58a1.09,1.09,0,1,1,0,2.13H68.95a0.89,0.89,0,0,0-1,1V37Z" transform="translate(-7.78 -4.92)" />
       <path d="M93.68,35.11c-1.82,4.1-4.51,5.81-9.28,5.81-5.39,0-8.71-2.75-8.71-7.31A6.88,6.88,0,0,1,80,27c1.87-.83,4.62-1.19,8.92-1.19,0.93,0,2,0,2.8.05a7,7,0,0,0,.93.05,0.89,0.89,0,0,0,1-.88V24.84c0-3.37-.31-4.46-1.71-5.71-1.19-1.09-2.8-1.56-5.24-1.56-4.15,0-6.64,1.71-7.11,4.88a1.45,1.45,0,0,1-2.9-.16c0-2.13,1.82-4.67,4.15-5.81a13.94,13.94,0,0,1,6-1.09c3.63,0,6.22.88,7.83,2.75,1.4,1.56,1.82,3.16,1.82,6.64V37a0.89,0.89,0,0,0,1,1h1.76a1.08,1.08,0,1,1,0,2.13H94.92a1.06,1.06,0,0,1-1.24-1.24V35.11Zm-15-1.61c0,3.32,2.33,5.24,6.33,5.24,3.27,0,5.76-1.24,7.16-3.58a16.07,16.07,0,0,0,1.45-6.38A0.8,0.8,0,0,0,93.11,28a34,34,0,0,0-4.62-.21C81.8,27.79,78.64,29.66,78.64,33.5Z" transform="translate(-7.78 -4.92)" />
       <path d="M109.44,21.05a6.5,6.5,0,0,1,2-3.53,8.68,8.68,0,0,1,5.71-2.13c1.35,0,2.13.52,2.13,1.35a0.83,0.83,0,0,1-.78,1,3.75,3.75,0,0,1-.67-0.05,2.45,2.45,0,0,0-.78-0.1,11.52,11.52,0,0,0-3.63.88c-2.59,1.19-4,4-4,8.2V37a0.89,0.89,0,0,0,1,1h3a1.08,1.08,0,1,1,0,2.13h-10a1.09,1.09,0,1,1,0-2.13h2.13a0.89,0.89,0,0,0,1-1V19.29a0.89,0.89,0,0,0-1-1h-2.13a1.09,1.09,0,1,1,0-2.13h4.72a1.06,1.06,0,0,1,1.24,1.24v3.68Z" transform="translate(-7.78 -4.92)" />
       <path d="M129.09,37a0.89,0.89,0,0,0,1,1h1.82a1.08,1.08,0,1,1,0,2.13h-8.82a1.09,1.09,0,1,1,0-2.13h2.13a0.89,0.89,0,0,0,1-1V19.29a0.89,0.89,0,0,0-1-1h-2.13a1.09,1.09,0,1,1,0-2.13h4.72a1.06,1.06,0,0,1,1.24,1.24V37ZM129.55,8.5a2.08,2.08,0,0,1-2.07,2.07,2.17,2.17,0,0,1-2.13-2.13,2.08,2.08,0,0,1,2.07-2.08A2.1,2.1,0,0,1,129.55,8.5Z" transform="translate(-7.78 -4.92)" />
      </svg></a> 
    </nav> 
    <nav class="right-nav"> 
     <ul> 
      <li class="callout mobile-link"> <a class="t-register cta-link" data-ga-label="Nav Bar" href="/public/free-trial/?fa=True&amp;cl=/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html">Start Free Trial</a> </li> 
      <li class="mobile-link"><a class="t-sign-in" href="/accounts/login/?next=/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html">Sign In</a></li> 
      <li><a href="/pricing/">Pricing</a></li> 
      <li><a href="/enterprise/">Enterprise</a></li> 
      <li class="search-field"> 
       <form id="js-search-form" action="/search/"> 
        <script type="application/ld+json">
                {
                  "@context": "http://schema.org",
                  "@type": "WebSite",
                  "url": "https://www.safaribooksonline.com/",
                  "potentialAction": {
                    "@type": "SearchAction",
                    "target": "https://www.safaribooksonline.com/search/?q={search_term_string}",
                    "query-input": "required name=search_term_string"
                  }
                }
                </script> 
        <input data-search-text-focus="Search books and videos..." data-search-text-idle="Search..." id="search" type="search" name="q" placeholder="Search..." autocomplete="off" required> 
        <input type="submit" value="search" class="search-submit"> 
       </form> </li> 
     </ul> 
    </nav> 
   </div> 
   <div class="sbo-menu-top"> 
    <section class="sbo-toc-container"> 
     <a href="/library/view/regular-expressions-cookbook/9781449327453/" class="sbo-toc-thumb"> <span class="sbo-title ss-list"> <h1 class="t-title">Regular Expressions Cookbook, 2nd Edition by Steven Levithan, Jan Goyvaerts</h1> </span> </a> 
    </section> 
   </div> 
  </header> 
  <section id="trial-overlay"> 
   <div class="trial-overlay-content"> 
    <h2 class="trial-modal-title"> Stay ahead with the world's most comprehensive technology and business learning platform. </h2> 
    <h2> With Safari, you learn the way you learn best. Get unlimited access to videos, live online training, learning paths, books, tutorials, and more. </h2> 
    <div class="controls"> 
     <a href="/public/free-trial/?fa=True&amp;cl=/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html" class="button" data-ga-label="Modal">Start Free Trial</a> 
     <p>No credit card required</p> 
    </div> 
    <a class="modal-dismiss" aria-label="modal dismiss"></a> 
   </div> 
  </section> 
  <section role="document"> 
   <section id="sbo-reader"> 
    <div class="sbo-reader-content sbo-sample-reader "> 
     <div id="sbo-rt-content"> 
      <div id="test-content-id">
       <div class="sect1" title="4.20.&nbsp;Validate Credit Card Numbers">
        <div class="titlepage">
         <div>
          <div>
           <h1 class="title"><a id="validation-creditcard"></a>4.20.&nbsp;Validate Credit Card Numbers</h1>
          </div>
         </div>
        </div>
        <div class="sect2" title="Problem">
         <div class="titlepage">
          <div>
           <div>
            <h2 class="title"><a id="validation-creditcard-problem"></a>Problem</h2>
           </div>
          </div>
         </div>
         <p><a id="idx10572" class="indexterm"></a><a id="idx10693" class="indexterm"></a>You’re given the job of implementing an order form for a company that accepts payment by credit card. Since the credit card processor charges for each transaction attempt, including failed attempts, you want to use a regular expression to weed out obviously invalid credit card numbers.</p>
         <p>Doing this will also improve the customer’s experience. A regular expression can instantly detect obvious typos as soon as the customer finishes filling in the field on the web form. A round trip to the credit card processor, by contrast, easily takes 10 to 30 seconds.</p>
        </div>
        <div class="sect2" title="Solution">
         <div class="titlepage">
          <div>
           <div>
            <h2 class="title"><a id="validation-creditcard-solution"></a>Solution</h2>
           </div>
          </div>
         </div>
         <p>To keep the implementation simple, this solution is split into two parts. First we strip out spaces and hyphens. Then we validate what remains.</p>
         <div class="sect3" title="Strip spaces and hyphens">
          <div class="titlepage">
           <div>
            <div>
             <h3 class="title"><a id="validation-creditcard-solution-strip"></a>Strip spaces and hyphens</h3>
            </div>
           </div>
          </div>
          <p><a id="idx10574" class="indexterm"></a><a id="idx10606" class="indexterm"></a><a id="idx10678" class="indexterm"></a><a id="idx10681" class="indexterm"></a><a id="idx10695" class="indexterm"></a>Retrieve the credit card number entered by the customer and store it into a variable. Before performing the check for a valid number, perform a search-and-replace to strip out spaces and hyphens. Replace all matches of this regular expression with blank replacement text:</p>
          <a id="I_programlisting4_d1e26419"></a>
          <pre class="programlisting">[<span class="gray50">?</span>-]</pre>
          <table border="0" summary="Simple list" class="simplelist">
           <tbody>
            <tr>
             <td><span class="strong"><strong>Regex options:</strong></span> None</td>
            </tr>
            <tr>
             <td><span class="strong"><strong>Regex flavors:</strong></span> .NET, Java, JavaScript, PCRE, Perl, Python, Ruby</td>
            </tr>
           </tbody>
          </table>
          <p><a class="xref" href="ch03s15.html" title="3.14.&nbsp;Replace All Matches">Recipe&nbsp;3.14</a> shows you how to perform this initial replacement.<a id="I_indexterm4_d1e34320" class="indexterm"></a><a id="I_indexterm4_d1e34321" class="indexterm"></a><a id="I_indexterm4_d1e34322" class="indexterm"></a><a id="I_indexterm4_d1e34323" class="indexterm"></a><a id="I_indexterm4_d1e34324" class="indexterm"></a></p>
         </div>
         <div class="sect3" title="Validate the number">
          <div class="titlepage">
           <div>
            <div>
             <h3 class="title"><a id="validation-creditcard-solution-check"></a>Validate the number</h3>
            </div>
           </div>
          </div>
          <p><a id="idx10577" class="indexterm"></a><a id="idx10698" class="indexterm"></a>With spaces and hyphens stripped from the input, the next regular expression checks if the credit card number uses the format of any of the six major credit card companies. It uses named capture to detect which brand of credit card the customer has:</p>
          <a id="I_programlisting4_d1e26441"></a>
          <pre class="programlisting">^(?:
(?&lt;visa&gt;4[0-9]{12}(?:[0-9]{3})?) |
(?&lt;mastercard&gt;5[1-5][0-9]{14}) |
(?&lt;discover&gt;6(?:011|5[0-9]{2})[0-9]{12}) |
(?&lt;amex&gt;3[47][0-9]{13}) |
(?&lt;diners&gt;3(?:0[0-5]|[68][0-9])[0-9]{11}) |
(?&lt;jcb&gt;(?:2131|1800|35[0-9]{3})[0-9]{11})
)$</pre>
          <table border="0" summary="Simple list" class="simplelist">
           <tbody>
            <tr>
             <td><span class="strong"><strong>Regex options:</strong></span> Free-spacing</td>
            </tr>
            <tr>
             <td><span class="strong"><strong>Regex flavors:</strong></span> .NET, Java 7, XRegExp, PCRE 7, Perl 5.10, Ruby 1.9</td>
            </tr>
           </tbody>
          </table>
          <a id="I_programlisting4_d1e26452"></a>
          <pre class="programlisting">^(?:
(?P&lt;visa&gt;4[0-9]{12}(?:[0-9]{3})?) |
(?P&lt;mastercard&gt;5[1-5][0-9]{14}) |
(?P&lt;discover&gt;6(?:011|5[0-9]{2})[0-9]{12}) |
(?P&lt;amex&gt;3[47][0-9]{13}) |
(?P&lt;diners&gt;3(?:0[0-5]|[68][0-9])[0-9]{11}) |
(?P&lt;jcb&gt;(?:2131|1800|35[0-9]{3})[0-9]{11})
)$</pre>
          <table border="0" summary="Simple list" class="simplelist">
           <tbody>
            <tr>
             <td><span class="strong"><strong>Regex options:</strong></span> Free-spacing</td>
            </tr>
            <tr>
             <td><span class="strong"><strong>Regex flavors:</strong></span> PCRE, Python</td>
            </tr>
           </tbody>
          </table>
          <p>Java 4 to 6, Perl 5.8 and earlier, and Ruby 1.8 do not support named capture. You can use numbered capture instead. Group 1 will capture Visa cards, group 2 MasterCard, and so on up to group 6 for JCB:</p>
          <a id="I_programlisting4_d1e26465"></a>
          <pre class="programlisting">^(?:
(4[0-9]{12}(?:[0-9]{3})?) |          # Visa
(5[1-5][0-9]{14}) |                  # MasterCard
(6(?:011|5[0-9]{2})[0-9]{12}) |      # Discover
(3[47][0-9]{13}) |                   # AMEX
(3(?:0[0-5]|[68][0-9])[0-9]{11}) |   # Diners Club
((?:2131|1800|35[0-9]{3})[0-9]{11})  # JCB
)$</pre>
          <table border="0" summary="Simple list" class="simplelist">
           <tbody>
            <tr>
             <td><span class="strong"><strong>Regex options:</strong></span> Free-spacing</td>
            </tr>
            <tr>
             <td><span class="strong"><strong>Regex flavors:</strong></span> .NET, Java, XRegExp, PCRE, Perl, Python, Ruby</td>
            </tr>
           </tbody>
          </table>
          <p>Standard JavaScript does not support named capture or free-spacing. Removing whitespace and comments, we get:</p>
          <a id="I_programlisting4_d1e26478"></a>
          <pre class="programlisting">^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|?
(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|?
(3(?:0[0-5]|[68][0-9])[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$</pre>
          <table border="0" summary="Simple list" class="simplelist">
           <tbody>
            <tr>
             <td><span class="strong"><strong>Regex options:</strong></span> None</td>
            </tr>
            <tr>
             <td><span class="strong"><strong>Regex flavors:</strong></span> .NET, Java, JavaScript, PCRE, Perl, Python, Ruby</td>
            </tr>
           </tbody>
          </table>
          <p>If you don’t need to determine which type the card is, you can remove the six capturing groups that surround the pattern for each card type, as they don’t serve any other purpose.</p>
          <p><a id="idx10576" class="indexterm"></a><a id="idx10697" class="indexterm"></a><a id="idx10765" class="indexterm"></a>Follow <a class="xref" href="ch03s07.html" title="3.6.&nbsp;Test Whether a Regex Matches the Subject String Entirely">Recipe&nbsp;3.6</a> to add this regular expression to your order form to validate the card number. If you use different processors for different cards, or if you just want to keep some statistics, you can use <a class="xref" href="ch03s10.html" title="3.9.&nbsp;Retrieve Part of the Matched Text">Recipe&nbsp;3.9</a> to check which named or numbered capturing group holds the match. That will tell you which brand of credit card the customer has.<a id="I_indexterm4_d1e34418" class="indexterm"></a><a id="I_indexterm4_d1e34419" class="indexterm"></a></p>
         </div>
         <div class="sect3" title="Example web page with JavaScript">
          <div class="titlepage">
           <div>
            <div>
             <h3 class="title"><a id="validate-creditcard-solution-web"></a>Example web page with JavaScript</h3>
            </div>
           </div>
          </div>
          <a id="I_programlisting4_d1e26525"></a>
          <pre class="programlisting">&lt;html&gt;
&lt;head&gt;
&lt;title&gt;Credit Card Test&lt;/title&gt;
&lt;/head&gt;

&lt;body&gt;
&lt;h1&gt;Credit Card Test&lt;/h1&gt;

&lt;form&gt;
&lt;p&gt;Please enter your credit card number:&lt;/p&gt;

&lt;p&gt;&lt;input type="text" size="20" name="cardnumber"
  onkeyup="validatecardnumber(this.value)"&gt;&lt;/p&gt;

&lt;p id="notice"&gt;(no card number entered)&lt;/p&gt;
&lt;/form&gt;

&lt;script&gt;
function validatecardnumber(cardnumber) {
  // Strip spaces and dashes
  cardnumber = cardnumber.replace(/[ -]/g, '');
  // See if the card is valid
  // The regex will capture the number in one of the capturing groups
  var match = /^(?:(4[0-9]{12}(?:[0-9]{3})?)|(5[1-5][0-9]{14})|?
(6(?:011|5[0-9]{2})[0-9]{12})|(3[47][0-9]{13})|(3(?:0[0-5]|[68][0-9])?
[0-9]{11})|((?:2131|1800|35[0-9]{3})[0-9]{11}))$/.exec(cardnumber);
  if (match) {
    // List of card types, in the same order as the regex capturing groups
    var types = ['Visa', 'MasterCard', 'Discover', 'American Express',
                 'Diners Club', 'JCB'];
    // Find the capturing group that matched
    // Skip the zeroth element of the match array (the overall match)
    for (var i = 1; i &lt; match.length; i++) {
      if (match[i]) {
        // Display the card type for that group
        document.getElementById('notice').innerHTML = types[i - 1];
        break;
      }
    }
  } else {
    document.getElementById('notice').innerHTML = '(invalid card number)';
  }
}
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
         </div>
        </div>
        <div class="sect2" title="Discussion">
         <div class="titlepage">
          <div>
           <div>
            <h2 class="title"><a id="validation-creditcard-discussion"></a>Discussion</h2>
           </div>
          </div>
         </div>
         <div class="sect3" title="Strip spaces and hyphens">
          <div class="titlepage">
           <div>
            <div>
             <h3 class="title"><a id="validation-creditcard-discussion-strip"></a>Strip spaces and hyphens</h3>
            </div>
           </div>
          </div>
          <p><a id="idx10575" class="indexterm"></a><a id="idx10607" class="indexterm"></a><a id="idx10679" class="indexterm"></a><a id="idx10682" class="indexterm"></a><a id="idx10696" class="indexterm"></a>On an actual credit card, the digits of the embossed card number are usually placed into groups of four. That makes the card number easier for humans to read. Naturally, many people will try to enter the card number in the same way, including the spaces, on order forms.</p>
          <p>Writing a regular expression that validates a card number, allowing for spaces, hyphens, and whatnot, is much more difficult that writing a regular expression that only allows digits. Thus, unless you want to annoy the customer with retyping the card number without spaces or hyphens, do a quick search-and-replace to strip them out before validating the card number and sending it to the card processor.</p>
          <p>The regular expression <span class="gray50">‹</span><code class="literal">[<span class="gray50">?</span>-]</code><span class="gray50">›</span> matches a character that is a space or a hyphen. Replacing all matches of this regular expression with nothing effectively deletes all spaces and hyphens.</p>
          <div class="tip" title="Tip">
           <h3 class="title">Tip</h3>
           <p>Credit card numbers can consist only of digits. Instead of using <span class="gray50">‹</span><code class="literal">[<span class="gray50">?</span>-]</code><span class="gray50">›</span> to remove only spaces and hyphens, you could use the shorthand character class <a id="I_indexterm4_d1e34477" class="indexterm"></a><span class="gray50">‹</span><code class="literal">\D</code><span class="gray50">›</span> to strip out all nondigits.<a id="I_indexterm4_d1e34483" class="indexterm"></a><a id="I_indexterm4_d1e34484" class="indexterm"></a><a id="I_indexterm4_d1e34485" class="indexterm"></a><a id="I_indexterm4_d1e34486" class="indexterm"></a><a id="I_indexterm4_d1e34487" class="indexterm"></a></p>
          </div>
         </div>
         <div class="sect3" title="Validate the number">
          <div class="titlepage">
           <div>
            <div>
             <h3 class="title"><a id="validation-creditcard-discussion-check"></a>Validate the number</h3>
            </div>
           </div>
          </div>
          <p><a id="idx10578" class="indexterm"></a><a id="idx10699" class="indexterm"></a>Each of the credit card companies uses a different number format. We’ll exploit that difference to allow users to enter a number without specifying a company; the company can be determined from the number. The format for each company is:</p>
          <div class="variablelist">
           <dl>
            <dt>
             <span class="term">Visa</span>
            </dt>
            <dd>
             <p>13 or 16 digits, starting with <code class="literal">4</code>.</p>
            </dd>
            <dt>
             <span class="term">MasterCard</span>
            </dt>
            <dd>
             <p>16 digits, starting with <code class="literal">51</code> through <code class="literal">55</code>.</p>
            </dd>
            <dt>
             <span class="term">Discover</span>
            </dt>
            <dd>
             <p>16 digits, starting with <code class="literal">6011</code> or <code class="literal">65</code>.</p>
            </dd>
            <dt>
             <span class="term">American Express</span>
            </dt>
            <dd>
             <p>15 digits, starting with <code class="literal">34</code> or <code class="literal">37</code>.</p>
            </dd>
            <dt>
             <span class="term">Diners Club</span>
            </dt>
            <dd>
             <p>14 digits, starting with <code class="literal">300</code> through <code class="literal">305</code>, <code class="literal">36</code>, or <code class="literal">38</code>.</p>
            </dd>
            <dt>
             <span class="term">JCB</span>
            </dt>
            <dd>
             <p>15 digits, starting with <code class="literal">2131</code> or <code class="literal">1800</code>, or 16 digits starting with <code class="literal">35</code>.</p>
            </dd>
           </dl>
          </div>
          <p>If you accept only certain brands of credit cards, you can delete the cards that you don’t accept from the regular expression. When deleting JCB, make sure to delete the last remaining <span class="gray50">‹</span><code class="literal">|</code><span class="gray50">›</span> in the regular expression as well. If you end up with <span class="gray50">‹</span><code class="literal">||</code><span class="gray50">›</span> or <span class="gray50">‹</span><code class="literal">|)</code><span class="gray50">›</span> in your regular expression, it will accept the empty string as a valid card number.</p>
          <p>For example, to accept only Visa, MasterCard, and AMEX, you can use:</p>
          <a id="I_programlisting4_d1e26669"></a>
          <pre class="programlisting">^(?:
4[0-9]{12}(?:[0-9]{3})? |         # Visa
5[1-5][0-9]{14} |                 # MasterCard
3[47][0-9]{13}                    # AMEX
)$</pre>
          <table border="0" summary="Simple list" class="simplelist">
           <tbody>
            <tr>
             <td><span class="strong"><strong>Regex options:</strong></span> Free-spacing</td>
            </tr>
            <tr>
             <td><span class="strong"><strong>Regex flavors:</strong></span> .NET, Java, XRegExp, PCRE, Perl, Python, Ruby</td>
            </tr>
           </tbody>
          </table>
          <p>Alternatively:</p>
          <a id="I_programlisting4_d1e26682"></a>
          <pre class="programlisting">^(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13})$</pre>
          <table border="0" summary="Simple list" class="simplelist">
           <tbody>
            <tr>
             <td><span class="strong"><strong>Regex options:</strong></span> None</td>
            </tr>
            <tr>
             <td><span class="strong"><strong>Regex flavors:</strong></span> .NET, Java, JavaScript, PCRE, Perl, Python, Ruby</td>
            </tr>
           </tbody>
          </table>
          <p>If you’re searching for credit card numbers in a larger body of text, replace the anchors with <a id="I_indexterm4_d1e34625" class="indexterm"></a><span class="gray50">‹</span><code class="literal">\b</code><span class="gray50">›</span> word boundaries.<a id="I_indexterm4_d1e34631" class="indexterm"></a><a id="I_indexterm4_d1e34632" class="indexterm"></a></p>
         </div>
         <div class="sect3" title="Incorporating the solution into a web page">
          <div class="titlepage">
           <div>
            <div>
             <h3 class="title"><a id="validate-creditcard-discussion-web"></a>Incorporating the solution into a web page</h3>
            </div>
           </div>
          </div>
          <p>The section <a class="xref" href="ch04s20.html#validate-creditcard-solution-web" title="Example web page with JavaScript">Example web page with JavaScript</a> shows how you could add these two regular expressions to your order form. The input box for the credit card number has an <code class="literal">onkeyup</code> event handler that calls the <code class="literal">validatecardnumber()</code> function. This function retrieves the card number from the input box, strips the spaces and hyphens, and then validates it using the regular expression with numbered capturing groups. The result of the validation is displayed by replacing the text in the last paragraph on the page.</p>
          <p>If the regular expression fails to match, <code class="literal"><em class="replaceable"><code>regexp</code></em>.exec()</code> returns <code class="literal">null</code>, and <code class="returnvalue">(invalid card number)</code> is displayed. If the regex does match, <code class="literal"><em class="replaceable"><code>regexp</code></em>.exec()</code> returns an array of strings. The zeroth element holds the overall match. Elements 1 through 6 hold the text matched by the six capturing groups.</p>
          <p>Our regular expression has six capturing groups, divided by alternation. This means that exactly one capturing group will participate in the match and hold the card number. The other groups will be empty (either <code class="literal">undefined</code> or the empty string, depending on your browser). The function checks the six capturing groups, one by one. When it finds one that is not empty, the card number is recognized and displayed.<a id="I_indexterm4_d1e34672" class="indexterm"></a><a id="I_indexterm4_d1e34673" class="indexterm"></a><a id="I_indexterm4_d1e34674" class="indexterm"></a></p>
         </div>
        </div>
        <div class="sect2" title="Extra Validation with the Luhn Algorithm">
         <div class="titlepage">
          <div>
           <div>
            <h2 class="title"><a id="validation-creditcard-luhn"></a>Extra Validation with the Luhn Algorithm</h2>
           </div>
          </div>
         </div>
         <p><a id="idx10573" class="indexterm"></a><a id="idx10642" class="indexterm"></a><a id="idx10694" class="indexterm"></a>There is an extra validation check that you can do on the credit card number before processing the order. The last digit in the credit card number is a checksum calculated according to the <em class="firstterm">Luhn algorithm</em>. Since this algorithm requires basic arithmetic, you cannot implement it with a regular expression.</p>
         <p>You can add the Luhn check to the web page example for this recipe by inserting the call <code class="literal">luhn(cardnumber);</code> before the “else” line in the <code class="literal">validatecardnumber()</code> function. This way, the Luhn check will be done only if the regular expression finds a valid match, and after determining the card brand. However, determining the brand of the credit card is not necessary for the Luhn check. All credit cards use the same method.</p>
         <p>In JavaScript, you can code the Luhn function as follows:</p>
         <a id="I_programlisting4_d1e26758"></a>
         <pre class="programlisting">function luhn(cardnumber) {
  // Build an array with the digits in the card number
  var digits = cardnumber.split('');
  for (var i = 0; i &lt; digits.length; i++) {
    digits[i] = parseInt(digits[i], 10);
  }  
  // Run the Luhn algorithm on the array
  var sum = 0;
  var alt = false;
  for (i = digits.length - 1; i &gt;= 0; i--) {
    if (alt) {
      digits[i] *= 2;
      if (digits[i] &gt; 9) {
        digits[i] -= 9;
      }
    }
    sum += digits[i];
    alt = !alt;
  }
  // Check the result
  if (sum % 10 == 0) {
    document.getElementById('notice').innerHTML += '; Luhn check passed';
  } else {
    document.getElementById('notice').innerHTML += '; Luhn check failed';
  }
}</pre>
         <p>This function takes a string with the credit card number as a parameter. The card number should consist only of digits. In our example, <code class="literal">validatecardnumber()</code> has already stripped spaces and hyphens and determined the card number to have the right number of digits.</p>
         <p>First, we split the string into an array of individual characters. Then we iterate over the array to convert the characters into integers. If we don’t convert them, the <code class="literal">sum</code> variable will end up as a string concatenation of the digits, rather than the integer addition of the numbers.</p>
         <p>The actual algorithm runs on the array, calculating a checksum. If the sum modulus 10 is zero, then the card number is valid. If not, the number is invalid.<a id="I_indexterm4_d1e34724" class="indexterm"></a><a id="I_indexterm4_d1e34725" class="indexterm"></a><a id="I_indexterm4_d1e34726" class="indexterm"></a></p>
        </div>
        <div class="sect2" title="See Also">
         <div class="titlepage">
          <div>
           <div>
            <h2 class="title"><a id="validation-creditcard-seealso"></a>See Also</h2>
           </div>
          </div>
         </div>
         <p>Techniques used in the regular expressions in this recipe are discussed in <a class="xref" href="ch02.html" title="Chapter&nbsp;2.&nbsp;Basic Regular Expression Skills">Chapter&nbsp;2</a>. <a class="xref" href="ch02s03.html" title="2.3.&nbsp;Match One of Many Characters">Recipe&nbsp;2.3</a> explains character classes. <a class="xref" href="ch02s05.html" title="2.5.&nbsp;Match Something at the Start and/or the End of a Line">Recipe&nbsp;2.5</a> explains anchors. <a class="xref" href="ch02s08.html" title="2.8.&nbsp;Match One of Several Alternatives">Recipe&nbsp;2.8</a> explains alternation. <a class="xref" href="ch02s09.html" title="2.9.&nbsp;Group and Capture Parts of the Match">Recipe&nbsp;2.9</a> explains grouping. <a class="xref" href="ch02s11.html" title="2.11.&nbsp;Capture and Name Parts of the Match">Recipe&nbsp;2.11</a> explains named capturing groups. <a class="xref" href="ch02s12.html" title="2.12.&nbsp;Repeat Part of the Regex a Certain Number of Times">Recipe&nbsp;2.12</a> explains repetition.<a id="I_indexterm4_d1e34747" class="indexterm"></a><a id="I_indexterm4_d1e34748" class="indexterm"></a></p>
        </div>
       </div>
      </div> 
     </div> 
     <section class="t-bottom-cta bottom-cta bottom-cta-book free-chapter"> 
      <h2> With Safari, you learn the way you learn best. Get unlimited access to videos, live online training, learning paths, books, interactive tutorials, and more. </h2> 
      <div class="controls"> 
       <a href="/public/free-trial/?fa=True&amp;cl=/library/view/regular-expressions-cookbook/9781449327453/ch04s20.html" class="button" data-ga-label="Bottom CTA">Start Free Trial</a> 
       <p>No credit card required</p> 
      </div> 
     </section> 
    </div> 
   </section> 
  </section> 
  <footer class="anybird-footer"> 
   <nav class="grid"> 
    <ul class="footer-nav col"> 
     <li><a href="/explore/"><span>Explore</span></a></li> 
     <li><a href="/our-library/"><span>Tour</span></a></li> 
     <li><a href="/pricing/"><span>Pricing</span></a></li> 
     <li><a href="/enterprise/"><span>Enterprise</span></a></li> 
     <li><a href="/government/"><span>Government</span></a></li> 
     <li><a href="/academic-public-library/"><span>Education</span></a></li> 
     <li><a href="/your-experience/#queue"><span>Queue App</span></a></li> 
    </ul> 
    <ul class="footer-contact col"> 
     <li><a href="/learn/"><span>Learn</span></a></li> 
     <li><a href="/blog/"><span>Blog</span></a></li> 
     <li><a href="/contact/"><span>Contact</span></a></li> 
     <li><a href="/careers/"><span>Careers</span></a></li> 
     <li><a href="/press-resources/"><span>Press Resources</span></a></li> 
     <li><a href="/public/support/"><span>Support</span></a></li> 
    </ul> 
    <ul class="footer-social col"> 
     <li id="footer-twitter"><a href="https://twitter.com/safari"><span>Twitter</span></a></li> 
     <li id="footer-github"><a href="http://github.com/safarijv"><span>GitHub</span></a></li> 
     <li id="footer-facebook"><a href="http://www.facebook.com/safaribooksonline"><span>Facebook</span></a></li> 
     <li id="footer-linkedin"><a href="https://www.linkedin.com/company/safari-books-online"><span>LinkedIn</span></a></li> 
    </ul> 
    <ul class="footer-legal col"> 
     <li><a href="/terms/"><span>Terms of Service</span></a></li> 
     <li><a href="/membership-agreement/"><span>Membership Agreement</span></a></li> 
     <li><a href="/privacy/"><span>Privacy Policy</span></a></li> 
    </ul> 
   </nav> 
   <div class="footer-copyright">
     Copyright © 2017 Safari Books Online. 
   </div> 
  </footer> 
  <script>
  var g = {
    
    position_cache: {},
    title: "Regular Expressions Cookbook, 2nd Edition",
    author_list: "Steven Levithan, Jan Goyvaerts",
    format: "book",
    source: "application/epub+zip",
    is_system_book: true,
    is_public: true,
    loaded_from_server: true,
    allow_scripts: false,
    has_mathml: false
    
  };
</script> 
  <script type="text/javascript" src="/library/view/static/CACHE/js/e5475d26c7d7.js"></script> 
  <noscript> 
   <iframe src="//www.googletagmanager.com/ns.html?id=GTM-5P4V6Z" height="0" width="0" style="display:none;visibility:hidden"> </iframe> 
  </noscript> 
  <script async defer src="/library/view/pageview.js"></script> 
  <script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","queueTime":0,"licenseKey":"510f1a6865","agent":"","transactionName":"YgdaZ0NSW0cEB0RdWltNfkZfUEFdCgofVVtMAFFBVR1DXQATQw5GVA9IX1RsQ10AEw==","applicationID":"10402228","errorBeacon":"bam.nr-data.net","applicationTime":1095}</script>   
 </body>
</html>