<!doctype html>
<html>
 <head> 
  <meta name="theme-color" content="#74BCDD"> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="text/html"> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=0"> 
  <link rel="icon" href="http://www.webondevices.com/wp-content/themes/webondevices/favicon.ico" type="image/x-icon"> 
  <title>
	The Arduino Plant with JavaScript voice recognition</title> 
  <link href="http://fonts.googleapis.com/css?family=Lato:100,300,400,700" rel="stylesheet" type="text/css"> 
  <link href="http://fonts.googleapis.com/css?family=PT+Serif:400,700,400italic" rel="stylesheet" type="text/css"> 
  <link rel="stylesheet" href="http://www.webondevices.com/wp-content/themes/webondevices/style.css"> 
  <link rel="pingback" href="http://www.webondevices.com/xmlrpc.php"> 
  <!-- This site is optimized with the Yoast SEO plugin v5.0.1 - https://yoast.com/wordpress/plugins/seo/ --> 
  <meta name="description" content="JavaScript voice recognition with Arduino and the web speech API"> 
  <link rel="canonical" href="http://www.webondevices.com/the-arduino-plant-with-javascript-voice-recognition/"> 
  <meta property="og:locale" content="en_US"> 
  <meta property="og:type" content="article"> 
  <meta property="og:title" content="The Arduino Plant with JavaScript voice recognition - Web on Devices"> 
  <meta property="og:description" content="JavaScript voice recognition with Arduino and the web speech API"> 
  <meta property="og:url" content="http://www.webondevices.com/the-arduino-plant-with-javascript-voice-recognition/"> 
  <meta property="og:site_name" content="Web on Devices"> 
  <meta property="article:section" content="Uncategorized"> 
  <meta property="article:published_time" content="2015-06-29T06:07:24+00:00"> 
  <meta property="article:modified_time" content="2015-07-14T05:26:04+00:00"> 
  <meta property="og:updated_time" content="2015-07-14T05:26:04+00:00"> 
  <meta property="og:image" content="http://www.webondevices.com/wp-content/uploads/2015/06/george.jpg"> 
  <meta property="og:image" content="http://www.webondevices.com/wp-content/uploads/2015/06/george-hero.jpg"> 
  <meta name="twitter:card" content="summary"> 
  <meta name="twitter:description" content="JavaScript voice recognition with Arduino and the web speech API"> 
  <meta name="twitter:title" content="The Arduino Plant with JavaScript voice recognition - Web on Devices"> 
  <meta name="twitter:image" content="http://www.webondevices.com/wp-content/uploads/2015/06/george.jpg"> 
  <!-- / Yoast SEO plugin. --> 
  <link rel="dns-prefetch" href="//s.w.org"> 
  <link rel="alternate" type="application/rss+xml" title="Web on Devices » The Arduino Plant with JavaScript voice recognition Comments Feed" href="http://www.webondevices.com/the-arduino-plant-with-javascript-voice-recognition/feed/"> 
  <script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.3\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/www.webondevices.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.8.2"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script> 
  <style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style> 
  <!-- This site uses the Google Analytics by MonsterInsights plugin v6.2.0 - Using Analytics tracking - https://www.monsterinsights.com/ --> 
  <script type="text/javascript" data-cfasync="false">
	/* Function to detect opted out users */
	function __gaTrackerIsOptedOut() {
		return document.cookie.indexOf(disableStr + '=true') > -1;
	}

	/* Disable tracking if the opt-out cookie exists. */
	var disableStr = 'ga-disable-UA-64514566-1';
	if ( __gaTrackerIsOptedOut() ) {
		window[disableStr] = true;
	}

	/* Opt-out function */
	function __gaTrackerOptout() {
	  document.cookie = disableStr + '=true; expires=Thu, 31 Dec 2099 23:59:59 UTC; path=/';
	  window[disableStr] = true;
	}

	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','__gaTracker');

	__gaTracker('create', 'UA-64514566-1', 'auto');
	__gaTracker('set', 'forceSSL', true);
	__gaTracker('send','pageview');
</script> 
  <!-- / Google Analytics by MonsterInsights --> 
  <link rel="https://api.w.org/" href="http://www.webondevices.com/wp-json/"> 
  <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://www.webondevices.com/xmlrpc.php?rsd"> 
  <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://www.webondevices.com/wp-includes/wlwmanifest.xml"> 
  <meta name="generator" content="WordPress 4.8.2"> 
  <link rel="shortlink" href="http://www.webondevices.com/?p=44"> 
  <link rel="alternate" type="application/json+oembed" href="http://www.webondevices.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.webondevices.com%2Fthe-arduino-plant-with-javascript-voice-recognition%2F"> 
  <link rel="alternate" type="text/xml+oembed" href="http://www.webondevices.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fwww.webondevices.com%2Fthe-arduino-plant-with-javascript-voice-recognition%2F&amp;format=xml"> 
 </head> 
 <body class="post-template-default single single-post postid-44 single-format-standard">
  <!-- Header --> 
  <header role="banner"> 
   <!-- Navigation --> 
   <nav role="navigation"> 
    <button class="back"><a href="http://www.webondevices.com">Back</a></button> 
    <ul class="menu"> 
     <li><a href="http://www.webondevices.com">Blog</a></li> 
     <li><a href="/resources">Resources</a></li> 
    </ul> 
   </nav> 
   <!-- Introduction --> 
   <section class="hero"> 
    <div class="image" style="background-image: url('http://www.webondevices.com/wp-content/uploads/2015/06/george-hero.jpg')">
     <!-- Empty -->
    </div> 
   </section> 
  </header> 
  <!-- Content --> 
  <article role="main"> 
   <h2>The Arduino Plant with JavaScript voice recognition</h2> 
   <time datetime="2015-06-29T06:07:24+00:00">This week</time>
   <span class="author"> by <a href="/about">Mate Marschalko</a></span> 
   <p>George has got light, temperature, soil moisture and two motion sensors for watching the world. He complains if any of the values from the sensors are excessive and is able interact with people by answering simple questions with the help of JavaScript voice recognition. George has got a simple face in the form of an 8×8, red LED board that can display basic expressions as well as turn his eyes into the direction where people are approaching from.</p> 
   <p><iframe height="315" src="https://www.youtube.com/embed/YGVS78MR5kY" frameborder="0" allowfullscreen></iframe></p> 
   <h3>The Hardware</h3> 
   <p>For displaying the simple facial expressions I used an 8×8 LED board with a built in MAX7219 controller chip. I also added the LM35 temperature, a simple soil moisture and a light sensor and finally for motion detection I used two PIR sensors. George moves his eyes where you come from and only talks if someone is around. The sensor data is concatenated into a JSON string which is then sent to Node.js through the USB. Using web sockets the Node server publishes this data for the browser. <strong>In the browser we use the Web Speech APIs to talk to and listen to people</strong>.</p> 
   <figure> 
    <img src="http://www.webondevices.com/wp-content/uploads/2015/06/george.jpg" alt="Arduino interior">
    <figcaption>
     Under the hood
    </figcaption>
   </figure> 
   <p>Please leave a comment if you would like a bit more detail on the hardware build.</p> 
   <h3>Now we’re talking</h3> 
   <p>The plant can complain about excessive sensor readings which is done using the HTML5 Web Speech API. In its simplest form this is how you get the browser to say something:</p> 
   <figure class="code"> 
    <pre><code>var utterance = new SpeechSynthesisUtterance('Hello World');
window.speechSynthesis.speak(utterance);</code></pre>
    <figcaption>
     HTML5 SpeechSynthesis API
    </figcaption>
   </figure> 
   <p>Using this API and a series of if/else conditions the plant expresses its feelings. The plant has a very easily extendable vocabulary. Everything is stored in an object and for each of the events it has a list of things to say that the javascript code randomly picks from:</p> 
   <figure class="code"> 
    <pre><code>plant = {
    complain: {
        hot: [
            "It's too hot in here.",
            "It's really warm in here",
            "I can't take this temperature",
            "My leaves are burning",
            "Can someone turn off the heating please?"
        ],
        cold: [
            "It's too cold in here.",
            "It's really cold in here",
            "It's freezing",
            "I can't take this temperature",
            "Can someone turn up the heating please?"
        ]
 
    // continued...</code></pre>
    <figcaption>
     Vocabulary
    </figcaption>
   </figure> 
   <p>I then used this vocabulary and the sensor data in the data object to trigger speech whenever a value is excessive:</p> 
   <figure class="code"> 
    <pre><code>if(data.temperature &lt; app.temp_min) {
    // I'm cold
    app.speak(
        plant.complain.cold[app.rdm(5)] + " It's " + data.temperature + " degrees.", false
    );
}
                 
if(data.temperature &gt; app.temp_max) {
    // I'm hot
    app.speak(
        plant.complain.hot[app.rdm(5)] + " It's " + data.temperature + " degrees.", false
    );
}</code></pre>
    <figcaption>
     Triggering speech
    </figcaption>
   </figure> 
   <figure> 
    <img src="http://www.webondevices.com/wp-content/uploads/2015/06/george-hero.jpg" alt="Arduino interior">
    <figcaption>
     Meet George
    </figcaption>
   </figure> 
   <p>Here’s the piece of code that only allows the plant to talk every 3 minutes. This boolean value is then used in the speak function:</p> 
   <figure class="code"> 
    <pre><code>// Allowing the plant to speak every 3 minutes
app.spokenTimer = setInterval(function(){
    app.recentlySpoken = false;
}, 3 * minutes);</code></pre>
    <figcaption>
     Limiting speech
    </figcaption>
   </figure> 
   <p>When someone waters the plant this delay is disabled to prevent the user from waiting 3 minutes until the voice feedback. The <code>setInterval</code> is needed to have a time range within the soil moisture level has to increase by 10% to trigger the event.</p> 
   <figure class="code"> 
    <pre><code>if(app.moisture + 10 &lt; data.moisture) {
    // I'm being watered
    app.moisture = parseInt(data.moisture);
    app.speak(
        plant.thank.water[app.rdm(5)] + " The last time I was watered was " + watered.returnDate(), true
    );
    localStorage.setItem("lastWatered", new Date());
}
 
// Sampling moisture
app.moistureTimer = setInterval(function(){
    app.moisture = parseInt(app.plantData.moisture);
}, 30 * seconds);</code></pre>
    <figcaption>
     Checks if George is being water
    </figcaption>
   </figure> 
   <h3>Answering questions</h3> 
   <p>George can interpret simple questions and answers them using the HTML5 Web Speech API. This is the Hello World example of voice recognition:</p> 
   <figure class="code"> 
    <pre><code>var recognition = new webkitSpeechRecognition();
recognition.onresult = function(event) {
    console.log(event);
}
recognition.start();</code></pre>
    <figcaption>
     HTML5 SpeechRecognition API
    </figcaption>
   </figure> 
   <p>There are two helper functions I added to make talking a very simple process:</p> 
   <p><code>app.matchWords([array], string)</code> - You need to pass in an array of words as the first attribute and a piece of string as a second. The function then returns true or false whether any of the words in the array has been found in the string.</p> 
   <p><code>app.answer(string)</code> - Pass in the piece of string as an answer and the browser will read it out loud. </p> 
   <p>Here's a simple example that would answer you if you asked: "What's the temperature?" or "Are you hot?":</p> 
   <figure class="code"> 
    <pre><code>// Temperature
if(app.matchWords(
    ["temperature", "hot", "cold", "warm"], text
)){
    app.answer(
        plant.answer[temp][app.rdm(2)] + " " +
        app.plantData.temperature +
        " degrees"
    );
}</code></pre>
    <figcaption>
     Understand question then answer
    </figcaption>
   </figure> 
   <p>All these helper functions make it very easy to extend the vocabulary of the plant and build new features.</p> 
   <h3>Future plans</h3> 
   <p>It might be worth spending a little bit extra time on George. It would be great to package him up into a nicer box rather than having bare wires hanging out from his body. I was also looking at HTML5 web speech libraries to see if anything can make him more reliable as sometimes it speaks and listens the same time and picks up and reacts to his own voice.</p> 
   <p>Please let me know in the comments section if you would like to see a more detailed tutorial on the entire build.</p> 
   <!-- <p class="intro">An Arduino is an open-source microcontroller development board. In plain English, you can use the Arduino to read sensors and control things like motors and lights. This allows you to upload programs to this board which can then interact with things in the real world.</p>

	<figure>
		<img src="img/rc-car.jpg" alt="Arduino RC car">
		<figcaption>The radio controlled car</figcaption>
	</figure>

	<p>An Arduino is an open-source microcontroller development board. In plain English, you can use the Arduino to <strong>read sensors</strong> and control things like motors and lights. This allows you to upload programs to this board which can then <code>-webkit-fontsmoothing: antialiased;</code> interact with things in the real world.</p>

	<figure class="code">
		<pre><code>$(board).on(‘ready’, function(){
	console.log(“test”);
});</code></pre>
		<figcaption>Example code for board ready - Javascript</figcaption>
	</figure>

	<p>An Arduino is an open-source microcontroller development board. In plain English, you can use the library.</p>

	<blockquote>
		“I’m so proud that this site is now ready and I can make money out of it…”
	</blockquote>

	<p>An Arduino is an open-source microcontroller development board. In plain English, you can use the library.</p>

	--> 
   <button class="navigate" type="button" data-href="http://www.webondevices.com">Back to all</button> 
   <section> 
    <div id="comments" class="comments-area"> 
     <h2 class="comments-title"> 3 thoughts on “<span>The Arduino Plant with JavaScript voice recognition</span>” </h2> 
     <ol class="comment-list"> 
      <li id="comment-3" class="pingback even thread-even depth-1"> 
       <div class="comment-body">
         Pingback: 
        <a href="https://unknotted.ucsd.edu/?p=207" rel="external nofollow" class="url">Node.js: The New Swiss Army Chainsaw | Unknotted</a> 
       </div> </li>
      <!-- #comment-## --> 
      <li id="comment-6" class="pingback odd alt thread-odd thread-alt depth-1"> 
       <div class="comment-body">
         Pingback: 
        <a href="http://www.scoop.it/t/open-hardware-news/p/4047207825/2015/07/07/the-arduino-plant-with-javascript-voice-recognition-web-on-devices" rel="external nofollow" class="url">The Arduino Plant with JavaScript voice recogni...</a> 
       </div> </li>
      <!-- #comment-## --> 
      <li id="comment-15" class="pingback even thread-even depth-1"> 
       <div class="comment-body">
         Pingback: 
        <a href="https://dineshramitc.wordpress.com/2015/07/17/the-arduino-plant-with-javascript-voice-recognition/" rel="external nofollow" class="url">The Arduino Plant with JavaScript voice recognition | Dinesh Ram Kali.</a> 
       </div> </li>
      <!-- #comment-## --> 
     </ol>
     <!-- .comment-list --> 
     <div id="respond" class="comment-respond"> 
      <h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/the-arduino-plant-with-javascript-voice-recognition/#respond" style="display:none;">Cancel reply</a></small></h3>
      <p class="must-log-in">You must be <a href="http://www.webondevices.com/wp-login.php?redirect_to=http%3A%2F%2Fwww.webondevices.com%2Fthe-arduino-plant-with-javascript-voice-recognition%2F">logged in</a> to post a comment.</p> 
     </div>
     <!-- #respond --> 
    </div>
    <!-- #comments --> 
   </section> 
  </article> 
  <!-- Free e-book --> 
  <section class="free-ebook" id="teaser"> 
   <div> 
    <h2>Free Ebook</h2> 
    <p>Learn hardware prototyping and become a better developer.</p> 
    <p><strong>This ebook will get you started with JavaScript Arduino electronics in no time.</strong></p> 
    <div class="book-image"></div> 
    <input id="ebook-send" type="email" placeholder="Email address"> 
    <p class="form-warning">Enter a valid e-mail</p> 
    <button class="submit large action" type="submit">Send me the PDF</button> 
    <h3 class="success">Check your emails (Spams too)!</h3> 
   </div> 
  </section> 
  <footer> 
   <!-- Follow Web on Devices --> 
   <section class="about-us"> 
    <div class="light-bulb">
     <img src="http://www.webondevices.com/wp-content/themes/webondevices/img/bulb-logo-full.png" alt="light bulb logo">
    </div> 
    <h2>Web on Devices</h2> 
    <p class="main-message">Electronics Hacking with JavaScript and other Web Technologies</p> 
    <button class="connect twitter" data-href="https://twitter.com/web_on_devices">Twitter</button> 
    <button class="connect facebook" data-href="https://www.facebook.com/webondevices">Facebook</button> 
   </section> 
   <!-- Follow Mate Marschalko --> 
   <section class="about-author"> 
    <a href="/about"> <img class="author" src="http://www.webondevices.com/wp-content/themes/webondevices/img/matemarschalko.jpg" alt="Mate Marschalko"> <h2>Mate Marschalko</h2> </a> 
    <p class="about-me">Front-end Web Developer, Creative Technologist and Maker. Builds Internet connected devices for the Internet of Things.</p> 
   </section> 
   <div class="teaser-bar"> 
    <a href="#teaser">Download FREE Ebook: Introduction to JavaScript Electronics</a> 
    <button><img src="http://www.webondevices.com/wp-content/themes/webondevices/img/close-w.png" alt="close"></button> 
   </div> 
   <!-- Legal and Contact --> 
   <section class="legal">
     All rights reserved | Contact at 
    <a href="emailto:hello@webondevices.com">hello@webondevices.com</a> 
   </section> 
  </footer> 
  <script src="http://www.webondevices.com/wp-content/themes/webondevices/js/libraries.js"></script> 
  <script src="http://www.webondevices.com/wp-content/themes/webondevices/js/main.js"></script> 
  <script type="text/javascript">
	// init highlights
	hljs.initHighlightingOnLoad();
</script>  
 </body>
</html>