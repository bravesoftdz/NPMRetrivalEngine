<!DOCTYPE html SYSTEM "about:legacy-compat">
<html xml:lang="en" lang="en" version="-//W3C//DTD XHTML 1.1//EN" xmlns:xhtml="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/xhtml">
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Extracting Metadata and Text From Binary Documents (Search Developer's Guide)
   — MarkLogic 9 Product Documentation</title>
  <meta charset="utf-8">
  <meta name="description" content="MarkLogic is the only Enterprise NoSQL Database">
  <meta name="keywords" content="marklogic, enterprise nosql database, enterprise nosql, database, nosql, nosql database, nosql db, xml, xml database, json, enterprise, bigdata, big data, xquery, xslt, petabyte, java db, java database, content, content store, content database, content db, content management system, CMS, document, document-oriented databases, document database, document db, document store, DB, xml database, xml db, json db, nonrelational, nonrelational database, nonrelational db">
  <meta name="viewport" content="initial-scale=1.0">
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link href="/css/v-2/apidoc/jquery.treeview.css" rel="stylesheet" type="text/css" media="screen">
  <link href="/css/v-38/apidoc-screen.css" rel="stylesheet" type="text/css" media="screen">
  <link href="/css/v-33/apidoc.css" rel="stylesheet" type="text/css" media="screen">
  <link href="/css/v-1/apidoc_print.css" rel="stylesheet" type="text/css" media="print">
  <!--[if lte IE 8]>
        <link href="/css/v-2/screen_ie.css"
          rel="stylesheet" type="text/css" media="screen" />
        <![endif]-->
  <script src="/apidoc/js/optimized/all-2017-09-26T07:57:25.475-07:00.js" type="text/javascript" xml:space="preserve"></script>
  <!-- Un-minimize for debugging
         <script type="text/javascript" src="/js/jquery-1.7.2.js"></script>
         -->
 </head>
 <body> 
  <!-- Google Tag Manager --> 
  <noscript>
   <iframe src="//www.googletagmanager.com/ns.html?id=GTM-MBC6N2" height="0" width="0" style="display:none;visibility:hidden" frameborder="1" scrolling="auto"></iframe>
  </noscript> 
  <script xml:space="preserve">if ( document.location.hostname == 'docs.marklogic.com') {
(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-MBC6N2'); }  </script> 
  <!-- End Google Tag Manager --> 
  <div id="header"> 
   <header> 
    <nav class="navbar-top row ml-nav"> 
     <div class="col-xs-5"> 
      <ul class="nav-web-properties">
       <li><a href="http://www.marklogic.com" target="_blank"><span class="glyphicon glyphicon-home"></span><span class="hidden-xs hidden-sm hidden-md">Marklogic.com</span></a></li>
       <li><a href="http://developer.marklogic.com" target="_blank"><span class="glyphicon glyphicon-console"></span><span class="hidden-xs hidden-sm hidden-md">Developers</span></a></li>
       <li><a href="http://world.marklogic.com" target="_blank"><span class="glyphicon glyphicon-globe"></span><span class="hidden-xs hidden-sm hidden-md">MarkLogic World</span></a></li>
       <li><a href="http://www.marklogic.com/services/training/" target="_blank"><span class="glyphicon glyphicon-apple"></span><span class="hidden-xs hidden-sm hidden-md">University</span></a></li>
      </ul> 
     </div> 
     <div class="col-xs-7"> 
      <ul class="nav-resources pull-right">
       <li><a href="http://stackoverflow.com/questions/ask?tags=marklogic"><span class="glyphicon glyphicon-question-sign"></span><span class="hidden-xs hidden-sm">Ask a Question</span></a></li>
      </ul> 
      <nav id="login-menu-nav">
       <ul class="pull-right">
        <li class="btn-group"><a href="#" class="drop-down-trigger navbar-top" id="login-trigger" aria-haspopup="true" data-toggle="dropdown"> Log in </a>
         <form id="local-login-form" class="dropdown-menu" method="post" action="//developer.marklogic.com/login">
          <div style="clear: both" id="login-error"></div>
          <div class="form-group">
           <label class="control-label" for="email">Email:</label>
           <input class="required email form-control input-sm" autofocus required id="email" name="email" title="password" value="" type="text">
          </div>
          <div class="form-group">
           <label class="control-label" for="password">Password:</label>
           <input class="password required form-control input-sm" required id="password" name="password" title="password" value="" type="password">
          </div>
          <div class="form-group">
           <button onclick="return false;" class="btn btn-xs btn-default" id="login_submit" type="button">Log in</button>
          </div>
          <div class="form-group">
           <button onclick="return false;" data-url="//developer.marklogic.com/people/recovery" class="btn btn-xs btn-default" id="recovery">Forgot password?</button>
          </div>
         </form></li>
        <li><a href="/people/signup" class="drop-down-trigger navbar-top" id="signup-trigger" data-url="//developer.marklogic.com/people/signup"> Sign up </a></li>
        <li class="btn-group"><a href="#" class="drop-down-trigger" id="session-trigger" aria-haspopup="true" data-toggle="dropdown" style="display:none"><span class="caret"></span></a>
         <ul class="dropdown-menu">
          <li><a href="//developer.marklogic.com/people/profile">Edit Profile</a></li>
          <li><a href="#" id="logout">Log out</a></li>
         </ul></li>
       </ul>
      </nav> 
     </div> 
    </nav> 
    <nav class="navbar navbar-inverse dmc-nav"> 
     <div class="container-fluid"> 
      <!-- Brand and toggle get grouped for better mobile display --> 
      <div class="navbar-header"> 
       <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#dmc-navbar-collapse" aria-expanded="false"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> 
       <a class="navbar-brand" ml:class="" href="//developer.marklogic.com" xmlns:ml="http://developer.marklogic.com/site/internal"> <img src="/images/logo-community-white.svg" alt="MarkLogic® Community"> </a> 
      </div> 
      <div class="collapse navbar-collapse row" id="dmc-navbar-collapse"> 
       <form class="navbar-form navbar-right search-form" action="//developer.marklogic.com/search" method="get" enctype="application/x-www-form-urlencoded">
        <div class="form-group"> 
         <input type="hidden" name="v" value="9.0"> 
         <input type="hidden" name="api" value="1"> 
         <div class="input-group"> 
          <input id="s_inp" name="q" type="text" class="form-control" autocapitalize="off" placeholder="Search with MarkLogic" value=""> 
          <span class="input-group-addon"> <i class="glyphicon glyphicon-search"></i> </span> 
         </div> 
        </div>
       </form> 
       <ul class="nav navbar-nav navbar-right">
        <li class="current"><a href="//docs.marklogic.com/" data-toggle="tooltip" data-placement="bottom" title="">Documentation</a></li>
        <li><a href="//developer.marklogic.com/products" data-toggle="tooltip" data-placement="bottom" title="">Downloads</a></li>
        <li><a href="//developer.marklogic.com/learn" data-toggle="tooltip" data-placement="bottom" title="">Tutorials</a></li>
        <li><a href="//developer.marklogic.com/code" data-toggle="tooltip" data-placement="bottom" title="">Tools</a></li>
        <li><a href="//developer.marklogic.com/blog" data-toggle="tooltip" data-placement="bottom" title="">Blog</a></li>
        <li><a href="//developer.marklogic.com/qa" data-toggle="tooltip" data-placement="bottom" title="">Q&amp;A</a></li>
        <li><a href="//developer.marklogic.com/meet" data-toggle="tooltip" data-placement="bottom" title="">People</a></li>
       </ul> 
      </div> 
     </div> 
    </nav> 
   </header> 
   <div id="header-below-bottom-bar"> 
    <div id="breadcrumb"> 
     <div class="col-xs-9">
      <a href="/">Docs</a>
      <span id="breadcrumbDynamic"></span>
     </div> 
    </div> 
    <div class="version">
     <span>Version:</span> 
     <select id="version_list" data-default="9.0"><option value="5.0">5.0</option><option value="6.0">6.0</option><option value="7.0">MarkLogic 7</option><option value="8.0">MarkLogic 8</option><option value="9.0" selected="true">MarkLogic 9</option></select>
    </div> 
   </div> 
  </div> 
  <div id="api_sub"> 
   <div id="apidoc_toc">
    <!--TOC goes here-->Loading TOC...
   </div> 
  </div> 
  <section id="page_content"> 
   <input id="functionPageBucketId" value="" type="hidden">
   <input id="tocSectionLinkSelector" value=".scrollable_section a[href='/guide/search-dev']" type="hidden">
   <input id="isUserGuide" value="true" type="hidden">
   <input id="toc_url" value="/media/apiTOC/default/apiTOC_2017-09-26T06:54:22.212-07:00.html" type="hidden"> 
   <div class="userguide pjax_enabled">
    <a class="guide-pdf-link" href="/guide/search-dev.pdf"><img src="/images/i_pdf.png" alt="Search Developer's Guide (PDF)" class="printerFriendly" width="16" height="16"></a>
    <a href="?print=yes" target="_blank" class="printerFriendly"><img src="/apidoc/images/printerFriendly.png"></a>
    <h1><a href="/guide/search-dev">Search Developer's Guide</a><span class="chapterNumber"> — Chapter&nbsp;20</span></h1>
    <div class="previousChapter pjax_enabled">
     <a href="/guide/search-dev/custom-dictionaries" accesskey="p">«&nbsp;Previous&nbsp;chapter</a>
    </div>
    <div class="nextChapter pjax_enabled">
     <a href="/guide/search-dev/wildcard" accesskey="n">Next&nbsp;chapter&nbsp;»</a>
    </div>
    <div class="section" data-fm-style="Heading-1">
     <a id="chapter"></a>
     <h2><a href="#chapter" class="sectionLink">Extracting Metadata and Text From Binary Documents</a></h2>
     <p><a id="id_pgfId-1064173"></a>This chapter describes how to extract metadata and/or text from binary documents. It contains the following sections:</p>
     <ul>
      <li><a href="#id_54807">Metadata and Text Extraction Overview</a></li>
      <li><a href="#id_44758">Usage Examples</a></li>
      <li><a href="#id_68368">Supported Binary Formats</a></li>
     </ul>
     <div class="section" data-fm-style="Heading-2">
      <a id="id_54807"></a>
      <h3><a href="#id_54807" class="sectionLink">Metadata and Text Extraction Overview</a></h3>
      <p><a id="id_pgfId-1068409"></a>Binary documents often have various associated metadata. For example, a JPEG image from a camera may have metadata of the camera's type and model number, a timestamp of when it was taken, and so on.</p>
      <p><a id="id_pgfId-1068867"></a>MarkLogic Server can access binary document metadata and then store it as XML in a properties document. You can then search and retrieve the metatdata using MarkLogic Server's rich XML search capabilities. In addition, for text-based binary documents, such as those in Microsoft Word format, MarkLogic can extract and index their text content.</p>
      <p><a id="id_pgfId-1064260"></a>MarkLogic Server server offers the XQuery built-in, <a href="/xdmp:document-filter">xdmp:document-filter</a>, and JavaScript method, <a href="/xdmp.documentFilter">xdmp.documentFilter</a>, to extract and associate metadata from binary documents: These functions extract metadata and text from binary documents as XHTML. The results may be used as document properties. The extracted text contains little formatting or structure, so it is best used for search, classification, or other text processing.</p>
     </div>
     <div class="section" data-fm-style="Heading-2">
      <a id="id_44758"></a>
      <h3><a href="#id_44758" class="sectionLink">Usage Examples</a></h3>
      <p><a id="id_pgfId-1068025"></a>The following sections show how xdmp:document-filter works with various file types. The Microsoft Word section also provides code to extract only the metadata elements from combined metadata and text results.</p>
      <ul>
       <li><a href="#id_98155">Microsoft Word</a></li>
       <li><a href="#id_13636">File Archives</a></li>
       <li><a href="#id_46966">PowerPoint</a></li>
      </ul>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_98155"></a>
       <h4><a href="#id_98155" class="sectionLink">Microsoft Word</a></h4>
       <p><a id="id_pgfId-1067959"></a>The following query and results are for a Microsoft Word document containing only the text 'This is a test':</p>
       <pre xml:space="preserve"><a id="id_pgfId-1065206"></a>xquery version "1.0-ml";
&nbsp;&nbsp;xdmp:document-filter(doc("/documents/test.docx"))</pre>
       <p><a id="id_pgfId-1068716"></a>Returns:</p>
       <pre xml:space="preserve"><a id="id_pgfId-1068726"></a>&nbsp;&nbsp;&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&nbsp;&nbsp;&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;head&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="content-type" content="application/msword"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="filter-capabilities" 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content="text subfiles HD-HTML"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="AppName" content="Microsoft Office Word"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Author" content="Clark Kent"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Company" content="MarkLogic"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Creation_Date" content="2011-10-11T02:40:00Z"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name='Description' 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content='This is my comment.'/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Last_Saved_Date" content="2011-10-11T02:41:00Z"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Line_Count" content="1"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Paragraphs_Count" content="1"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Revision" content="1"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Template" content="Normal"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Typist" content="Clark Kent"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Word_Count" content="4"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="isys" content="SubType: Word 2007"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="size" content="12691"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/head&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;body&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This is a test.&lt;/p&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;p&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;/p&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;/body&gt;
&nbsp;&nbsp;&lt;/html&gt;</pre>
       <p><a id="id_pgfId-1065961"></a>In the document, the word 'test' is both italicized and bolded. <code>xdmp:document-filter </code>does not return such text formatting. </p>
       <p><a id="id_pgfId-1065975"></a>Expanding on the previous example, the following code uses <a href="/xdmp:document-filter">xdmp:document-filter</a> to extract only the metadata from that same Microsoft Word document:</p>
       <pre xml:space="preserve"><a id="id_pgfId-1064268"></a>xquery version "1.0-ml";
let $url := "/documents/test.docx"
return xdmp:document-set-properties(
&nbsp;&nbsp;$url, 
&nbsp;&nbsp;for $meta in xdmp:document-filter(fn:doc($the-document))//*:meta
&nbsp;&nbsp;return element {$meta/@name} {fn:string($meta/@content)}
)</pre>
       <p><a id="id_pgfId-1064275"></a>The properties document now looks as follows:</p>
       <pre xml:space="preserve"><a id="id_pgfId-1064277"></a>xdmp:document-properties('/documents/test.docx')</pre>
       <p><a id="id_pgfId-1068800"></a>returns:</p>
       <pre xml:space="preserve"><a id="id_pgfId-1068789"></a>&lt;prop:properties xmlns:prop="http://marklogic.com/xdmp/property"&gt;
&nbsp;&nbsp;&lt;content-type&gt;application/msword&lt;/content-type&gt;
&nbsp;&nbsp;&lt;filter-capabilities&gt;text subfiles HD-HTML&lt;/filter-capabilities&gt;
&nbsp;&nbsp;&lt;AppName&gt;Microsoft Office Word&lt;/AppName&gt;
&nbsp;&nbsp;&lt;Author&gt;Clark Kent&lt;/Author&gt;
&nbsp;&nbsp;&lt;Company&gt;MarkLogic&lt;/Company&gt;
&nbsp;&nbsp;&lt;Creation_Date&gt;2011-10-11T02:40:00Z&lt;/Creation_Date&gt;
&nbsp;&nbsp;&lt;Description&gt;This is my comment.&lt;/Description&gt;
&nbsp;&nbsp;&lt;Last_Saved_Date&gt;2011-10-11T02:41:00Z&lt;/Last_Saved_Date&gt;
&nbsp;&nbsp;&lt;Line_Count&gt;1&lt;/Line_Count&gt;
&nbsp;&nbsp;&lt;Paragraphs_Count&gt;1&lt;/Paragraphs_Count&gt;
&nbsp;&nbsp;&lt;Revision&gt;1&lt;/Revision&gt;
&nbsp;&nbsp;&lt;Subject&gt;Creating binary doc props&lt;/Subject&gt;
&nbsp;&nbsp;&lt;Template&gt;Normal/Template&gt;
&nbsp;&nbsp;&lt;Typist&gt;Clark Kent&lt;/Typist&gt;
&nbsp;&nbsp;&lt;Word_Count&gt;4&lt;/Word_Count&gt;
&nbsp;&nbsp;&lt;isys&gt;SubType: Word 2007&lt;/isys&gt;
&nbsp;&nbsp;&lt;size&gt;12691&lt;/size&gt;
&nbsp;&nbsp;&lt;prop:last-modified&gt;2011-10-12T09:47:10-07:00&lt;/prop:last-modified&gt;
&lt;/prop:properties&gt;</pre>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_13636"></a>
       <h4><a href="#id_13636" class="sectionLink">File Archives</a></h4>
       <p><a id="id_pgfId-1068165"></a>If you need to extract files from <code>zip</code> archives for individual processing, use <code>xdmp:zip-manifest </code>and <a href="/xdmp:zip-get">xdmp:zip-get</a>. Use <a href="/xdmp:document-filter">xdmp:document-filter</a> if you just want all the text from the archive, since it does not preserve the embedded files' structure, but includes all of the documents' text. This is useful for finding the original location in search results; if you search for 'Elvis' and use <code>xdmp:document-filter</code> on the various files, the results include every binary containing 'Elvis', whether it is a zip archive, Word document, or photo. </p>
       <p><a id="id_pgfId-1068208"></a>In this example, <code>xdmp:document-filter</code> runs on the file archive <code>test.zip</code>, which consists of two Word files and a JPEG file, </p>
       <pre xml:space="preserve"><a id="id_pgfId-1066116"></a>xquery version "1.0-ml";
&nbsp;&nbsp;xdmp:document-filter(doc("/documents/test.zip"))</pre>
       <p><a id="id_pgfId-1066094"></a>returns</p>
       <pre xml:space="preserve"><a id="id_pgfId-1068903"></a>&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&nbsp;&nbsp;&lt;head&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="content-type" content="application/zip"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="filter-capabilities" content="subfiles"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="AppName" content="Microsoft Office Word"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Author" content="Lois Lane"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Company" content="MarkLogic"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Creation_Date" content="2011-10-14T21:11:00Z"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Last_Saved_Date" content="2011-10-14T21:11:00Z"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Line_Count" content="1"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Paragraphs_Count" content="1"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Revision" content="2"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Template" content="Normal"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Typist" content="Lois Lane"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Word_Count" content="3"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="isys" content="SubType: Word 2007"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Focal_Length" content="4"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Make" content="LG Electronics"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Model" content="VM670"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Original_Date_Time" content="2011:10:19 14:59:24"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Original_Date_Time.datetime" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content="2011-10-19T14:59:24Z"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="ResolutionUnit" content="2"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="XResolution" content="72.000000"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="YResolution" content="72.000000"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="AppName" content="Microsoft Office Word"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Author" content="Clark Kent"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Company" content="MarkLogic"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Creation_Date" content="2011-10-11T02:40:00Z"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Last_Saved_Date" content="2011-10-11T02:41:00Z"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Line_Count" content="1"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Paragraphs_Count" content="1"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Revision" content="1"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Template" content="Normal"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Typist" content="Clark Kent"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Word_Count" content="2"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="isys" content="SubType: Word 2007"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="size" content="47730"/&gt;
&nbsp;&nbsp;&lt;/head&gt;
&lt;body&gt;
&nbsp;&lt;p&gt;
&nbsp;&lt;/p&gt;
&nbsp;&lt;p&gt;
&nbsp;&nbsp;This is a another test.&lt;/p&gt;
&nbsp;&nbsp;&lt;p&gt;
&nbsp;&nbsp;&lt;/p&gt;
&nbsp;&nbsp;&lt;p&gt;
&nbsp;&nbsp;&nbsp;&nbsp;This is a test.&lt;/p&gt;
&nbsp;&nbsp;&lt;p&gt;
&nbsp;&nbsp;&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
       <p><a id="id_pgfId-1066101"></a>While each sentence in this example's returned HTML body text is from a different file, there is no way to distinguish which text comes from which file. Similarly, the returned subfile metadata is not guaranteed to be returned in file order (for example, <code>name='a'</code>,<code> name='b'</code> might be from different documents in the archive) and so also cannot be correctly associated with an individual subfile.</p>
       <p><a id="id_pgfId-1069012"></a>Also, individual subfiles in the archive are not necessarily distinguishable at all. In the above example, you cannot tell from the output how many files, or what file types, are in the archive. When using <a href="/xdmp:document-filter">xdmp:document-filter</a> on an archive, you should think of the archive as a single file, rather than a compilation of subfiles. You will get back all the metadata and text contained in the single archive file, but will have no way of associating that returned information with the individual subfiles it came from. </p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_46966"></a>
       <h4><a href="#id_46966" class="sectionLink">PowerPoint</a></h4>
       <p><a id="id_pgfId-1067985"></a>The following query and results are for a two slide PowerPoint document, where each slide has a title and separate content:</p>
       <pre xml:space="preserve"><a id="id_pgfId-1067488"></a>xquery version "1.0-ml";
&nbsp;&nbsp;xdmp:document-filter(doc("/documents/test.pptx"))</pre>
       <p><a id="id_pgfId-1068748"></a>returns:</p>
       <pre xml:space="preserve">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
&nbsp;&nbsp;&lt;head&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="content-type" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content="application/vnd.ms-powerpoint"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="filter-capabilities" content="text subfiles HD-HTML"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;title&gt;This is a test &lt;/title&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="AppName" content="Microsoft Office PowerPoint"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Author" content="Clark Kent"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Company" content="MarkLogic"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Creation_Date" content="2011-10-17T19:58:34Z"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Last_Saved_Date" content="2011-10-17T20:00:13Z"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Paragraphs_Count" content="4"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Presentation_Format" content="On-screen Show (4:3)"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Revision" content="1"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Slide_Count" content="2"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Typist" content="Clark Kent"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="Word_Count" content="12"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="isys" content="SubType: PowerPoint 2007"/&gt;
&nbsp;&nbsp;&nbsp;&nbsp;&lt;meta name="size" content="36909"/&gt;
&nbsp;&nbsp;&lt;/head&gt;
&nbsp;&nbsp;&lt;body&gt;
&lt;p&gt;
&lt;/p&gt;
&lt;p&gt;
This is a test &lt;/p&gt;
&lt;p&gt;
Of PowerPoint&lt;/p&gt;
&lt;p&gt;
&lt;/p&gt;
&lt;p&gt;
Test #3
&lt;/p&gt;
&lt;p&gt;
Second Slide.&lt;/p&gt;
&lt;p&gt;
<a id="id_pgfId-1068004"></a>&lt;/p&gt;
&lt;/body&gt;
&lt;/html&gt;</pre>
       <p><a id="id_pgfId-1067414"></a>Similarly, any text formatting is not returned, nor is any indicator of what role the text played on a slide (title, body, etc.), nor is there any way to tell what text belongs to which slide.</p>
      </div>
     </div>
     <div class="section" data-fm-style="Heading-2">
      <a id="id_68368"></a>
      <h3><a href="#id_68368" class="sectionLink">Supported Binary Formats</a></h3>
      <p><a id="id_pgfId-1065872"></a>The following sections list the binary file formats and file extensions from which <code>xdmp:document-filter</code> can extract metadata and, depending on the format, text from. Due to the large number of formats, they are first broken down into general application areas, such as Databases or Multimedia, then each area lists its applicable formats and extensions.</p>
      <p><a id="id_pgfId-1069192"></a>Some formats can be identified by <a href="/xdmp:document-filter">xdmp:document-filter</a>, but have no text or metadata to extract, such as executables. For these, the returned &lt;meta name="content-type" content=.../&gt; identifies the file's format.</p>
      <ul>
       <li><a href="#id_57270">Archives</a></li>
       <li><a href="#id_67229">Databases</a></li>
       <li><a href="#id_74509">Email and Messaging</a></li>
       <li><a href="#id_23075">Multimedia</a></li>
       <li><a href="#id_67013">Other</a></li>
       <li><a href="#id_86201">Presentation</a></li>
       <li><a href="#id_89712">Raster Image</a></li>
       <li><a href="#id_74790">Spreadsheet</a></li>
       <li><a href="#id_64699">Text and Markup</a></li>
       <li><a href="#id_77002">Vector Image</a></li>
       <li><a href="#id_29330">Word Processing and General Office</a></li>
      </ul>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_57270"></a>
       <h4><a href="#id_57270" class="sectionLink">Archives</a></h4>
       <p><a id="id_pgfId-1065848"></a><strong>Formats</strong>: 7-Zip, ACE, ARJ, Bzip2, ISO Disk Image, Java Archive, LZH, Microsoft Cabinet, Microsoft Office Binder, RedHat Package Manager, Roshal Archive, Self-extracting .exe, StuffIt, StuffIt Self Extracting Archive, SuffIt X, GNU Zip, UNIX cpio, UNIX Tar, Zip, PKZip, WinZip</p>
       <p><a id="id_pgfId-1065855"></a><strong>Extensions</strong>: .7Z, .ACE, .ARJ, .BZ2, .CAB, .CPIO, .EXE, .GZ, .ISO, JAR, LZH, .ORD, .RAR, .RPM, .SIT, .SEA, .SITX, .TAR, .TBZ2, .ZIP</p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_67229"></a>
       <h4><a href="#id_67229" class="sectionLink">Databases</a></h4>
       <p><a id="id_pgfId-1065889"></a><strong>Formats</strong>: dBase, dBase III, Microsoft Access, Paradox Database</p>
       <p><a id="id_pgfId-1065896"></a><strong>Extensions</strong>: .DB, .DBF, .DB3, .MDB</p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_74509"></a>
       <h4><a href="#id_74509" class="sectionLink">Email and Messaging</a></h4>
       <p><a id="id_pgfId-1065906"></a><strong>Formats</strong>: Encoded mail messages of any of the forms MHT, Multipart Alternative, Multipart Digest, Multipart Mixed, Multipart Newsgroup, Multipart Signed, and TNEF. Also, the individual formats Eudora, Microsoft Outlook, Microsoft Outlook3, Microsoft Outlook Express3. Microsoft Outlook Forms Template, Sendmail 'mbox', Thunderbird</p>
       <p><a id="id_pgfId-1065913"></a><strong>Extensions</strong>: .EML, .MBOX, .MBX, .MHT, .MSG, .OFT, .PST</p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_23075"></a>
       <h4><a href="#id_23075" class="sectionLink">Multimedia</a></h4>
       <p><a id="id_pgfId-1065591"></a><strong>Formats</strong>: 3GP, Adobe Flash, Adobe Flash Video, Audio Video Interleave (AVI), DVD Information File, DVD Video Object, Microsoft Windows Movie Maker, Musical Instrument Digital Interface (MIDI), MPEG Video, MPEG-1 Audio Layer 3, MPEG-4 Video, MPEG-2 Audio Layer 3, OGG Flac Audio, OGG Vorbis Audio, QuickTime, Real Media, Waveform Audio File Format (WAVE), Window Media Audio, Windows Media Video.</p>
       <p><a id="id_pgfId-1065643"></a><strong>Extensions</strong>: .3GP, .AIFF, .AVI, .BUP, .FLAC, .FLV, .IFO, .MID, .MIDI, .MOV, .MP3, .MP4, .MPG, .MSWMM, .OGG, .RM, .SMF, .SWF, .VOB, .WAV, .WMA, .WMV</p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_67013"></a>
       <h4><a href="#id_67013" class="sectionLink">Other</a></h4>
       <p><a id="id_pgfId-1065660"></a><strong>Formats</strong>: Apple Executable, BIN HEX Encoded, BitTorrent Metafile, Linux Executable and Linkable Format, Log File, Microsoft Project, Microsoft Windows DLL, Microsoft Windows Executable, Microsoft Windows Installer, Microsoft Windows, Shortcut, Open Access II (OAII), VCard, Uniplex</p>
       <p><a id="id_pgfId-1065667"></a><strong>Extensions</strong>: .BIN, .COM, .DLL, .ELF, .EXE, .HBX, .HEX, .HQXX, .LNK, .LOG, .MPP, .MPX, .MSI, .SYS, .TORRENT, .VCF</p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_86201"></a>
       <h4><a href="#id_86201" class="sectionLink">Presentation</a></h4>
       <p><a id="id_pgfId-1065684"></a><strong>Formats</strong>: IBM Lotus Symphony Presentation, LibreOffice Presentation, Microsoft PowerPoint for Windows or Macintosh, OpenOffice Impress, StarOffice Impress</p>
       <p><a id="id_pgfId-1065691"></a><strong>Extensions</strong>: .ODP, .ODS, .PPT, .PPTX, .SDI, .SDP, .SXI</p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_89712"></a>
       <h4><a href="#id_89712" class="sectionLink">Raster Image</a></h4>
       <p><a id="id_pgfId-1065708"></a><strong>Formats</strong>: Encapsulated PostScript, Grapics Interchange Format (GIF), Joint Photographic Experts Group (JPEG), Microsoft Document Imaging, Microsoft Windows Bitmap, PCX, Portable Network Graphic (PNG), Progressive JPEG, Tagged Image Format File (TIFF)</p>
       <p><a id="id_pgfId-1065715"></a><strong>Extensions</strong>: .BMP, .EPS, .GFA, .GIF, .GIFF, .JIF, .JPEG, .JPG, .JPE, .MDI, .PCX, .PNG, .TIF, .TIFF</p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_74790"></a>
       <h4><a href="#id_74790" class="sectionLink">Spreadsheet</a></h4>
       <p><a id="id_pgfId-1065744"></a><strong>Formats</strong>: Comma Separated Values, Franeword Spreadsheet, IBM Lotus Symphony, LibreOffice Spreadsheet, Lotus 1-2-3, Microsoft Excel for Windows or Mac, Microsoft Works SS for DOS or Windows, OpenOffice Calc, StarOffice Calc</p>
       <p><a id="id_pgfId-1065751"></a><strong>Extensions</strong>: .CSV, .FW3, .ODS, .SX, .SXC, .SXS, .XLS, XLSB, .XLSX, .WK., .WK3, .WK4, .WKS, .WPS</p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_64699"></a>
       <h4><a href="#id_64699" class="sectionLink">Text and Markup</a></h4>
       <p><a id="id_pgfId-1065768"></a><strong>Formats</strong>: ASCII Text (7 and 8 bit) , ANSI Text (7 and 8 bit), HTML (text only, codes revealed, metadata only), IBM DCA, Microsoft HTML Help, Microsoft OneNote, Rich Text Format, SGML Text, Source, Transcript, Unicode UTF8 and UTF16 and UCS2, XML, Windows Enhanced Meta File, Windows Meta File</p>
       <p><a id="id_pgfId-1065775"></a><strong>Extensions</strong>: .CHM, .DCA, .EMF, .HTM, .HTML,.ONE, .RFT, .RTF, .SGML, .TXT, .XML, .WMF</p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_77002"></a>
       <h4><a href="#id_77002" class="sectionLink">Vector Image</a></h4>
       <p><a id="id_pgfId-1065796"></a><strong>Formats</strong>: Adobe Illustrator, Adobe InDesign, Adobe Photoshop, AutoCAD Drawing, AutoCAD drawing Exchange Format, Corel Draw Image, Intergraph-Microstation CAD, MathCAD, Microsoft XPS, Microsoft Visio</p>
       <p><a id="id_pgfId-1067148"></a><strong>Extensions</strong>: .AI, .CDR, .DGN, .DWG, .DXF, .INDD, .MCD, .OXPS, .PSD, .VSD, .XMCD, .XPS </p>
      </div>
      <div class="section" data-fm-style="Heading-3">
       <a id="id_29330"></a>
       <h4><a href="#id_29330" class="sectionLink">Word Processing and General Office</a></h4>
       <p><a id="id_pgfId-1065827"></a><strong>Formats</strong>: Adobe PDF, Adobe PostScript, Ami Pro for Windows, Apple iWork, Framework WP, Hangul, IBM DCA/FFT, IBM DisplayWrite, IBM Lotus Symphony Document, JustSystems Ichitaro, LibreOfffice Document, Lotus Manuscript, Lotus Notes, Mass 11, Microsoft Publisher, Microsoft Word for DOS/Windows/Macintosh, QuarkXpress, MultiMate, MultiMate Advantage, OpenOffice Writer, Professional Write for DOS, Professional Write Plus for Windows, Q&amp;A Write, QuickBooks Backup, QuickBooks for Windows, StarOffice Writer, TrueType Font, VCalendar Electronic Calendar, Wang IWP, Wang WP Plus, Windows Write, WinWord, WordPerfect for DOS/Macintosh/Windows, Wordstar for DOS/Windows, Wordstar 2000 for DOS, XYwrite</p>
       <p><a id="id_pgfId-1065834"></a><strong>Extensions</strong>: .AMI, .DCA, DOC, .DOCX, .DOX, .DW4, .FFT, .FW3, .ICS, .IWP, .JTD, .JBW, .JTT, ,KEY, .M11, .MAN, .MANU, .MNU, .NSF, .NUMBERS, .ODT, PAGES, .PDF, .PS, .PUT, .QCx, .QXx, .PW, .PW1, .PW2, .QA, .QA3, .QBB, .QBW, .RFT, .SAM, .SXW, .SDW, .TTF, .VCS, .WPD, WRI, .WS, .WS2, .WSD, .XY</p>
      </div>
     </div>
    </div>
   </div>
   <div class="previousChapter pjax_enabled">
    <a href="/guide/search-dev/custom-dictionaries" accesskey="p">«&nbsp;Previous&nbsp;chapter</a>
   </div>
   <div class="nextChapter pjax_enabled">
    <a href="/guide/search-dev/wildcard" accesskey="n">Next&nbsp;chapter&nbsp;»</a>
   </div> 
   <div id="copyright">
     Copyright © 2017 MarkLogic Corporation. MARKLOGIC is a registered trademark of MarkLogic Corporation. 
   </div>
   <div id="terms">
     Powered by 
    <a href="//developer.marklogic.com/products">MarkLogic Server <span class="server-version">7.0-4.1</span></a> and 
    <a href="//developer.marklogic.com/code/rundmc">rundmc</a> | 
    <a href="http://www.marklogic.com/terms-of-use/">Terms of Use</a> | 
    <a href="http://www.marklogic.com/privacy-policy/">Privacy Policy</a>
   </div> 
  </section> 
  <!-- ml:elapsed-time/ -->  
 </body>
</html>