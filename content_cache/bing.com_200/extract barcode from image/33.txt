<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
 <head> 
  <title>Java PDF example code ExtractImages.java</title> 
  <meta name="keywords" content="pdf viewer, java pdf, java pdf viewer, print pdf, pdf forms, javadoc, api, documentation, ExtractImages.java"> 
  <meta name="description" content="Java PDF library - ExtractImages.java"> 
  <style type="text/css">
    <!--code { font-family: Courier New, Courier; font-size: 10pt; margin: 0px; }-->
  </style> 
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
 </head>
 <body> 
  <!-- ======================================================== --> 
  <!-- = Java Sourcecode to HTML automatically converted code = --> 
  <!-- =   Java2Html Converter   by Markus Gebhard  markus@jave.de   = --> 
  <!-- =     Further information: http://www.java2html.de     = --> 
  <div align="left" class="java"> 
   <table border="0" cellpadding="3" cellspacing="0" bgcolor="#ffffff"> 
    <tbody>
     <tr> 
      <!-- start source code --> 
      <td nowrap valign="top" align="left"> <code> <font color="#3f7f5f">/*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*&nbsp;===========================================</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*&nbsp;Java&nbsp;Pdf&nbsp;Extraction&nbsp;Decoding&nbsp;Access&nbsp;Library</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*&nbsp;===========================================</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*&nbsp;Project&nbsp;Info:&nbsp;&nbsp;<a href="http://www.idrsolutions.com">http://www.idrsolutions.com</a></font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*&nbsp;Help&nbsp;section&nbsp;for&nbsp;developers&nbsp;at&nbsp;<a href="http://www.idrsolutions.com/support/">http://www.idrsolutions.com/support/</a></font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*&nbsp;(C)&nbsp;Copyright&nbsp;1997-2017&nbsp;IDRsolutions&nbsp;and&nbsp;Contributors.</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*&nbsp;This&nbsp;file&nbsp;is&nbsp;part&nbsp;of&nbsp;JPedal/JPDF2HTML5</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*</font><br> <font color="#ffffff">&nbsp;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*&nbsp;---------------</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*&nbsp;ExtractImages.java</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*&nbsp;---------------</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f7f5f">*/</font><br> <font color="#ffffff"></font><br> <font color="#7f0055"><b>package&nbsp;</b></font><font color="#000000">org.jpedal.examples.images;</font><br> <font color="#ffffff"></font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">com.idrsolutions.image.tiff.TiffEncoder;</font><br> <font color="#ffffff"></font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.awt.image.BufferedImage;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.io.File;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.io.FileOutputStream;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">java.io.InputStream;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.xml.parsers.DocumentBuilder;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.xml.parsers.DocumentBuilderFactory;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.xml.transform.Transformer;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.xml.transform.TransformerFactory;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.xml.transform.dom.DOMSource;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.xml.transform.stream.StreamResult;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">javax.xml.transform.stream.StreamSource;</font><br> <font color="#ffffff"></font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.jpedal.examples.handlers.DefaultImageHelper;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.jpedal.exception.PdfException;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.jpedal.objects.PdfImageData;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.w3c.dom.Document;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.w3c.dom.Element;</font><br> <font color="#7f0055"><b>import&nbsp;</b></font><font color="#000000">org.w3c.dom.Node;</font><br> <font color="#ffffff"></font><br> <font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;h2&gt;</font><font color="#3f5fbf">Image&nbsp;Extraction&nbsp;from&nbsp;PDF&nbsp;files</font><font color="#7f7f9f">&lt;/h2&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;p&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;This&nbsp;class&nbsp;provides&nbsp;a&nbsp;simple&nbsp;Java&nbsp;API&nbsp;to&nbsp;extract&nbsp;images&nbsp;from&nbsp;a&nbsp;PDF&nbsp;file&nbsp;and&nbsp;also</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;a&nbsp;static&nbsp;convenience&nbsp;method&nbsp;if&nbsp;you&nbsp;just&nbsp;want&nbsp;to&nbsp;dump&nbsp;all&nbsp;the&nbsp;images&nbsp;from&nbsp;a&nbsp;PDF&nbsp;file</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;or&nbsp;directory&nbsp;containing&nbsp;PDF&nbsp;files.</font><font color="#7f7f9f">&lt;p&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;p&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;h3&gt;</font><font color="#3f5fbf">Example&nbsp;1&nbsp;-&nbsp;access&nbsp;API&nbsp;methods</font><font color="#7f7f9f">&lt;/h3&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;pre&gt;&lt;code&gt;</font><font color="#3f5fbf">ExtractImages&nbsp;extract=new&nbsp;ExtractImages("C:/pdfs/mypdf.pdf");</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;//extract.setPassword("password");</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;if&nbsp;(extract.openPDFFile())&nbsp;{</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;pageCount=extract.getPageCount();</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;page=1;&nbsp;page&amp;lt;=pageCount;&nbsp;page++)&nbsp;{</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;int&nbsp;imagesOnPageCount=extract.getImageCount(page);</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;for&nbsp;(int&nbsp;image=0;&nbsp;image&amp;lt;imagesOnPageCount;&nbsp;image++)&nbsp;{</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;BufferedImage&nbsp;image=extract.getImage(page,&nbsp;image,&nbsp;true);</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;}</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;extract.closePDFfile();</font><font color="#7f7f9f">&lt;/code&gt;&lt;/pre&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;p&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;h3&gt;</font><font color="#3f5fbf">Example&nbsp;2&nbsp;-&nbsp;convenience&nbsp;static&nbsp;method</font><font color="#7f7f9f">&lt;/h3&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;Extract&nbsp;all&nbsp;images&nbsp;with&nbsp;no&nbsp;metadata&nbsp;XML&nbsp;file&nbsp;into&nbsp;a&nbsp;directory</font><font color="#7f7f9f">&lt;p&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;p&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;pre&gt;&lt;code&gt;</font><font color="#3f5fbf">ExtractImages.writeAllImagesToDir("pdfs",&nbsp;"images",&nbsp;false,&nbsp;false);</font><font color="#7f7f9f">&lt;/code&gt;&lt;/pre&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;h3&gt;</font><font color="#3f5fbf">Example&nbsp;3&nbsp;-Access&nbsp;directly&nbsp;from&nbsp;the&nbsp;Jar</font><font color="#7f7f9f">&lt;/h3&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;ExtractImages&nbsp;can&nbsp;run&nbsp;from&nbsp;jar&nbsp;directly&nbsp;using&nbsp;the&nbsp;command&nbsp;and&nbsp;will&nbsp;extract&nbsp;all&nbsp;files&nbsp;from&nbsp;a&nbsp;PDF&nbsp;file&nbsp;or&nbsp;directory</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;to&nbsp;a&nbsp;defined&nbsp;output&nbsp;directory:</font><font color="#7f7f9f">&lt;p&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;code&gt;</font><font color="#3f5fbf">java&nbsp;-cp&nbsp;libraries_needed&nbsp;org/jpedal/examples/images/ExtractImages&nbsp;inputValues</font><font color="#7f7f9f">&lt;/code&gt;&lt;p&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;Where&nbsp;inputValues&nbsp;is&nbsp;3&nbsp;values:</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;ul&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;li&gt;</font><font color="#3f5fbf">First&nbsp;value:&nbsp;&nbsp;The&nbsp;PDF&nbsp;filename&nbsp;(including&nbsp;the&nbsp;path&nbsp;if&nbsp;needed)&nbsp;or&nbsp;a&nbsp;directory&nbsp;containing&nbsp;PDF&nbsp;files.&nbsp;If&nbsp;it&nbsp;contains&nbsp;spaces&nbsp;it&nbsp;must&nbsp;be&nbsp;enclosed&nbsp;by&nbsp;double&nbsp;quotes&nbsp;(ie&nbsp;"C:/Path&nbsp;with&nbsp;spaces/").</font><font color="#7f7f9f">&lt;/li&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;li&gt;</font><font color="#3f5fbf">Second&nbsp;value:&nbsp;The&nbsp;location&nbsp;to&nbsp;write&nbsp;out&nbsp;images&nbsp;extracted&nbsp;from&nbsp;the&nbsp;PDF&nbsp;file&nbsp;or&nbsp;files.&nbsp;If&nbsp;it&nbsp;contains&nbsp;spaces&nbsp;it&nbsp;must&nbsp;be&nbsp;enclosed&nbsp;by&nbsp;double&nbsp;quotes&nbsp;(ie&nbsp;"C:/Path&nbsp;with&nbsp;spaces/").</font><font color="#7f7f9f">&lt;/li&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;li&gt;</font><font color="#3f5fbf">Third&nbsp;value:&nbsp;&nbsp;Required&nbsp;output&nbsp;image&nbsp;type&nbsp;(default&nbsp;is&nbsp;png&nbsp;if&nbsp;nothing&nbsp;specified).&nbsp;Options&nbsp;are&nbsp;tiff,&nbsp;png,&nbsp;jpg.</font><font color="#7f7f9f">&lt;/li&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;/ul&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;p&gt;</font><font color="#3f5fbf">&lt;a&nbsp;href="http://www.idrsolutions.com/how-to-extract-images-from-pdf-files/"&gt;See&nbsp;our&nbsp;Support&nbsp;Pages&nbsp;for&nbsp;more&nbsp;info&nbsp;on&nbsp;Image&nbsp;Extraction.</font><font color="#7f7f9f">&lt;/a&gt;</font><br> <font color="#ffffff">&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#7f0055"><b>public&nbsp;class&nbsp;</b></font><font color="#000000">ExtractImages&nbsp;</font><font color="#7f0055"><b>extends&nbsp;</b></font><font color="#000000">BaseImageExtraction&nbsp;</font><font color="#000000">{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">outputPagesInSeparateDirs&nbsp;=&nbsp;</font><font color="#7f0055"><b>true</b></font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#000000">String&nbsp;defaultOutputDir;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">writeOutMetadata&nbsp;=&nbsp;</font><font color="#7f0055"><b>true</b></font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;Sets&nbsp;up&nbsp;an&nbsp;ExtractImages&nbsp;instance&nbsp;to&nbsp;open&nbsp;a&nbsp;PDF&nbsp;File</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">fileName&nbsp;full&nbsp;path&nbsp;to&nbsp;a&nbsp;single&nbsp;PDF&nbsp;file</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ExtractImages</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;fileName</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">(</font><font color="#000000">fileName</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">init</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;Sets&nbsp;up&nbsp;an&nbsp;ExtractImages&nbsp;instance&nbsp;to&nbsp;open&nbsp;&nbsp;a&nbsp;PDF&nbsp;file&nbsp;contained&nbsp;as&nbsp;a&nbsp;BLOB&nbsp;within&nbsp;a&nbsp;byte[]&nbsp;stream</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">byteArray</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">ExtractImages</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>byte</b></font><font color="#000000">[]&nbsp;</font><font color="#000000">byteArray</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">(</font><font color="#000000">byteArray</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">init</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">writeOutMetadata&nbsp;-&nbsp;if&nbsp;true&nbsp;include&nbsp;an&nbsp;XML&nbsp;file&nbsp;for</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;each&nbsp;image&nbsp;with&nbsp;size,&nbsp;location&nbsp;and&nbsp;other&nbsp;metadata</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setCreateMetsDataXMLfile</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">writeOutMetadata</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.writeOutMetadata&nbsp;=&nbsp;writeOutMetadata;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;Convenience&nbsp;method&nbsp;to&nbsp;Extract&nbsp;all&nbsp;the&nbsp;images&nbsp;in&nbsp;a&nbsp;directory&nbsp;of&nbsp;PDF&nbsp;files</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">inputDir&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;containing&nbsp;PDF&nbsp;files</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">outputDir&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;directory&nbsp;for&nbsp;writing&nbsp;out&nbsp;images</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">generateMetaData&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;true&nbsp;include&nbsp;additional&nbsp;XML&nbsp;file&nbsp;with&nbsp;metadata&nbsp;on&nbsp;image</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">outputPagesInSepDirs&nbsp;if&nbsp;true&nbsp;place&nbsp;images&nbsp;from&nbsp;each&nbsp;page&nbsp;in&nbsp;separate&nbsp;sub-directory</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@throws&nbsp;</font><font color="#3f5fbf">org.jpedal.exception.PdfException</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;static&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">writeAllImagesToDir</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;inputDir,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;outputDir,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;imageType,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">generateMetaData,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">outputPagesInSepDirs</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">PdfException&nbsp;</font><font color="#000000">{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">ExtractImages&nbsp;extract&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">ExtractImages</font><font color="#000000">(</font><font color="#000000">inputDir</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">extract.setup</font><font color="#000000">(</font><font color="#000000">outputDir,&nbsp;imageType,&nbsp;generateMetaData,&nbsp;outputPagesInSepDirs</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">extract.processFiles</font><font color="#000000">(</font><font color="#000000">inputDir</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">extract.closePDFfile</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#646464">@Override</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">decodeFile</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;fileName</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">PdfException&nbsp;</font><font color="#000000">{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">openPDFFile</font><font color="#000000">())&nbsp;{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//page&nbsp;range</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">start&nbsp;=&nbsp;</font><font color="#990000">1</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">end&nbsp;=&nbsp;getPageCount</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">/*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">*&nbsp;create&nbsp;output&nbsp;dir&nbsp;for&nbsp;images</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">defaultOutputDir&nbsp;==&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">output_dir&nbsp;=&nbsp;user_dir&nbsp;+&nbsp;</font><font color="#2a00ff">"images"&nbsp;</font><font color="#000000">+&nbsp;separator&nbsp;+&nbsp;name&nbsp;+&nbsp;separator;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">output_dir&nbsp;=&nbsp;defaultOutputDir;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//create&nbsp;a&nbsp;directory&nbsp;if&nbsp;it&nbsp;doesn't&nbsp;exist</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">File&nbsp;output_path&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">File</font><font color="#000000">(</font><font color="#000000">output_dir</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">!output_path.exists</font><font color="#000000">())&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">output_path.mkdirs</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>for&nbsp;</b></font><font color="#000000">(</font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">page&nbsp;=&nbsp;start;&nbsp;page&nbsp;&lt;&nbsp;end&nbsp;+&nbsp;</font><font color="#990000">1</font><font color="#000000">;&nbsp;page++</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//image&nbsp;count&nbsp;(note&nbsp;image&nbsp;1&nbsp;is&nbsp;item&nbsp;0,&nbsp;so&nbsp;any&nbsp;loop&nbsp;runs&nbsp;0&nbsp;to&nbsp;count-1)</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">image_count&nbsp;=&nbsp;getImageCount</font><font color="#000000">(</font><font color="#000000">page</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#3f7f5f">//tell&nbsp;user</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">image_count&nbsp;&gt;&nbsp;</font><font color="#990000">0</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//create&nbsp;a&nbsp;directory&nbsp;for&nbsp;page&nbsp;our&nbsp;put&nbsp;all&nbsp;in&nbsp;same&nbsp;dir</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">String&nbsp;target&nbsp;=&nbsp;output_dir;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">outputPagesInSeparateDirs</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">target&nbsp;=&nbsp;output_dir&nbsp;+&nbsp;separator&nbsp;+&nbsp;page;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">File&nbsp;page_path&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">File</font><font color="#000000">(</font><font color="#000000">target</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">!page_path.exists</font><font color="#000000">())&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">page_path.mkdirs</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>try&nbsp;</b></font><font color="#000000">{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">writeImagesFromPage</font><font color="#000000">(</font><font color="#000000">image_count,&nbsp;page</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>catch&nbsp;</b></font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">Exception&nbsp;ex</font><font color="#000000">)&nbsp;{&nbsp;</font><font color="#3f7f5f">//&nbsp;Cascade&nbsp;up</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>throw&nbsp;new&nbsp;</b></font><font color="#000000">PdfException</font><font color="#000000">(</font><font color="#000000">ex.getMessage</font><font color="#000000">())</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;Flush&nbsp;images&nbsp;in&nbsp;case&nbsp;we&nbsp;do&nbsp;more&nbsp;than&nbsp;1&nbsp;page&nbsp;so&nbsp;only&nbsp;contains</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;images&nbsp;from&nbsp;current&nbsp;page</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">decode_pdf.flushObjectValues</font><font color="#000000">(</font><font color="#7f0055"><b>true</b></font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">writeImagesFromPage</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">image_count,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">page</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">BufferedImage&nbsp;image_to_save;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">String&nbsp;outputDir&nbsp;=&nbsp;output_dir;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">outputPagesInSeparateDirs</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">outputDir&nbsp;=&nbsp;output_dir&nbsp;+&nbsp;page&nbsp;+&nbsp;separator;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//&nbsp;Work&nbsp;through&nbsp;and&nbsp;save&nbsp;each&nbsp;image</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>for&nbsp;</b></font><font color="#000000">(</font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">i&nbsp;=&nbsp;</font><font color="#990000">0</font><font color="#000000">;&nbsp;i&nbsp;&lt;&nbsp;image_count;&nbsp;i++</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;image_name&nbsp;=&nbsp;getImageName</font><font color="#000000">(</font><font color="#000000">page,&nbsp;i</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//get&nbsp;raw&nbsp;version&nbsp;of&nbsp;image&nbsp;(R&nbsp;imageType&nbsp;for&nbsp;raw&nbsp;image)</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">image_to_save&nbsp;=&nbsp;getImage</font><font color="#000000">(</font><font color="#000000">page,&nbsp;image_name,&nbsp;</font><font color="#7f0055"><b>false</b></font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">saveImage</font><font color="#000000">(</font><font color="#000000">image_to_save,&nbsp;outputDir&nbsp;+&nbsp;</font><font color="#990000">'R'&nbsp;</font><font color="#000000">+&nbsp;image_name&nbsp;+&nbsp;</font><font color="#990000">'.'&nbsp;</font><font color="#000000">+&nbsp;imageType,&nbsp;imageType</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//load&nbsp;processed&nbsp;version&nbsp;of&nbsp;image&nbsp;(converted&nbsp;to&nbsp;rgb)</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">image_to_save&nbsp;=&nbsp;getImage</font><font color="#000000">(</font><font color="#000000">page,&nbsp;image_name,&nbsp;</font><font color="#7f0055"><b>true</b></font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//used&nbsp;to&nbsp;check&nbsp;tests&nbsp;still&nbsp;fail</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//image_to_save=new&nbsp;BufferedImage(1,1,BufferedImage.TYPE_3BYTE_BGR);</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//save&nbsp;image</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">image_to_save&nbsp;!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">saveImage</font><font color="#000000">(</font><font color="#000000">image_to_save,&nbsp;outputDir&nbsp;+&nbsp;image_name&nbsp;+&nbsp;</font><font color="#990000">'.'&nbsp;</font><font color="#000000">+&nbsp;imageType,&nbsp;imageType</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">/*save&nbsp;metadata&nbsp;as&nbsp;XML&nbsp;file&nbsp;in&nbsp;1.4/1.5&nbsp;java&nbsp;-&nbsp;not&nbsp;in&nbsp;1.3*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">writeOutMetadata</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">outputMetaDataToXML</font><font color="#000000">(</font><font color="#000000">fileName,&nbsp;page,&nbsp;pdf_images,&nbsp;i,&nbsp;image_name</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#646464">@Override</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">init</font><font color="#000000">()&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">type&nbsp;=&nbsp;ExtractTypes.IMAGES;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>super</b></font><font color="#000000">.init</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;save&nbsp;image&nbsp;-&nbsp;different&nbsp;versions&nbsp;have&nbsp;different&nbsp;bugs&nbsp;for&nbsp;file&nbsp;formats&nbsp;so&nbsp;we&nbsp;use&nbsp;best&nbsp;for</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;each&nbsp;image&nbsp;type</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">image_to_save</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;static&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">saveImage</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">BufferedImage&nbsp;image_to_save,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;fileName,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;prefix</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">Exception&nbsp;</font><font color="#000000">{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">prefix.contains</font><font color="#000000">(</font><font color="#2a00ff">"tif"</font><font color="#000000">))&nbsp;{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">FileOutputStream&nbsp;os&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">FileOutputStream</font><font color="#000000">(</font><font color="#000000">fileName</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//get&nbsp;tiff&nbsp;compression</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;tiffFlag&nbsp;=&nbsp;System.getProperty</font><font color="#000000">(</font><font color="#2a00ff">"org.jpedal.compress_tiff"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">compressTiffs&nbsp;=&nbsp;tiffFlag&nbsp;!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">TiffEncoder&nbsp;tiffEncoder&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">TiffEncoder</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">tiffEncoder.setCompressed</font><font color="#000000">(</font><font color="#000000">compressTiffs</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">tiffEncoder.write</font><font color="#000000">(</font><font color="#000000">image_to_save,&nbsp;os</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">os.flush</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">os.close</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{&nbsp;</font><font color="#3f7f5f">//other&nbsp;images</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">DefaultImageHelper.write</font><font color="#000000">(</font><font color="#000000">image_to_save,&nbsp;prefix,&nbsp;fileName</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;write&nbsp;out&nbsp;details&nbsp;of&nbsp;image&nbsp;to&nbsp;XML&nbsp;file</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">outputMetaDataToXML</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;file_name,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">page,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">PdfImageData&nbsp;pdf_images,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">i,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;image_name</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>float&nbsp;</b></font><font color="#000000">x1&nbsp;=&nbsp;pdf_images.getImageXCoord</font><font color="#000000">(</font><font color="#000000">i</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>float&nbsp;</b></font><font color="#000000">y1&nbsp;=&nbsp;pdf_images.getImageYCoord</font><font color="#000000">(</font><font color="#000000">i</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>float&nbsp;</b></font><font color="#000000">w&nbsp;=&nbsp;pdf_images.getImageWidth</font><font color="#000000">(</font><font color="#000000">i</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>float&nbsp;</b></font><font color="#000000">h&nbsp;=&nbsp;pdf_images.getImageHeight</font><font color="#000000">(</font><font color="#000000">i</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>try&nbsp;</b></font><font color="#000000">{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//create&nbsp;doc&nbsp;and&nbsp;set&nbsp;root</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">DocumentBuilderFactory&nbsp;dbf&nbsp;=&nbsp;DocumentBuilderFactory.newInstance</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">DocumentBuilder&nbsp;db&nbsp;=&nbsp;dbf.newDocumentBuilder</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">Document&nbsp;doc&nbsp;=&nbsp;db.newDocument</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">Node&nbsp;root&nbsp;=&nbsp;doc.createElement</font><font color="#000000">(</font><font color="#2a00ff">"meta"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">doc.appendChild</font><font color="#000000">(</font><font color="#000000">root</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//add&nbsp;comments</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">Node&nbsp;creation&nbsp;=&nbsp;doc.createComment</font><font color="#000000">(</font><font color="#2a00ff">"Created&nbsp;"&nbsp;</font><font color="#000000">+&nbsp;org.jpedal.utils.TimeNow.getShortTimeNow</font><font color="#000000">())</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">doc.appendChild</font><font color="#000000">(</font><font color="#000000">creation</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">Node&nbsp;info&nbsp;=&nbsp;doc.createComment</font><font color="#000000">(</font><font color="#2a00ff">"Pixel&nbsp;Location&nbsp;of&nbsp;image&nbsp;x1,y1,x2,y2"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">doc.appendChild</font><font color="#000000">(</font><font color="#000000">info</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">Node&nbsp;moreInfo&nbsp;=&nbsp;doc.createComment</font><font color="#000000">(</font><font color="#2a00ff">"x1,y1&nbsp;is&nbsp;top&nbsp;left&nbsp;corner&nbsp;origin&nbsp;is&nbsp;bottom&nbsp;left&nbsp;corner"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">doc.appendChild</font><font color="#000000">(</font><font color="#000000">moreInfo</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//add&nbsp;location</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">Element&nbsp;location&nbsp;=&nbsp;doc.createElement</font><font color="#000000">(</font><font color="#2a00ff">"PAGELOCATION"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">location.setAttribute</font><font color="#000000">(</font><font color="#2a00ff">"x1"</font><font color="#000000">,&nbsp;String.valueOf</font><font color="#000000">(</font><font color="#000000">x1</font><font color="#000000">))</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">location.setAttribute</font><font color="#000000">(</font><font color="#2a00ff">"y1"</font><font color="#000000">,&nbsp;String.valueOf</font><font color="#000000">((</font><font color="#000000">y1&nbsp;+&nbsp;h</font><font color="#000000">)))</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">location.setAttribute</font><font color="#000000">(</font><font color="#2a00ff">"x2"</font><font color="#000000">,&nbsp;String.valueOf</font><font color="#000000">((</font><font color="#000000">x1&nbsp;+&nbsp;w</font><font color="#000000">)))</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">location.setAttribute</font><font color="#000000">(</font><font color="#2a00ff">"y2"</font><font color="#000000">,&nbsp;String.valueOf</font><font color="#000000">(</font><font color="#000000">y1</font><font color="#000000">))</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">root.appendChild</font><font color="#000000">(</font><font color="#000000">location</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//add&nbsp;pdf&nbsp;file&nbsp;extracted&nbsp;from</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">Element&nbsp;fileName&nbsp;=&nbsp;doc.createElement</font><font color="#000000">(</font><font color="#2a00ff">"FILE"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">fileName.setAttribute</font><font color="#000000">(</font><font color="#2a00ff">"value"</font><font color="#000000">,&nbsp;file_name</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">root.appendChild</font><font color="#000000">(</font><font color="#000000">fileName</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//write&nbsp;out</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">InputStream&nbsp;stylesheet&nbsp;=&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.getClass</font><font color="#000000">()</font><font color="#000000">.getResourceAsStream</font><font color="#000000">(</font><font color="#2a00ff">"/org/jpedal/examples/text/xmlstyle.xslt"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">TransformerFactory&nbsp;transformerFactory&nbsp;=&nbsp;TransformerFactory.newInstance</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">Transformer&nbsp;transformer&nbsp;=&nbsp;transformerFactory.newTransformer</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">StreamSource</font><font color="#000000">(</font><font color="#000000">stylesheet</font><font color="#000000">))</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">String&nbsp;outputDir&nbsp;=&nbsp;output_dir;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">outputPagesInSeparateDirs</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">outputDir&nbsp;=&nbsp;output_dir&nbsp;+&nbsp;page&nbsp;+&nbsp;separator;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">transformer.transform</font><font color="#000000">(</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">DOMSource</font><font color="#000000">(</font><font color="#000000">doc</font><font color="#000000">)</font><font color="#000000">,&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">StreamResult</font><font color="#000000">(</font><font color="#000000">outputDir&nbsp;+&nbsp;image_name&nbsp;+&nbsp;</font><font color="#2a00ff">".xml"</font><font color="#000000">))</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>catch&nbsp;</b></font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">Exception&nbsp;e</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">e.printStackTrace</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//////////////////////////////////////////////////////////////////////////</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;This&nbsp;class&nbsp;will&nbsp;allow&nbsp;you&nbsp;to&nbsp;extract&nbsp;Images&nbsp;via&nbsp;command&nbsp;line&nbsp;from&nbsp;a&nbsp;single&nbsp;PDF&nbsp;file&nbsp;or&nbsp;a&nbsp;directory&nbsp;of&nbsp;PDF&nbsp;files.</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;p&gt;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;The&nbsp;example&nbsp;expects&nbsp;three&nbsp;parameters:</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;ul&gt;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;li&gt;</font><font color="#3f5fbf">Value&nbsp;1&nbsp;is&nbsp;the&nbsp;file&nbsp;name&nbsp;or&nbsp;directory&nbsp;of&nbsp;PDF&nbsp;files&nbsp;to&nbsp;process</font><font color="#7f7f9f">&lt;/li&gt;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;li&gt;</font><font color="#3f5fbf">Value&nbsp;2&nbsp;is&nbsp;directory&nbsp;to&nbsp;write&nbsp;out&nbsp;the&nbsp;images</font><font color="#7f7f9f">&lt;/li&gt;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;li&gt;</font><font color="#3f5fbf">Value&nbsp;3&nbsp;is&nbsp;image&nbsp;type&nbsp;(jpeg,tiff,png).&nbsp;Default&nbsp;is&nbsp;png</font><font color="#7f7f9f">&lt;/li&gt;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f7f9f">&lt;/ul&gt;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">args&nbsp;The&nbsp;expected&nbsp;arguments&nbsp;are&nbsp;described&nbsp;above.</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;static&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">main</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String</font><font color="#000000">[]&nbsp;</font><font color="#000000">args</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//check&nbsp;user&nbsp;has&nbsp;passed&nbsp;us&nbsp;a&nbsp;filename,&nbsp;output&nbsp;location&nbsp;and&nbsp;image&nbsp;type</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">len&nbsp;=&nbsp;args.length;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">len&nbsp;!=&nbsp;</font><font color="#990000">3</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">System.out.println</font><font color="#000000">(</font><font color="#2a00ff">"Class&nbsp;takes&nbsp;3&nbsp;parameters:&nbsp;"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">System.out.println</font><font color="#000000">(</font><font color="#2a00ff">"Value&nbsp;1&nbsp;is&nbsp;the&nbsp;file&nbsp;name&nbsp;or&nbsp;directory&nbsp;of&nbsp;PDF&nbsp;files&nbsp;to&nbsp;process"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">System.out.println</font><font color="#000000">(</font><font color="#2a00ff">"Value&nbsp;2&nbsp;is&nbsp;Directory&nbsp;for&nbsp;writing&nbsp;the&nbsp;images"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">System.out.println</font><font color="#000000">(</font><font color="#2a00ff">"Value&nbsp;3&nbsp;is&nbsp;image&nbsp;type&nbsp;(jpeg,tiff,png)."</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">len&nbsp;&gt;&nbsp;</font><font color="#990000">3</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">System.out.println</font><font color="#000000">(</font><font color="#2a00ff">"\nToo&nbsp;many&nbsp;arguments&nbsp;entered"</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">StringBuilder&nbsp;arguments&nbsp;=&nbsp;</font><font color="#7f0055"><b>new&nbsp;</b></font><font color="#000000">StringBuilder</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>for&nbsp;</b></font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;arg&nbsp;:&nbsp;args</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">arguments.append</font><font color="#000000">(</font><font color="#000000">arg</font><font color="#000000">)</font><font color="#000000">.append</font><font color="#000000">(</font><font color="#990000">'\n'</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">System.out.println</font><font color="#000000">(</font><font color="#2a00ff">"You&nbsp;entered:\n"&nbsp;</font><font color="#000000">+&nbsp;arguments</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">System.exit</font><font color="#000000">(</font><font color="#990000">0</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>try&nbsp;</b></font><font color="#000000">{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">ExtractImages.writeAllImagesToDir</font><font color="#000000">(</font><font color="#000000">args</font><font color="#000000">[</font><font color="#990000">0</font><font color="#000000">]</font><font color="#000000">,&nbsp;args</font><font color="#000000">[</font><font color="#990000">1</font><font color="#000000">]</font><font color="#000000">,&nbsp;args</font><font color="#000000">[</font><font color="#990000">2</font><font color="#000000">]</font><font color="#000000">,&nbsp;true,&nbsp;</font><font color="#7f0055"><b>false</b></font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>catch&nbsp;</b></font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">PdfException&nbsp;e</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">e.printStackTrace</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;Controls&nbsp;if&nbsp;each&nbsp;page&nbsp;written&nbsp;to&nbsp;separate&nbsp;sub-directory</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;Default&nbsp;is&nbsp;true</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">outputPagesInSeparateDirs&nbsp;boolean&nbsp;flag</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setOutputPagesInSeparateDirs</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">outputPagesInSeparateDirs</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.outputPagesInSeparateDirs&nbsp;=&nbsp;outputPagesInSeparateDirs;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;extract&nbsp;any&nbsp;image&nbsp;from&nbsp;any&nbsp;page&nbsp;-&nbsp;recommended&nbsp;you&nbsp;process&nbsp;images&nbsp;on&nbsp;each&nbsp;page&nbsp;in&nbsp;turn&nbsp;as&nbsp;quicker</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">page&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical&nbsp;page&nbsp;number&nbsp;(1&nbsp;is&nbsp;first&nbsp;page)</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">imageNumber&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;image&nbsp;on&nbsp;page&nbsp;(0&nbsp;is&nbsp;first&nbsp;image)</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">imageAsDisplayed&nbsp;if&nbsp;true&nbsp;return&nbsp;image&nbsp;as&nbsp;displayed&nbsp;(with&nbsp;scaling/rotation)&nbsp;otherwise&nbsp;use&nbsp;raw&nbsp;stored&nbsp;image&nbsp;(often&nbsp;but&nbsp;not&nbsp;always&nbsp;the&nbsp;same).&nbsp;Neither&nbsp;is&nbsp;clipped</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@return&nbsp;</font><font color="#3f5fbf">BufferedImage</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@throws&nbsp;</font><font color="#3f5fbf">PdfException</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">BufferedImage&nbsp;getImage</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">page,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">imageNumber,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">imageAsDisplayed</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">PdfException&nbsp;</font><font color="#000000">{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">checkFileOpened</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">getImage</font><font color="#000000">(</font><font color="#000000">page,&nbsp;getImageName</font><font color="#000000">(</font><font color="#000000">page,&nbsp;imageNumber</font><font color="#000000">)</font><font color="#000000">,&nbsp;imageAsDisplayed</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;extract&nbsp;any&nbsp;image&nbsp;from&nbsp;any&nbsp;page&nbsp;-&nbsp;recommended&nbsp;you&nbsp;process&nbsp;images&nbsp;on&nbsp;each&nbsp;page&nbsp;in&nbsp;turn&nbsp;as&nbsp;quicker</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">page&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;logical&nbsp;page&nbsp;number&nbsp;(1&nbsp;is&nbsp;first&nbsp;page)</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">image_name&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;name&nbsp;of&nbsp;image</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">imageAsDisplayed&nbsp;if&nbsp;true&nbsp;return&nbsp;image&nbsp;as&nbsp;displayed&nbsp;(with&nbsp;scaling/rotation)&nbsp;otherwise&nbsp;use&nbsp;raw&nbsp;stored&nbsp;image&nbsp;(often&nbsp;but&nbsp;not&nbsp;always&nbsp;the&nbsp;same).&nbsp;Neither&nbsp;is&nbsp;clipped</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@return&nbsp;</font><font color="#3f5fbf">BufferedImage</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@throws&nbsp;</font><font color="#3f5fbf">PdfException</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">BufferedImage&nbsp;getImage</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">page,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;image_name,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">imageAsDisplayed</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">PdfException&nbsp;</font><font color="#000000">{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">selectPage</font><font color="#000000">(</font><font color="#000000">page</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">imageAsDisplayed</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">decode_pdf.getObjectStore</font><font color="#000000">()</font><font color="#000000">.loadStoredImage</font><font color="#000000">(</font><font color="#000000">image_name</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}&nbsp;</font><font color="#7f0055"><b>else&nbsp;</b></font><font color="#000000">{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">decode_pdf.getObjectStore</font><font color="#000000">()</font><font color="#000000">.loadStoredImage</font><font color="#000000">(</font><font color="#990000">'R'&nbsp;</font><font color="#000000">+&nbsp;image_name</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>private&nbsp;</b></font><font color="#7f0055"><b>void&nbsp;</b></font><font color="#000000">setup</font><font color="#000000">(</font><font color="#000000">String&nbsp;outputDir,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#000000">String&nbsp;imageType,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">generateMetaData,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>boolean&nbsp;</b></font><font color="#000000">outputPagesInSepDirs</font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>this</b></font><font color="#000000">.imageType&nbsp;=&nbsp;imageType;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">outputDir&nbsp;!=&nbsp;</font><font color="#7f0055"><b>null</b></font><font color="#000000">)&nbsp;{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//check&nbsp;output&nbsp;dir&nbsp;has&nbsp;separator</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>if&nbsp;</b></font><font color="#000000">(</font><font color="#000000">!outputDir.endsWith</font><font color="#000000">(</font><font color="#000000">separator</font><font color="#000000">))&nbsp;{</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">outputDir&nbsp;+=&nbsp;separator;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">defaultOutputDir&nbsp;=&nbsp;outputDir;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">setCreateMetsDataXMLfile</font><font color="#000000">(</font><font color="#000000">generateMetaData</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">setOutputPagesInSeparateDirs</font><font color="#000000">(</font><font color="#000000">outputPagesInSepDirs</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;returns&nbsp;an&nbsp;image&nbsp;count&nbsp;for&nbsp;the&nbsp;selected&nbsp;page</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">page&nbsp;logical&nbsp;page&nbsp;number</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@return&nbsp;</font><font color="#3f5fbf">int&nbsp;number&nbsp;of&nbsp;images&nbsp;(0&nbsp;if&nbsp;no&nbsp;images)</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@throws&nbsp;</font><font color="#3f5fbf">PdfException</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">getImageCount</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">page</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">PdfException&nbsp;</font><font color="#000000">{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">checkFileOpened</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">selectPage</font><font color="#000000">(</font><font color="#000000">page</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f7f5f">//image&nbsp;count&nbsp;(note&nbsp;image&nbsp;1&nbsp;is&nbsp;item&nbsp;0,&nbsp;so&nbsp;any&nbsp;loop&nbsp;runs&nbsp;0&nbsp;to&nbsp;count-1)</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">pdf_images.getImageCount</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#ffffff"></font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">/**</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;Return&nbsp;name&nbsp;of&nbsp;image&nbsp;(composite&nbsp;of&nbsp;filename&nbsp;and&nbsp;Internal&nbsp;PDF&nbsp;image&nbsp;name)</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">page&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&nbsp;logical&nbsp;page&nbsp;number</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@param&nbsp;</font><font color="#3f5fbf">imageNumber&nbsp;-&nbsp;number&nbsp;of&nbsp;image&nbsp;(0&nbsp;is&nbsp;first&nbsp;image)</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@return&nbsp;</font><font color="#3f5fbf">-&nbsp;String&nbsp;containing&nbsp;image&nbsp;name</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*&nbsp;</font><font color="#7f9fbf">@throws&nbsp;</font><font color="#3f5fbf">PdfException</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#3f5fbf">*/</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>public&nbsp;</b></font><font color="#000000">String&nbsp;getImageName</font><font color="#000000">(</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">page,&nbsp;</font><font color="#7f0055"><b>final&nbsp;</b></font><font color="#7f0055"><b>int&nbsp;</b></font><font color="#000000">imageNumber</font><font color="#000000">)&nbsp;</font><font color="#7f0055"><b>throws&nbsp;</b></font><font color="#000000">PdfException&nbsp;</font><font color="#000000">{</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">checkFileOpened</font><font color="#000000">()</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">selectPage</font><font color="#000000">(</font><font color="#000000">page</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff"></font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#7f0055"><b>return&nbsp;</b></font><font color="#000000">pdf_images.getImageName</font><font color="#000000">(</font><font color="#000000">imageNumber</font><font color="#000000">)</font><font color="#000000">;</font><br> <font color="#ffffff">&nbsp;&nbsp;&nbsp;&nbsp;</font><font color="#000000">}</font><br> <font color="#000000">}</font></code> </td> 
      <!-- end source code --> 
     </tr> 
    </tbody>
   </table> 
  </div> 
  <!-- =       END of automatically generated HTML code       = --> 
  <!-- ======================================================== --> 
  <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
        </script> 
  <script type="text/javascript">
        var pageTracker = _gat._getTracker("UA-289539-6");
        pageTracker._initData();
        pageTracker._trackPageview();
        </script>   
 </body>
</html>