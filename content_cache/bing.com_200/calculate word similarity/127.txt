<!DOCTYPE html PUBLIC "-//IETF//DTD HTML//EN">
<html>
 <head> 
  <title>Clustering Calculator</title> 
 </head> 
 <body> 
  <font size+3> <b>UNSUPPORTED SOFTWARE: USE AT OWN RISK</b> </font> 
  <h1>Clustering Calculator</h1> 
  <p><a name="Calculator"></a> </p>
  <ul> 
   <li><strong><a href="#NewFeatures">New Features</a></strong></li> 
   <li><strong><a href="#Bugs">Bugs, Bugs, Bugs</a> (read this before you start)</strong></li> 
   <li><strong><a href="#ClusterCalc">Run the Clustering Calculator</a></strong></li> 
   <li><strong><p><a href="#Virtual">The Virtual Clipboard for large datasets</a></p> </strong></li> 
   <li><strong><a href="#InputFormats">About the Input</a></strong></li> 
   <li><strong><a href="#DistanceMeasures">About the Distance/Similarity Measures</a></strong></li> 
   <li><strong><a href="#ClusterMethods">About the Clustering Methods</a></strong></li> 
   <li><strong><a href="#AboutOutput">About the Output</a></strong></li> 
   <li><strong><a href="#VisualizeTree">Visualizing the Tree</a></strong></li> 
   <li><strong><a href="#PageNote">About Multi-page Input Windows</a></strong></li> 
   <li><strong><a href="dosclust.html">Obtaining a DOS or UNIX version of this program</a></strong></li> 
   <li><strong><a href="#Credits">Credits</a></strong></li> 
   <li><strong><a href="#LocalInstall">Installing this program on your machine</a></strong></li> 
   <li><strong><a href="#Source">Obtaining the source code</a></strong></li> 
  </ul> 
  <p> </p>
  <hr>
  <p></p> 
  <p><a name="ClusterCalc"></a><strong><u>Clustering Calculator</u></strong></p> 
  <p><strong>The sample data are counts of insects caught in 4 types of traps from C. Buddle, 1999. Click "Calculate!" to run this example, or "Clear Inputs" to enter your own data.</strong></p> 
  <center>
   <p> 
    <applet code="cluster.class" archive="cluster.zip" id="cluster" width="800" height="1000"> 
     <param name="inputFormat" value="Character Matrix: samples are columns"> 
     <param name="nameLocation" value="Data Window"> 
     <param name="distanceMeasure" value="Canberra Distance"> 
     <param name="clusterMethod" value="Unweighted Arithmetic Average"> 
     <param name="sampleData" value="12 Pit(nodet) Pit(w/det) Pan(nodet) Pan(w/det),
Bapa 44 38 37 58,
Pama 40 57 44 21,
Agor 34 25 57 28,
Pamo 39 18 26 20,
Lein 10 12 12 17,
Trte 7 11 4 8,
Xylu 5 4 7 8,
Ozsc 4 8 2 4,
Waca 6 5 0 4,
Hahi 3 3 2 3,
Dibi 5 1 1 4,
Poam 3 7 0 1"> 
     <p></p> 
     <center>
      <p>You need a Java-enabled browser to run this program. Perhaps your browser has Java disabled? </p> 
     </center>
    </applet> </p>
  </center> 
  <center>
   <p><strong>I have copied the Phylip/DRAWTREE output to a clipboard, so take me to <a href="TreeToy.html">TreeToy!</a></strong> </p>
   <center>
    <p><a href="#Top">(back to top)</a></p>
   </center> 
   <hr>
   <p></p>
  </center> 
  <p><a name="NewFeatures"></a><strong><u>New Features</u></strong></p> 
  <strong><a name="BootstrapConsensus"></a>Bootstrap Consensus Trees</strong> 
  <p>So far, this calculator is not able to print out a Phylip DRAWTREE string with consensus values for randomized trees. However, by selecting these two options from the <i>More Options...</i> menu: </p>
  <ul> 
   <li>"Stability Analysis: show generated trees" </li>
   <li>"Output a Phylip/DRAWTREE-readable version of the tree" </li>
  </ul> you will get a list of the Phylip tree strings in the output (and the usual text picture of the tree will not appear). You can then run these through Phylip's CONSENSE program. Thanks to Michel Tersac (michel.tersac@ensam.inra.fr) for this idea. 
  <br>
  <br> 
  <strong><a name="LoadSave"></a>File load/save</strong> 
  <p>If you install a local copy of the applet (see <a href="#LocalInstall">below</a>), then you can load and save the contents of a window from or to a file on your machine, without use of the virtual clipboard. These <b>Load</b> and <b>Save</b> buttons next to a window <i>don't</i> work if you are running <b>cluster</b> directly from the web. </p> 
  <strong>Stability analysis</strong> 
  <p>The applet can assess stability of the tree topology under various resampling scenarios, in order to answer the question <em>If I were to repeat this experiment several times, how often would the observed groupings occur?</em> </p> 
  <p>There are two factors that determine how this analysis is done: </p>
  <ol type="a"> 
   <li>What other trees might my experiment have come up with?</li> 
   <li>How do I compare the tree I did see with these others?</li> 
  </ol> There are many approaches possible. Currently, this applet only allows stability analysis when you have a character matrix. Each hypothetical tree is generated by creating a new character matrix from the old one, and then clustering. You can choose one of these methods for generating a new character matrix: 
  <ul> 
   <li>Jacknife - drop each character in turn from the original matrix. The number of trees generated equals the number of characters.</li> 
   <li>Bootstrap - each sample is redrawn with replacement from the set of existing samples.</li> 
   <li>Permute - the samples are randomly permuted. This can control for any order-dependency in the clustering method.</li> 
   <li>Poisson - the value of each cell in the new character matrix is drawn independently from a Poisson distribution whose mean is the observed value for that cell. You choose the number of trees to generate. This may be an appropriate sampling model for count data generated by trapping, for example.</li> 
   <li>Multinomial - the observed proportions of characters for each sample are treated as probabilities for a multinomial distribution. If the total of the characters is n, then n draws are made from this distribution. This might be appropriate for genetic data, for example.</li> 
  </ul> 
  <p><strong>Comparing two trees</strong></p> This analysis examines only the 
  <em>topology</em> of the two trees, and ignores branch lengths. Consider an interior node (
  <strong>inode</strong>) in a binary tree. The samples which are its descendents (its 
  <strong>leaf nodes</strong>) form two groups: those descending from the left branch, and those descending from the right branch. We treat this 
  <strong>inode's partition of its leaf nodes into two sets</strong> as the feature of interest (i.e. for a given inode, we examine only how it splits its descendent samples into two groups, and 
  <strong>not the structure within those two groups</strong>). So every time we generate a new tree, we check it for inodes that divide the same set of samples into the same two subsets as an inode in the original tree does. The output is a number for each inode in the original tree, giving the number of generated trees in which an inode with the same partition was found. Here's an example: 
  <p><img src="clusterStability.jpg"></p> 
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <hr>
  <p></p> 
  <p><a name="InputFormats"></a><strong><u>About the Input</u></strong></p> 
  <p>The calculator accepts input in several formats:</p> 
  <li><a href="#CornellCondensed">Cornell Condensed</a></li> 
  <li><a href="#SquareMatrix">Square Distance/Similarity Matrix</a></li> 
  <li><a href="#TriangularMatrix">Upper/Lower Triangular Distance/Similarity Matrix</a></li> 
  <li><a href="#SampleCharacter">Character Matrix: Samples are Columns</a></li> 
  <li><a href="#CharacterSample">Character Matrix: Samples are Rows</a></li> 
  <p>In all cases, if you select the names in "Names Window" option and that window doesn't contain enough names, or if you select the "No Names" option, sample numbers are used as names for unnamed samples.</p> 
  <p><a name="CornellCondensed"></a><strong>Cornell Condensed Example:</strong></p> 
  <pre>1     1  1.0 11 4.0 17 7.0 19 4.0 20 2.0
1     32 4.0
2     1  3.0 4  2.0 6  3.0 7  4.0 11 4.0
2     16 5.0 17 5.0 19 4.0 20 7.0 27 5.0
2     32 3.0
extra 2  4.0 4  7.0 6  2.0 11 4.0 16 2.0
extra 32 6.0
    </pre> 
  <p>Each sample can occupy several consecutive lines. The first number (or name)&nbsp;in a line is the sample number (or name), and the rest of the line is a sequence of (item, abundance) pairs. For example, sample "extra" has an abundance of 4.0 for item 11. Abundances of items not listed for a sample are zero. For example, sample 2 has an abundance of 0.0 for item 5. Distances between samples are calculated using the Euclidean metric. If you select "Data Window" as the location of sample names, then the first "word" in each line is taken as the sample name. The number of spaces or tabs between items is not important, but newline characters are: each line must begin with a sample name or number.</p> 
  <p><a name="SquareMatrix"></a><strong>Square Distance Matrix Example (with names):</strong></p> 
  <pre>ridge 0.0 0.1 0.3 0.9
floor 0.1 0.0 0.5 0.6
banks 0.3 0.5 0.0 0.7
other 0.9 0.6 0.7 0.0</pre> 
  <p>The window must contain a number (representing distance or similarity) for each orderered pair of samples. If you select "Data Window" as the location of the sample names, then the name of each sample must appear just before its list of distances to other samples. Here, the distance from sample "banks" to sample "other" is 0.7 If you have similarity data, select "Square Similarity Matrix", and the calculator will obtain distances by subtracting each similari from 1.0 Only the lower triangle of the input is used, and the calculator does not verify that your input matrix is symmetrical and has zeroes (or ones) along the diagonal.</p> 
  <p>Names and numbers in the window must be separated by spaces, tabs, and/or newlines, but unlike for the Cornell Condensed format, <strong>only the order matters! </strong>For example, this input is considered equivalent to the previous example:</p> 
  <pre>ridge 0.0 0.1
0.3 0.9
floor
0.1 0.0 0.5 0.6
banks 0.3 0.5 0.0 0.7 other 0.9 0.6 0.7</pre> 
  <p><a name="TriangularMatrix"></a><strong>Upper Triangular Distance Matrix Example (with names):</strong></p> 
  <pre>ridge 0.1 0.3 0.9
floor 0.5 0.6
banks 0.7
other</pre> 
  <p><strong>Lower Triangular Similarity Matrix Example (with names):</strong></p> 
  <pre>ridge
floor 0.9
banks 0.7 0.5
other 0.1 0.4 0.3</pre> 
  <p><strong>Lower Triangular Similarity Matrix Example (without names, with diagonal):</strong> </p> 
  <pre>0.0
0.9 0.0
0.7 0.5 0.0
0.1 0.4 0.3 0.0</pre> 
  <p>The window must contain a number (representing distance or similarity) for each unorderered pair of distinct samples. If you select "Data Window" as the location of the sample names, then the name of each sample must appear just before its list of distances to other samples. Here, the distance from sample "banks" to sample "other" is 0.7 (and their similarity is 0.3) The zeroes along the diagonal of a distance matrix, or the ones along the diagonal of a similarity matrix can be present, but if so, make sure to check the "Diagonal Present" option. If you have similarity data, the calculator will obtain distances by subtracting each similarity from 1.0 Only the lower triangle of a square matrix is used, and the calculator does not verify that such a matrix is symmetrical and has zeroes (or ones) along the diagonal.</p> 
  <p>Names and numbers in the window must be separated by spaces, tabs, and/or newlines, but unlike for the Cornell Condensed format, <strong>only the order matters! </strong>For example, this input is considered equivalent to the previous example:</p> 
  <pre>0.9 0.7 0.5
0.1 0.4
0.3
    </pre> 
  <p><a name="CharacterSample"></a><strong>Character Matrix: Samples as Rows Example (with names):</strong></p> 
  <p><tt>7<br> A B C D E F G<br> Lake 0 4 0 0 5 0 6<br> Pond 3 0 0 2 3 3 0<br> Lawn 1 0 0 2 1 1 0</tt></p> 
  <p>There is a list of characters for which each sample has a value. In this example, there are 7 characters, each representing the abundance of a different species of insect found in sweep samples at different locations. The first item in the window is the number of characters in each sample. The rest of the window must contain a number for each sample-character pair (even if it is zero), and all numbers for a given sample must appear consecutively. To accomodate the natural layout of this kind of data, <strong>this applet now assumes row and column names are present</strong>. This assumption can be turned off under the <strong>More Options...</strong> menu.</p> 
  <p>If you select "Data Window" as the location of the sample names, then the name of each sample must appear just before its list of character values. The distance between samples is calculated using the distance/similarity measure you choose. Names and numbers in the window must be separated by spaces, tabs, and/or newlines, but unlike for the Cornell Condensed format, <strong>only the order matters! </strong>For example, this input is considered equivalent to the previous example:</p> 
  <p><tt>7 A B C D E F G Lake 0 4<br> 0 0 5 0 6 Pond 3 0 0 2 3 3 0<br> <br> Lawn 1 0<br> 0 2 1 1<br> <br> 0</tt></p> 
  <p><br> <a name="SampleCharacter"></a><strong>Character Matrix: Samples As Columns Example (with names):</strong></p> 
  <pre>7
  Lake Pond Lawn
A 0 3 1
B 4 0 0
C 0 0 0
D 0 2 2
E 5 3 1
F 0 3 1
G 6 0 0
    </pre> 
  <p>This is the transpose of the <a href="#CharacterSample">Samples as Rows</a> format: the first item is the number of characters in each sample. This is followed by the sample names, if you selected the "Names in Data Window"&nbsp;option, and then for each character, the values it takes in each sample. In this example there are 7 characters, and three samples, namely "Lake", "Pond", and "Lawn". The value of the fifth character for the Lake sample is 5, and the value of the first character for the Lawn sample is 1. As for the Samples-as-rows format, <strong>only the order of the data matters.</strong></p> 
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <p> </p>
  <hr WIDTH="100%">
  <p></p> 
  <p><a name="DistanceMeasures"></a><strong><u>About the Distance/Similarity Measures</u></strong></p> 
  <p>For the <a href="#CornellCondensed">Cornell Condensed</a>, <a href="#SampleCharacter">Sample-Character</a>, and <a href="#CharacterSample">Character-Sample</a> input formats, you can choose the method for calculating distances (or similarities) between samples.</p> 
  <p><strong><u>Distance Measures<br> </u></strong>The distance between two samples is calculated using their values for each character, in various ways.For the following table, <strong><i>X<sub>ik</sub> </i></strong>is the value of character k for sample i, and <strong><i>|X|</i></strong> means the absolute value of quantity <strong><i>X</i></strong>.</p> 
  <table border="1" cellpadding="3"> 
   <tbody>
    <tr> 
     <td> 
      <center>
       <p><strong>Name</strong></p>
      </center> </td> 
     <td> 
      <center>
       <p><strong>Distance between samples i and j</strong></p>
      </center> </td> 
    </tr> 
    <tr> 
     <td>Euclidean</td> 
     <td>Square-root of the sum over all characters k of <strong><i>(X<sub>ik</sub> -X<sub>jk</sub> )<sup>2</sup> </i></strong></td> 
    </tr> 
    <tr> 
     <td>Mean Censored Euclidean</td> 
     <td>Square-root of (the sum over all characters k of <strong><i>(X<sub>ik</sub> -X<sub>jk</sub> )<sup>2</sup>/ n )</i></strong> where <strong><i>n</i></strong> is the number of characters for which at least one of the two samples has a non-zero value</td> 
    </tr> 
    <tr> 
     <td>Bray-Curtis</td> 
     <td>(Sum over all characters k of <strong><i>|X<sub>ik</sub> -X<sub>jk</sub> |</i></strong> ) divided by <br> (Sum over all characters k of <strong><i>X<sub>ik</sub> + X<sub>jk</sub></i></strong> )</td> 
    </tr> 
    <tr> 
     <td>Canberra</td> 
     <td>(Sum over all characters k of <strong><i>|X<sub>ik</sub> -X<sub>jk</sub> | / (X<sub>ik</sub> + X<sub>jk</sub> )</i></strong> ) divided by <br> the number of characters</td> 
    </tr> 
   </tbody>
  </table> 
  <p><strong><u>(Binary) Similarity Measures<br> </u></strong>The similarity of two samples is calculated using only the presence or absence of each character in each sample, where presence means a value greater than zero for the character. For the following table, the variables <strong>a</strong>, <strong>b</strong>, <strong>c</strong>, and <strong>d</strong> mean the number of characters:</p> 
  <ul> 
   <p><strong><i>a</i></strong> = present in both samples</p> 
   <p><strong><i>b </i></strong>= present in sample i, absent in sample j</p> 
   <p><strong><i>c </i></strong>= present in sample j, absent in sample i</p> 
   <p><strong><i>d </i></strong>= absent in both samples</p> 
  </ul> 
  <table border="1" cellpadding="3"> 
   <tbody>
    <tr> 
     <td> 
      <center>
       <p><strong>Name</strong></p>
      </center> </td> 
     <td> 
      <center>
       <p><strong>Similarity of samples i and j</strong></p>
      </center> </td> 
    </tr> 
    <tr> 
     <td>Jaccard</td> 
     <td> 
      <center>
       <p><strong><i>a / (a +&nbsp;b +&nbsp;c)</i></strong></p>
      </center> </td> 
    </tr> 
    <tr> 
     <td>Sorensen</td> 
     <td> 
      <center>
       <p><strong><i>2a / (2a + b +&nbsp;c)</i></strong></p>
      </center> </td> 
    </tr> 
    <tr> 
     <td>Simple Matching Coefficient</td> 
     <td> 
      <center>
       <p><strong><i>(a +&nbsp;d) / (a + b + c + d)</i></strong></p>
      </center> </td> 
    </tr> 
    <tr> 
     <td>Baroni-Urbani and Buser</td> 
     <td><strong><i>(a + ( ad )<sup>1/2 </sup>) / (a + b + c +&nbsp;( ad )<sup>1/2 </sup>)</i></strong></td> 
    </tr> 
   </tbody>
  </table> 
  <p>If a similarity measure gives a value of <strong><i>S</i></strong>, then the distance between the two samples is calculated as <strong><i>1.0 - S</i></strong> <br> and this will be the value used in the clustering algorithm. </p>
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <hr WIDTH="100%">
  <p></p> 
  <p><a name="ClusterMethods"></a><strong><u>About the Clustering Methods</u></strong></p> 
  <p>The methods used here are all hierarchical and combinatorial: </p> 
  <li>each sample begins in a cluster of its own</li> 
  <li>while there is more than one cluster left:</li> 
  <ul> 
   <li>the two closest clusters are <strong>combined </strong>into a new cluster</li> 
   <li>the distance between the newly formed cluster and each other cluster is calculated</li> 
  </ul> 
  <p>The methods differ only in how they calculate the "distance" from one cluster to another:</p> 
  <table border="1"> 
   <tbody>
    <tr> 
     <td> 
      <center>
       <p><strong>Clustering Method</strong></p>
      </center> </td> 
     <td> 
      <center>
       <p><strong>Distance Between Clusters A and B</strong></p>
      </center> 
      <center>
       <p><strong>(where A was formed by combining cluster A1 with cluster A2) </strong></p>
      </center> </td> 
    </tr> 
    <tr> 
     <td>Single Linkage</td> 
     <td>the smallest distance between a sample in cluster A and a sample in cluster B</td> 
    </tr> 
    <tr> 
     <td>Complete Linkage</td> 
     <td>the largest distance between a sample in cluster A and a sample in cluster B</td> 
    </tr> 
    <tr> 
     <td>Unweighted Arithmetic Average</td> 
     <td>the average distance between a sample in cluster A and a sample in cluster B</td> 
    </tr> 
    <tr> 
     <td>Weighted Arithmetic Average</td> 
     <td>the weighted average distance between a sample in cluster A and a sample in cluster B. The weight assigned to the distance between samples S1 (in A) and S2 (in B) is (1/2)^G where G is the sum of the nesting levels of S1 and S2. (The nesting level of a sample is the number of its enclosing clusters at this stage, in other words, the number of times the sample has participated in a "combine"&nbsp;step.) The effect is to reduce the influence of groups of similar samples, if such are present, on the clustering process.</td> 
    </tr> 
    <tr> 
     <td>Unweighted Centroid</td> 
     <td>Cluster A is treated as the centroid of clusters A1 and A2. The distance from A to B is the average of the distance from A1 to B, and the distance from A2 to B, corrected so that A lies on a line joining A1 and A2, in the abstract "metric" space. This is a recursive definition. The distance between a pair of single-member clusters is just the distance between their member samples. </td> 
    </tr> 
    <tr> 
     <td>Weighted Centroid</td> 
     <td>like the unweighted centroid method, but reduces the influence of large numbers of similar samples</td> 
    </tr> 
    <tr> 
     <td>Ward's Minimum Variance</td> 
     <td>the increase in the mean squared deviation (from a sample to the centroid of its containing cluster) that would occur if clusters A and B were fused</td> 
    </tr> 
   </tbody>
  </table> 
  <p> </p>
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <hr WIDTH="100%">
  <a name="AboutOutput"></a>
  <strong><u>About the Output</u></strong>
  <p></p> 
  <p><strong>Note: Output from this program cannot be printed directly. Use the clipboard (or <a href="VirtualClipboard">Virtual Clipboard</a>) to copy and paste the contents of the Output window into your favourite word processor.</strong></p> 
  <p>The program always prints out the clustering algorithm chosen, and the number of samples. By checking the appropriate box on the calculator, you can have it output the:</p> 
  <li><strong><a href="#DistanceSimilarity">Distance vs. Similarity</a></strong></li> 
  <li><strong><a href="DistanceMatrix">Distance/Similarity Table</a></strong></li> 
  <li><strong><a href="DistanceMatrix">Distance/Similarity Matrix</a></strong></li> 
  <li><strong><a href="ClusteringProgress">Clustering Progress</a></strong></li> 
  <li><strong><a href="TreeAsText">Tree as a Text Picture</a></strong></li> 
  <li><strong><a href="PhylipTree">Tree in Phylip/DRAWTREE format</a></strong></li> 
  <p><a name="DistanceSimilarity"></a><strong>Distance vs. Similarity</strong></p> 
  <p>You can choose to have the program output either similarities or distances, in both the <a href="#DistanceMatrix">matrix</a> and <a href="#DistanceTable">table</a> output and in the <a href="#ClusteringProgress">clustering progress output</a>. This does not affect the computations, the distances output for the <a href="#TreeAsText">tree as a text picture</a>, nor the labels output for the <a href="#TreeAsText">Phylip tree output.</a></p> 
  <p>The <a name="DistanceTable"></a><strong>Distance/Similarity Table </strong>option shows distances/similarities between pairs of samples in a table. This can be used to verify that your input data is being correctly interpreted.</p> 
  <p>For example, the sample data produces the following output, if you check the "output similarities instead of distances" option.</p> 
  <pre>From    To      Similarity
========================
PLI     CH      0.88
CI      CH      0.99
CI      PLI     0.88
NS      CH      0.66
NS      PLI     0.62
NS      CI      0.66
CL      CH      0.77
CL      PLI     0.7
CL      CI      0.78
CL      NS      0.73
CT      CH      0.75
CT      PLI     0.71
CT      CI      0.75
CT      NS      0.64
CT      CL      0.76
SI      CH      0.36
SI      PLI     0.36
SI      CI      0.36
SI      NS      0.28
SI      CL      0.29
SI      CT      0.34
SPI     CH      0.51
SPI     PLI     0.51
SPI     CI      0.5
SPI     NS      0.53
SPI     CL      0.51
SPI     CT      0.46
SPI     SI      0.19
SGI     CH      0.49
SGI     PLI     0.49
SGI     CI      0.48
SGI     NS      0.5
SGI     CL      0.49
SGI     CT      0.45
SGI     SI      0.2
SGI     SPI     0.8</pre> 
  <p>For each sample, its name is followed by the distances between it and the samples preceding it. Here, the distance between sample SPI and sample SI is 0.81, and the distance between CT andCI is 0.256667 </p> 
  <p> </p>
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <hr WIDTH="100%">
  <p></p> 
  <p>The <a name="DistanceMatrix"></a><strong>Distance/Similarity Matrix</strong> option shows the lower triangular matrix of distances or similarities between samples. This can be used to verify that your input data is being correctly interpreted.</p> 
  <p>For example, the sample data produces the following output, if the "output similarities instead of distances" option is <strong>not</strong> checked:</p> 
  <pre>Distance matrix:
        CH      PLI     CI      NS      CL      CT      SI      SPI  
PLI     0.12    
CI      0.01    0.12    
NS      0.34    0.38    0.353333        
CL      0.23    0.3     0.25            0.27    
CT      0.25    0.29    0.256667        0.338   0.24    
SI      0.64    0.64    0.64            0.72    0.71    0.668333        
SPI     0.49    0.49    0.493333        0.47    0.49    0.54            0.81    
SGI     0.51    0.51    0.503333        0.485   0.5     0.506667        0.7025  0.2     
    </pre> 
  <p>For each sample, its name is followed by the distances between it and the samples preceding it. Here, the distance between sample SPI and sample SI is 0.81, and the distance between CT and CI is 0.256667 The formatting is a bit wonky, but it should allow the text to be cut and pasted directly into TAB-aware programs like spreadsheets.</p> 
  <p> </p>
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <hr WIDTH="100%">
  <p></p> 
  <p>The <a name="ClusteringProgress"></a><strong>Clustering Progress </strong>option shows the step-by-step progress of the clustering method. The output is a table showing the two clusters joined at each step, and the distance or similarity between them.</p> 
  <p>For example, the sample data produces the following output, if the "output similarities instead of distances" option is <strong>not</strong> checked:</p> 
  <pre>Clustering procedure:
Step       A      B    Distance
===============================
1       CI      CH      0.01
2       1'      PLI     0.12
3       SGI     SPI     0.2
4       CT      CL      0.24
5       4'      2'      0.256667
6       5'      NS      0.338
7       3'      6'      0.506667
8       7'      SI      0.7025
    </pre> 
  <p>At the first step, the samples CI and CH are joined because the distance separating them, 0.01, is the smallest of any pair of samples. At step 2, the cluster formed in step 1, namely "1'", is joined to sample PLI at a distance of 0.12 The "'" is added to cluster numbers to prevent confusion with sample names which might happen to be numbers.</p> 
  <p> </p>
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <hr WIDTH="100%">
  <p></p> 
  <p>The <a name="TreeAsText"></a><strong>Tree as Text Picture</strong> option draws a tree representing the clustering process. The samples form "leaf" nodes which occur at the right of the picture. Each step in the clustering process is represented by an "interior" node, which has descendents to its right. The calculator also shows a table listing the distances between adjacent nodes.</p> 
  <p>For example, the sample data yields the following tree:</p> 
  <pre>
Tree Topology: (branch lengths ignored)

          +----SGI
     +----+1
     |    +----SPI
+----7
|    |              +----CT
|    |         +----2
|    |         |    +----CL
|    |    +----5
|    |    |    |         +----CI
|    |    |    |    +----3
|    |    |    |    |    +----CH
|    |    |    +----4
|    |    |         +----PLI
|    +----6
|         +----NS
8
+----SI

From    To        Length
========================
1'      SGI     0.1
1'      SPI     0.1
7'      1'      0.153333
2'      CT      0.12
2'      CL      0.12
5'      2'      0.00833333
3'      CI      0.005
3'      CH      0.005
4'      3'      0.055
4'      PLI     0.06
5'      4'      0.0683333
6'      5'      0.0406667
6'      NS      0.169
7'      6'      0.0843333
8'      7'      0.0979167
8'      SI      0.35125
    </pre> 
  <p>The structure of the tree represents the clustering process: the two descendents of an interior node are the two clusters joined at that point in the process. For example, clusters 2 and&nbsp;4 were combined to create cluster 5. Although no attempt is made to represent distances in the drawing of the tree, a table is printed listing the actual distances between adjacent nodes. These distances have the property that for any pair of leaf nodes (ie. samples), the distance you get by tracing along the tree from one node to the other, adding appropriate values from the table as you go, is equal to the distance at which the two nodes joined the same cluster. For example, samples NS and CI are connected by the following path: </p> 
  <pre>From    To      Distance
=========================
 NS     6'      0.169
 6'     5'      0.0406667
 5'     4'      0.0683333
 4'     3'      0.055
 3'     CI      0.005
-------------------------
Total Distance: 0.338
    </pre> 
  <p>The "tree length" between NS and CI is thus 0.338, and this is the same as the distance at which clusters 5 and NS were joined in step 6, as can be seen in the <a href="ClusteringProgress">Clustering Progress</a> table. </p> 
  <p>For the Unweighted Arithmetic Mean clustering method used in the example, <strong>this fact can be stated in several ways:</strong></p> 
  <ol> 
   <li>the tree length between NS and CI is 0.338</li> 
   <li>the smallest cluster containing NS and CI was created at a threshold of 0.338</li> 
   <li>NS and CI are members of maximal disjoint clusters the average distance between whose members is 0.338</li> 
  </ol> 
  <p>Statements 1 and 2 would be true regardless of which clustering method generated this output. Statement 3 is only true for the Unweighted Arithmetic Mean clustering method.</p> 
  <p>This statement is <strong>not</strong> equivalent and <strong>doesn't follow</strong> from the previous ones:</p> 
  <li>the distance between samples NS and CI is 0.338</li> 
  <p>For the other clustering methods, similar kinds of statements are true and not true.</p> 
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <p> </p>
  <hr WIDTH="100%">
  <p></p> 
  <p>The <a name="PhylipTree"></a><strong>Tree in Phylip/DRAWTREE format</strong> option outputs a string representing the tree in a way that the Phylip program DRAWTREE can plot the tree in two dimensions. This string can also be used in the TreeToy webpage, as <a href="#VisualizeTree">described</a> below. For example, the sample input yields the following Phylip tree: </p> 
  <pre>Tree in Phylip/DRAWTREE format: 
(((SGI:0.1,SPI:0.1):0.153333,(((CT:0.12,CL:0.12):0.00833333,
((CI:0.005,CH:0.005):0.055,PLI:0.06):0.0683333):0.0406667,NS:0.169):0.0843333):0.0979167,SI:0.35125);</pre> 
  <p> </p>
  <hr WIDTH="100%">
  <a name="VisualizeTree"></a>
  <strong><u>Visualizing the Tree</u></strong> 
  <p></p> 
  <p>If you want to look at your tree in a two-dimensional graphical form that reflects tree distances, you can use TreeToy as follows:</p> 
  <li>make sure the "<a href="#PhylipTree">Output a Phylip/DRAWTREE...</a>" option is checked on this calculator</li> 
  <li>run the calculator by hitting "Calculate!"</li> 
  <li>from the Output window, select everything after the "Tree in Phylip/DRAWTREE format:" line until the semicolon at the end</li> 
  <li>copy this selected text to your system clipboard </li> 
  <li>return to this spot on the page and follow <a href="TreeToy.html">this link to TreeToy</a>, where you can paste from the clipboard (or Virtual Clipboard) into the Input Window, and hit "Build Tree from Input" to display the tree graphically.</li> 
  <p><strong>Warning</strong>: your browser will probably discard the contents of the Clustering output window when you visit TreeToy, so make sure you copy/paste out anything you don't want to lose!</p> 
  <p>Phylip is a package of free clustering, phylogeny, and data analysis programs produced by Joel Felsenstein et al, and is available for many platforms. You can visit its <a href="http://evolution.genetics.washington.edu/phylip.html">homepage.</a> The Phylip DRAWTREE program will take a textual representation of a tree (such as can be <a href="PhylipTree">produced by this calculator</a>), and render it as a two-dimensional graph in various graphics formats, many of which can be printed. If you want to print your graph, consider downloading a version of Phylip.</p> 
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <p> </p>
  <hr WIDTH="100%">
  <p></p> 
  <hr> 
  <center>
   <p></p>
   <form enctype="multipart/form-data" method="post" action="http://www2.biology.ualberta.ca/jbrzusto/copytoclip.php"> 
   </form>
  </center> 
  <center>
   <p><b><u><a name="Virtual"></a>Virtual Clipboard (for large files)</u></b> </p>
  </center> 
  <p>The Virtual Clipboard lets you paste data into or copy data out of multi-page windows. The <b>---&gt; VC</b> and <b>&lt;--- VC</b> buttons move data to and from the virtual clipboard. If you see a "Browse" button below, then your browser will also let you copy a file on your machine to the Virtual Clipboard. You can then paste it from the V.C. into the calculator's input windows. </p> 
  <input TYPE="hidden" name="MAX_FILE_SIZE" value="1048576"> 
  <p>Name of file: <input type="file" size="30" name="userfile"></p> 
  <p><input type="submit" value="Copy this File to the Virtual Clipboard"></p> 
  <p></p>
  <form enctype="multipart/form-data" method="post" action="http://www2.biology.ualberta.ca/jbrzusto/viewclip.php">
   <p></p> 
   <p><input type="submit" value="View the Virtual Clipboard"></p> 
   <b>Note: if you get a <em>"Save As..."</em> dialog box when viewing the virtual clipboard, it is because the data there is in a binary format (e.g. a PICT file saved from TreeToy). You should specify an appropriate name (e.g. <em>myplot.pict</em> instead of <em>viewclip.php</em>) before saving it.</b> 
   <p></p>
  </form> 
  <p></p>
  <form enctype="multipart/form-data" method="post" action="http://www2.biology.ualberta.ca/jbrzusto/eraseclip.php">
   <p></p> 
   <p><input type="submit" value="Erase the Virtual Clipboard"></p> 
   <p> </p>
  </form>
  <hr> 
  <center>
   <p><b><u>The Virtual Clipboard is Brainless</u></b></p>
  </center> 
  <p>Is your window full of garbage after pasting? Unfortunately, the Virtual Clipboard knows nothing about file formats, so cutting and pasting directly from an Excel file will fill your window with junk (ie. raw Excel file bytes). You can, however, copy from the open Excel worksheet to a text editor, then save as text in a new file which you can then copy to the Virtual Clipboard. You can also just save a copy of your Excel file in tab-delimited text format, and copy that file to the VC. The point of the VC&nbsp;is just to help work around the limitations on window size in Netscape, MS Explorer, and probably other browsers.</p> 
  <center>
   <p><a href="#ClusterCalc">(go to Calculator)</a></p>
  </center> 
  <p> </p>
  <hr>
  <p></p> 
  <p><a name="PageNote"></a><strong><u>A Note on Pages</u></strong></p> 
  <p>Some browsers limit the size of text windows, so this program allows for bigger input and output using multiple <strong>pages</strong>. Each page is limited to around 10000 characters. To see if you have filled a page, try typing more characters at the end of the window. When you use your system's copy/paste functions to get text in and out of this program, you have to do so one page at a time; the program has no control over this.</p> 
  <p> </p>
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <hr WIDTH="100%">
  <p></p> 
  <p><a name="Bugs"></a><strong><u>Bugs, Bugs, Bugs</u></strong></p> 
  <p>Here are some problems you might encounter (there are doubtless many others - please <a href="">let me know!</a>):</p> 
  <li><strong>scrollbars don't function</strong>: some versions of Netscape for the Mac don't draw scrollbars until you force the browser to refresh the page by, for example, resizing it.</li> 
  <li><strong>horizontal scrollbars don't appear:</strong> some versions of Netscape for the PC don't draw horizontal scrollbars on text windows. You can still move around the window by clicking inside it and using cursor keys.</li> 
  <li><strong>the Virtual Clipboard doesn't work</strong>: you can't (couldn't used to?) copy a local file to the Virtual Clipboard from Microsoft Internet Explorer. You might not be able to use the VC at all from some browsers. The size of your clipboard might not appear correctly. These are all problems with the current VC, which is only there to get around (sensible!) security limitations imposed by Java.</li> 
  <li><strong>the interface is clunky</strong>: I'm working on it.</li> 
  <p><a href="#Top">(back to top)</a></p> 
  <p> </p>
  <hr WIDTH="100%">
  <p></p> 
  <p><a name="Credits"></a><strong><u>Credits:</u></strong></p> 
  <p>The clustering functions are slightly-modified Java translations of FORTRAN code by <a href="mailto:fionn@infm.ulst.ac.uk">Fionn Murtagh</a>, available from the <a href="http://www.stat.cmu.edu/S/">statlib S-plus archive</a> as <a href="http://www.stat.cmu.edu/S/multiv">multiv</a>. Free use and redistribution are permitted for non-commercial purposes.</p> 
  <p>The DRAWTREE textual tree format comes from the <a href="http://evolution.genetics.washington.edu/phylip.html">Phylip</a> package by Joel Felsenstein et al. My thanks to them for making it free.</p> 
  <p>Thanks for motivation and feedback to Jim Hammond, Mark Dale, John Spence, Greg Wilson, Curtis Strobeck, and Charley Krebs.</p> 
  <p>This is <strong>free</strong> software. </p>
  <hr> 
  <p></p> 
  <p>For why software should be free, see <a href="http://gnu.linux.ucla.edu/philosophy/why-free.html"> http://gnu.linux.ucla.edu/philosophy/why-free.html</a></p> 
  <p>For other free ecology programs, see <a href="http://www2.biology.ualberta.ca/jbrzusto/index.html"> http://www2.biology.ualberta.ca/jbrzusto</a> </p>
  <p>This Java and HTML/PHP web page is by John Brzustowski (junkjbrzusto@ualberta.cacaca but removing the obvious parts). You can <a href="">email me comments or criticisms</a>. Although I strive to ensure the correctness of these programs, you use them <strong>entirely at your own risk</strong>. There is no warranty!</p> 
  <center>
   <p><a href="#Top">(back to top)</a></p>
  </center> 
  <hr> 
  <p><a name="LocalInstall"></a><strong><u>Installing CLUSTER on Your Machine</u></strong></p> 
  <p> If your connection to this server is slow, you can get your own copy of the program: </p>
  <ul> 
   <li>use your browser's <b>File | Save as...</b> feature to save this HTML/php file to a directory on your machine</li> 
   <li> <a href="http://www2.biology.ualberta.ca/jbrzusto/cluster.zip"> download the file cluster.zip</a> to the same directory</li> 
  </ul> To run the program, use your browser to open your copy of this HTML file. (For older browsers, you might have to unzip the archive cluster.zip in this directory. Be sure to preserve the directory structure stored in the archive.)
  <p></p> 
  <p> The virtual clipboard can only be used in conjunction with a web server. <b>See <a href="#LoadSave">above</a> before deciding to try the following.</b> Your webmaster can set up your server to allow you to use the virtual clipboard as follows: </p>
  <ul> 
   <li>download all files from <a href="http://www2.biology.ualberta.ca/jbrzusto/ftp/cgi/virtclip/"> http://www2.biology.ualberta.ca/jbrzusto/ftp/cgi/virtclip/</a></li> 
   <li>follow the (terse!) directions in the file README.TXT</li> 
  </ul> 
  <p></p> 
  <p><a href="#Top">(back to top)</a></p> 
  <p><a name="source"></a><strong><u>Getting the source code</u></strong></p> 
  <p>The zipped java source for this applet is <a href="clustersrc.zip">here</a>. </p> 
  <hr> 
  <address><a href="">John Brzustowski</a></address> 
  <!-- Created: Sun Nov 21 13:26:07 MST 1999 --> 
  <!-- hhmts start --> Last modified: Wed Jul 3 18:54:17 MST 2002 
  <!-- hhmts end -->   
 </body>
</html>