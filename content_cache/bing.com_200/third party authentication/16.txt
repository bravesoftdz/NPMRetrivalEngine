<!doctype html>
<html lang="en-US">
 <head> 
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,requiresActiveX=false"> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1"> 
  <title>ASP.NET Core Authentication with IdentityServer4 | .NET Web Development and Tools Blog</title> 
  <meta name="description" content="Your official information source from the .NET Web Development and Tools group at Microsoft."> 
  <link rel="profile" href="http://gmpg.org/xfn/11"> 
  <link rel="pingback" href="https://blogs.msdn.microsoft.com/webdev/xmlrpc.php"> 
  <!-- Move Favicons To Child Theme Functions --> 
  <!--<link rel="shortcut icon" href="https://blogs.msdn.microsoft.com/webdev/wp-content/themes/cloud-platform/images/favicon.ico" />--> 
  <meta name="msvalidate.01" content="01EEB8C34FE4A6AA047F3FA8A590C583"> 
  <link rel="dns-prefetch" href="//s.w.org"> 
  <link rel="alternate" type="application/rss+xml" title=".NET Web Development and Tools Blog » Feed" href="https://blogs.msdn.microsoft.com/webdev/feed/"> 
  <link rel="alternate" type="application/rss+xml" title=".NET Web Development and Tools Blog » Comments Feed" href="https://blogs.msdn.microsoft.com/webdev/comments/feed/"> 
  <link rel="alternate" type="application/rss+xml" title=".NET Web Development and Tools Blog » ASP.NET Core Authentication with IdentityServer4 Comments Feed" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/feed/"> 
  <meta property="og:type" content="article"> 
  <meta property="og:title" content="ASP.NET Core Authentication with IdentityServer4"> 
  <meta property="og:url" content="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/"> 
  <meta property="og:description" content=""> 
  <meta name="twitter:card" content="summary"> 
  <meta name="twitter:title" content="ASP.NET Core Authentication with IdentityServer4"> 
  <meta name="twitter:url" content="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/"> 
  <meta name="twitter:description" content=""> 
  <script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/blogs.msdn.microsoft.com\/webdev\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.5"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script> 
  <style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style> 
  <link rel="stylesheet" id="wds_msdn-parent-style-css" href="https://blogs.msdn.microsoft.com/webdev/wp-content/themes/msdn-network-parent/style.min.css?ver=12272016" type="text/css" media="all"> 
  <link rel="stylesheet" id="wds_cloud_platform-child-style-css" href="https://blogs.msdn.microsoft.com/webdev/wp-content/themes/cloud-platform/style.min.css?ver=12052016" type="text/css" media="all"> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-includes/js/jquery/jquery.js?ver=1.12.4"></script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1"></script> 
  <link rel="https://api.w.org/" href="https://blogs.msdn.microsoft.com/webdev/wp-json/"> 
  <link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://blogs.msdn.microsoft.com/webdev/xmlrpc.php?rsd"> 
  <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://blogs.msdn.microsoft.com/webdev/wp-includes/wlwmanifest.xml"> 
  <link rel="canonical" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/"> 
  <link rel="shortlink" href="https://blogs.msdn.microsoft.com/webdev/?p=8945"> 
  <link rel="alternate" type="application/json+oembed" href="https://blogs.msdn.microsoft.com/webdev/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwebdev%2F2017%2F01%2F23%2Fasp-net-core-authentication-with-identityserver4%2F"> 
  <link rel="alternate" type="text/xml+oembed" href="https://blogs.msdn.microsoft.com/webdev/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fblogs.msdn.microsoft.com%2Fwebdev%2F2017%2F01%2F23%2Fasp-net-core-authentication-with-identityserver4%2F&amp;format=xml"> 
  <script>
		if(window.document.referrer.indexOf('login.live.com') !== -1) {
			// redefine ga function to prevent referrer data collected by google analytics
			window.ga = function(){};
		}
	</script> 
 </head>
 <body class="post-template-default single single-post postid-8945 single-format-standard msdn-47804 group-blog">
  <div id="msccBanner" dir="ltr" data-site-name="uhf-MSDNBlogs" data-mscc-version="0.3.6" data-nver="aspnet-2.0.5" data-sver="0.1.2" class="cc-banner" role="alert">
   <div class="cc-container">
    <svg class="cc-icon cc-v-center" x="0px" y="0px" viewbox="0 0 44 44" height="30px" fill="none" stroke="currentColor">
     <circle cx="22" cy="22" r="20" stroke-width="2"></circle>
     <line x1="22" x2="22" y1="18" y2="33" stroke-width="3"></line>
     <line x1="22" x2="22" y1="12" y2="15" stroke-width="3"></line>
    </svg> 
    <span class="cc-v-center cc-text">This site uses cookies for analytics, personalized content and ads. By continuing to browse this site, you agree to this use.</span> 
    <a href="https://go.microsoft.com/fwlink/?linkid=845480" aria-label="Learn more about Microsoft’s Cookie Policy" id="msccLearnMore" class="cc-link cc-v-center cc-float-right" data-mscc-ic="false">Learn more</a>
   </div>
  </div>
  <script type="text/javascript">
jQuery( window ).load( function() {
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    if (typeof mscc === 'undefined' || (!mscc || mscc.hasConsent())) {
                ga('require', 'linkid');
                ga('create', 'UA-65691138-1', 'auto');
                ga('send', 'pageview');
            }
} );
</script> 
  <!-- Begin Custom CSS -->
  <style type="text/css" id="wds-custom-css">
			.rsswidget img{
float:none;
}.home .blog-title {
  margin: 10px 0 20px;
  font-size: 29px;
}

.network-home-highlights-wrapper {
	font-size: 14px;
	font-family: WOL_Reg, 'Segoe UI', Tahoma, Arial, sans-serif;
}
.network-home-highlights-wrapper .entry-title {
  font-size: 16px;
}
.network-home-highlights-wrapper .blog-source {
	font-size: 12px;
}

.widget .widget-title {
  color: #2a2a2a;
  font-size: 16px;
}

.widget-link-list {
  list-style-type: none;
  margin: 0 0 30px 0;
  padding: 0;
}
.widget-link-list li {
  margin: 0 0 7px 0;
  padding: 0;
}

.widget-link-list img {
	margin: 0; 
	padding: 0;
}

.widget .widget-rss-link {
  position: relative;
}
.widget .widget-rss-link a {
  display: block;
  position: absolute;
  top: -39px;
  right: 0;
  width: 14px;
  height: 14px;
}
.widget .widget-rss-link a img {
  padding: 0;
}

/*Main Navigation*/
.main-navigation {
	font-size: 13px;
}
.main-navigation ul {
	/* subnav adjacent item gap - allows subnav to not appear connected to adjacent menu items */
	display: block;
	table-layout: auto;
}

.main-navigation ul li {
	display: block; /* subnav adjacent item gap */
}

.main-navigation ul,
.main-navigation li {
	background: #68217a;
	margin: 0;
}
.main-navigation ul li {
	padding: 0;
}
.main-navigation li a {
	height: 60px;
	padding: 5px 30px 6px 10px;
}

.main-navigation .menu > .menu-item {
	border-bottom: 1px solid #fff; /* subnav adjacent item gap */
}
.main-navigation .menu > .menu-item.active {
	background: #442059;
	border-bottom-color: #442059;
}

.main-navigation li:hover {
  background: #442059;
}

.main-navigation ul .sub-menu {
	margin-top: 1px; /* subnav adjacent item gap */
}

.main-navigation li .sub-menu li a {
	line-height: 1.3em;
}

.sub-menu.active li {
	background: #442059;
}

.sub-menu.active li:hover{
  background: #68217a;
}
/*End Main Navigation*/

.child-level-below-nav .blog-title a {
  color: #68217a;
}

a:visited,
h2.entry-title a:visited {
  color: #969696;
}

a:hover,
h2.entry-title a:hover {
  color: #004185;
}

.child-level-below-nav .blog-title {
  font-size: 3.9rem;
}

h1.entry-title {
  font-size: 2.6rem;
  margin-bottom: 8px;
}
h2.entry-title {
  font-size: 2rem;
  margin-bottom: 8px;
}
h2.entry-title a {
  color: #0072c6;
}

.entry-meta {
  margin-bottom: 8px;
}

.post-info {
  margin-bottom: 0;
}

.entry-summary {
  margin-top: 0;
}

.social-icons-wrap ul {
  margin-top: 12px;
}

.wds-ratings-stars.current-rating,
.wds-ratings-stars.current-rating.wds-ratings-active,
.wds-ratings-stars.wds-ratings-active {
  color: #f4b93f;
}

/* Begin tabs and container for sxp */
	.sxp-title {font-size: 1.333em/*16px*/;}
	.sxp-feed p.sxp-time-author-comments {margin: 4px 0 -8px;}
	.sxp-feed {margin-top: 30px;}
  .right-sidebar .sxp-feed {margin: 0 0 15px 0;}
	.sxp-feed:first-child {margin-top: 0;}
	.sxp-feed p {margin: 12px 0 0;}
  .right-sidebar .sxp-feed p {margin: 0;}
	.sxp-feed .sxp-time {color: #707070;}
	.sxp-feed .sxp-comments {margin-left: 21px; padding-left: 16px; background: url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/7282.icon-comments.png') 0 4px no-repeat;}
	.sxp-container {padding: 0 20px;}
  .right-sidebar .sxp-container {padding: 0;}
	#sxp-feed-container-all {}
	#sxp-feed-container-news {display: none;}  
	#sxp-feed-container ul {padding: 0 0 0 15px;}
	#sxp-feed-container-parent {position: relative; border: solid 1px #ccc; border-width: 0 1px 1px; padding: 0 0 20px;}
	#sxp-tabs {margin: 0 0 30px; width: 100%; background: #68217a; height: 32px; padding: 0 !important; border-bottom: solid 1px #ccc; font-size: 14px;}
	#sxp-tabs li {list-style-type: none; height: 32px; position: relative; float: left; border: solid #CCC; border-width: 0 1px 1px 0;}
	#sxp-tabs a {color: #fff; background: #68217a; height: 100%; line-height: 34px; padding: 0 20px; display: block; margin-left: 0;}
	#sxp-tabs a:hover {text-decoration: none;}
	#sxp-tabs a:first-child + a {left: -3px;}
	#sxp-tabs a:hover {background: #442059;}
	#sxp-tabs .selected {margin-top: -4px; height: 36px;}
	#sxp-tabs .selected a, #sxp-tabs .selected a:hover {background: #442059;}
	#sxp-tabs .selected span {z-index: 805; position: absolute; bottom: -7px; width: 100%; height: 7px; background: transparent url('https://msdnshared.blob.core.windows.net/media/2015/11/jj157208.developer-selected-tail(en-us,MSDN.10).png') no-repeat 50% 0;}
	#all-rss-link {float: right; margin: 0 15px 0 0; padding: 0 15px 0 0; position: relative; top: -21px; }
	#all-rss-link span {margin: 0 0 0 4px; display: inline-block; background: url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/2110.metroRSS.png') 0 0; height: 14px; width: 14px;}
	#all-rss-link a { font-size: 13px; color: #00749e; }
	#all-rss-link a:hover { text-decoration: underline; }
	#all-rss-link a:visited { color: #707070; }
	.feedPager {border-top: solid 1px #ccc; margin: 30px 0 20px; padding: 12px 0;}
	.feedPager a.pagerLink.currentPage {font-weight: bold; color: #000;}
	.feedPager a.pagerLink.currentPage:hover {cursor: default;}
	.feedPager a.pagerLink {margin-left: 15px;}
	.feedPager a.pagerLink:first-child {margin-left: 0;}
	.content-fragment.raw-html:first-child .user-defined-markup {overflow: visible;}
/* End tabs and container for sxp */	

/*Social Tile links*/
.sidebar-tiles {
	clear: both;
    list-style: none;
    margin: 0;
    overflow: hidden;
    padding: 0
}
.sidebar-tiles li {
	float: left;
	margin: 0 5px 5px 0;
	padding: 0;
}
.sidebar-tiles li:focus {
  outline: dotted thin;
}
.sidebar-tiles li.last {
   margin-right: 0;
}
.sidebar-tiles a {
    background: #424242;
    color: #fff;
    display: block;
    font-size: 11px;
    margin: 0;
    padding: 54px 10px 0 5px;
    width: 70px;
    height: 70px;
    text-decoration: none;
    line-height: 13px;
    width: 65px;
}
.sidebar-tiles a.sidebar-tile-subscribe {
	background: #ea700d url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/0045.icon-tile-rss.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-twitter {
	background: #55acee url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/twitter-tile.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-facebook {
	background: #3b5998 url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/2055.facebook.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-youtube {
	background: #cc181e url('https://msdnshared.blob.core.windows.net/media/2016/11/youtube1.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-comments {
	background: #006bc2 url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/5415.icon-comments-large.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-contact {
	background: #68217a url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/5340.icon-email-large.png') 50% 50% no-repeat;
}
.sidebar-tiles a.sidebar-tile-home {
	background: #68217a url('https://msdnshared.blob.core.windows.net/media/TNBlogsFS/prod.evol.blogs.technet.com/CommunityServer.Blogs.Components.WeblogFiles/00/00/00/94/25/5417.home.png') 50% 50% no-repeat;
}
.sidebar-tiles a:hover {
	color: #fff;
	background-color: #442059;
}

@media (min-width:37.5em){ /*medium*/
  .home .blog-title {
    margin: -10px 0 20px;
    font-size: 39px;
  }
  .main-navigation ul {
  	height: 121px;
  }
}
@media (min-width:60em){ /*large*/
  .main-navigation ul {
  	height: 58px;
  }
}

/*Child specific styles*/

.child-level-below-nav h2.blog-title {
  margin: 10px 0 8px;
  padding: 0;
  font-size: 29px;
}

.child-level-below-nav .child-below-nav-right img {
  float: none;
  top: auto;
  margin: 23px 0 0;
}
.site-content {
  margin: 2rem auto 0; /* need space after site logo */
}

.sidebar-btn {
  margin: 0 0 13px 0;
  color: #fff;
}
.sidebar-btn-purple {
	background-color: #68217a;
}
.sidebar-btn-green {
	background-color: #009E49;
}
.sidebar-btn-cyan {
	background-color: #0072C6;
}
.sidebar-btn a {
	line-height: 34px; 
	font-family: 'Segoe UI Semibold','Segoe UI',Tahoma,Helvetica,Sans-Serif;
	padding: 0 30px 0 35px;
	display: table-cell;
	vertical-align: middle;
	background: url('https://cdn3.visualstudio.com/Areas/VisualStudio/Themes/VStudio/Content/Images/arrowWhite.png') no-repeat right center;
	border-right: 10px solid transparent; 
	color: #fff;
}
.sidebar-btn a:hover {
  text-decoration: underline;
  color: #fff;
}


@media (min-width:37.5em){ 
  .child-level-below-nav h2.blog-title {
    margin: 10px 0 8px;
    padding: 0;
    font-size: 39px;
  }
}
@media (min-width:48.125em){
  .child-level-below-nav .child-below-nav-right img {
    float: none;
    top: auto;
    margin: 23px 0 0;
  }
  #secondary {
      float: right;
      width: 23.5492%;
  }
  #tag-wrap,
  .comments-area {
      clear: left;
      width: 74.5164%;
  }
  .comments-area .comment-list {
      clear: left;
  }
}
@media (min-width:60em){ 

}			</style>
  <!-- End Custom CSS --> 
  <link rel="shortcut icon" href="https://blogs.msdn.microsoft.com/webdev/wp-content/themes/cloud-platform/images/favicon-msdn.png"> 
  <meta property="Search.Network" name="Search.Network" content="ceblognetwork"> 
  <style type="text/css" id="syntaxhighlighteranchor"></style> 
  <link rel="icon" href="https://msdnshared.blob.core.windows.net/media/2017/02/Microsoft-favicon-cropped6.png" sizes="32x32"> 
  <link rel="icon" href="https://msdnshared.blob.core.windows.net/media/2017/02/Microsoft-favicon-cropped6.png" sizes="192x192"> 
  <link rel="apple-touch-icon-precomposed" href="https://msdnshared.blob.core.windows.net/media/2017/02/Microsoft-favicon-cropped6.png"> 
  <meta name="msapplication-TileImage" content="https://msdnshared.blob.core.windows.net/media/2017/02/Microsoft-favicon-cropped6.png">   
  <div id="top-link"></div> 
  <div class="site-header-wrap"> 
   <header id="masthead" class="site-header" role="banner"> 
    <div class="top-breadcrumb-wrap-child"> 
     <div class="top-breadcrumbs">
      <a href="https://blogs.technet.microsoft.com/serverandtools">Server &amp; Tools Blogs</a> &gt; 
      <a href="https://blogs.msdn.microsoft.com/developer-tools">Developer Tools Blogs</a> &gt; .NET Web Development and Tools Blog
     </div> 
     <div class="utility-breadcrumbs"> 
      <nav id="site-utility-navigation" class="utility-navigation" role="navigation"> 
       <div class="menu-utility-nav-container"> 
        <ul id="menu-utility-nav" class="menu"> 
         <li class="menu-item"><a href="https://blogs.msdn.microsoft.com/wp-login.php?aadsso_action=login">Sign in</a></li> 
        </ul> 
       </div> 
      </nav> 
     </div> 
    </div> 
    <a href="#togglemenu" class="header-mobile-dropdown-toggle-child">Menu</a> 
    <div class="header-mobile-dropdown-child-level"> 
     <nav id="site-navigation" class="main-navigation" role="navigation"> 
      <a class="skip-link screen-reader-text" href="#content"> Skip to content </a> 
      <div class="menu-developer-tools-blogs-main-menu-container">
       <ul id="menu-developer-tools-blogs-main-menu-1" class="menu">
        <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-43"><a href="#">Executive Bloggers</a> 
         <ul class="sub-menu"> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-103"><a href="http://weblogs.asp.net/scottgu/">Scott Guthrie</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-123"><a href="http://blogs.msdn.microsoft.com/bharry/">Brian Harry</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-133"><a href="http://blogs.msdn.microsoft.com/stevengu/">Steve Guggenheimer</a></li> 
         </ul> </li> 
        <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-53"><a href="#">Visual Studio</a> 
         <ul class="sub-menu"> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-143"><a href="http://blogs.msdn.microsoft.com/visualstudio">Visual Studio</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-153"><a href="https://code.visualstudio.com/blogs">Visual Studio Code</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-723"><a href="https://blogs.msdn.microsoft.com/visualstudioalm/tag/diagnostics/">Diagnostics</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-383"><a href="http://blogs.msdn.microsoft.com/heaths/">Setup &amp; Install by Heath Stewart</a></li> 
         </ul> </li> 
        <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-63"><a href="#">DevOps</a> 
         <ul class="sub-menu"> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-393"><a href="https://blogs.msdn.microsoft.com/devops/?tag=CI,CD,Release%20Management">Continuous Integration and Deployment</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1225"><a href="https://blogs.msdn.microsoft.com/devops/?tag=Git,Version%20Control">Git and Version Control</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-243"><a href="https://blogs.msdn.microsoft.com/devops/tag/agile/">Agile</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-412"><a href="https://blogs.msdn.microsoft.com/devops/?tag=Azure,Cloud">Azure and Cloud</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-413"><a href="https://blogs.msdn.microsoft.com/devops/tag/testing/">Test</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-423"><a href="https://blogs.msdn.microsoft.com/devops/tag/tfs/">Team Foundation Server</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1235"><a href="https://blogs.msdn.microsoft.com/devops/">Visual Studio Team Services</a></li> 
         </ul> </li> 
        <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-73"><a href="#">Languages</a> 
         <ul class="sub-menu"> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1195"><a href="https://blogs.msdn.microsoft.com/dotnet/tag/c/">Visual C#</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1205"><a href="https://blogs.msdn.microsoft.com/vbteam/">Visual Basic</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-453"><a href="http://blogs.msdn.microsoft.com/vcblog/">Visual C++</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-463"><a href="https://blogs.msdn.microsoft.com/dotnet/tag/visual-f/">Visual F#</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-473"><a href="https://blogs.msdn.microsoft.com/visualstudio/tag/javascript/">JavaScript</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-483"><a href="http://blogs.msdn.microsoft.com/typescript/">TypeScript</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1075"><a href="https://blogs.msdn.microsoft.com/pythonengineering/">Python</a></li> 
         </ul> </li> 
        <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-83"><a href="#">.NET</a> 
         <ul class="sub-menu"> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-263"><a href="http://blogs.msdn.microsoft.com/dotnet/">.NET</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1052"><a href="http://blogs.msdn.microsoft.com/bethmassi/">.NET with Beth Massi</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-513"><a href="http://www.hanselman.com/blog/CategoryView.aspx?category=ASP.NET">ASP.NET by Scott Hanselman</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-724"><a href="https://blogs.msdn.microsoft.com/odatateam/">OData Team</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-533"><a href="http://blogs.msdn.microsoft.com/wpf/">WPF</a></li> 
         </ul> </li> 
        <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-93"><a href="#">Platform Development</a> 
         <ul class="sub-menu"> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-273"><a href="http://blogs.windows.com/buildingapps/">Apps for Windows</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1032"><a href="https://blogs.msdn.microsoft.com/bingdevcenter/">Bing</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1063"><a href="http://blogs.windows.com/msedgedev/">Edge</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-553"><a href="http://azure.microsoft.com/blog/">Microsoft Azure</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-573"><a href="http://blogs.office.com/dev?filter=true&amp;filter-product=sharepoint">Office 365 Development</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-583"><a href="http://blogs.msdn.microsoft.com/webdev/">Web</a></li> 
         </ul> </li> 
        <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-has-children menu-item-1085"><a href="#">Data Development</a> 
         <ul class="sub-menu"> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1095"><a href="https://blogs.technet.microsoft.com/dataplatforminsider/">SQL Server</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1105"><a href="https://blogs.msdn.microsoft.com/ssdt/">SQL Server Data Tools</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1115"><a href="https://azure.microsoft.com/en-us/blog/tag/documentdb/">Cosmos DB</a></li> 
          <li class="menu-item menu-item-type-custom menu-item-object-custom menu-item-1125"><a href="http://blog.revolutionanalytics.com/">Revolutions R</a></li> 
         </ul> </li> 
       </ul>
      </div> 
     </nav> 
     <!-- #site-navigation --> 
    </div> 
    <div class="child-level-below-nav"> 
     <div class="child-below-nav-wrapper"> 
      <div class="child-below-nav-left"> 
       <div class="blog-name"> 
        <div class="inner-name-wrapper"> 
         <h2 class="blog-title"><a href="https://blogs.msdn.microsoft.com/webdev">.NET Web Development and Tools Blog</a></h2> 
        </div> 
       </div> 
       <p class="blog-description">Your official information source from the .NET Web Development and Tools group at Microsoft. </p> 
      </div> 
      <div class="child-below-nav-right"> 
       <a href="https://blogs.msdn.microsoft.com/webdev/" title=".NET Web Development and Tools Blog" rel="home"><img src="https://msdnshared.blob.core.windows.net/media/2017/02/8814.VisualStudioClean158.png" alt=".NET Web Development and Tools Blog"></a> 
      </div> 
     </div> 
    </div> 
   </header> 
   <!-- #masthead --> 
  </div> 
  <div id="content" class="site-content"> 
   <div id="primary" class="content-area"> 
    <main id="main" class="site-main" role="main"> 
     <article id="post-8945" class="post-8945 post type-post status-publish format-standard hentry category-aspnetcore tag-asp-net-identity tag-identityserver"> 
      <header class="entry-header"> 
       <h1 class="entry-title">ASP.NET Core Authentication with IdentityServer4</h1> 
       <div class="rating-wrap"> 
        <div id="star-rating-8945" class="wds-ratings" data-rating="5" data-userrating="0" data-postid="8945" data-container="body" data-toggle="tooltip" title="1 user(s) rated"> 
         <div class="wds-ratings-inner-wrap"> 
          <div> 
           <div aria-label="Select 5 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="5">
            <span aria-hidden="true" class="star-1"><span>?</span></span>
            <span aria-hidden="true" class="star-2"><span>?</span></span>
            <span aria-hidden="true" class="star-3"><span>?</span></span>
            <span aria-hidden="true" class="star-4"><span>?</span></span>
            <span aria-hidden="true" class="star-5"><span>?</span></span>
           </div>
           <div aria-label="Select 4 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="4">
            <span aria-hidden="true" class="star-1"><span>?</span></span>
            <span aria-hidden="true" class="star-2"><span>?</span></span>
            <span aria-hidden="true" class="star-3"><span>?</span></span>
            <span aria-hidden="true" class="star-4"><span>?</span></span>
           </div>
           <div aria-label="Select 3 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="3">
            <span aria-hidden="true" class="star-1"><span>?</span></span>
            <span aria-hidden="true" class="star-2"><span>?</span></span>
            <span aria-hidden="true" class="star-3"><span>?</span></span>
           </div>
           <div aria-label="Select 2 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="2">
            <span aria-hidden="true" class="star-1"><span>?</span></span>
            <span aria-hidden="true" class="star-2"><span>?</span></span>
           </div>
           <div aria-label="Select 1 star, this article is 5 star rated" tabindex="0" class="wds-ratings-stars wds-ratings-stars-enable-editing" data-stars="1">
            <span aria-hidden="true" class="star-1"><span>?</span></span>
           </div> 
          </div> 
         </div> 
        </div> 
       </div> 
      </header>
      <!-- .entry-header --> 
      <div class="entry-meta row"> 
       <div class="post-info"> 
        <span class="posted-on"><time class="entry-date published" datetime="2017-01-23T11:36:46+00:00">January 23, 2017</time><time class="updated" datetime="2017-02-10T07:33:50+00:00">February 10, 2017</time></span> 
        <span class="byline">by <span class="author vcard profile-usercard-hover" data-profile-userid="81969c01fea14d958ba79bc853a83048"><a class="url fn n profile-usercard-a" href="https://social.msdn.microsoft.com/profile/Jeffrey+T.+Fritz">Jeffrey T. Fritz</a></span></span> 
        <span class="slashes comment-slashes">//</span> 
        <a class="num-comments" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/#comments">9 Comments</a> 
       </div> 
       <div class="row"> 
        <div class="social-icons-wrap"> 
         <ul class="social-icons"> 
          <li>
           <div class="fb-share-button" data-href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/" data-layout="button_count" data-size="large" data-mobile-iframe="true">
            <a class="fb-xfbml-parse-ignore" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/&amp;src=sdkpreparse">Share</a>
           </div></li> 
          <div id="fb-root" style="display:none"></div> 
          <li class="social-icon twitter"><a data-social="{&quot;type&quot;:&quot;twitter&quot;, &quot;url&quot;:&quot;https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/&quot;, &quot;text&quot;: &quot;ASP.NET Core Authentication with IdentityServer4&quot;}" href="#" id="post_tweet_count">0</a></li> 
          <li class="social-icon linkedin"><a data-social="{&quot;type&quot;:&quot;linkedin&quot;, &quot;url&quot;:&quot;https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/&quot;, &quot;text&quot;: &quot;ASP.NET Core Authentication with IdentityServer4&quot;}" href="#" id="get_post_linkedin_count">0</a></li> 
         </ul> 
        </div>
        <!-- .social-icons-wrap --> 
        <script type="text/javascript">
		// Get social counts
		jQuery( window ).load(function () {
			jQuery.getScript('https://blogs.msdn.microsoft.com/webdev/wp-content/themes/msdn-network-parent/js/social-counts.min.js?ver=12272016')
				.done(function(script,textStatus) {
					window.msdnsocial.ajax('https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/');
				});
		});
	</script> 
       </div> 
      </div>
      <!-- .entry-meta --> 
      <div class="entry-content"> 
       <p><em>This is a guest post by Mike Rousos</em></p> 
       <p>In my post on <a href="https://blogs.msdn.microsoft.com/webdev/2016/10/27/bearer-token-authentication-in-asp-net-core/">bearer token authentication in ASP.NET Core</a>, I mentioned that there are a couple good third-party libraries for issuing JWT bearer tokens in .NET Core. In that post, I used <a href="https://github.com/openiddict/openiddict-core">OpenIddict</a> to demonstrate how end-to-end token issuance can work in an ASP.NET Core application.</p> 
       <p>Since that post was published, I’ve had some requests to also show how a similar result can be achieved with the other third-party authentication library available for .NET Core: <a href="https://github.com/IdentityServer/IdentityServer4">IdentityServer4</a>. So, in this post, I’m revisiting the question of how to issue tokens in ASP.NET Core apps and, this time, I’ll use IdentityServer4 in the sample code.</p> 
       <p>As before, I think it’s worth mentioning that there are a lot of good options available for authentication in ASP.NET Core. <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-authentication-scenarios/">Azure Active Directory Authentication</a> is an easy way to get authentication as a service. If you would prefer to own the authentication process yourself, I’ve used and had success with both <a href="https://github.com/openiddict/openiddict-core">OpenIddict</a> and <a href="https://github.com/IdentityServer/IdentityServer4">IdentityServer4</a>.</p> 
       <p>Bear in mind that both IdentityServer4 and OpenIddict are third-party libraries, so they are maintained and supported by community members – not by Microsoft.</p> 
       <h2><a href="https://github.com/mjrousos/dotnet-blog/blob/8ca299572fed7d8b63ccfd311e48ddec9c051e2a/2016/11-Nov/IdentityServer4Authentication/post.md#the-scenario" id="user-content-the-scenario" class="anchor"></a>The Scenario</h2> 
       <p>As you may remember from <a href="https://blogs.msdn.microsoft.com/webdev/2016/10/27/bearer-token-authentication-in-asp-net-core/">last time</a>, the goal of this scenario is to setup an authentication server which will allow users to sign in (via <a href="https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity">ASP.NET Core Identity</a>) and provides a JWT bearer token that can be used to access protected resources from a SPA or mobile app.</p> 
       <p>In this scenario, all the components are owned by the same developer and trusted, so an <a href="https://tools.ietf.org/html/rfc6749#section-1.3.3">OAuth 2.0 resource owner password flow</a> is acceptable (and is used here because it’s simple to use in a demonstration). Be aware that this model exposes user credentials and access tokens (both of which are sensitive and could be used to impersonate a user) to the client. In more complex scenarios (especially if clients shouldn’t be trusted with user credentials or access tokens), OpenID Connect flows such as <a href="https://openid.net/specs/openid-connect-core-1_0.html#ImplicitFlowAuth">implicit</a> or <a href="https://openid.net/specs/openid-connect-core-1_0.html#HybridFlowAuth">hybrid</a> flows are preferable. IdentityServer4 and OpenIddict both support those scenarios. One of IdentityServer4’s maintainers (Dominick Baier) has a good blog post on <a href="https://leastprivilege.com/2016/01/17/which-openid-connectoauth-2-o-flow-is-the-right-one/">when different flows should be used</a> and IdentityServer4 quickstarts include <a href="http://docs.identityserver.io/en/release/quickstarts/3_interactive_login.html">a sample of using the implicit flow</a>.</p> 
       <p>As we walk through this scenario, I’d also encourage you to check out <a href="https://identityserver4.readthedocs.io/en/release/">IdentityServer4 documentation</a>, as it gives more detail than I can fit into this (relatively) short post.</p> 
       <h2><a href="https://github.com/mjrousos/dotnet-blog/blob/8ca299572fed7d8b63ccfd311e48ddec9c051e2a/2016/11-Nov/IdentityServer4Authentication/post.md#getting-started" id="user-content-getting-started" class="anchor"></a>Getting Started</h2> 
       <p>As before, my first step is to create a new ASP.NET Core web app from the ‘web application’ template, making sure to select “Individual User Accounts” authentication. This will create an app that uses ASP.NET Core Identity to manage users. An Entity Framework Core context will be auto-generated to manage identity storage. The connection string in appsettings.json points to the database where this data will be stored.</p> 
       <p>Because it’s interesting to understand how IdentityServer4 includes role and claim information in its tokens, I also seed the database with a couple roles and add a custom property (<code>OfficeNumber</code>) to my <code>ApplicationUser</code> type which can be used as a custom claim later.</p> 
       <p>These initial steps of setting up an ASP.NET Core application with identity are identical to what I did in my previously with OpenIddict, so I won’t go into great detail here. If you would like this setup explained further, please see <a href="https://blogs.msdn.microsoft.com/webdev/2016/10/27/bearer-token-authentication-in-asp-net-core/">my previous post</a>.</p> 
       <h2><a href="https://github.com/mjrousos/dotnet-blog/blob/8ca299572fed7d8b63ccfd311e48ddec9c051e2a/2016/11-Nov/IdentityServer4Authentication/post.md#adding-identityserver4" id="user-content-adding-identityserver4" class="anchor"></a>Adding IdentityServer4</h2> 
       <p>Now that our base ASP.NET Core application is up and running (with Identity services), we’re ready to add IdentityServer4 support.</p> 
       <ol> 
        <li>Add <code>"IdentityServer4": "1.0.2"</code> as a dependency in the app’s project.json file.</li> 
        <li>Add IdentityServer4 to the HTTP request processing pipeline with a call to <code>app.UseIdentityServer()</code> in the app’s <code>Startup.Configure</code> method. 
         <ol> 
          <li>It’s important that the <code>UseIdentityServer()</code> call come after registering ASP.NET Core Identity (<code>app.UseIdentity()</code>).</li> 
         </ol> </li> 
        <li>Register IdentityServer4 services in the <code>Startup.ConfigureServices</code> method by calling <code>services.AddIdentityServer()</code>.</li> 
       </ol> 
       <p>We’ll also want to specify how IdentityServer4 should sign tokens. During development, an auto-generated certificate can be used to sign tokens by calling <code>AddTemporarySigningCredential</code> after the call to <code>AddIdentityServer</code> in <code>Startup.ConfigureServices</code>. Eventually, we’ll want to use a real cert for signing, though. We can sign with an x509 certificate by calling <code>AddSigningCredential</code>:</p> 
       <div class="highlight highlight-source-cs"> 
        <pre>services.AddIdentityServer()
  <span class="pl-c">// .AddTemporarySigningCredential() // Can be used for testing until a real cert is available</span>
  .AddSigningCredential(<span class="pl-k">new</span> X509Certificate2(Path.Combine(<span class="pl-s"><span class="pl-pds">"</span>.<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>certs<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>IdentityServer4Auth.pfx<span class="pl-pds">"</span></span>)))</pre> 
       </div> 
       <p>Note that you should not load the certificate from the app path in production; there are other <code>AddSigningCredential</code> overloads that can be used to load the certificate from the machine’s certificate store.</p> 
       <p>As mentioned in <a href="https://blogs.msdn.microsoft.com/webdev/2016/10/27/bearer-token-authentication-in-asp-net-core/">my previous post</a>, it’s possible to create self-signed certificates for testing this out with the <code>makecert</code> and <code>pvk2pfx</code> command line tools (which should be on the path in a Visual Studio Developer Command prompt).</p> 
       <ul> 
        <li><code>makecert -n "CN=AuthSample" -a sha256 -sv IdentityServer4Auth.pvk -r IdentityServer4Auth.cer</code> 
         <ul> 
          <li>This will create a new self-signed test certificate with its public key in IdentityServer4Auth.cer and it’s private key in IdentityServer4Auth.pvk.</li> 
         </ul> </li> 
        <li><code>pvk2pfx -pvk IdentityServer4Auth.pvk -spc IdentityServer4Auth.cer -pfx IdentityServer4Auth.pfx</code> 
         <ul> 
          <li>This will combine the pvk and cer files into a single pfx file containing both the public and private keys for the certificate. Our app will use the private key from the pfx to sign tokens. <strong>Make sure to protect this file</strong>. The .cer file can be shared with other services for the purpose of signature validation.</li> 
         </ul> </li> 
       </ul> 
       <p>Token issuance from IdentityServer4 won’t yet be functional, but this is the skeleton of how IdentityServer4 is connected to our ASP.NET Core app.</p> 
       <h3><a href="https://github.com/mjrousos/dotnet-blog/blob/8ca299572fed7d8b63ccfd311e48ddec9c051e2a/2016/11-Nov/IdentityServer4Authentication/post.md#configuring-identityserver4" id="user-content-configuring-identityserver4" class="anchor"></a>Configuring IdentityServer4</h3> 
       <p>Before IdentityServer4 will function, it must be configured. This configuration (which is done in <code>ConfigureServices</code>) allows us to specify how users are managed, what clients will be connecting, and what resources/scopes IdentityServer4 is protecting.</p> 
       <h4><a href="https://github.com/mjrousos/dotnet-blog/blob/8ca299572fed7d8b63ccfd311e48ddec9c051e2a/2016/11-Nov/IdentityServer4Authentication/post.md#specify-protected-resources" id="user-content-specify-protected-resources" class="anchor"></a>Specify protected resources</h4> 
       <p>IdentityServer4 must know what scopes can be requested by users. These are defined as <a href="http://docs.identityserver.io/en/release/configuration/resources.html">resources</a>. IdentityServer4 has two kinds of resources:</p> 
       <ul> 
        <li>API resources represent some protected data or functionality which a user might gain access to with an access token. An example of an API resource would be a web API (or set of APIs) that require authorization to call.</li> 
        <li>Identity resources represent information (claims) which are given to a client to identify a user. This could include their name, email address, or other claims. Identity information is returned in an ID token by OpenID Connect flows. In our simple sample, we’re using an OAuth 2.0 flow (the password resource flow), so we won’t be using identity resources.</li> 
       </ul> 
       <p>The simplest way to specify resources is to use the <code>AddInMemoryApiResources</code> and <code>AddInMemoryIdentityResources</code> extension methods to pass a list of resources. In our sample, we do that by updating our <code>services.AddIdentityServer()</code> call to read as follows:</p> 
       <div class="highlight highlight-source-cs"> 
        <pre>services.AddIdentityServer()
  <span class="pl-c">// .AddTemporarySigningCredential() // Can be used for testing until a real cert is available</span>
  .AddSigningCredential(<span class="pl-k">new</span> X509Certificate2(Path.Combine(<span class="pl-s"><span class="pl-pds">"</span>.<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>certs<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>IdentityServer4Auth.pfx<span class="pl-pds">"</span></span>)))
  .AddInMemoryApiResources(MyApiResourceProvider.GetAllResources()); <span class="pl-c">// &lt;- THE NEW LINE </span></pre> 
       </div> 
       <p>The <code>MyApiResourceProvider.GetAllResources()</code> method just returns an <code>IEnumerable</code> of ApiResources.</p> 
       <div class="highlight highlight-source-cs"> 
        <pre><span class="pl-k">return</span> <span class="pl-k">new</span>[]
{
    <span class="pl-c">// Add a resource for some set of APIs that we may be protecting</span>
    <span class="pl-c">// Note that the constructor will automatically create an allowed scope with</span>
    <span class="pl-c">// name and claims equal to the resource's name and claims. If the resource</span>
    <span class="pl-c">// has different scopes/levels of access, the scopes property can be set to</span>
    <span class="pl-c">// list specific scopes included in this resource, instead.</span>
    <span class="pl-k">new</span> ApiResource(
        <span class="pl-s"><span class="pl-pds">"</span>myAPIs<span class="pl-pds">"</span></span>,                                       <span class="pl-c">// Api resource name</span>
        <span class="pl-s"><span class="pl-pds">"</span>My API Set #1<span class="pl-pds">"</span></span>,                                <span class="pl-c">// Display name</span>
        <span class="pl-k">new</span>[] { JwtClaimTypes.Name, JwtClaimTypes.Role, <span class="pl-s"><span class="pl-pds">"</span>office<span class="pl-pds">"</span></span> }) <span class="pl-c">// Claims to be included in access token</span>
};</pre> 
       </div> 
       <p>If we also needed identity resources, they could be added with a similar call to <code>AddInMemoryIdentityResources</code>.</p> 
       <p>If more flexibility is needed in specifying resources, this can be accomplished by registering a custom <code>IResourceStore</code> with ASP.NET Core’s dependency injection. An <code>IResourceStore</code> allows for finer control over how resources are created, allowing a developer to read resource information from an external data source, for example. An <code>IResourceStore</code> which works with EntityFramework.Core (<code>IdentityServer4.EntityFramework.Stores.ResourceStore</code>) is available in the IdentityServer4.EntityFramework package.</p> 
       <h4><a href="https://github.com/mjrousos/dotnet-blog/blob/8ca299572fed7d8b63ccfd311e48ddec9c051e2a/2016/11-Nov/IdentityServer4Authentication/post.md#specify-clients" id="user-content-specify-clients" class="anchor"></a>Specify Clients</h4> 
       <p>In addition to specifying protected resources, IdentityServer4 must be configured with a list of clients that will be requesting tokens. Like configuring resources, client configuration can be done with an extension method: <code>AddInMemoryClients</code>. Also like configuring resources, it’s possible to have more control over the client configuration by implementing our own <code>IClientStore</code>. In this sample, a simple call to <code>AddInMemoryClients</code> would suffice to configure clients, but I opted to use an <code>IClientStore</code> to demonstrate how easy it is to extend IdentityServer4 in this way. This would be a useful approach if, for example, client information was read from an external database. And, as with <code>IResourceStore</code>, you can find a ready-made <code>IClientStore</code> implementation for working with EntityFramework.Core in the IdentityServer4.EntityFramework package.</p> 
       <p>The <code>IClientStore</code> interface only has a single method (<code>FindClientByIdAsync</code>) which is used to look up clients given a client ID. The returned object (of type <code>Client</code>) contains, <a href="http://docs.identityserver.io/en/release/reference/client.html">among other things</a>, information about the client’s name, allowed grant types and scopes, token lifetimes, and the client secret (if it has one).</p> 
       <p>In my sample, I added the following <code>IClientStore</code> implementation which will yield a single client configured to use the resource owner password flow and our custom ‘myAPIs’ resource:</p> 
       <div class="highlight highlight-source-cs"> 
        <pre><span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">CustomClientStore</span> : <span class="pl-k">IClientStore</span>
{
    <span class="pl-k">public</span> <span class="pl-k">static</span> IEnumerable&lt;Client&gt; <span class="pl-en">AllClients</span> { <span class="pl-k">get</span>; } = <span class="pl-k">new</span>[]
    {
        <span class="pl-k">new</span> Client
        {
            ClientId = <span class="pl-s"><span class="pl-pds">"</span>myClient<span class="pl-pds">"</span></span>,
            ClientName = <span class="pl-s"><span class="pl-pds">"</span>My Custom Client<span class="pl-pds">"</span></span>,
            AccessTokenLifetime = <span class="pl-c1">60</span> * <span class="pl-c1">60</span> * <span class="pl-c1">24</span>,
            AllowedGrantTypes = GrantTypes.ResourceOwnerPassword,
            RequireClientSecret = <span class="pl-c1">false</span>,
            AllowedScopes = 
            {
                <span class="pl-s"><span class="pl-pds">"</span>myAPIs<span class="pl-pds">"</span></span>
            }
        }
    };

    <span class="pl-k">public</span> Task&lt;Client&gt; <span class="pl-en">FindClientByIdAsync</span>(<span class="pl-k">string</span> <span class="pl-smi">clientId</span>)
    {
        <span class="pl-k">return</span> Task.FromResult(AllClients.FirstOrDefault(c =&gt; c.ClientId == clientId));
    }
}</pre> 
       </div> 
       <p>I then registered the store with ASP.NET Core dependency injection (<code>services.AddSingleton&lt;IClientStore, CustomClientStore&gt;()</code> in <code>Startup.ConfigureServices</code>).</p> 
       <h4><a href="https://github.com/mjrousos/dotnet-blog/blob/8ca299572fed7d8b63ccfd311e48ddec9c051e2a/2016/11-Nov/IdentityServer4Authentication/post.md#connecting-identityserver4-and-aspnet-core-identity" id="user-content-connecting-identityserver4-and-aspnet-core-identity" class="anchor"></a>Connecting IdentityServer4 and ASP.NET Core Identity</h4> 
       <p>To use ASP.NET Core Identity, we’ll be using the <code>IdentityServer4.AspNetIdentity</code> package. After adding this package to our project.json, the previous <code>app.AddIdentityServer()</code> call in <code>Startup.ConfigureServices</code> can be updated to look like this:</p> 
       <div class="highlight highlight-source-cs"> 
        <pre>services.AddIdentityServer()
  <span class="pl-c">// .AddTemporarySigningCredential() // Can be used for testing until a real cert is available</span>
  .AddSigningCredential(<span class="pl-k">new</span> X509Certificate2(Path.Combine(<span class="pl-s"><span class="pl-pds">"</span>.<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>certs<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>IdentityServer4Auth.pfx<span class="pl-pds">"</span></span>)))
  .AddInMemoryApiResources(MyApiResourceProvider.GetAllResources())
  .AddAspNetIdentity&lt;ApplicationUser&gt;(); <span class="pl-c">// &lt;- THE NEW LINE</span></pre> 
       </div> 
       <p>This will cause IdentityServer4 to get user profile information from our ASP.NET Core Identity context, and will automatically setup the necessary <code>IResourceOwnerPasswordValidator</code> for validating credentials. It will also configure IdentityServer4 to correctly extract JWT subject, user name, and role claims from ASP.NET Core Identity entities.</p> 
       <h2><a href="https://github.com/mjrousos/dotnet-blog/blob/8ca299572fed7d8b63ccfd311e48ddec9c051e2a/2016/11-Nov/IdentityServer4Authentication/post.md#putting-it-together" id="user-content-putting-it-together" class="anchor"></a>Putting it Together</h2> 
       <p>With configuration done, IdentityServer4 should now work to serve tokens for the client we defined. The registering of IdentityServer4 services in <code>Startup.ConfigureServices</code> ends up looking like this all together:</p> 
       <div class="highlight highlight-source-cs"> 
        <pre><span class="pl-c">// Add IdentityServer services</span>
services.AddSingleton&lt;IClientStore, CustomClientStore&gt;();

services.AddIdentityServer()
    <span class="pl-c">// .AddTemporarySigningCredential() // Can be used for testing until a real cert is available</span>
    .AddSigningCredential(<span class="pl-k">new</span> X509Certificate2(Path.Combine(<span class="pl-s"><span class="pl-pds">"</span>.<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>certs<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>IdentityServer4Auth.pfx<span class="pl-pds">"</span></span>)))
    .AddInMemoryApiResources(MyApiResourceProvider.GetAllResources())
    .AddAspNetIdentity&lt;ApplicationUser&gt;();</pre> 
       </div> 
       <p>As before, a tool like <a href="https://www.getpostman.com/">Postman</a> can be used to test out the app. The scope we specify in the request should be our custom API resource scope (‘myAPIs’).</p> 
       <p>Here is a sample token request:</p> 
       <pre><code>POST /connect/token HTTP/1.1
Host: localhost:5000
Cache-Control: no-cache
Postman-Token: 958df72b-663c-5638-052a-aed41ba0dbd1
Content-Type: application/x-www-form-urlencoded

grant_type=password&amp;username=Mike%40Contoso.com&amp;password=MikesPassword1!&amp;client_id=myClient&amp;scope=myAPIs
</code></pre> 
       <p>The returned access token in our app’s response (which can be decoded using <a href="http://jwt.calebb.net/">online utilities</a>) looks like this:</p> 
       <div class="highlight highlight-source-json"> 
        <pre>{
 <span class="pl-ii">alg</span>: <span class="pl-s"><span class="pl-pds">"</span>RS256<span class="pl-pds">"</span></span>,
 <span class="pl-ii">kid</span>: <span class="pl-s"><span class="pl-pds">"</span>671A47CE65E10A98BB86EDCD5F9684E9D048FAE9<span class="pl-pds">"</span></span>,
 <span class="pl-ii">typ</span>: <span class="pl-s"><span class="pl-pds">"</span>JWT<span class="pl-pds">"</span></span>,
 <span class="pl-ii">x5t</span>: <span class="pl-s"><span class="pl-pds">"</span>ZxpHzmXhCpi7hu3NX5aE6dBI-uk<span class="pl-pds">"</span></span>
}.
{
 <span class="pl-ii">nbf</span>: <span class="pl-c1">1481054282</span>,
 <span class="pl-ii">exp</span>: <span class="pl-c1">1481140682</span>,
 <span class="pl-ii">iss</span>: <span class="pl-s"><span class="pl-pds">"</span>http://localhost:5000<span class="pl-pds">"</span></span>,
 <span class="pl-ii">aud</span>: [
  <span class="pl-s"><span class="pl-pds">"</span>http://localhost:5000/resources<span class="pl-pds">"</span></span>,
  <span class="pl-s"><span class="pl-pds">"</span>myAPIs<span class="pl-pds">"</span></span>
 ],
 <span class="pl-ii">client_id</span>: <span class="pl-s"><span class="pl-pds">"</span>myClient<span class="pl-pds">"</span></span>,
 <span class="pl-ii">sub</span>: <span class="pl-s"><span class="pl-pds">"</span>f6435683-f81c-4bd4-9c14-c7c09b236f4e<span class="pl-pds">"</span></span>,
 <span class="pl-ii">auth_time</span>: <span class="pl-c1">1481054281</span>,
 <span class="pl-ii">idp</span>: <span class="pl-s"><span class="pl-pds">"</span>local<span class="pl-pds">"</span></span>,
 <span class="pl-ii">name</span>: <span class="pl-s"><span class="pl-pds">"</span>Mike@Contoso.com<span class="pl-pds">"</span></span>,
 <span class="pl-ii">role</span>: <span class="pl-s"><span class="pl-pds">"</span>Administrator<span class="pl-pds">"</span></span>,
 <span class="pl-ii">office</span>: <span class="pl-s"><span class="pl-pds">"</span>300<span class="pl-pds">"</span></span>,
 <span class="pl-ii">scope</span>: [
  <span class="pl-s"><span class="pl-pds">"</span>myAPIs<span class="pl-pds">"</span></span>
 ],
 <span class="pl-ii">amr</span>: [
  <span class="pl-s"><span class="pl-pds">"</span>pwd<span class="pl-pds">"</span></span>
 ]
}.
[<span class="pl-ii">signature</span>]</pre> 
       </div> 
       <p>You can read more details about how to understand the JWT fields in <a href="https://blogs.msdn.microsoft.com/webdev/2016/10/27/bearer-token-authentication-in-asp-net-core/">my previous post</a>. Note that there are a few small differences between the tokens generated with OpenIddict and those generated with IdentityServer4.</p> 
       <ul> 
        <li>IdentityServer4 includes the amr (authentication method references) field which lists authentication methods used.</li> 
        <li>IdentityServer4 always requires a client be specified in token requests, so it will always have a client_id in the response whereas OpenIddict treats the client as optional for some OAuth 2.0 flows.</li> 
        <li>IdentityServer4 does not include the optional <a href="https://tools.ietf.org/html/rfc7519#section-4.1.6">iat</a> field indicating when the access token was issued, but does include the auth_time field (<a href="https://openid.net/specs/openid-connect-core-1_0.html#IDToken">defined by OpenID Connect</a> as an optional field for OAuth 2.0 flows) which will have the same value.</li> 
       </ul> 
       <p>In both cases, it’s possible to customize claims that are returned for given resources/scopes, so developers can make sure claims important to their scenarios are included.</p> 
       <h2><a href="https://github.com/mjrousos/dotnet-blog/blob/8ca299572fed7d8b63ccfd311e48ddec9c051e2a/2016/11-Nov/IdentityServer4Authentication/post.md#conclusion" id="user-content-conclusion" class="anchor"></a>Conclusion</h2> 
       <p>Hopefully this walkthrough of a simple IdentityServer4 scenario is useful for understanding how that package can be used to enable authentication token issuance in ASP.NET Core. Please be sure to check out the <a href="http://docs.identityserver.io/en/release/">IdentityServer4 docs</a> for more complete documentation. As IdentityServer4 is not a Microsoft-owned library, support questions or issue reports should be directed to <a href="https://identityserver.io/">IdentityServer</a> or <a href="https://github.com/IdentityServer/IdentityServer4">the IdentityServer4 GitHub repository</a>.</p> 
       <p>The scenario implemented here is no different from what was covered <a href="https://blogs.msdn.microsoft.com/webdev/2016/10/27/bearer-token-authentication-in-asp-net-core/">previously</a>, but serves as an example of how different community-driven libraries can work to solve a given problem. One of the most exciting aspects of .NET Core is the tremendous community involvement we’ve seen in producing high-quality libraries to extend what can be done with .NET Core and ASP.NET Core. I think token-based authentication is a great example of that.</p> 
       <p>I have checked in <a href="https://github.com/mjrousos/IdentityServer4Authentication">sample code</a> that shows the end product of the walk-through in this blog. Reviewing that repository may be helpful in clarifying any remaining questions.</p> 
       <h2><a href="https://github.com/mjrousos/dotnet-blog/blob/8ca299572fed7d8b63ccfd311e48ddec9c051e2a/2016/11-Nov/IdentityServer4Authentication/post.md#resources" id="user-content-resources" class="anchor"></a>Resources</h2> 
       <ul> 
        <li><a href="https://github.com/IdentityServer/IdentityServer4">IdentityServer4 project site</a></li> 
        <li><a href="https://www.nuget.org/packages/IdentityServer4/1.0.2">IdentityServer4 library (NuGet)</a></li> 
        <li><a href="https://identityserver4.readthedocs.io/en/release/">IdentityServer4 documentation</a></li> 
        <li><a href="https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity">ASP.NET Core Identity</a></li> 
        <li><a href="https://blogs.msdn.microsoft.com/webdev/2016/10/27/bearer-token-authentication-in-asp-net-core/">Previous blog post on ASP.NET Core token-based authentication</a></li> 
        <li><a href="https://openid.net/specs/openid-connect-core-1_0.html">OpenID Connect spec</a></li> 
        <li><a href="https://tools.ietf.org/html/rfc6749">OAuth 2.0 spec</a></li> 
        <li><a href="https://leastprivilege.com/2016/01/17/which-openid-connectoauth-2-o-flow-is-the-right-one/">Choosing the right connection flow</a></li> 
        <li><a href="https://tools.ietf.org/html/rfc7519">JSON Web Token (JWT) spec)</a></li> 
        <li><a href="https://www.getpostman.com/">Postman</a></li> 
        <li><a href="http://jwt.calebb.net/">Online JWT decoder</a></li> 
        <li><a href="https://github.com/mjrousos/IdentityServer4Authentication">Sample code from this article</a></li> 
       </ul> 
       <div class="back-to-top-wrap">
        <a href="#top-link" class="back-to-top">Back to<br>top</a>
       </div> 
      </div>
      <!-- .entry-content --> 
     </article>
     <!-- #post-## --> 
    </main>
    <!-- #main --> 
   </div>
   <!-- #primary --> 
   <div id="secondary" class="widget-area" role="complementary"> 
    <aside id="msdn_bing_social_search-5" class="widget msdn_bing_social_search"> 
     <div class="-widget-msdn-blogs-social-search msdn-blogs-social-search"> 
      <div class="field-item search"> 
       <form id="-widget-search-allblogs-container"> 
        <span class="field-item-input"> <input id="-widget-search-textbox-allblogs" name="search-textbox-allblogs" type="search" class="search-field" maxlength="64" size="45" autocomplete="off" title=""> <input id="-widget-search-button-allblogs" name="search-button-allblogs" type="submit" class="search-submit" title=""> </span> 
       </form> 
       <form id="-widget-search-thisblog-container"> 
        <span class="field-item-input"> <input id="-widget-search-textbox-thisblog" name="search-textbox-thisblog" type="search" class="search-field" maxlength="64" size="45" autocomplete="off" title="Search this blog with Bing"> <button id="-widget-search-button-thisblog" name="search-button-thisblog" type="submit" class="search-submit search-icon" title="Search this blog with Bing"></button> </span> 
       </form> 
      </div> 
      <div class="bing-social-search-option"> 
       <span class="bing-social-search-thisblog"> <input type="radio" name="SearchTypeRadio" value="thisblog" id="-widget-thisblog"><label for="-widget-thisblog" id="-widget-thisblog-text">Search this blog</label></span> 
       <span class="bing-social-search-allblogs"> <input type="radio" name="SearchTypeRadio" value="allblogs" id="-widget-allblogs" checked><label for="-widget-allblogs" id="-widget-allblogs-text">Search all blogs</label></span> 
      </div> 
      <script type="text/javascript">
			jQuery(document).ready(function( $ ) {
				var $elmSearchAll = $('#-widget-search-allblogs-container').hide();
				var $elmSearchThis = $('#-widget-search-thisblog-container');

				// try to get the blog id, if we fail, then we aren't on a blog and just use the regular search approach

					$('#-widget-thisblog').click(function () {
						var self = $(this);
						if (self.is(':checked')) {
							$elmSearchAll.hide();
							$elmSearchThis.show();
						}
					});

					$('#-widget-allblogs').click(function () {
						var self = $(this);
						if (self.is(':checked')) {
							$elmSearchThis.hide();
							$elmSearchAll.show();
						}
					});
			});
			</script> 
      <script type="text/javascript">window.$ = window.jQuery;</script> 
      <script src="https://i4.services.social.microsoft.com/Search/Widgets/SearchBox.jss?boxid=-widget-search-textbox-allblogs&amp;btnid=-widget-search-button-allblogs&amp;brand=msdn&amp;refinement=109&amp;resref&amp;addEnglish&amp;watermark&amp;focusOnInit=false&amp;beta=0&amp;iroot&amp;overrideWatermark=false&amp;rn&amp;rq" type="text/javascript" language="javascript"></script> 
      <script src="https://i4.services.social.microsoft.com/Search/Widgets/SearchBox.jss?boxid=-widget-search-textbox-thisblog&amp;btnid=-widget-search-button-thisblog&amp;brand=msdn&amp;refinement&amp;resref&amp;addEnglish&amp;watermark&amp;focusOnInit=false&amp;beta=0&amp;iroot&amp;overrideWatermark=false&amp;rn=.NET%2BWeb%2BDevelopment%2Band%2BTools%2BBlog&amp;rq=site%3Ahttps%3A%2F%2Fblogs.msdn.microsoft.com%2Fwebdev" type="text/javascript" language="javascript"></script> 
     </div> 
    </aside>
    <aside id="text-6" class="widget widget_text">
     <h2 class="widget-title color-highlight-bg">ASP.NET Resources</h2> 
     <div class="textwidget">
      <ul class="widget-link-list"> 
       <li> <a href="http://www.asp.net">www.ASP.Net</a> </li> 
       <li> <a href="http://www.asp.net/forums">ASP.NET Forums</a> </li> 
       <li> <a href="http://webdevchecklist.com/asp.net">Web Developer Checklist</a> </li> 
       <li> <a href="http://aspnet.uservoice.com/">ASP.NET User Voice</a> </li> 
       <li> <a href="http://blogs.msdn.com/b/dotnet/p/dotnetusergroups.aspx">.NET Meetups</a> </li> 
      </ul> 
     </div> 
    </aside>
    <aside id="text-8" class="widget widget_text">
     <h2 class="widget-title color-highlight-bg">Related Blogs</h2> 
     <div class="textwidget">
      <ul class="widget-link-list"> 
       <li> <a href="http://weblogs.asp.net/scottgu/">Scott Guthrie's Blog</a> </li> 
       <li> <a href="http://www.hanselman.com/blog/">Scott Hanselman's Blog</a> </li> 
       <li> <a href="http://www.sedodream.com/">Sayed Hashimi's Blog</a> </li> 
       <li> <a href="http://weblogs.asp.net/jgalloway/">Jon Galloway's blog</a> </li> 
       <li> <a href="http://madskristensen.net/">Mads Kristensen's blog</a> </li> 
       <li> <a href="http://blogs.msdn.com/adonet">Entity Framework Team blog</a> </li> 
       <li> <a href="http://www.bradygaster.com/">Brady Gaster's Blog</a> </li> 
       <li> <a href="http://blog.nuget.org">NuGet Team Blog</a> </li> 
       <li> <a href="http://www.jeffreyfritz.com">Jeff Fritz's Blog</a> </li> 
       <li> <a href="http://cloudidentity.com">Vittorio Bertocci's Blog</a> </li> 
      </ul> 
     </div> 
    </aside>
    <aside id="pages-3" class="widget widget_pages">
     <h2 class="widget-title color-highlight-bg">Pages</h2> 
     <ul> 
      <li class="page_item page-item-6011"><a href="https://blogs.msdn.microsoft.com/webdev/jobs/">We are Hiring</a></li> 
     </ul> 
    </aside> 
    <aside id="recent-posts-3" class="widget widget_recent_entries"> 
     <h2 class="widget-title color-highlight-bg">Recent Posts</h2> 
     <ul> 
      <li> <a href="https://blogs.msdn.microsoft.com/webdev/2017/09/14/announcing-signalr-for-asp-net-core-2-0/">Announcing SignalR (alpha) for ASP.NET Core 2.0</a> <span class="post-date">September 14, 2017</span> </li> 
      <li> <a href="https://blogs.msdn.microsoft.com/webdev/2017/09/08/welcome-to-the-new-blog-template-for-asp-net-developers/">Welcome to the New Blog Template for ASP.NET Developers</a> <span class="post-date">September 8, 2017</span> </li> 
      <li> <a href="https://blogs.msdn.microsoft.com/webdev/2017/09/07/getting-started-with-windows-containers/">Getting Started with Windows Containers</a> <span class="post-date">September 7, 2017</span> </li> 
      <li> <a href="https://blogs.msdn.microsoft.com/webdev/2017/08/25/asp-net-core-2-0-features-1/">ASP.NET Core 2.0 Features</a> <span class="post-date">August 25, 2017</span> </li> 
     </ul> 
    </aside> 
    <aside id="rss-3" class="widget widget_rss">
     <h2 class="widget-title color-highlight-bg"><a class="rsswidget" href="http://sxp.microsoft.com/feeds/3.0/devblogs"><img class="rss-widget-icon" style="border:0" width="14" height="14" src="https://blogs.msdn.microsoft.com/webdev/wp-includes/images/rss.png" alt="RSS"></a> <a class="rsswidget" href="https://blogs.technet.microsoft.com/cloudplatform">Live Now on Developer Tools Blogs</a></h2>
     <ul>
      <li><a class="rsswidget" href="https://azure.microsoft.com/blog/embed-stunning-visuals-into-your-apps-with-power-bi-embedded-generally-available/">Embed Stunning Visuals into your Apps with Power BI Embedded- Generally Available</a></li>
      <li><a class="rsswidget" href="https://azure.microsoft.com/blog/microsoft-azure-allies-with-nearform-for-node-js-developer-migration-and-support-services/">Microsoft Azure allies with nearForm for Node.js Developer Migration and Support Services</a></li>
      <li><a class="rsswidget" href="https://azure.microsoft.com/blog/securing-the-intelligent-edge/">Securing the Intelligent Edge</a></li>
     </ul>
    </aside>
    <aside id="tag_cloud-3" class="widget widget_tag_cloud">
     <h2 class="widget-title color-highlight-bg">Tags</h2>
     <div class="tagcloud">
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/net/" class="tag-link-14 tag-link-position-1" title="91 topics" style="font-size: 17.973451327434pt;">.NET</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/ajax/" class="tag-link-2244 tag-link-position-2" title="24 topics" style="font-size: 11.530973451327pt;">AJAX</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/announcement/" class="tag-link-34 tag-link-position-3" title="48 topics" style="font-size: 14.867256637168pt;">Announcement</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/announcements/" class="tag-link-224 tag-link-position-4" title="106 topics" style="font-size: 18.778761061947pt;">Announcements</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/asp-net/" class="tag-link-104 tag-link-position-5" title="202 topics" style="font-size: 22pt;">ASP.NET</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/asp-net-5/" class="tag-link-64 tag-link-position-6" title="18 topics" style="font-size: 10.150442477876pt;">ASP.NET 5</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/asp-net-mvc/" class="tag-link-114 tag-link-position-7" title="32 topics" style="font-size: 12.911504424779pt;">ASP.NET MVC</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/asp-net-mvc-framework/" class="tag-link-184 tag-link-position-8" title="25 topics" style="font-size: 11.646017699115pt;">ASP.NET MVC Framework</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/asp-net-vnext/" class="tag-link-44 tag-link-position-9" title="14 topics" style="font-size: 9pt;">ASP.NET vNext</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/asp-net-web-api/" class="tag-link-134 tag-link-position-10" title="32 topics" style="font-size: 12.911504424779pt;">ASP.NET Web Api</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/asp-net-webhooks/" class="tag-link-2951 tag-link-position-11" title="14 topics" style="font-size: 9pt;">ASP.NET WebHooks</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/communitystandup/" class="tag-link-2891 tag-link-position-12" title="43 topics" style="font-size: 14.29203539823pt;">CommunityStandup</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/css/" class="tag-link-1384 tag-link-position-13" title="19 topics" style="font-size: 10.380530973451pt;">CSS</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/css-and-html/" class="tag-link-944 tag-link-position-14" title="30 topics" style="font-size: 12.566371681416pt;">CSS and HTML</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/development/" class="tag-link-4 tag-link-position-15" title="62 topics" style="font-size: 16.132743362832pt;">Development</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/intellisense/" class="tag-link-1084 tag-link-position-16" title="24 topics" style="font-size: 11.530973451327pt;">IntelliSense</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/jeff-king/" class="tag-link-2254 tag-link-position-17" title="15 topics" style="font-size: 9.2300884955752pt;">Jeff King</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/jscript/" class="tag-link-1094 tag-link-position-18" title="26 topics" style="font-size: 11.87610619469pt;">JScript</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/mike-snow/" class="tag-link-2044 tag-link-position-19" title="18 topics" style="font-size: 10.150442477876pt;">Mike Snow</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/msdeploy/" class="tag-link-984 tag-link-position-20" title="17 topics" style="font-size: 9.9203539823009pt;">MSDeploy</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/msnow/" class="tag-link-2034 tag-link-position-21" title="19 topics" style="font-size: 10.380530973451pt;">msnow</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/mvc/" class="tag-link-24 tag-link-position-22" title="33 topics" style="font-size: 13.026548672566pt;">MVC</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/orcas/" class="tag-link-2174 tag-link-position-23" title="38 topics" style="font-size: 13.716814159292pt;">Orcas</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/publish/" class="tag-link-1134 tag-link-position-24" title="14 topics" style="font-size: 9pt;">publish</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/sayed-ibrahim-hashimi/" class="tag-link-964 tag-link-position-25" title="22 topics" style="font-size: 11.070796460177pt;">Sayed Ibrahim Hashimi</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/silverlight/" class="tag-link-2014 tag-link-position-26" title="36 topics" style="font-size: 13.486725663717pt;">Silverlight</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/silverlight-resources/" class="tag-link-2024 tag-link-position-27" title="19 topics" style="font-size: 10.380530973451pt;">silverlight resources</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/sp1/" class="tag-link-1714 tag-link-position-28" title="14 topics" style="font-size: 9pt;">SP1</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/tips-and-tricks/" class="tag-link-174 tag-link-position-29" title="38 topics" style="font-size: 13.716814159292pt;">tips and tricks</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/vishal-r-joshi/" class="tag-link-2344 tag-link-position-30" title="20 topics" style="font-size: 10.610619469027pt;">Vishal R. Joshi</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/visual-studio/" class="tag-link-524 tag-link-position-31" title="155 topics" style="font-size: 20.619469026549pt;">Visual Studio</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/visual-studio-2008/" class="tag-link-1944 tag-link-position-32" title="66 topics" style="font-size: 16.477876106195pt;">Visual Studio 2008</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/visual-studio-2008-sp1/" class="tag-link-2104 tag-link-position-33" title="29 topics" style="font-size: 12.451327433628pt;">visual Studio 2008 sp1</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/visual-studio-2010/" class="tag-link-1244 tag-link-position-34" title="79 topics" style="font-size: 17.283185840708pt;">Visual Studio 2010</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/visual-studio-2012/" class="tag-link-794 tag-link-position-35" title="16 topics" style="font-size: 9.5752212389381pt;">Visual Studio 2012</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/visual-studio-2013/" class="tag-link-304 tag-link-position-36" title="35 topics" style="font-size: 13.371681415929pt;">Visual Studio 2013</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/visual-web-developer/" class="tag-link-754 tag-link-position-37" title="67 topics" style="font-size: 16.477876106195pt;">Visual Web Developer</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/vs10/" class="tag-link-1784 tag-link-position-38" title="31 topics" style="font-size: 12.796460176991pt;">VS10</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/vs2008/" class="tag-link-1934 tag-link-position-39" title="44 topics" style="font-size: 14.407079646018pt;">VS2008</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/vwd/" class="tag-link-804 tag-link-position-40" title="112 topics" style="font-size: 19.008849557522pt;">VWD</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/wap/" class="tag-link-744 tag-link-position-41" title="25 topics" style="font-size: 11.646017699115pt;">WAP</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/web/" class="tag-link-394 tag-link-position-42" title="97 topics" style="font-size: 18.318584070796pt;">Web</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/web-2-0/" class="tag-link-2264 tag-link-position-43" title="38 topics" style="font-size: 13.716814159292pt;">Web 2.0</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/web-deployment/" class="tag-link-974 tag-link-position-44" title="40 topics" style="font-size: 13.946902654867pt;">Web Deployment</a> 
      <a href="https://blogs.msdn.microsoft.com/webdev/tag/web-development/" class="tag-link-404 tag-link-position-45" title="17 topics" style="font-size: 9.9203539823009pt;">Web Development</a>
     </div> 
    </aside>
    <aside id="text-9" class="widget widget_text">
     <h2 class="widget-title color-highlight-bg">Related Resources</h2> 
     <div class="textwidget">
      <ul class="widget-link-list"> 
       <li><a href="http://www.visualstudio.com">Visual Studio Product Website</a></li> 
       <li><a href="http://msdn.microsoft.com/vstudio">Visual Studio Developer Center</a></li> 
      </ul> 
     </div> 
    </aside>
    <aside id="msdn-archive-widget-3" class="widget msdn-archive-widget">
     <h2 class="widget-title color-highlight-bg">Archives</h2> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2017/09/">September 2017</a>&nbsp;(3)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2017/08/">August 2017</a>&nbsp;(2)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2017/07/">July 2017</a>&nbsp;(1)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2017/06/">June 2017</a>&nbsp;(2)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2017/05/">May 2017</a>&nbsp;(2)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2017/04/">April 2017</a>&nbsp;(6)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2017/03/">March 2017</a>&nbsp;(5)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2017/02/">February 2017</a>&nbsp;(7)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2017/01/">January 2017</a>&nbsp;(4)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2016/12/">December 2016</a>&nbsp;(6)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2017/">All of 2017</a>&nbsp;(32)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2016/">All of 2016</a>&nbsp;(75)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2015/">All of 2015</a>&nbsp;(53)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2014/">All of 2014</a>&nbsp;(77)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2013/">All of 2013</a>&nbsp;(103)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2012/">All of 2012</a>&nbsp;(70)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2011/">All of 2011</a>&nbsp;(18)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2010/">All of 2010</a>&nbsp;(53)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2009/">All of 2009</a>&nbsp;(58)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2008/">All of 2008</a>&nbsp;(78)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2007/">All of 2007</a>&nbsp;(48)</li> 
     <li><a href="https://blogs.msdn.microsoft.com/webdev/2006/">All of 2006</a>&nbsp;(30)</li> 
    </aside> 
   </div>
   <!-- #secondary --> 
   <div id="tag-wrap">
    <h2 class="color-highlight-bg">Tags</h2>
    <ul class="tag-list">
     <li><a href="https://blogs.msdn.microsoft.com/webdev/tag/asp-net-identity/">ASP.NET Identity</a></li>
     <li><a href="https://blogs.msdn.microsoft.com/webdev/tag/identityserver/">IdentityServer</a></li>
    </ul>
   </div> 
   <div id="comments" class="comments-area"> 
    <div class="comments-head"> 
     <h3 class="comments-title color-highlight-bg"> Join the conversation </h3> 
     <a href="#" class="add-comment-button button">Add Comment</a> 
    </div> 
    <div id="respond" class="comment-respond"> 
     <h3 id="reply-title" class="comment-reply-title"> <small><a rel="nofollow" id="cancel-comment-reply-link" href="/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/#respond" style="display:none;">Cancel</a></small></h3> 
     <form action="https://blogs.msdn.microsoft.com/webdev/wp-comments-post.php" method="post" id="commentform" class="comment-form"> 
      <p class="comment-form-comment"><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>
      <p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" value="" size="30" maxlength="245" aria-required="true" required></p> 
      <p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="text" value="" size="30" maxlength="100" aria-describedby="email-notes" aria-required="true" required></p> 
      <p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="text" value="" size="30" maxlength="200"></p> 
      <p class="form-submit"><input name="submit" type="submit" id="submit" class="submit btn btn-default" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="8945" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"> </p>
      <p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="1e201c6da4"></p>
      <p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="156"></p> 
     </form> 
    </div>
    <!-- #respond --> 
    <ol class="comment-list"> 
     <li id="comment-196295" class="comment even thread-even depth-1"> 
      <article id="div-comment-196295" class="comment-body"> 
       <footer class="comment-meta"> 
        <div class="comment-right"> 
         <time class="comment-time" datetime="2017-01-27T12:45:31+00:00"> 8 months ago </time> 
         <div class="comment-actions"> 
          <a rel="nofollow" class="comment-reply-link" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/?replytocom=196295#respond" onclick="return addComment.moveForm( &quot;div-comment-196295&quot;, &quot;196295&quot;, &quot;respond&quot;, &quot;8945&quot; )" aria-label="Reply to Greg">Reply</a> 
         </div> 
        </div> 
        <div class="comment-author vcard"> 
         <img alt="" src="https://secure.gravatar.com/avatar/338e3ed7065b73596340441b14d30216?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/338e3ed7065b73596340441b14d30216?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> 
         <div class="author-wrap"> 
          <span class="author-name">Greg</span> 
         </div> 
        </div>
        <!-- .comment-author --> 
       </footer>
       <!-- .comment-meta --> 
       <div class="comment-content"> 
        <p>Great read… do you have an example of the users &amp; roles not being in memory stores? I have claims in AspNetUserClaims as roles (type=”role”) and cannot see how to get these added to the token. I extended IProfileService but the GetDataProvileAsync method never gets called. I have a feeling this is related to scopes but can’t find an example that clearly illustrates how to set this up.</p> 
       </div>
       <!-- .comment-content --> 
       <div class="comment-metadata"> 
       </div>
       <!-- .comment-metadata --> 
      </article>
      <!-- .comment-body --> </li>
     <!-- #comment-## --> 
     <li id="comment-196455" class="comment odd alt thread-odd thread-alt depth-1 parent"> 
      <article id="div-comment-196455" class="comment-body"> 
       <footer class="comment-meta"> 
        <div class="comment-right"> 
         <time class="comment-time" datetime="2017-01-27T19:54:50+00:00"> 8 months ago </time> 
         <div class="comment-actions"> 
          <a rel="nofollow" class="comment-reply-link" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/?replytocom=196455#respond" onclick="return addComment.moveForm( &quot;div-comment-196455&quot;, &quot;196455&quot;, &quot;respond&quot;, &quot;8945&quot; )" aria-label="Reply to David Kirsch">Reply</a> 
         </div> 
        </div> 
        <div class="comment-author vcard"> 
         <img alt="" src="https://secure.gravatar.com/avatar/7e4463bedce74799954affda31510208?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/7e4463bedce74799954affda31510208?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> 
         <div class="author-wrap"> 
          <span class="author-name">David Kirsch</span> 
         </div> 
        </div>
        <!-- .comment-author --> 
       </footer>
       <!-- .comment-meta --> 
       <div class="comment-content"> 
        <p>Hey there, thanks for this article!<br> I think there is an error in it though…</p> 
        <p>Under Adding Identity Server 4, point 3 says this: Register IdentityServer4 services in the Startup.ConfigureServices method by calling app.AddIdentityServer(). </p> 
        <p>I think it should be “services.AddIdentityServer();”. “app” is in Configure(…), but not ConfigureServices(…).</p> 
        <p>Thanks again, I’ve been wanting to use this for a while, hoping this will finally get me up and running!</p> 
       </div>
       <!-- .comment-content --> 
       <div class="comment-metadata"> 
       </div>
       <!-- .comment-metadata --> 
      </article>
      <!-- .comment-body --> 
      <ul class="children"> 
       <li id="comment-198465" class="comment byuser comment-author-mike-rousos even depth-2"> 
        <article id="div-comment-198465" class="comment-body"> 
         <footer class="comment-meta"> 
          <div class="comment-right"> 
           <time class="comment-time" datetime="2017-02-01T19:56:23+00:00"> 8 months ago </time> 
           <div class="comment-actions"> 
            <a rel="nofollow" class="comment-reply-link" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/?replytocom=198465#respond" onclick="return addComment.moveForm( &quot;div-comment-198465&quot;, &quot;198465&quot;, &quot;respond&quot;, &quot;8945&quot; )" aria-label="Reply to Mike Rousos - MSFT">Reply</a> 
           </div> 
          </div> 
          <div class="comment-author vcard"> 
           <img alt="" src="https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Mike+Rousos+-+MSFT&amp;size=extralarge&amp;version=00000000-0000-0000-0000-000000000000" class="avatar avatar-40 photo" height="40" width="40"> 
           <div class="author-wrap"> 
            <span class="author-name"><a href="https://social.msdn.microsoft.com/profile/Mike+Rousos+-+MSFT" rel="external nofollow" class="url">Mike Rousos - MSFT</a></span> 
           </div> 
          </div>
          <!-- .comment-author --> 
         </footer>
         <!-- .comment-meta --> 
         <div class="comment-content"> 
          <p>Good catch, David. It should be services.AddIdentityServer() (rather than app.AddIdentityServer()). You can see it is called correctly in the code snippet. I’ll see about getting the post corrected.</p> 
         </div>
         <!-- .comment-content --> 
         <div class="comment-metadata"> 
         </div>
         <!-- .comment-metadata --> 
        </article>
        <!-- .comment-body --> </li>
       <!-- #comment-## --> 
      </ul>
      <!-- .children --> </li>
     <!-- #comment-## --> 
     <li id="comment-197625" class="comment odd alt thread-even depth-1 parent"> 
      <article id="div-comment-197625" class="comment-body"> 
       <footer class="comment-meta"> 
        <div class="comment-right"> 
         <time class="comment-time" datetime="2017-01-30T11:43:48+00:00"> 8 months ago </time> 
         <div class="comment-actions"> 
          <a rel="nofollow" class="comment-reply-link" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/?replytocom=197625#respond" onclick="return addComment.moveForm( &quot;div-comment-197625&quot;, &quot;197625&quot;, &quot;respond&quot;, &quot;8945&quot; )" aria-label="Reply to Greg">Reply</a> 
         </div> 
        </div> 
        <div class="comment-author vcard"> 
         <img alt="" src="https://secure.gravatar.com/avatar/338e3ed7065b73596340441b14d30216?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/338e3ed7065b73596340441b14d30216?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> 
         <div class="author-wrap"> 
          <span class="author-name">Greg</span> 
         </div> 
        </div>
        <!-- .comment-author --> 
       </footer>
       <!-- .comment-meta --> 
       <div class="comment-content"> 
        <p>Jeffrey – </p> 
        <p>Great read. I added a “ValuesController” with the [Authorize] attribute and only when I enter the URL (…/api/Values) do I get the values. When I enter using Postman for example with a Get command using an Authorization of “bearer [mytoken]” I always receive a 401 Unauthorized response – any thoughts?</p> 
        <p>Thanks!</p> 
       </div>
       <!-- .comment-content --> 
       <div class="comment-metadata"> 
       </div>
       <!-- .comment-metadata --> 
      </article>
      <!-- .comment-body --> 
      <ul class="children"> 
       <li id="comment-198446" class="comment byuser comment-author-mike-rousos even depth-2 parent"> 
        <article id="div-comment-198446" class="comment-body"> 
         <footer class="comment-meta"> 
          <div class="comment-right"> 
           <time class="comment-time" datetime="2017-02-01T19:50:50+00:00"> 8 months ago </time> 
           <div class="comment-actions"> 
            <a rel="nofollow" class="comment-reply-link" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/?replytocom=198446#respond" onclick="return addComment.moveForm( &quot;div-comment-198446&quot;, &quot;198446&quot;, &quot;respond&quot;, &quot;8945&quot; )" aria-label="Reply to Mike Rousos - MSFT">Reply</a> 
           </div> 
          </div> 
          <div class="comment-author vcard"> 
           <img alt="" src="https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Mike+Rousos+-+MSFT&amp;size=extralarge&amp;version=00000000-0000-0000-0000-000000000000" class="avatar avatar-40 photo" height="40" width="40"> 
           <div class="author-wrap"> 
            <span class="author-name"><a href="https://social.msdn.microsoft.com/profile/Mike+Rousos+-+MSFT" rel="external nofollow" class="url">Mike Rousos - MSFT</a></span> 
           </div> 
          </div>
          <!-- .comment-author --> 
         </footer>
         <!-- .comment-meta --> 
         <div class="comment-content"> 
          <p>Hi Greg. The Authorize attribute will look at the logged-in user. To get that to work with a bearer token, you will need to have middleware to extract user information from the token. I would recommending using the Microsoft.AspNetCore.Authentication.JwtBearer package (<a href="https://www.nuget.org/packages/Microsoft.AspNetCore.Authentication.JwtBearer/" rel="nofollow">https://www.nuget.org/packages/Microsoft.AspNetCore.Authentication.JwtBearer/</a>) to do that. </p> 
          <p>A simple use of the middleware might look something like this:<br> app.UseJwtBearerAuthentication(new JwtBearerOptions()<br> {<br> Audience = “http://localhost:5001/”,<br> Authority = “http://localhost:5000/”,<br> AutomaticAuthenticate = true<br> }); </p> 
          <p>I’m hoping to write another blog which focuses on this topic in more depth soon.</p> 
         </div>
         <!-- .comment-content --> 
         <div class="comment-metadata"> 
         </div>
         <!-- .comment-metadata --> 
        </article>
        <!-- .comment-body --> 
        <ul class="children"> 
         <li id="comment-200325" class="comment odd alt depth-3"> 
          <article id="div-comment-200325" class="comment-body"> 
           <footer class="comment-meta"> 
            <div class="comment-right"> 
             <time class="comment-time" datetime="2017-02-07T01:40:14+00:00"> 8 months ago </time> 
             <div class="comment-actions"> 
              <a rel="nofollow" class="comment-reply-link" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/?replytocom=200325#respond" onclick="return addComment.moveForm( &quot;div-comment-200325&quot;, &quot;200325&quot;, &quot;respond&quot;, &quot;8945&quot; )" aria-label="Reply to Bennie Copeland">Reply</a> 
             </div> 
            </div> 
            <div class="comment-author vcard"> 
             <img alt="" src="https://secure.gravatar.com/avatar/5d409546da2a6671a1fc2cf7d1a698ef?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/5d409546da2a6671a1fc2cf7d1a698ef?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> 
             <div class="author-wrap"> 
              <span class="author-name">Bennie Copeland</span> 
             </div> 
            </div>
            <!-- .comment-author --> 
           </footer>
           <!-- .comment-meta --> 
           <div class="comment-content"> 
            <p>I’ve been looking into this myself, and using Bearer tokens seems to be IdentityServers default. On the client I install the IdentityServer4.AccessTokenValidation nuget package and in the configure method I set:</p> 
            <p>app.UseIdentityServerAuthentication(new IdentityServerAuthenticationOptions<br> {<br> Authority = “http://localhost:5000”,<br> RequireHttpsMetadata = false,<br> ApiName = “api1”<br> });</p> 
            <p>Looking at the github code for IdentityServerAuthenticationOptions, it sets the AuthenticationScheme to Bearer along with setting both AutomaticAuthenticate and AutomaticChallenge to true.</p> 
           </div>
           <!-- .comment-content --> 
           <div class="comment-metadata"> 
           </div>
           <!-- .comment-metadata --> 
          </article>
          <!-- .comment-body --> </li>
         <!-- #comment-## --> 
        </ul>
        <!-- .children --> </li>
       <!-- #comment-## --> 
      </ul>
      <!-- .children --> </li>
     <!-- #comment-## --> 
     <li id="comment-197635" class="comment byuser comment-author-gvdonovan even thread-odd thread-alt depth-1 parent"> 
      <article id="div-comment-197635" class="comment-body"> 
       <footer class="comment-meta"> 
        <div class="comment-right"> 
         <time class="comment-time" datetime="2017-01-30T12:01:21+00:00"> 8 months ago </time> 
         <div class="comment-actions"> 
          <a rel="nofollow" class="comment-reply-link" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/?replytocom=197635#respond" onclick="return addComment.moveForm( &quot;div-comment-197635&quot;, &quot;197635&quot;, &quot;respond&quot;, &quot;8945&quot; )" aria-label="Reply to gdonovan">Reply</a> 
         </div> 
        </div> 
        <div class="comment-author vcard"> 
         <img alt="" src="https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=gdonovan&amp;size=extralarge&amp;version=00000000-0000-0000-0000-000000000000" class="avatar avatar-40 photo" height="40" width="40"> 
         <div class="author-wrap"> 
          <span class="author-name"><a href="https://social.msdn.microsoft.com/profile/gdonovan" rel="external nofollow" class="url">gdonovan</a></span> 
         </div> 
        </div>
        <!-- .comment-author --> 
       </footer>
       <!-- .comment-meta --> 
       <div class="comment-content"> 
        <p>I added a “ValuesController” with the [Authorize] attribute and cannot access the endpoint using postman (GET with Authorization of “bearer [my token]”. Any thoughts?</p> 
       </div>
       <!-- .comment-content --> 
       <div class="comment-metadata"> 
       </div>
       <!-- .comment-metadata --> 
      </article>
      <!-- .comment-body --> 
      <ul class="children"> 
       <li id="comment-198455" class="comment byuser comment-author-mike-rousos odd alt depth-2"> 
        <article id="div-comment-198455" class="comment-body"> 
         <footer class="comment-meta"> 
          <div class="comment-right"> 
           <time class="comment-time" datetime="2017-02-01T19:51:54+00:00"> 8 months ago </time> 
           <div class="comment-actions"> 
            <a rel="nofollow" class="comment-reply-link" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/?replytocom=198455#respond" onclick="return addComment.moveForm( &quot;div-comment-198455&quot;, &quot;198455&quot;, &quot;respond&quot;, &quot;8945&quot; )" aria-label="Reply to Mike Rousos - MSFT">Reply</a> 
           </div> 
          </div> 
          <div class="comment-author vcard"> 
           <img alt="" src="https://i1.social.s-msft.com/profile/u/avatar.jpg?displayname=Mike+Rousos+-+MSFT&amp;size=extralarge&amp;version=00000000-0000-0000-0000-000000000000" class="avatar avatar-40 photo" height="40" width="40"> 
           <div class="author-wrap"> 
            <span class="author-name"><a href="https://social.msdn.microsoft.com/profile/Mike+Rousos+-+MSFT" rel="external nofollow" class="url">Mike Rousos - MSFT</a></span> 
           </div> 
          </div>
          <!-- .comment-author --> 
         </footer>
         <!-- .comment-meta --> 
         <div class="comment-content"> 
          <p>As mentioned above, this can be accomplished with JwtBearerAuthentication middleware (to extract user information from the auth token) from the <a href="https://www.nuget.org/packages/Microsoft.AspNetCore.Authentication.JwtBearer/" rel="nofollow">https://www.nuget.org/packages/Microsoft.AspNetCore.Authentication.JwtBearer/</a> package.</p> 
         </div>
         <!-- .comment-content --> 
         <div class="comment-metadata"> 
         </div>
         <!-- .comment-metadata --> 
        </article>
        <!-- .comment-body --> </li>
       <!-- #comment-## --> 
      </ul>
      <!-- .children --> </li>
     <!-- #comment-## --> 
     <li id="comment-209545" class="comment even thread-even depth-1"> 
      <article id="div-comment-209545" class="comment-body"> 
       <footer class="comment-meta"> 
        <div class="comment-right"> 
         <time class="comment-time" datetime="2017-03-06T06:53:52+00:00"> 7 months ago </time> 
         <div class="comment-actions"> 
          <a rel="nofollow" class="comment-reply-link" href="https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/?replytocom=209545#respond" onclick="return addComment.moveForm( &quot;div-comment-209545&quot;, &quot;209545&quot;, &quot;respond&quot;, &quot;8945&quot; )" aria-label="Reply to Bill">Reply</a> 
         </div> 
        </div> 
        <div class="comment-author vcard"> 
         <img alt="" src="https://secure.gravatar.com/avatar/0b165173c01e8c317d68fe64c8e3b724?s=40&amp;d=mm&amp;r=g" srcset="https://secure.gravatar.com/avatar/0b165173c01e8c317d68fe64c8e3b724?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"> 
         <div class="author-wrap"> 
          <span class="author-name">Bill</span> 
         </div> 
        </div>
        <!-- .comment-author --> 
       </footer>
       <!-- .comment-meta --> 
       <div class="comment-content"> 
        <p>I have a question about the Resource Owner Password Flow. The project I’m working on consists of a web API, a single page react application, and a mobile application. From each client, the user would need to supply their username and password in order to access protected parts of the web API. I’ve set up an Identity Server 4 authentication server that uses my own implementation of the IProfileService and IResourceOwnerPasswordValidator interfaces because I’m using ASP.NET Core Identity. This allows Identity Server to access the ASP.NET Core Identity UserManager, RoleManager, and SignInManagers.</p> 
        <p>The grant type I have been using for all of this is the “ResourceOwnerPassword” type. I haven’t totally integrated authorization into the single page app, but I can pass a user’s username and password to the identity server and a token is generated that I can add to the header of a request to my API. I’ve done more research about Identity Server and related technologies because I’m new to all of this. It seems like it is undesirable to use the ResourceOwnerPassword grant type. From what I can tell it seems like I should be using the Implicit grant type, but I don’t fully understand how usernames and passwords fit into that flow. Can you give any insight into which type I should be using?</p> 
       </div>
       <!-- .comment-content --> 
       <div class="comment-metadata"> 
       </div>
       <!-- .comment-metadata --> 
      </article>
      <!-- .comment-body --> </li>
     <!-- #comment-## --> 
    </ol>
    <!-- .comment-list --> 
   </div>
   <!-- #comments --> 
  </div>
  <!-- #content --> 
  <div class="footer-wrap"> 
   <footer id="colophon" class="site-footer" role="contentinfo"> 
    <div class="site-info"> 
     <div class="footer-copyright"> 
      <p>© 2017 Microsoft Corporation.</p> 
     </div> 
     <div class="bottom-footer-menu"> 
      <div class="menu-footer-menu-container">
       <ul id="menu-footer-menu" class="footer-menu">
        <li id="menu-item-5971" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5971"><a href="http://msdn.microsoft.com/cc300389">Terms of Use</a></li> 
        <li id="menu-item-5981" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5981"><a href="http://www.microsoft.com/library/toolbar/3.0/trademarks/en-us.mspx">Trademarks</a></li> 
        <li id="menu-item-5991" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-5991"><a href="http://go.microsoft.com/fwlink/?LinkId=248681">Privacy &amp; Cookies</a></li> 
       </ul>
      </div> 
     </div> 
     <div class="footer-logo"> 
      <!--<div class="copyright-logo" role="img" aria-label="Microsoft logo"></div>--> 
     </div>
     <!-- .footer-logo --> 
    </div>
    <!-- .site-info --> 
   </footer>
   <!-- #colophon --> 
  </div>
  <!-- .footer-wrap --> 
  <!-- #page --> 
  <script type="text/javascript">
	jQuery(document).ready(function($){
		$login_link = $( 'a[href*="wp-login.php?"]' );
				$login_link.on( 'click', function( evt ) {
			// evt.preventDefault();
						// console.log( 'cookie-set', '/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/' );
			$.cookie( 'aadsso-redirect', '/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/', { expires: 1, path: '/' });
		});
	});
	</script> 
  <script>
		jQuery(window).load(function () {
			// Fix Bug #644092:MAS36: Page number
			jQuery('div.nav-links>a.page-numbers').each(function(){
				jQuery(this).attr('aria-label', 'Page ' + jQuery(this).html());
			});

			// Fix Bug #633981:MAS20B:  Talkback: Talkback announces link for Number of Comments as 'Number link'
			jQuery('span.comments-link>a').each(function () {
				var num = parseInt(jQuery(this).html());
				if (isNaN(num)) {
					return false;
				}
				var content = num + (num === 1 ? ' comment' : ' comments');
				jQuery(this).attr({
					'aria-label': content,
					'title': content
				});
			});


			jQuery('#search-option>div').each(function () {
				jQuery(this).attr('aria-label',jQuery('span.search-text',this).html());
			});

			// Fix Bug #671896:MAS40B :Inspect: Header: "Name" property is not descriptive for  "Microsoft | TechNet" link (logo).
			var currentHost = location.hostname;
			if (currentHost.indexOf('msdn') !== -1) {
				jQuery('#home-link').attr('aria-label','Microsoft Developer');
			} else if (currentHost.indexOf('technet') !== -1) {
				jQuery('#home-link').attr('aria-label','Microsoft Technet');
			}

			// Detect High Contrast Mode in non IE/Edge Browsers
			jQuery('html').css('background-image', 'url("data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==")');
			if (jQuery('html').css('background-image') === 'none') {
				jQuery('html').attr('data-high-contrast', 'true');
			}

			// Fix Bug #670327:MAS40B: Inspect: Header: "Localized control type" property is incorrect for the header elements.
			// Fix Bug #683788:MAS40B: TalkBack: Header: For menu items in technet link menu bar, expand/collapse pattern available, is not announced by TalkBack 
			jQuery('#site-navigation>div>ul>li>a').attr('role', 'button').attr('aria-expanded', 'false').click(function () {
				if (jQuery(this).attr('aria-expanded') === 'true') {
					jQuery(this).attr('aria-expanded', 'false');
				} else {
					jQuery(this).attr('aria-expanded', 'true');
				}
			});

		});
	</script> 
  <!--ADD WEDCS SCRIPT--> 
  <div id="_WEDCSInsertedData" style="display: none;"></div> 
  <script type="text/javascript">
		jQuery( window ).load(
			function() {
				window.varSegmentation = 0;
				window.varClickTracking = 1;
				window.varCustomerTracking = 1;
				window.varAutoFirePV = 1;
				window.Route = ""; // was 23470 in the windows theme framework
				window.Ctrl = "";

								var blogPost = {};

								blogPost.permalink = 'https://blogs.msdn.microsoft.com/webdev/2017/01/23/asp-net-core-authentication-with-identityserver4/';
				blogPost.title = 'ASP.NET Core Authentication with IdentityServer4';
				blogPost.author = 'Jeffrey T. Fritz';
				blogPost.post_date = '2017-01-23 11:36:46';
				blogPost.category = 'AspNetCore';
				blogPost.tag = 'ASP.NET Identity,IdentityServer';
				blogPost.comment_number = '9';
								window.blogPost = blogPost;

				var wedcs_script = document.createElement('script');
				wedcs_script.type = 'text/javascript';
				wedcs_script.async = true;
				wedcs_script.src = 'https://blogs.msdn.microsoft.com/webdev/wp-content/mu-plugins/wedcs-script/ms2_blogs.js';
				if (typeof mscc === 'undefined' || (!mscc || mscc.hasConsent())) {
					document.getElementsByTagName('body')[0].appendChild(wedcs_script);
				}
			});
	</script> 
  <!--
	<script src="//c.microsoft.com/ms.js" type="text/javascript"></script>
	<noscript><img alt="" width="1" height="1" src="http://c.microsoft.com/trans_pixel.aspx"/></noscript>
	--> 
  <script type="text/javascript">
    jQuery( window ).load(
        function () {
            $("[alt|='.NET Web Development and Tools Blog']").attr("alt", "Visual Studio");
            $("[title|='.NET Web Development and Tools Blog']").attr("title", "Visual Studio");
        });
 </script> 
  <script type="text/javascript">
			jQuery( window ).load(
				function () {
					var stylesheet = document.createElement('link');
					stylesheet.href = 'https://blogs.msdn.microsoft.com/webdev/wp-content/plugins/simple-follow-me-social-buttons-widget/assets/css/style.css?ver=3.3.3';
					stylesheet.rel = 'stylesheet';
					stylesheet.type = 'text/css';
					document.getElementsByTagName('head')[0].appendChild(stylesheet);
				});
		</script> 
  <script type="text/javascript">
			jQuery( window ).load(
				function () {
					var stylesheet = document.createElement('link');
					stylesheet.href = 'https://blogs.msdn.microsoft.com/webdev/wp-content/plugins/simple-follow-me-social-buttons-widget/assets/css/icons.css?ver=3.3.3';
					stylesheet.rel = 'stylesheet';
					stylesheet.type = 'text/css';
					document.getElementsByTagName('head')[0].appendChild(stylesheet);
				});
		</script> 
  <script type="text/javascript">
			jQuery( window ).load(
				function () {
					var script = document.createElement('script');
					script.src = 'https://blogs.msdn.microsoft.com/webdev/wp-content/plugins/simple-follow-me-social-buttons-widget/assets/js/front-widget.js?ver=3.3.3';
					script.type = 'text/javascript';
					script.async = true;
					document.getElementsByTagName('body')[0].appendChild(script);
				});
		</script> 
  <span id="page-view-tracking-info" blog-id="47804" post-id="8945"></span> 
  <script type="text/javascript">
			// Check for compatibility before IE8
			if (!Date.now) {
 				 Date.now = function() { return new Date().getTime(); };
			}
			jQuery( window ).load( function() {
				jQuery.ajax({
					url: 'https://blogs.msdn.microsoft.com/webdev/wp-admin/admin-ajax.php',
					type: 'get',
					data: {
						action: 'track_page_view',
						track_page_view_post_id: jQuery('#page-view-tracking-info').attr('post-id'),
						track_page_view_blog_id: jQuery('#page-view-tracking-info').attr('blog-id'),
						track_page_view_post_url: window.location.href.split('?')[0],
						timestamp: Date.now()
						}
				});
			});
		</script> 
  <script type="text/javascript">
		var addthis_config =
		    {
				data_track_addressbar: false,
	        	ui_use_css: false,
	        	ui_508_compliant: true
	    	}
	</script> 
  <script>
dataLayer = [[]];
</script> 
  <!-- Google Tag Manager --> 
  <noscript>
   <iframe src="//www.googletagmanager.com/ns.html?id=GTM-PLR87W" height="0" width="0" style="display:none;visibility:hidden"></iframe>
  </noscript> 
  <script>jQuery(window).load(function(){(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PLR87W')});
</script> 
  <!-- End Google Tag Manager --> 
  <script type="text/javascript">
		jQuery( window ).load(
			function(i) {
				var n = window,
					t = document,
					e = n.console,
					f, u, r, o;
				typeof e == "undefined" && (f = function() {}, e = {
					log: f,
					warn: f,
					assert: f,
					clear: f,
					dir: f,
					error: f,
					info: f,
					profile: f,
					profileEnd: f
				}), u = {
					appendToHead: function(n) {
						if (t.getElementsByTagName("head").length > 0) t.getElementsByTagName("head")[0].appendChild(n);
						else throw "bootstrapper: no head element found.";
					},
					appendToBody: function(n) {
						if (t.getElementsByTagName("body").length > 0) t.getElementsByTagName("body")[0].appendChild(n);
						else throw "bootstrapper: no body element found.";
					},
					addStyleElement: function(n) {
						var i = t.createElement("link");
						i.setAttribute("href", n), i.setAttribute("rel", "stylesheet"), i.setAttribute("type", "text/css"), u.appendToHead(i)
					},
					loadFiles: function(n, t) {
						if (t !== i && u.recursiveScriptLoad(0, t), n !== i)
							for (var r = 0, r = 0; r < n.length; r++) u.addStyleElement(n[r])
					},
					recursiveScriptLoad: function(n, t) {
						t[n] && u.addScriptElement(t[n], function() {
							u.recursiveScriptLoad(n + 1, t)
						})
					},
					isCompatible: function(n, t) {
						var r, u, i;
						return (r = n.split("."), u = t.split("."), i = function(n) {
							return isNaN(n) ? 0 : n
						}, i(r[0]) > i(u[0]) || i(r[0]) === i(u[0]) && i(r[1]) > i(u[1]) || i(r[0]) === i(u[0]) && i(r[1]) === i(u[1]) && i(r[2]) >= i(u[2])) ? !0 : !1
					},
					addScriptElement: function(i, r) {
						var f, e;
						f = t.createElement("script"), f.setAttribute("type", "text/javascript"), f.async = true, f.setAttribute("src", i), f.attachEvent ? (e = function() {
							setTimeout(function() {
								typeof n.jQuery != "undefined" && r ? r() : e()
							}, 10)
						}, e()) : f.onload = r, u.appendToBody(f)
					},
					load: function(n, t) {
						setTimeout(function() {
							if (typeof n == "undefined") try {
								u.addScriptElement(t.defaultPath, function() {
									u.loadFiles(t.cssFiles, t.jsFiles)
								});
								return
							} catch (i) {
								e.warn("bootstrapper: failed to load default jQuery")
							} else if (!u.isCompatible(n.fn.jquery, t.minimumVersion)) {
								e.warn("bootstrapper: jQuery version is too old to load UserCard. Use v1.4.2 or later.");
								return
							}
							u.loadFiles(t.cssFiles, t.jsFiles)
						}, 0)
					}
				}, r = {
					host: n.location.host,
					search: "",
					protocol: "https"
				}, r.host = "widgets.services.microsoft.com", r.search = "?brand=msdn&lang=en&ver=4.9.0.0", r.protocol = "https:", o = {
					minimumVersion: "1.1.2",
					defaultPath: "https://code.jquery.com/jquery-1.4.2.min.js",
					cssFiles: [r.protocol + "//" + r.host + "/v1/UnifiedBaseballCard.css" + r.search, r.protocol + "//" + r.host + "/v1/usercard.css" + r.search],
					jsFiles: ["https://ajax.aspnetcdn.com/ajax/jquery.templates/beta1/jquery.tmpl.min.js", r.protocol + "//" + r.host + "/v1/jquery.timeago.js" + r.search, r.protocol + "//" + r.host + "/v1/jquery.textfill.js" + r.search, r.protocol + "//" + r.host + "/v1/widgets.js" + r.search]
				}, typeof n.jQuery == "undefined" ? u.load(i, o) : u.load(n.jQuery, o)
			}
		);
	</script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-content/plugins/akismet/_inc/form.js?ver=3.1.11"></script> 
  <link rel="stylesheet" id="eucookielaw-css-css" href="https://uhf.microsoft.com/mscc/statics/mscc-0.3.6.min.css?ver=4.7.5" type="text/css" media="all"> 
  <link rel="stylesheet" id="msdn-comment-notification-comment-form-css" href="https://blogs.msdn.microsoft.com/webdev/wp-content/plugins/msdn-comment-notification/msdn-comment-notification-comment-form.css?ver=20161219" type="text/css" media="all"> 
  <script type="text/javascript">
/* <![CDATA[ */
var wds_ratings_config = {"ajaxurl":"https:\/\/blogs.msdn.microsoft.com\/webdev\/wp-admin\/admin-ajax.php","user_id":"0","nonce":"6913b004f0","debug":"","no_auth_alert":"You must be logged in to rate this article.","repeatedly_vote_alert":"You can not vote repeatedly in a short time","allow_anonymous_rating":"","blog_id":"47804","rating_limit_login_user":"1","rating_limit_anonymous":"1","hide_rating_post_ids":""};
var wds_ratings_config = {"ajaxurl":"https:\/\/blogs.msdn.microsoft.com\/webdev\/wp-admin\/admin-ajax.php","user_id":"0","nonce":"6913b004f0","debug":"","no_auth_alert":"You must be logged in to rate this article.","repeatedly_vote_alert":"You can not vote repeatedly in a short time","allow_anonymous_rating":"","blog_id":"47804","rating_limit_login_user":"1","rating_limit_anonymous":"1","hide_rating_post_ids":""};
/* ]]> */
</script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-content/plugins/wds-ratings/wds-ratings.js?ver=20161014"></script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-content/themes/msdn-network-parent/js/onclick-menu-cloud.min.js?ver=12052016"></script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-includes/js/comment-reply.min.js?ver=4.7.5"></script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-content/themes/msdn-network-parent/js/comments.min.js?ver=12272016"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var msdnparent = {"is_search":"","is_singular":"1"};
/* ]]> */
</script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-content/themes/msdn-network-parent/js/project.min.js?ver=12272016"></script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-includes/js/wp-embed.min.js?ver=4.7.5"></script> 
  <script type="text/javascript" src="https://uhf.microsoft.com/mscc/statics/mscc-0.3.6.min.js?ver=4.7.5"></script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-content/plugins/eu-cookie-law/eucookielaw-searchbox-script.js?ver=4.7.5"></script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-content/plugins/msdn-comment-notification/msdn-comment-notification-comment-form.js?ver=20161219"></script> 
  <script type="text/javascript" src="https://blogs.msdn.microsoft.com/webdev/wp-content/themes/msdn-network-parent/js/vendor/jquery.cookie.js?ver=12272016"></script>   
 </body>
</html>