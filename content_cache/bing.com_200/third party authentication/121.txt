<!doctype html>
<!--[if IE 7]>
<html class="ie ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html class="ie ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 7) & !(IE 8)]><!-->
<html lang="en-US">
 <!--<![endif]-->
 <head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width"> 
  <title>SharePoint Authentication and Session Management | Rob Garrett – Blog</title> 
  <link rel="profile" href="http://gmpg.org/xfn/11"> 
  <link rel="pingback" href="http://blog.robgarrett.com/xmlrpc.php"> 
  <!--[if lt IE 9]>
<script src="http://blog.robgarrett.com/wp-content/themes/twentytwelve/js/html5.js" type="text/javascript"></script>
<![endif]--> 
  <link rel="dns-prefetch" href="//fonts.googleapis.com"> 
  <link rel="dns-prefetch" href="//s.w.org"> 
  <link rel="alternate" type="application/rss+xml" title="Rob Garrett - Blog » Feed" href="http://blog.robgarrett.com/feed/"> 
  <link rel="alternate" type="application/rss+xml" title="Rob Garrett - Blog » Comments Feed" href="http://blog.robgarrett.com/comments/feed/"> 
  <link rel="alternate" type="application/rss+xml" title="Rob Garrett - Blog » SharePoint Authentication and Session Management Comments Feed" href="http://blog.robgarrett.com/2013/05/06/sharepoint-authentication-and-session-management/feed/"> 
  <script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.2.1\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/blog.robgarrett.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.7.6"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),!(j.toDataURL().length<3e3)&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,65039,8205,55356,57096),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57331,55356,57096),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55357,56425,55356,57341,8205,55357,56507),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55357,56425,55356,57341,55357,56507),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script> 
  <style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style> 
  <link rel="stylesheet" id="chld_thm_cfg_parent-css" href="http://blog.robgarrett.com/wp-content/themes/twentytwelve/style.css?ver=4.7.6" type="text/css" media="all"> 
  <link rel="stylesheet" id="twentytwelve-fonts-css" href="https://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,400,700&amp;subset=latin,latin-ext" type="text/css" media="all"> 
  <link rel="stylesheet" id="twentytwelve-style-css" href="http://blog.robgarrett.com/wp-content/themes/twentytwelve-child/style.css?ver=1.0.1432498646" type="text/css" media="all"> 
  <!--[if lt IE 9]>
<link rel='stylesheet' id='twentytwelve-ie-css'  href='http://blog.robgarrett.com/wp-content/themes/twentytwelve/css/ie.css?ver=20121010' type='text/css' media='all' />
<![endif]--> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-includes/js/jquery/jquery.js?ver=1.12.4"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1"></script> 
  <link rel="https://api.w.org/" href="http://blog.robgarrett.com/wp-json/"> 
  <link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://blog.robgarrett.com/xmlrpc.php?rsd"> 
  <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://blog.robgarrett.com/wp-includes/wlwmanifest.xml"> 
  <link rel="prev" title="SharePoint 2013 MCSD Beta MCSD Exams" href="http://blog.robgarrett.com/2013/04/22/sharepoint-2013-mcsd-beta-mcsd-exams/"> 
  <link rel="next" title="Posting Code into WordPress.com" href="http://blog.robgarrett.com/2013/10/09/posting-code-into-wordpress-com/"> 
  <meta name="generator" content="WordPress 4.7.6"> 
  <link rel="canonical" href="http://blog.robgarrett.com/2013/05/06/sharepoint-authentication-and-session-management/"> 
  <link rel="shortlink" href="http://blog.robgarrett.com/?p=4513"> 
  <link rel="alternate" type="application/json+oembed" href="http://blog.robgarrett.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fblog.robgarrett.com%2F2013%2F05%2F06%2Fsharepoint-authentication-and-session-management%2F"> 
  <link rel="alternate" type="text/xml+oembed" href="http://blog.robgarrett.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fblog.robgarrett.com%2F2013%2F05%2F06%2Fsharepoint-authentication-and-session-management%2F&amp;format=xml"> 
  <style type="text/css" id="syntaxhighlighteranchor"></style> 
 </head> 
 <body class="post-template-default single single-post postid-4513 single-format-standard custom-font-enabled single-author"> 
  <div id="page" class="hfeed site"> 
   <header id="masthead" class="site-header" role="banner"> 
    <hgroup> 
     <h1 class="site-title"><a href="http://blog.robgarrett.com/" title="Rob Garrett – Blog" rel="home">Rob Garrett – Blog</a></h1> 
     <h2 class="site-description">Software and Technology Tid-bits</h2> 
    </hgroup> 
    <hgroup class="customIcons"> 
     <div class="bookcovers"> 
      <div class="bookcover">
       <a href="http://amzn.to/17pjxOZ"><img width="100" alt="book cover" src="http://ecx.images-amazon.com/images/I/51bBjz-OOuL.jpg" border="0"></a>
      </div> 
      <div class="bookcover">
       <a href="http://amzn.to/17pjLFT"><img width="100" alt="book cover" src="http://ecx.images-amazon.com/images/I/51d5-vT2xXL.jpg" border="0"></a>
      </div> 
     </div> 
     <div class="customTiles"> 
      <a class="customLink" href="http://twitter.com/rgarrettpro">
       <div class="customTile">
        Twitter
       </div></a> 
      <a class="customLink" href="https://facebook.com/rdgarrett">
       <div class="customTile">
        Facebook
       </div></a> 
      <a class="customLink" href="http://blog.robgarrett.com/feed">
       <div class="customTile">
        RSS
       </div></a> 
      <a class="customLink" href="http://robgarrett.info">
       <div class="customTile">
        Info
       </div></a> 
     </div> 
    </hgroup> 
    <hgroup> 
     <div class="customAccolades"> 
      <div>
       <img src="http://blog.robgarrett.com/wp-content/uploads/2015/02/MCSE_2013rgb_1516.png">
      </div> 
      <div>
       <img src="http://blog.robgarrett.com/wp-content/uploads/2015/02/MCSA_2013rgb_1590.png">
      </div> 
     </div> 
    </hgroup> 
    <nav id="site-navigation" class="main-navigation" role="navigation"> 
     <button class="menu-toggle">Menu</button> 
     <a class="assistive-text" href="#content" title="Skip to content">Skip to content</a> 
     <div class="menu-site-menu-container">
      <ul id="menu-site-menu" class="nav-menu">
       <li id="menu-item-6151" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-6151"><a href="http://blog.robgarrett.com">Home</a></li> 
      </ul>
     </div> 
    </nav>
    <!-- #site-navigation --> 
    <a href="http://blog.robgarrett.com/"><img src="http://blog.robgarrett.com/wp-content/uploads/2014/09/cropped-spencer-lodge-technology-blog-header.jpg" class="header-image" width="960" height="250" alt="Rob Garrett – Blog"></a> 
   </header>
   <!-- #masthead --> 
   <div id="main" class="wrapper"> 
    <div id="primary" class="site-content"> 
     <div id="content" role="main"> 
      <article id="post-4513" class="post-4513 post type-post status-publish format-standard hentry category-applications category-software-development tag-security tag-sharepoint"> 
       <header class="entry-header"> 
        <h1 class="entry-title">SharePoint Authentication and Session Management</h1> 
       </header>
       <!-- .entry-header --> 
       <div class="entry-content"> 
        <p>What is authentication?</p> 
        <p><em>1. A security measure designed to protect a communications system against acceptance of a fraudulent transmission or simulation by establishing the validity of a transmission, message, or originator.<br> 2. A means of identifying individuals and verifying their eligibility to receive specific categories of information.<br> </em></p> 
        <p>Authentication is essentially the process of validating a user is who they say they are, such that they can gain access to a system – in this context, the system is SharePoint. Authentication is not authorization, which is the process in determine if a known user is permitted access to certain data in the system, after successful authentication.</p> 
        <p>SharePoint, much like any content management system, relies on user authentication to provide user access to secured content. Pre-SharePoint 2010, SharePoint relied on NTLM, Kerberos, or basic (forms-based) authentication protocols (their discussion out of scope of this text). SharePoint 2010 introduced Claims-based-Authentication (CBA), also present in SharePoint 2013. CBA consists of authentication abstraction, using a Secure Token Service (STS), and identification of users with multiple attributes –claims – not just the traditional username and password pair.</p> 
        <p>A Secure Token Service implements open standards. A typical STS implementation communicates over HTTPS, and packages user identity information (claim data) via signed and encrypted XML – Secure Assertion Markup Language (SAML). Examples of STS implementations are the STS engine in SharePoint 2010/2013, ADFS, and third party applications build using the Windows Identity Framework.</p> 
        <h1>SharePoint Session Management</h1> 
        <p>A user session in SharePoint 2010/2013 is the time in which a user is logged into SharePoint without needing to re-authenticate. SharePoint, like most secure systems, implements limited lifespan sessions – i.e. users may authentication with a SharePoint system, but they’re not authenticated with the system indefinitely. The length of user sessions falls under the control of session management, configured for each SharePoint Web Application.</p> 
        <p>SharePoint handles session management differently, depending on the authentication method in play (Kerberos, NTLM, CBA, Forms, etc.). This article discusses how SharePoint works with Active Directory Federated Services (ADFS) – an STS – to maintain abstracted user authentication and user session lifetime. The following is a sequence diagram of the default authentication and session creation process in SharePoint 2010/2013 when using CBA with ADFS.</p> 
        <p><a href="http://blog.robgarrett365.com/wp-content/uploads/2014/09/sp-auth-seq.png" target="_blank"><img src="http://blog.robgarrett365.com/wp-content/uploads/2014/09/050613_2021_sharepointa1.png" alt=""></a></p> 
        <p>The following is a summary of the authentication process, shown in the sequence diagram.</p> 
        <ol> 
         <li>A user requests a page in SharePoint from their browser this might be the home page of the site.</li> 
         <li>SharePoint captures the request and determines that no valid session exists, by the absence of the FEDAUTH cookie.</li> 
         <li>SharePoint redirects the user to the internal STS – this is important because the internal STS handles all authentication requests for SharePoint and is the core of the CBA implementation in SharePoint 2010/2013.</li> 
         <li>Since we have configured SharePoint to use ADFS as a trusted login provider, the internal STS redirects the user to the ADFS login page.</li> 
         <li>ADFS acquires credentials and authenticates the user.</li> 
         <li>ADFS creates a SAML token, containing the user’s claims, as encrypted and signed.</li> 
         <li>ADFS posts the SAML token to the internal SharePoint STS.</li> 
         <li>The Internal STS saves the SAML token in the SAML Token Cache.</li> 
         <li>SharePoint creates the FEDAUTH cookie, which contains a reference to the SAML token in the cache.</li> 
         <li>The Internal STS redirects the user back to SharePoint, and then back to the original requested page.</li> 
        </ol> 
        <h2>Session Lifetime</h2> 
        <p>The lifetime of a SharePoint session, when using ADFS, is the topic of much confusion. Ultimately, SharePoint determines whether a user has a current session by the presence of the FEDAUTH cookie. The default behavior of SharePoint is to store this persistent cookie on the user’s disk, with fixed expiration date. Before sending a new FEDAUTH cookie back to the user’s browser, SharePoint calculates the expiration of the cookie with the following formula:</p> 
        <p><strong>SAML Token Lifetime – Logon Token Cache Expiration Window<br> </strong></p> 
        <p>The above values are important since they govern the overall lifetime of the FEDAUTH cookie, and hence the session lifetime. The following table describes each value and its source:</p> 
        <div> 
         <table style="border-collapse: collapse;" border="0"> 
          <tbody valign="top"> 
           <tr style="background: #4f81bd;"> 
            <td style="padding-left: 7px; padding-right: 7px; border: solid .5pt;"><span style="color: white;"><strong>Configuration Value</strong></span></td> 
            <td style="padding-left: 7px; padding-right: 7px; border-top: solid .5pt; border-left: none; border-bottom: solid .5pt; border-right: solid .5pt;"><span style="color: white;"><strong>Description</strong></span></td> 
           </tr> 
           <tr> 
            <td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid .5pt; border-bottom: solid .5pt; border-right: solid .5pt;"><strong>SAML Token Lifetime</strong></td> 
            <td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid .5pt; border-right: solid .5pt;">This value, in minutes, is provided by the token issuer – ADFS. In the case of ADFS, each Relying Party configuration (one for each instance of SharePoint farm) has this value as part of the configuration.By default, SharePoint sets the session lifetime the same as this SAML token lifetime.<p></p> <p>You can change this value using PowerShell and the ADFS command: Set-ADFSRelyingPartyTrust.</p> <p>E.g.</p> <p><em>Add-PSSnapin Microsoft.ADFS.PowerShell<br> </em></p> <p><em>Set-AdfsRelyingPartyTrust –TargetName “Relying Party Name” –TokenLifeTime 10</em></p></td> 
           </tr> 
           <tr> 
            <td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: solid .5pt; border-bottom: solid .5pt; border-right: solid .5pt;"><strong>Logon Token Cache Expiration Window</strong></td> 
            <td style="padding-left: 7px; padding-right: 7px; border-top: none; border-left: none; border-bottom: solid .5pt; border-right: solid .5pt;">This value, in minutes, is provided by SharePoint STS and governs how long the SAML token remains active in the cache, and therefore how long the associated user session remains alive. For example, if ADFS sets the SAML Token Lifetime to 10 minutes and this value is set in the STS as 2 minutes then the overall SharePoint session lifespan is 8 minutes.<p></p> <p>E.g.</p> <p><em>$ap = Get-SPSecurityTokenServiceConfig<br> </em></p> <p><em>$ap.LogonTokenCacheExpirationWindow = (New-TimeSpan -minutes 2)<br> </em></p> <p><em>$ap.Update();<br> </em></p> <p><em>IIsreset</em></p></td> 
           </tr> 
          </tbody> 
         </table> 
        </div> 
        <h2>Sliding Session</h2> 
        <p>A siding session is one where the session expiration time changes as a user interacts with the system. By default, SharePoint 2010/2013 does not offer sliding sessions. Each new session expires on a fixed time, based on the aforementioned formula, earlier in this text.</p> 
        <p>Use of a sliding session does not mean that we must compromise security. Should a user become inactive, a sliding session will timeout just as the fixed session, the main difference that a user can extend a sliding session with continued use of the SharePoint system.</p> 
        <p>Creation of sliding session requires configuration of the Relying Party in ADFS and the SharePoint Logon Token Cache Expiration. The following PowerShell configures the Relying Party to 60 minutes, which is the absolute maximum time that a session remains active should the user become inactive:</p> 
        <p><span style="font-family: Courier New; font-size: 9pt;">Add-PSSnapin Microsoft.ADFS.PowerShell<br> Set-AdfsRelyingPartyTrust –TargetName “<em>Relying Party Name</em>” –TokenLifeTime 60<br> </span></p> 
        <p>The following PowerShell sets the Logon Token Cache Expiration in SharePoint STS, which forces the sliding session lifetime to 20 minutes.</p> 
        <p><span style="font-family: Courier New; font-size: 9pt;">$ap = Get-SPSecurityTokenServiceConfig<br> $ap.LogonTokenCacheExpirationWindow = (New-TimeSpan -minutes 40)<br> $ap.Update();<br> IIsreset<br> </span></p> 
        <p>The above settings are only part of the solution. On their own we have a fixed session duration of 20 minutes, determined by the earlier mentioned formula subtracting the logon token cache expiration from the RP token lifetime. To make sure the session renews with continued activity, we must refresh the session (and FEDAUTH cookie), which we can achieve with an HTTP module. The following code is an excerpt to refresh the session with each HTTP request.</p> 
        <p><img src="http://blog.robgarrett365.com/wp-content/uploads/2014/09/050613_2021_sharepointa2.png" alt=""></p> 
        <h2>Persistent verses Session Cookies</h2> 
        <p>By default, SharePoint stores the authentication/session (FEDAUTH) cookie as a persistent cookie on disk. This allows the user to close and reopen their browser and access SharePoint without having to re-authenticate. This behavior is not always desirable.</p> 
        <p>Fortunately, we can ask SharePoint to use in-memory cookies (session cookies) for the authentication (FEDAUTH) cookie, as follows:</p> 
        <p><span style="font-family: Courier New; font-size: 9pt;">$sts = Get-SPSecurityTokenServiceConfig<br> $sts.UseSessionCookies = $true<br> $sts.Update()<br> iisreset<br> </span></p> 
       </div>
       <!-- .entry-content --> 
       <footer class="entry-meta">
         This entry was posted in 
        <a href="http://blog.robgarrett.com/category/applications/" rel="category tag">Applications</a>, 
        <a href="http://blog.robgarrett.com/category/software-development/" rel="category tag">Software Development</a> and tagged 
        <a href="http://blog.robgarrett.com/tag/security/" rel="tag">Security</a>, 
        <a href="http://blog.robgarrett.com/tag/sharepoint/" rel="tag">SharePoint</a> on 
        <a href="http://blog.robgarrett.com/2013/05/06/sharepoint-authentication-and-session-management/" title="3:21 pm" rel="bookmark"><time class="entry-date" datetime="2013-05-06T15:21:12+00:00">May 6, 2013</time></a>
        <span class="by-author"> by <span class="author vcard"><a class="url fn n" href="http://blog.robgarrett.com/author/robgarrett/" title="View all posts by robgarrett" rel="author">robgarrett</a></span></span>. 
       </footer>
       <!-- .entry-meta --> 
      </article>
      <!-- #post --> 
      <nav class="nav-single"> 
       <h3 class="assistive-text">Post navigation</h3> 
       <span class="nav-previous"><a href="http://blog.robgarrett.com/2013/04/22/sharepoint-2013-mcsd-beta-mcsd-exams/" rel="prev"><span class="meta-nav">?</span> SharePoint 2013 MCSD Beta MCSD Exams</a></span> 
       <span class="nav-next"><a href="http://blog.robgarrett.com/2013/10/09/posting-code-into-wordpress-com/" rel="next">Posting Code into WordPress.com <span class="meta-nav">?</span></a></span> 
      </nav>
      <!-- .nav-single --> 
      <div id="comments" class="comments-area"> 
       <h2 class="comments-title"> 5 thoughts on “<span>SharePoint Authentication and Session Management</span>” </h2> 
       <ol class="commentlist"> 
        <li class="comment even thread-even depth-1" id="li-comment-42241"> 
         <article id="comment-42241" class="comment"> 
          <header class="comment-meta comment-author vcard"> 
           <img alt="" src="http://0.gravatar.com/avatar/f415e63598d131ae698ce24c3af6824d?s=44&amp;d=mm&amp;r=g" srcset="http://0.gravatar.com/avatar/f415e63598d131ae698ce24c3af6824d?s=88&amp;d=mm&amp;r=g 2x" class="avatar avatar-44 photo" height="44" width="44">
           <cite><b class="fn"><a href="http://www.dovetailhq.com" rel="external nofollow" class="url">Rob</a></b> </cite>
           <a href="http://blog.robgarrett.com/2013/05/06/sharepoint-authentication-and-session-management/#comment-42241"><time datetime="2013-08-01T02:37:51+00:00">August 1, 2013 at 2:37 am</time></a> 
          </header>
          <!-- .comment-meta --> 
          <section class="comment-content comment"> 
           <p>Hi Rob</p> 
           <p>We dont want SharePoint to store the authentication/session (FEDAUTH) cookie as a persistent cookie on disk. </p> 
           <p>Shifted back to in memory as you suggested.</p> 
           <p>The problem is that it breaks Office integration (which we can live with).</p> 
           <p>But even when turn off app integration at server level – we cant open office docs from std sharepoint library view without a login control coming up.</p> 
           <p>Have you ever seen this before?</p> 
           <p>We are Office 2010 and SharePoint 2010.</p> 
           <p>Many thanks…</p> 
           <p>Rob</p> 
          </section>
          <!-- .comment-content --> 
          <div class="reply"> 
          </div>
          <!-- .reply --> 
         </article>
         <!-- #comment-## --> </li>
        <!-- #comment-## --> 
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-42251"> 
         <article id="comment-42251" class="comment"> 
          <header class="comment-meta comment-author vcard"> 
           <img alt="" src="http://0.gravatar.com/avatar/fc14ba7d55f8a586dd2739ef38de01dc?s=44&amp;d=mm&amp;r=g" srcset="http://0.gravatar.com/avatar/fc14ba7d55f8a586dd2739ef38de01dc?s=88&amp;d=mm&amp;r=g 2x" class="avatar avatar-44 photo" height="44" width="44">
           <cite><b class="fn">Andrew Beno</b> </cite>
           <a href="http://blog.robgarrett.com/2013/05/06/sharepoint-authentication-and-session-management/#comment-42251"><time datetime="2013-08-05T09:15:18+00:00">August 5, 2013 at 9:15 am</time></a> 
          </header>
          <!-- .comment-meta --> 
          <section class="comment-content comment"> 
           <p>Hey Rob,</p> 
           <p>I’m curious to get your opinion on a scenario we’re trying to achieve. We have FBA users logging into a SP2013 site using the OOTB forms login page. Ideally, we’d like to have the users re-authenticate when they close their browser, but it appears you need to set UseSessionCookies = true, but that then causes “problems” when accessing Office documents (the user is prompted to authenticate more or less every time). So, we have to then use persistent cookies. We’re then left with 3 variables to configure as far as I’m aware: FormsTokenLifetime, LogonTokenCacheExpirationWindow, and CookieLifetime. As far as I can tell, when your session will expire has nothing to do with FormsTokenLifetime or LogonTokenCacheExpirationWindow. For example, if we set the FormsTokenLifetime to 5 minutes, LogonTokenCacheExpirationWindow to 4 minutes, and CookieLifetime to 10 minutes.. the user can logon and be inactive for 8 minutes and not have to reauthenticate.</p> 
           <p>I thought about configuring it as follows, but I’m not sure if there are any performance concerns with this setup and tokens being reissued:<br> $sts = Get-SPSecurityTokenServiceConfig<br> $sts.FormsTokenLifetime = (New-TimeSpan -Minutes 30)<br> $sts.LogonTokenCacheExpirationWindow = (New-TimeSpan -Minutes 20)<br> $sts.CookieLifetime = (New-TimeSpan -Minutes 15)<br> $sts.Update()<br> iisreset</p> 
           <p>My understanding on the above would be if a user logs in and is active for the first 10 minutes, no token would be re-issued (since that’s in the FormsTokenLifetime – LogonTokenCacheExpirationWindow time period). After that first 10 minutes, if the user issues just one request within the next 5 minutes, the cookie lifetime will be extended by 15 minutes. If they are instead inactive for 5 minutes, the cookie would expire as it’s lifetime is 15 minutes and the user would have to reauthenticate. I’m not sure if these settings would be something to worry about performance wise, I suppose it depends on the number of users accessing the site at a given time. I also still need to do more testing on what happens after the token is re-issued (do the same time windows/constraints apply?).</p> 
           <p>Anyway, nice post on this topic.. we’re not using ADFS but I still found it helpful.</p> 
           <p>Andy</p> 
          </section>
          <!-- .comment-content --> 
          <div class="reply"> 
          </div>
          <!-- .reply --> 
         </article>
         <!-- #comment-## --> </li>
        <!-- #comment-## --> 
        <li class="comment even thread-even depth-1" id="li-comment-42261"> 
         <article id="comment-42261" class="comment"> 
          <header class="comment-meta comment-author vcard"> 
           <img alt="" src="http://2.gravatar.com/avatar/ecb5d583335882259dbabec2cdce42da?s=44&amp;d=mm&amp;r=g" srcset="http://2.gravatar.com/avatar/ecb5d583335882259dbabec2cdce42da?s=88&amp;d=mm&amp;r=g 2x" class="avatar avatar-44 photo" height="44" width="44">
           <cite><b class="fn"><a href="http://robgarrett.com" rel="external nofollow" class="url">Rob Garrett</a></b> </cite>
           <a href="http://blog.robgarrett.com/2013/05/06/sharepoint-authentication-and-session-management/#comment-42261"><time datetime="2013-10-15T09:33:56+00:00">October 15, 2013 at 9:33 am</time></a> 
          </header>
          <!-- .comment-meta --> 
          <section class="comment-content comment"> 
           <p>Rob and Andy,</p> 
           <p>Yes, Office integration is a real pain with session cookies, and does require use of a persistent cookie. It really comes down to a choice – in my case, my client was dead set on having the session expire when they closed the browser, and didn’t mind losing Office integration.</p> 
           <p>Since April 2011 CU, SharePoint 2010 supports sliding session, see here: <a href="http://blogs.msdn.com/b/scicoria/archive/2011/06/10/sharepoint-2010-fba-and-sliding-sessions.aspx" rel="nofollow">http://blogs.msdn.com/b/scicoria/archive/2011/06/10/sharepoint-2010-fba-and-sliding-sessions.aspx</a></p> 
          </section>
          <!-- .comment-content --> 
          <div class="reply"> 
          </div>
          <!-- .reply --> 
         </article>
         <!-- #comment-## --> </li>
        <!-- #comment-## --> 
        <li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-42271"> 
         <article id="comment-42271" class="comment"> 
          <header class="comment-meta comment-author vcard"> 
           <img alt="" src="http://1.gravatar.com/avatar/45290188c518556df3909d20b6efd3be?s=44&amp;d=mm&amp;r=g" srcset="http://1.gravatar.com/avatar/45290188c518556df3909d20b6efd3be?s=88&amp;d=mm&amp;r=g 2x" class="avatar avatar-44 photo" height="44" width="44">
           <cite><b class="fn">stuart</b> </cite>
           <a href="http://blog.robgarrett.com/2013/05/06/sharepoint-authentication-and-session-management/#comment-42271"><time datetime="2013-11-11T10:55:41+00:00">November 11, 2013 at 10:55 am</time></a> 
          </header>
          <!-- .comment-meta --> 
          <section class="comment-content comment"> 
           <p>Rob,<br> Does this apply to SharePoint using office 365, how do I use the http module with that?<br> thx</p> 
          </section>
          <!-- .comment-content --> 
          <div class="reply"> 
          </div>
          <!-- .reply --> 
         </article>
         <!-- #comment-## --> 
         <ol class="children"> 
          <li class="comment even depth-2" id="li-comment-42281"> 
           <article id="comment-42281" class="comment"> 
            <header class="comment-meta comment-author vcard"> 
             <img alt="" src="http://2.gravatar.com/avatar/ecb5d583335882259dbabec2cdce42da?s=44&amp;d=mm&amp;r=g" srcset="http://2.gravatar.com/avatar/ecb5d583335882259dbabec2cdce42da?s=88&amp;d=mm&amp;r=g 2x" class="avatar avatar-44 photo" height="44" width="44">
             <cite><b class="fn"><a href="http://robgarrett.com" rel="external nofollow" class="url">Rob Garrett</a></b> </cite>
             <a href="http://blog.robgarrett.com/2013/05/06/sharepoint-authentication-and-session-management/#comment-42281"><time datetime="2013-12-15T22:18:35+00:00">December 15, 2013 at 10:18 pm</time></a> 
            </header>
            <!-- .comment-meta --> 
            <section class="comment-content comment"> 
             <p>Nope, you cannot add http modules to O365.</p> 
            </section>
            <!-- .comment-content --> 
            <div class="reply"> 
            </div>
            <!-- .reply --> 
           </article>
           <!-- #comment-## --> </li>
          <!-- #comment-## --> 
         </ol>
         <!-- .children --> </li>
        <!-- #comment-## --> 
       </ol>
       <!-- .commentlist --> 
       <p class="nocomments">Comments are closed.</p> 
      </div>
      <!-- #comments .comments-area --> 
     </div>
     <!-- #content --> 
    </div>
    <!-- #primary --> 
    <div id="secondary" class="widget-area" role="complementary"> 
     <aside id="search-2" class="widget widget_search">
      <form role="search" method="get" id="searchform" class="searchform" action="http://blog.robgarrett.com/"> 
       <div> 
        <label class="screen-reader-text" for="s">Search for:</label> 
        <input type="text" value="" name="s" id="s"> 
        <input type="submit" id="searchsubmit" value="Search"> 
       </div> 
      </form>
     </aside>
     <aside id="text-3" class="widget widget_text">
      <h3 class="widget-title">Notice</h3> 
      <div class="textwidget">
       <p>Due to the amount of spam this site receives, I have disabled post comments (they fill up my database even if not shown on the site).</p> 
       <p>If you wish to leave me feedback, please send me a tweet to <a href="https://twitter.com/rgarrettpro">@rgarrettpro</a> and include a link to the post.</p> 
      </div> 
     </aside> 
     <aside id="recent-posts-2" class="widget widget_recent_entries"> 
      <h3 class="widget-title">Recent Posts</h3> 
      <ul> 
       <li> <a href="http://blog.robgarrett.com/2017/05/15/sharepoint-2010-calendar-item-error-item-does-not-exist-it-may-have-been-deleted-by-another-user/">SharePoint 2010 Calendar Item Error – Item Does Not exist. It may have been deleted by another user</a> </li> 
       <li> <a href="http://blog.robgarrett.com/2017/03/16/sharepoint-high-trust-app-only-context-from-powershell/">SharePoint High-Trust App Only Context from PowerShell</a> </li> 
       <li> <a href="http://blog.robgarrett.com/2016/12/02/sharepoint-online-appregnew-via-powershell/">SharePoint Online AppRegNew via PowerShell</a> </li> 
       <li> <a href="http://blog.robgarrett.com/2016/08/31/nodejs-development-environment-wsharepoint-framework-support/">NodeJS Development Environment w/SharePoint Framework Support</a> </li> 
       <li> <a href="http://blog.robgarrett.com/2016/07/11/sharepoint-2013-not-crawling-cold-fusion-cfm-pages/">SharePoint 2013 Not Crawling Cold Fusion (CFM) Pages</a> </li> 
      </ul> 
     </aside> 
     <aside id="archives-2" class="widget widget_archive">
      <h3 class="widget-title">Archives</h3> 
      <label class="screen-reader-text" for="archives-dropdown-2">Archives</label> 
      <select id="archives-dropdown-2" name="archive-dropdown" onchange="document.location.href=this.options[this.selectedIndex].value;"> <option value="">Select Month</option> <option value="http://blog.robgarrett.com/2017/05/"> May 2017 </option> <option value="http://blog.robgarrett.com/2017/03/"> March 2017 </option> <option value="http://blog.robgarrett.com/2016/12/"> December 2016 </option> <option value="http://blog.robgarrett.com/2016/08/"> August 2016 </option> <option value="http://blog.robgarrett.com/2016/07/"> July 2016 </option> <option value="http://blog.robgarrett.com/2016/05/"> May 2016 </option> <option value="http://blog.robgarrett.com/2016/04/"> April 2016 </option> <option value="http://blog.robgarrett.com/2016/03/"> March 2016 </option> <option value="http://blog.robgarrett.com/2015/12/"> December 2015 </option> <option value="http://blog.robgarrett.com/2015/09/"> September 2015 </option> <option value="http://blog.robgarrett.com/2015/07/"> July 2015 </option> <option value="http://blog.robgarrett.com/2015/06/"> June 2015 </option> <option value="http://blog.robgarrett.com/2015/05/"> May 2015 </option> <option value="http://blog.robgarrett.com/2015/02/"> February 2015 </option> <option value="http://blog.robgarrett.com/2014/05/"> May 2014 </option> <option value="http://blog.robgarrett.com/2013/12/"> December 2013 </option> <option value="http://blog.robgarrett.com/2013/10/"> October 2013 </option> <option value="http://blog.robgarrett.com/2013/05/"> May 2013 </option> <option value="http://blog.robgarrett.com/2013/04/"> April 2013 </option> <option value="http://blog.robgarrett.com/2012/10/"> October 2012 </option> <option value="http://blog.robgarrett.com/2012/09/"> September 2012 </option> <option value="http://blog.robgarrett.com/2012/08/"> August 2012 </option> <option value="http://blog.robgarrett.com/2012/02/"> February 2012 </option> <option value="http://blog.robgarrett.com/2011/11/"> November 2011 </option> <option value="http://blog.robgarrett.com/2011/07/"> July 2011 </option> <option value="http://blog.robgarrett.com/2011/04/"> April 2011 </option> <option value="http://blog.robgarrett.com/2011/03/"> March 2011 </option> <option value="http://blog.robgarrett.com/2011/01/"> January 2011 </option> <option value="http://blog.robgarrett.com/2010/02/"> February 2010 </option> <option value="http://blog.robgarrett.com/2010/01/"> January 2010 </option> <option value="http://blog.robgarrett.com/2009/12/"> December 2009 </option> <option value="http://blog.robgarrett.com/2009/10/"> October 2009 </option> <option value="http://blog.robgarrett.com/2009/09/"> September 2009 </option> <option value="http://blog.robgarrett.com/2009/08/"> August 2009 </option> <option value="http://blog.robgarrett.com/2009/07/"> July 2009 </option> <option value="http://blog.robgarrett.com/2009/05/"> May 2009 </option> <option value="http://blog.robgarrett.com/2009/02/"> February 2009 </option> <option value="http://blog.robgarrett.com/2009/01/"> January 2009 </option> <option value="http://blog.robgarrett.com/2008/11/"> November 2008 </option> <option value="http://blog.robgarrett.com/2008/10/"> October 2008 </option> <option value="http://blog.robgarrett.com/2008/09/"> September 2008 </option> <option value="http://blog.robgarrett.com/2008/07/"> July 2008 </option> <option value="http://blog.robgarrett.com/2008/06/"> June 2008 </option> <option value="http://blog.robgarrett.com/2008/05/"> May 2008 </option> <option value="http://blog.robgarrett.com/2008/04/"> April 2008 </option> <option value="http://blog.robgarrett.com/2008/03/"> March 2008 </option> <option value="http://blog.robgarrett.com/2008/02/"> February 2008 </option> <option value="http://blog.robgarrett.com/2008/01/"> January 2008 </option> <option value="http://blog.robgarrett.com/2007/12/"> December 2007 </option> <option value="http://blog.robgarrett.com/2007/10/"> October 2007 </option> <option value="http://blog.robgarrett.com/2007/09/"> September 2007 </option> <option value="http://blog.robgarrett.com/2007/08/"> August 2007 </option> <option value="http://blog.robgarrett.com/2007/07/"> July 2007 </option> <option value="http://blog.robgarrett.com/2007/06/"> June 2007 </option> <option value="http://blog.robgarrett.com/2007/05/"> May 2007 </option> <option value="http://blog.robgarrett.com/2007/04/"> April 2007 </option> <option value="http://blog.robgarrett.com/2007/03/"> March 2007 </option> <option value="http://blog.robgarrett.com/2007/02/"> February 2007 </option> <option value="http://blog.robgarrett.com/2007/01/"> January 2007 </option> <option value="http://blog.robgarrett.com/2006/12/"> December 2006 </option> <option value="http://blog.robgarrett.com/2006/11/"> November 2006 </option> <option value="http://blog.robgarrett.com/2006/10/"> October 2006 </option> <option value="http://blog.robgarrett.com/2006/08/"> August 2006 </option> <option value="http://blog.robgarrett.com/2006/07/"> July 2006 </option> <option value="http://blog.robgarrett.com/2006/06/"> June 2006 </option> <option value="http://blog.robgarrett.com/2006/05/"> May 2006 </option> <option value="http://blog.robgarrett.com/2006/04/"> April 2006 </option> <option value="http://blog.robgarrett.com/2006/03/"> March 2006 </option> <option value="http://blog.robgarrett.com/2006/02/"> February 2006 </option> <option value="http://blog.robgarrett.com/2006/01/"> January 2006 </option> <option value="http://blog.robgarrett.com/2005/12/"> December 2005 </option> <option value="http://blog.robgarrett.com/2005/11/"> November 2005 </option> <option value="http://blog.robgarrett.com/2005/10/"> October 2005 </option> <option value="http://blog.robgarrett.com/2005/09/"> September 2005 </option> <option value="http://blog.robgarrett.com/2005/08/"> August 2005 </option> <option value="http://blog.robgarrett.com/2005/07/"> July 2005 </option> <option value="http://blog.robgarrett.com/2005/06/"> June 2005 </option> <option value="http://blog.robgarrett.com/2005/05/"> May 2005 </option> <option value="http://blog.robgarrett.com/2005/04/"> April 2005 </option> <option value="http://blog.robgarrett.com/2005/03/"> March 2005 </option> <option value="http://blog.robgarrett.com/2005/02/"> February 2005 </option> <option value="http://blog.robgarrett.com/2005/01/"> January 2005 </option> <option value="http://blog.robgarrett.com/2004/12/"> December 2004 </option> <option value="http://blog.robgarrett.com/2004/11/"> November 2004 </option> <option value="http://blog.robgarrett.com/2004/10/"> October 2004 </option> </select> 
     </aside>
     <aside id="tag_cloud-2" class="widget widget_tag_cloud">
      <h3 class="widget-title">Tags</h3>
      <div class="tagcloud">
       <a href="http://blog.robgarrett.com/tag/apple/" class="tag-link-91 tag-link-position-1" title="4 topics" style="font-size: 9.2727272727273pt;">Apple</a> 
       <a href="http://blog.robgarrett.com/tag/asp-net/" class="tag-link-101 tag-link-position-2" title="17 topics" style="font-size: 16.4pt;">ASP.NET</a> 
       <a href="http://blog.robgarrett.com/tag/blogging/" class="tag-link-121 tag-link-position-3" title="20 topics" style="font-size: 17.163636363636pt;">Blogging</a> 
       <a href="http://blog.robgarrett.com/tag/broadband/" class="tag-link-131 tag-link-position-4" title="5 topics" style="font-size: 10.290909090909pt;">Broadband</a> 
       <a href="http://blog.robgarrett.com/tag/c/" class="tag-link-151 tag-link-position-5" title="20 topics" style="font-size: 17.163636363636pt;">C#</a> 
       <a href="http://blog.robgarrett.com/tag/calendar/" class="tag-link-161 tag-link-position-6" title="3 topics" style="font-size: 8pt;">Calendar</a> 
       <a href="http://blog.robgarrett.com/tag/cell-phone/" class="tag-link-171 tag-link-position-7" title="3 topics" style="font-size: 8pt;">Cell Phone</a> 
       <a href="http://blog.robgarrett.com/tag/code/" class="tag-link-201 tag-link-position-8" title="49 topics" style="font-size: 22pt;">Code</a> 
       <a href="http://blog.robgarrett.com/tag/community-server/" class="tag-link-211 tag-link-position-9" title="3 topics" style="font-size: 8pt;">Community Server</a> 
       <a href="http://blog.robgarrett.com/tag/computers/" class="tag-link-221 tag-link-position-10" title="3 topics" style="font-size: 8pt;">Computers</a> 
       <a href="http://blog.robgarrett.com/tag/conference/" class="tag-link-231 tag-link-position-11" title="5 topics" style="font-size: 10.290909090909pt;">Conference</a> 
       <a href="http://blog.robgarrett.com/tag/email/" class="tag-link-261 tag-link-position-12" title="4 topics" style="font-size: 9.2727272727273pt;">Email</a> 
       <a href="http://blog.robgarrett.com/tag/employment/" class="tag-link-271 tag-link-position-13" title="6 topics" style="font-size: 11.181818181818pt;">Employment</a> 
       <a href="http://blog.robgarrett.com/tag/firefox/" class="tag-link-281 tag-link-position-14" title="7 topics" style="font-size: 11.818181818182pt;">Firefox</a> 
       <a href="http://blog.robgarrett.com/tag/getting-things-done-gtd/" class="tag-link-311 tag-link-position-15" title="7 topics" style="font-size: 11.818181818182pt;">Getting Things Done (GTD)</a> 
       <a href="http://blog.robgarrett.com/tag/google/" class="tag-link-321 tag-link-position-16" title="7 topics" style="font-size: 11.818181818182pt;">Google</a> 
       <a href="http://blog.robgarrett.com/tag/hdtv/" class="tag-link-341 tag-link-position-17" title="5 topics" style="font-size: 10.290909090909pt;">HDTV</a> 
       <a href="http://blog.robgarrett.com/tag/humorous/" class="tag-link-361 tag-link-position-18" title="9 topics" style="font-size: 13.090909090909pt;">Humorous</a> 
       <a href="http://blog.robgarrett.com/tag/ipod/" class="tag-link-391 tag-link-position-19" title="3 topics" style="font-size: 8pt;">IPOD</a> 
       <a href="http://blog.robgarrett.com/tag/management/" class="tag-link-441 tag-link-position-20" title="11 topics" style="font-size: 14.109090909091pt;">Management</a> 
       <a href="http://blog.robgarrett.com/tag/microsoft/" class="tag-link-471 tag-link-position-21" title="7 topics" style="font-size: 11.818181818182pt;">Microsoft</a> 
       <a href="http://blog.robgarrett.com/tag/microsoft-internet-explorer/" class="tag-link-501 tag-link-position-22" title="4 topics" style="font-size: 9.2727272727273pt;">Microsoft Internet Explorer</a> 
       <a href="http://blog.robgarrett.com/tag/microsoft-office/" class="tag-link-521 tag-link-position-23" title="12 topics" style="font-size: 14.490909090909pt;">Microsoft Office</a> 
       <a href="http://blog.robgarrett.com/tag/microsoft-sharepoint/" class="tag-link-531 tag-link-position-24" title="48 topics" style="font-size: 21.872727272727pt;">Microsoft SharePoint</a> 
       <a href="http://blog.robgarrett.com/tag/microsoft-windows/" class="tag-link-551 tag-link-position-25" title="5 topics" style="font-size: 10.290909090909pt;">Microsoft Windows</a> 
       <a href="http://blog.robgarrett.com/tag/misc/" class="tag-link-561 tag-link-position-26" title="12 topics" style="font-size: 14.490909090909pt;">Misc</a> 
       <a href="http://blog.robgarrett.com/tag/msdn/" class="tag-link-571 tag-link-position-27" title="3 topics" style="font-size: 8pt;">MSDN</a> 
       <a href="http://blog.robgarrett.com/tag/music/" class="tag-link-581 tag-link-position-28" title="3 topics" style="font-size: 8pt;">Music</a> 
       <a href="http://blog.robgarrett.com/tag/nant/" class="tag-link-591 tag-link-position-29" title="3 topics" style="font-size: 8pt;">NANT</a> 
       <a href="http://blog.robgarrett.com/tag/network/" class="tag-link-611 tag-link-position-30" title="4 topics" style="font-size: 9.2727272727273pt;">Network</a> 
       <a href="http://blog.robgarrett.com/tag/off-topic/" class="tag-link-621 tag-link-position-31" title="3 topics" style="font-size: 8pt;">Off Topic</a> 
       <a href="http://blog.robgarrett.com/tag/photography/" class="tag-link-641 tag-link-position-32" title="3 topics" style="font-size: 8pt;">Photography</a> 
       <a href="http://blog.robgarrett.com/tag/powershell/" class="tag-link-981 tag-link-position-33" title="4 topics" style="font-size: 9.2727272727273pt;">PowerShell</a> 
       <a href="http://blog.robgarrett.com/tag/security/" class="tag-link-681 tag-link-position-34" title="12 topics" style="font-size: 14.490909090909pt;">Security</a> 
       <a href="http://blog.robgarrett.com/tag/servers/" class="tag-link-691 tag-link-position-35" title="5 topics" style="font-size: 10.290909090909pt;">Servers</a> 
       <a href="http://blog.robgarrett.com/tag/sharepoint/" class="tag-link-711 tag-link-position-36" title="9 topics" style="font-size: 13.090909090909pt;">SharePoint</a> 
       <a href="http://blog.robgarrett.com/tag/sharepoint-2010/" class="tag-link-721 tag-link-position-37" title="18 topics" style="font-size: 16.654545454545pt;">SharePoint 2010</a> 
       <a href="http://blog.robgarrett.com/tag/sharepoint-2013/" class="tag-link-731 tag-link-position-38" title="14 topics" style="font-size: 15.381818181818pt;">SharePoint 2013</a> 
       <a href="http://blog.robgarrett.com/tag/user-groups/" class="tag-link-811 tag-link-position-39" title="3 topics" style="font-size: 8pt;">User Groups</a> 
       <a href="http://blog.robgarrett.com/tag/visual-studio/" class="tag-link-841 tag-link-position-40" title="9 topics" style="font-size: 13.090909090909pt;">Visual Studio</a> 
       <a href="http://blog.robgarrett.com/tag/web-development/" class="tag-link-861 tag-link-position-41" title="10 topics" style="font-size: 13.6pt;">Web Development</a> 
       <a href="http://blog.robgarrett.com/tag/windows-media/" class="tag-link-901 tag-link-position-42" title="5 topics" style="font-size: 10.290909090909pt;">Windows Media</a> 
       <a href="http://blog.robgarrett.com/tag/windows-mobile/" class="tag-link-911 tag-link-position-43" title="3 topics" style="font-size: 8pt;">Windows Mobile</a> 
       <a href="http://blog.robgarrett.com/tag/windows-vista/" class="tag-link-921 tag-link-position-44" title="13 topics" style="font-size: 15pt;">Windows Vista</a> 
       <a href="http://blog.robgarrett.com/tag/workflow/" class="tag-link-941 tag-link-position-45" title="3 topics" style="font-size: 8pt;">Workflow</a>
      </div> 
     </aside>
     <aside id="categories-2" class="widget widget_categories">
      <h3 class="widget-title">Categories</h3> 
      <ul> 
       <li class="cat-item cat-item-11"><a href="http://blog.robgarrett.com/category/applications/" title="The apps we use day in and day out.">Applications</a> </li> 
       <li class="cat-item cat-item-21"><a href="http://blog.robgarrett.com/category/business-advice/" title="Anything and everything related to the business world, primarily in IT.">Business Advice</a> </li> 
       <li class="cat-item cat-item-31"><a href="http://blog.robgarrett.com/category/everything/" title="&quot;Every&quot; post goes into this category">Everything</a> </li> 
       <li class="cat-item cat-item-41"><a href="http://blog.robgarrett.com/category/gadgets-and-tech/" title="Cool gadgets and technology - life is that little bit better with my utility belt">Gadgets and Tech</a> </li> 
       <li class="cat-item cat-item-51"><a href="http://blog.robgarrett.com/category/miscellaneous/" title="General stuff that doesn't go anywhere else">Miscellaneous</a> </li> 
       <li class="cat-item cat-item-61"><a href="http://blog.robgarrett.com/category/software-development/" title="The main theme of this blog: SharePoint, C#, ASP.NET, yada, yada">Software Development</a> </li> 
       <li class="cat-item cat-item-1"><a href="http://blog.robgarrett.com/category/uncategorized/">Uncategorized</a> </li> 
       <li class="cat-item cat-item-71"><a href="http://blog.robgarrett.com/category/web-sites/">Web Sites</a> </li> 
      </ul> 
     </aside>
     <aside id="meta-2" class="widget widget_meta">
      <h3 class="widget-title">Meta</h3> 
      <ul> 
       <li><a href="http://blog.robgarrett.com/wp-login.php">Log in</a></li> 
       <li><a href="http://blog.robgarrett.com/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li> 
       <li><a href="http://blog.robgarrett.com/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li> 
       <li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li> 
      </ul> 
     </aside> 
    </div>
    <!-- #secondary --> 
   </div>
   <!-- #main .wrapper --> 
   <footer id="colophon" role="contentinfo"> 
    <div class="site-info"> 
     <a href="https://wordpress.org/" title="Semantic Personal Publishing Platform">Proudly powered by WordPress</a> 
    </div>
    <!-- .site-info --> 
   </footer>
   <!-- #colophon --> 
  </div>
  <!-- #page --> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shCore.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushAS3.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushBash.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushColdFusion.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushClojure.js?ver=20090602"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCpp.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCSharp.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushCss.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDelphi.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushDiff.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushErlang.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushFSharp.js?ver=20091003"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushGroovy.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJava.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJavaFX.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushJScript.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushLatex.js?ver=20090613"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushMatlabKey.js?ver=20091209"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushObjC.js?ver=20091207"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPerl.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPhp.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPlain.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPowerShell.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushPython.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/third-party-brushes/shBrushR.js?ver=20100919"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushRuby.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushScala.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushSql.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushVb.js?ver=3.0.9b"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/scripts/shBrushXml.js?ver=3.0.9b"></script> 
  <script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "http://blog.robgarrett.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['auto-links'] = false;
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();
</script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-content/themes/twentytwelve/js/navigation.js?ver=20140711"></script> 
  <script type="text/javascript" src="http://blog.robgarrett.com/wp-includes/js/wp-embed.min.js?ver=4.7.6"></script>  
 </body>
</html>