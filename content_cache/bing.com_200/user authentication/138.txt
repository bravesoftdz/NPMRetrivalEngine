<!doctype html>
<html>
 <head> 
  <title>Implement secure ASP.NET MVC applications - CodeProject</title> 
  <link type="text/css" rel="stylesheet" href="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Css/Main.min.css?dt=2.8.170915.1"> 
  <meta http-equiv="content-language" content="en-US"> 
  <meta charset="UTF-8"> 
  <meta name="Description" content="This article discusses various aspects of ASP.NET MVC security and shows some tips to implement these elements in your applications.; Author: Jovan Popovic; Updated: 21 Jul 2014; Section: Web Security; Chapter: Web Development; Updated: 21 Jul 2014"> 
  <meta name="Keywords" content="C#, ASP.NET, Javascript, XML, HTML, Dev, Intermediate, MVC,Web Security,Web Development,Free source code, tutorials"> 
  <meta name="Author" content="Jovan Popovic"> 
  <meta name="Rating" content="General"> 
  <meta name="Revisit-After" content="1 days"> 
  <meta name="application-name" content="CodeProject"> 
  <meta name="google-translate-customization" content="d908bb7ce7aff658-4c2f3a504525c916-g629383f736781a8a-13"> 
  <link rel="dns-prefetch" href="//ajax.googleapis.com"> 
  <link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - All Topics" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=1"> 
  <link rel="alternate" type="application/rss+xml" title="CodeProject Latest articles - Android" href="https://www.codeproject.com/WebServices/ArticleRSS.aspx?cat=22"> 
  <link rel="alternate" type="application/rss+xml" title="CodeProject Lounge Postings" href="https://www.codeproject.com/webservices/LoungeRSS.aspx"> 
  <meta name="robots" content="index, follow"> 
  <link rel="search" type="application/opensearchdescription+xml" title="CodeProject" href="https://www.codeproject.com/info/OpenSearch.xml"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "TechArticle",
  "headline": "Implement secure ASP.NET MVC applications",
  "url": "https://www.codeproject.com/Articles/288631/Secure-ASP-NET-MVC-applications",
  "discussionUrl": "https://www.codeproject.com/Articles/288631/Secure-ASP-NET-MVC-applications",
  "isFamilyFriendly": "true",
  "image": "https://www.codeproject.com/KB/web-security/ASPNET-MVC-Security/Thumb-288631.png",
  "keywords": "C#, Javascript, XML, HTML, ASP.NET, MVC, Dev",
  "commentCount": "39",
  "editor" : {
    "@type" : "Person",
    "name" : "Sean Ewington",
    "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=3873871"
  },
  "license": "http://www.codeproject.com/info/cpol10.aspx",
  "publisher" : {
    "@type" : "Organization",
    "name" : "CodeProject"
  }
  "description": "This article discusses various aspects of ASP.NET MVC security and shows some tips to implement these elements in your applications.",
  "upvoteCount": "115",
  "articleSection": "Web Security",
  "author" : [{
      "@type" : "Person",
      "name" : "Jovan Popovic",
      "url" : "https://www.codeproject.com/script/Membership/View.aspx?mid=1025738"
    }],
  "datePublished": "2011-11-24",
  "dateCreated": "2011-11-24",
  "dateModified": "2014-07-21",
  "aggregateRating" : {
    "@type" : "aggregateRating",
    "ratingValue" : 4.94,
    "ratingCount" : 115,
    "bestRating" : 5,
    "worstRating" : 1
  },
}
</script> 
  <script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [{
    "@type": "ListItem",
    "position": 1,
    "item" : {
      "@id" : "/Chapters/2/Web-Development.aspx",
      "name" : "Web Development"
    }
  },{
    "@type": "ListItem",
    "position": 2,
    "item" : {
      "@id" : "/KB/web-security/",
      "name" : "Web Security"
    }
  }]
}
</script> 
  <base target="_top"> 
  <link rel="icon" href="https://www.codeproject.com/favicon.ico" type="image/ico"> 
  <link rel="shortcut icon" href="https://www.codeproject.com/favicon.ico" type="image/ico"> 
  <link rel="apple-touch-icon" href="https://www.codeproject.com/favicon.ico" type="image/png"> 
  <script type="text/javascript" language="Javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
  <script type="text/javascript">//<![CDATA[
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='%2fscript%2fJS%2fjquery-2.2.4.min.js' type='text/javascript' %3E%3C/script%3E"));
}//]]></script> 
  <script type="text/javascript" language="Javascript">//<![CDATA[
function defrm () { /* thanks twitter */ document.write = ''; window.top.location = window.self.location;  setTimeout(function() { document.body.innerHTML = ''; }, 0);  window.self.onload = function(evt) { document.body.innerHTML = ''; }; }if (window.top !== window.self) {  try {  if (window.top.location.host) { /* will throw */ } else { defrm(); /* chrome */ }  } catch (ex) { defrm(); /* everyone else */ } }if (typeof(DemoUrl)!='undefined')   document.write(unescape('%3Cme')+'ta http'+'-equiv="re'+'fresh"                  con'+'tent="1;url='+DemoUrl+unescape('"%3CE'));
$(document).ready(function(){
    $('#__EVENTVALIDATION').attr('autocomplete', 'off');
});

//]]>
</script> 
  <script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-1735123-1']);
	_gaq.push(['_trackPageview']);
	_gaq.push(['_setDomainName', 'www.codeproject.com']);
	_gaq.push(['_setSessionTimeout', '1200']); 

	(function () {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})(); 
</script> 
 </head> 
 <body class="chrome chrome45"> 
  <a class="access-link" href="#Main"><img alt="Click here to Skip to main content" src="https://codeproject.global.ssl.fastly.net/images/t.gif"></a> 
  <div class="page-background"> 
   <div class="alert-bar  overlay " style="display: none;"> 
    <a href="#" class="close-notify">×</a> 
    <div>
     Sign up for our free weekly 
     <a href="/feature/web-newsletter">Web Developer Newsletter</a>.
    </div> 
   </div> 
   <div id="ctl00_STM" class="site-top-menu fixed"> 
    <div class="main-content"> 
     <div class="container memberbar clearfix"> 
      <div id="ctl00_MemberMenu_GenInfo" class="float-left">
       13,135,357 members (44,077 online)
      </div> 
      <div class="float-left"> 
      </div> 
      <div class="float-right"> 
       <script type="text/javascript">//<!--
			function doSubmit(secure)
			{
				if (secure)
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2farticles%2f288631%2fsecure-asp-net-mvc-applications"
				else
					document.subForm.action = "https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2farticles%2f288631%2fsecure-asp-net-mvc-applications"
				document.subForm.submit();
				return true;
			}//-->
			</script> 
       <a name="SignUp"></a> 
       <span class="member-signin tooltip openable"> <span><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2farticles%2f288631%2fsecure-asp-net-mvc-applications">Sign in</a></span> 
        <div class="tooltip-flyout"> 
         <form name="subForm" id="subForm" action="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2farticles%2f288631%2fsecure-asp-net-mvc-applications" method="post" class="tight"> 
          <input id="FormName" name="FormName" value="MenuBarForm" type="hidden"> 
          <div>
           Email
          </div> 
          <div>
           <input class="small-text" type="email" name="Email" id="Email">
          </div> 
          <div>
           Password
          </div> 
          <div>
           <input class="small-text" type="password" name="Password" id="Password">
          </div> 
          <div class="action"> 
           <input id="joinBtn" type="button" class="create hidden" onclick="return Join();" value="Join"> 
           <input type="hidden" name="fld_quicksign" value="true"> 
           <script type="text/javascript">
                                  function simpleMask(str, key) {
                                      var result = ''; 
                                      for (var i = 0; i < str.length; ++i)
                                          result += String.fromCharCode(key ^ str.charCodeAt(i));
                                      return result;
                                  }
                                  function Join() {
                                      var url = 'https://www.codeproject.com/script/Membership/Modify.aspx';
document.location.href=url;
                                      return false;
                                  }
                                  $('#joinBtn').css('visibility', 'visible');
                                  </script> 
           <input type="submit" value="Sign in" class="signin" onclick="return doSubmit(false);"> 
          </div> 
          <div class="container">
            &nbsp; 
           <a id="ctl00_MemberMenu_SendPassword" class="forgot float-right" href="/script/Membership/SendPassword.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Forgot your password?</a> 
          </div> 
         </form> 
         <hr class="divider-dark"> Sign in with 
         <a class="oauth" title="Sign in using Github" href="/script/Membership/OAuthLogOn.aspx?auth=GitHub"><img src="/script/Membership/Images/octicons_github.png" style="vertical-align:middle;padding-right:3px;border:0;"></a> 
         <a class="oauth" title="Sign in using Linkedin" href="/script/Membership/OAuthLogOn.aspx?auth=LinkedIn"><img src="/script/Membership/Images/linkedin.png" style="vertical-align:middle;padding-right:3px;border:0;"></a> 
         <a class="oauth" title="Sign in using Facebook" href="/script/Membership/OAuthLogOn.aspx?auth=Facebook"><img src="/script/Membership/Images/facebook.png" style="vertical-align:middle;padding-right:3px;border:0;"></a> 
         <a class="oauth" title="Sign in using Google" href="/script/Membership/OAuthLogOn.aspx?auth=Google"><img src="/script/Membership/Images/google-plus.png" style="vertical-align:middle;padding-right:3px;border:0;"></a> 
         <a class="oauth" title="Sign in using Microsoft" href="/script/Membership/OAuthLogOn.aspx?auth=Microsoft"><img src="/script/Membership/Images/microsoft.png" style="vertical-align:middle;padding-right:3px;border:0;"></a> 
        </div> </span> 
      </div> 
     </div> 
    </div> 
   </div> 
   <div id="ctl00_SH" class="site-header fixed"> 
    <div class="main-content"> 
     <div class="logo">
      <a href="/"><img id="ctl00_Logo" tabindex="1" title="CodeProject" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/logo250x135.gif" alt="Home" style="height:135px;width:250px;border-width:0px;"></a>
     </div> 
     <div class="promo">
      <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Web-Development/Web-Security/Security" data-tags="C#, ASP.NET, Javascript, XML, HTML, Dev, Intermediate, MVC,rating4.5">
       <noscript>
        <a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=728x90&amp;c=411057"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=728x90&amp;c=411057" width="728px" height="90px" target="_blank"></a>
       </noscript>
      </div>
     </div> 
    </div> 
   </div> 
   <a href="#Main"><img alt="Click here to Skip to main content" class="access-link" src="https://codeproject.global.ssl.fastly.net/images/t.gif"></a> 
   <div id="ctl00_TPR" class="sub-headerbar clearfix fixed"> 
    <div class="float-right"> 
     <div class="searchbar"> 
      <form method="get" action="/search.aspx?sbo=kw" name="Search" class="tight"> 
       <table border="0" cellspacing="0" cellpadding="0" class="search">
        <tbody>
         <tr>
          <td><input TabIndex="2" class="search " id="sb_tb" value="" name="q"></td>
          <td><input type="image" src="https://codeproject.global.ssl.fastly.net/images/search.gif"></td>
         </tr>
        </tbody>
       </table> 
       <div class="hover-container"> 
        <div id="SearchFilter" class="search-advanced popup small-text align-left"> 
         <b>Search within:<br></b> 
         <input type="radio" id="sb_kw" name="sbo" value="kw" checked="true">
         <label for="sb_kw">Articles</label>
         <br> 
         <input type="radio" id="sb_qa" name="sbo" value="qa">
         <label for="sb_qa">Quick Answers</label>
         <br> 
         <input type="radio" id="sb_fm" name="sbo" value="fm">
         <label for="sb_fm">Messages</label>
         <br> 
        </div> 
       </div> 
      </form> 
     </div> 
    </div> 
    <div class="float-left"> 
     <div class="navbar clearfix"> 
      <ul class="navmenu openable"> 
       <li class="desktop-only"><a id="ctl00_TopNavBar_Home" href="https://www.codeproject.com">home</a> </li>
       <li class="openable"><a id="ctl00_TopNavBar_Art" class="down selected" href="/script/Articles/Latest.aspx">articles</a> 
        <ul> 
         <li class="openable"><a id="ctl00_TopNavBar_ArtTopicList" class="fly" onmouseover="navBarMenu.ShowMap(this, 'ctl00_TopNavBar_MapFlyout');" href="/script/Content/SiteMap.aspx">Chapters and Sections<span class="has-submenu">&gt;</span></a>
          <ul id="ctl00_TopNavBar_MapFlyout"> 
           <li> 
            <div id="siteMap"> 
             <img src="https://codeproject.global.ssl.fastly.net/images/loading48.gif" alt="loading" style="margin:150px;width:100px;height:100px;"> 
            </div> </li> 
          </ul> </li> 
         <li><a id="ctl00_TopNavBar_ArtSearch" class="fly break" href="/search.aspx?sbo=kw">Search</a></li> 
         <li><a id="ctl00_TopNavBar_ArtLatestArts" class="fly" href="/script/Articles/Latest.aspx?at=1,3,7">Latest Articles</a></li> 
         <li><a id="ctl00_TopNavBar_ArtLatestTips" class="fly" href="/script/Articles/Latest.aspx?at=6">Latest Tips/Tricks</a></li> 
         <li><a id="ctl00_TopNavBar_ArtTop" class="fly" href="/script/Articles/TopArticles.aspx?ta_so=5">Top Articles</a></li> 
         <li><a id="ctl00_TopNavBar_ArtBeginner" class="fly" href="/search.aspx?sbo=kw?aidlst=152&amp;sa_us=True">Beginner Articles</a></li> 
         <li><a id="ctl00_TopNavBar_ArtBlogArticles" class="fly break" href="/script/Articles/BlogArticleList.aspx">Technical Blogs</a></li> 
         <li><a id="ctl00_TopNavBar_ArtGuide" class="fly" href="/info/Submit.aspx">Posting/Update Guidelines</a></li> 
         <li><a id="ctl00_TopNavBar_ArtHelpForum" class="fly" href="/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li> 
         <li><a id="ctl00_TopNavBar_ArtCompetition" class="fly break" href="/script/Contests/CurrentCompetitions.aspx?cmpTpId=1">Article Competition</a></li> 
         <li><a id="ctl00_TopNavBar_ArtPostArticle" class="fly highlight1" href="/script/Articles/Submit.aspx"> <img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px"> Submit an article or tip </a></li> 
         <li><a id="ctl00_TopNavBar_ArtPostBlog" class="fly highlight2" href="/script/Articles/BlogFeed.aspx"> <img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px"> Post your Blog </a></li> 
         <li class="last"></li> 
        </ul> </li> 
       <li class="openable"> <a id="ctl00_TopNavBar_Answers" href="/script/Answers/List.aspx?tab=active"> <span class="desktop-only tablet-only">quick answers</span><span class="mobile-only">Q&amp;A</span> </a> 
        <ul> 
         <li id="ctl00_TopNavBar_AQL"><a id="ctl00_TopNavBar_ArticleQuestion" class="fly highlight1" href="#_comments"> <img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px"> Ask a Question about this article</a> </li> 
         <li><a id="ctl00_TopNavBar_QAAsk" class="fly highlight2" href="/Questions/ask.aspx"><img src="https://codeproject.global.ssl.fastly.net/images/write13.png" width="13px" height="13px"> Ask a Question</a></li> 
         <li><a id="ctl00_TopNavBar_QAUnanswered" class="fly" href="/script/Answers/List.aspx?tab=unanswered">View Unanswered Questions</a></li> 
         <li><a id="ctl00_TopNavBar_QALatest" class="fly" href="/script/Answers/List.aspx?tab=active">View All Questions...</a></li> 
         <li><a id="ctl00_TopNavBar_QATR_ctl00_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=81" style="padding-left:30px">C# questions</a></li> 
         <li><a id="ctl00_TopNavBar_QATR_ctl01_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=85" style="padding-left:30px">ASP.NET questions</a></li> 
         <li><a id="ctl00_TopNavBar_QATR_ctl02_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=842" style="padding-left:30px">VB.NET questions</a></li> 
         <li><a id="ctl00_TopNavBar_QATR_ctl03_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=93" style="padding-left:30px">SQL questions</a></li> 
         <li><a id="ctl00_TopNavBar_QATR_ctl04_Tag" class="fly" href="/script/Answers/List.aspx?tab=active&amp;alltags=true&amp;tags=87" style="padding-left:30px">Javascript questions</a></li> 
         <li class="last"></li> 
        </ul> </li> 
       <li class="openable"><a id="ctl00_TopNavBar_Forums" href="/script/Forums/List.aspx"> <span class="desktop-only tablet-only">discussions</span><span class="mobile-only">forums</span> </a> 
        <ul> 
         <li><a id="ctl00_TopNavBar_MessageBoardsAll" class="fly" href="/script/Forums/List.aspx">All Message Boards...</a></li> 
         <li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1580997/Application-Lifecycle.aspx">Application Lifecycle<span class="has-submenu">&gt;</span></a> 
          <ul class="openable">
           <li><a class="fly" href="/Forums/1533717/Running-a-Business.aspx">Running a Business</a></li> 
           <li><a class="fly" href="/Forums/1533716/Sales-Marketing.aspx">Sales / Marketing</a></li> 
           <li><a class="fly" href="/Forums/1651/Collaboration-Beta-Testing.aspx">Collaboration / Beta Testing</a></li> 
           <li><a class="fly" href="/Forums/3304/Work-Issues.aspx">Work Issues</a></li> 
          </ul></li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/369270/Design-and-Architecture.aspx">Design and Architecture</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/12076/ASP-NET.aspx">ASP.NET</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1580226/JavaScript.aspx">JavaScript</a> </li> 
         <li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/1647/C-Cplusplus-MFC.aspx">C / C++ / MFC<span class="has-submenu">&gt;</span></a> 
          <ul class="openable">
           <li><a class="fly" href="/Forums/4486/ATL-WTL-STL.aspx">ATL / WTL / STL</a></li> 
           <li><a class="fly" href="/Forums/3785/Managed-Cplusplus-CLI.aspx">Managed C++/CLI</a></li> 
          </ul></li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1649/Csharp.aspx">C#</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1627782/Free-Tools.aspx">Free Tools</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1827460/Objective-C-and-Swift.aspx">Objective-C and Swift</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1725/Database.aspx">Database</a> </li> 
         <li class="openable"><a class="fly" style="padding-left:30px" href="/Forums/186301/Hardware-Devices.aspx">Hardware &amp; Devices<span class="has-submenu">&gt;</span></a> 
          <ul class="openable">
           <li><a class="fly" href="/Forums/1644/System-Admin.aspx">System Admin</a></li> 
          </ul></li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1606152/Hosting-and-Servers.aspx">Hosting and Servers</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1643/Java.aspx">Java</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1650/NET-Framework.aspx">.NET Framework</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1848626/Android.aspx">Android</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1876716/iOS.aspx">iOS</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/13695/Mobile.aspx">Mobile</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1540733/SharePoint.aspx">SharePoint</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1004257/Silverlight-WPF.aspx">Silverlight / WPF</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1646/Visual-Basic.aspx">Visual Basic</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1640/Web-Development.aspx">Web Development</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/suggestions.aspx">Site Bugs / Suggestions</a> </li> 
         <li><a class="fly" style="padding-left:30px" href="/Forums/1652005/Spam-and-Abuse-Watch.aspx">Spam and Abuse Watch</a> </li> 
         <li class="last"></li> 
        </ul> </li> 
       <li class="openable desktop-only"><a id="ctl00_TopNavBar_Features" href="/Feature/">features</a> 
        <ul> 
         <li><a id="ctl00_TopNavBar_Comps" class="fly" href="/script/Contests/CurrentCompetitions.aspx?cmpTpId=1&amp;awsac=true">Competitions</a></li> 
         <li><a id="ctl00_TopNavBar_News" class="fly" href="/script/News/List.aspx">News</a></li> 
         <li><a id="ctl00_TopNavBar_Insider" class="fly" href="/Feature/Insider/">The Insider Newsletter</a></li> 
         <li><a id="ctl00_TopNavBar_DailyBuild" class="fly" href="/Feature/DailyBuild">The Daily Build Newsletter</a></li> 
         <li><a id="ctl00_TopNavBar_Newsletters" class="fly" href="/script/Mailouts/Archive.aspx?mtpid=1">Newsletter archive</a></li> 
         <li><a id="ctl00_TopNavBar_Surveys" class="fly" href="/script/Surveys/List.aspx">Surveys</a></li> 
         <li><a id="ctl00_TopNavBar_Showcase" class="fly" href="/KB/showcase/">Product Showcase</a></li> 
         <li><a id="ctl00_TopNavBar_Research" class="fly" href="/script/ResearchLibrary/Index.aspx">Research Library</a></li> 
         <li><a id="ctl00_TopNavBar_Stuff" class="fly" href="/Info/Stuff.aspx">CodeProject Stuff</a></li> 
         <li class="last"></li> 
        </ul> </li> 
       <li class="openable"><a id="ctl00_TopNavBar_Lounge" href="/Lounge.aspx"> <span class="desktop-only tablet-only">community</span><span class="mobile-only">lounge</span> </a> 
        <ul> 
         <li><a id="ctl00_TopNavBar_WhosWho" class="fly" href="/script/Membership/Profiles.aspx">Who's Who</a></li> 
         <li><a id="ctl00_TopNavBar_MVPs" class="fly break" href="/script/Contests/MVPWinners.aspx">Most Valuable Professionals</a></li> 
         <li><a id="ctl00_TopNavBar_LoungeLnk" class="fly highlight2" href="/Lounge.aspx">The Lounge &nbsp;</a></li> 
         <li><a id="ctl00_TopNavBar_InsiderLnk" class="fly" href="/Insider.aspx">The Insider News</a></li> 
         <li><a id="ctl00_TopNavBar_WeirdWonderful" class="fly" href="/Feature/WeirdAndWonderful.aspx">The Weird &amp; The Wonderful</a></li> 
         <li><a id="ctl00_TopNavBar_SoapBoxLnk" class="fly" href="/Forums/1536756/The-Soapbox.aspx">The Soapbox</a></li> 
         <li><a id="ctl00_TopNavBar_PRLnk" class="fly break" href="/Forums/1738007/Press-Releases.aspx">Press Releases</a></li> 
         <li class="openable"><a class="fly" href="/Forums/1580229/Hindi.aspx">Non-English Language <span class="has-submenu">&gt;</span></a> 
          <ul> 
           <li><a class="fly" href="/Forums/1580229/Hindi.aspx">General Indian Topics</a></li> 
           <li><a class="fly" href="/Forums/1580230/Chinese.aspx">General Chinese Topics</a></li> 
          </ul> </li>
         <li class="last"></li> 
        </ul> </li> 
       <li class="openable desktop-only tablet-only" style="margin-left:20px"><a id="ctl00_TopNavBar_Help" href="/KB/FAQs/">help</a> 
        <ul> 
         <li><a id="ctl00_TopNavBar_HelpWhatIs" class="fly" href="/info/guide.aspx">What is 'CodeProject'?</a></li> 
         <li><a id="ctl00_TopNavBar_HelpGeneral" class="fly break" href="/KB/FAQs/">General FAQ</a></li> 
         <li><a id="ctl00_TopNavBar_HelpPostQuestion" class="fly break highlight2" href="/Questions/ask.aspx">Ask a Question</a></li> 
         <li><a id="ctl00_TopNavBar_HelpBugs" class="fly" href="/suggestions.aspx">Bugs and Suggestions</a></li> 
         <li><a id="ctl00_TopNavBar_HelpArticles" class="fly" href="/Forums/1641/Article-Writing.aspx">Article Help Forum</a></li> 
         <li><a id="ctl00_TopNavBar_HelpSiteMap" class="fly" href="/script/Content/SiteMap.aspx">Site Map</a></li> 
         <li><a id="ctl00_TopNavBar_HelpAdvertise" class="fly" href="http://developermedia.com/">Advertise with us</a></li> 
         <li><a id="ctl00_TopNavBar_HelpAboutAds" class="fly" href="/info/AboutOurAds.aspx">About our Advertising</a></li> 
         <li><a id="ctl00_TopNavBar_HelpJobs" class="fly" href="/info/Jobs/">Employment Opportunities</a></li> 
         <li><a id="ctl00_TopNavBar_HelpAboutUs" class="fly" href="/info/about.aspx">About Us</a></li> 
         <li class="last"></li> 
        </ul> </li> 
      </ul> 
     </div> 
    </div> 
    <div class="sub-headerbar-divider"></div> 
   </div> 
   <div id="A" class="container-content-wrap fixed"> 
    <div class="container-content"> 
     <div class="clearfix"> 
      <div class="container-breadcrumb float-left "> 
       <div>
        <a href="/script/Content/SiteMap.aspx">Articles</a> » 
        <a href="/Chapters/2/Web-Development.aspx">Web Development</a> » 
        <a href="/KB/web-security/">Web Security</a> » 
        <a href="/KB/web-security/#Security">Security</a>
       </div> 
      </div> 
      <div class="edit-links float-right">
        &nbsp; 
      </div> 
      <div class="article-nav float-right"> 
       <div style="display:inline-block;position:relative;top:-6px;margin-right:20px"> 
       </div> 
       <a id="ctl00_ActionLinks_BookmarkMd_ImgBt" title="Bookmark" alternatetext="Bookmark" name="bm_288631_2" onclick="return bookmarkMe(288631,2,'/script/Bookmarks/Ajax/Add.aspx?obid=288631&amp;obtid=2&amp;bio=true&amp;bis=medium','medium');" href="/script/Bookmarks/Add.aspx?obid=288631&amp;obtid=2&amp;bio=true&amp;bis=medium" style="display:inline-block;height:24px;width:24px;"><img title="Bookmark" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/bookmark24.png" alt="" style="border-width:0px;"></a> 
       <span id="ctl00_ActionLinks_BookmarkMd_StatusMsg" class="tiny-text" style="display:none" name="bm_288631_2"></span> 
       <a id="ctl00_ActionLinks_PrintMd" href="/Articles/288631/Secure-ASP-NET-MVC-applications?display=Print"> <img src="/App_Themes/CodeProject/Img/print48.png" title="Print" width="24px" height="24px" style="border:0"> </a> 
      </div> 
     </div> 
     <table class="extended container-article-parts" cellpadding="0" cellspacing="0"> 
      <tbody>
       <tr valign="top"> 
        <td width="117px" class="article-wing-left"> 
         <div id="ctl00_Nav" class="container-article-tabs"> 
          <div class="tabs"> 
           <div class="selected">
            Article
           </div>
           <div class="unselected">
            <a href="/script/Articles/ViewDownloads.aspx?aid=288631">Browse Code</a>
           </div>
           <div class="unselected">
            <a href="/script/Articles/Statistics.aspx?aid=288631">Stats</a>
           </div>
           <div class="unselected">
            <a href="/script/Articles/ListVersions.aspx?aid=288631">Revisions (37)</a>
           </div>
           <div class="unselected">
            <a href="/script/Articles/ListAlternatives.aspx?aid=288631">Alternatives</a>
           </div> 
           <div class="unselected">
            <a href="WebControls/#_comments" id="ctl00_ArticleTabs_CommentLink" class="anchorLink">Comments <span id="ctl00_ArticleTabs_CmtCnt">(39)</span></a> 
           </div> 
          </div> 
          <a id="ctl00_AddAlternative" title="Write a related article about upgrades or translate this into a different language." class="add-item" href="/script/Articles/SubmissionWizard.aspx?at=1&amp;apid=288631">Add your own<br>alternative version</a> 
          <div> 
           <h4>Tagged as</h4> 
           <span id="ctl00_TagList_TagWrp" class="tags vertical"> <span id="ctl00_TagList_VisibleTags">
             <div class="t">
              <a rel="tag" href="/Tags/C--hash--" data-id="81">C#</a>
             </div>
             <div class="t">
              <a rel="tag" href="/Tags/ASP.NET" data-id="85">ASP.NET</a>
             </div>
             <div class="t">
              <a rel="tag" href="/Tags/Javascript" data-id="87">Javascript</a>
             </div>
             <div class="t">
              <a rel="tag" href="/Tags/XML" data-id="88">XML</a>
             </div>
             <div class="t">
              <a rel="tag" href="/Tags/HTML" data-id="104">HTML</a>
             </div>
             <div class="t">
              <a rel="tag" href="/Tags/Dev" data-id="118">Dev</a>
             </div>
             <div class="t">
              <a rel="tag" href="/Tags/Intermediate" data-id="153">Intermediate</a>
             </div>
             <div class="t">
              <a rel="tag" href="/Tags/MVC" data-id="313">MVC</a>
             </div></span> </span> 
          </div> 
          <div class="stats"> 
           <h4>Stats</h4> 
           <div id="ctl00_ArtStats">
            <div class="stats">
             <div>
              269.9K views
             </div>
             <div>
              8.6K downloads
             </div>
             <div>
              333 bookmarked
             </div>
            </div>
           </div> 
          </div> 
          <div class="subdue padded-top" title="Date First posted">
           Posted 24 Nov 2011
          </div> 
          <div title="Licence"> 
           <a id="ctl00_LicenseLink" title="The Code Project Open License (CPOL)" class="license" href="http://www.codeproject.com/info/cpol10.aspx">CPOL</a> 
          </div> 
         </div> </td> 
        <td> 
         <div id="AT" class="container-article  fixed"> 
          <div class="article"> 
           <form name="aspnetForm" method="post" action="/articles/288631/secure-asp-net-mvc-applications" id="aspnetForm" style="margin:0;padding:0"> 
            <div> 
             <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="WTigq2ty4hCS3QKgmWuGsvVNEi1w/5ANxmH1golDQS+P638vKlQCNVEN8osxSmSa9eatwjg8ZvQlVYgwKlW2V5Po4Ef65MGwkpLNkf3Dz989Hzy5qoJX1zvfMW2qQM9jpylnntW92FVkeFrZVZmfNOM1OecYyBdMIPx7mbPJXggFZTYgGRfbwBVtelEClQCTaTB0R1OHiZjH+AA70TB4lqUaz7AUNus6aF5VI2aPV5XKymFQM2hdbij3dfUVy0zLAwwibLURXE3NT+LPNllE7gfvmckDftFdnJCymLzZzBzGpL741pBbo+DOHgdjhl39acl2zCqR4NDZwOyp9KfWFZIvQzVs9+02sxp3LN4yU1KOwZ903m2HQaO6LjmRetHYLeIoDg/Cu48fEHon1aK8cPkWh+jF1hYmIh/ii4l6+jkFHwPzGra4AOCacsJk4IPlUF5KKPE6hhfGhSIZCF9Cg00V/jPVyIzoHVknaW6R5bq3dPSZdmnMUfHhhi7ccbMmXCwh+ANfXqcOLApHtaMbmoF5hM2/1i+5rNlAQsUsd5bav7lZKo6jTGZevmJmafTd0wmOuQIllowxcyfkRrhUHoGzuFoqXlOSU2KBaFHDls9QyYXWJcICvxLvKiQ5akjwjBsMCCDVaVy0zA1xNxxmIWLVRHj70P6MtcOGZCYFF2+TK6RrpAWi2CuZ9ssDNEu8sGi9CtxDfwPJG68R63sHAWtv+yLjC7LA/tLxjENW0AoIC4HtyNIZhGn1DU8/kaAqsv0M2xXPag29EUIrosMiSYzSrV2yNEwSZRojzjl9d55d8/8RzKYkaCyma3V6E4rZcThRKOgAIRyRdLWH08N3V+v8OGVHqWvW1ZDrih1Vx2DcotCMoe+CIsaviWNsXGY9tQbasgz0PdsnE0DrGiEbxHWtP1yhMNsX5sor2nCyJ/I2XWsIo3JfJka3pD4GyViZUSyuyBh/gxfnq29WNjn6JbzCFcPaCDR/E3QosAjw8m6QYjKrobc+LtdCDjNC0PNWweyfhUPYWmrE1z0OChwS6GvfcmRj3hwP3CVx8nRSmFgTApTdmMLmkIoN2tCKbCNxSMGrQFsszH0OFN1sfKEiPtyljeXEElbqj92aplfIs+L/VAuO3sNWVBq2UahrxxrKOtVkAwhZifutpyVFCb/Jm7TRaEa8HXA6bXyc2YcZqduCNrjkGcusxpV5aCs4lA8qa/xwhuyJ1TDVKmTxi3+8zouTQff2nq/OTt+vga+QZXK8wlbRxQvnGfy8YWuPVPWI1mfbqz2xh2bQPro2I5PlxJJyhyltyC3c+t4Z/TPalZ+z2Ftq+TeT5G33BWR80kS+jbru/qwHpAi5hlEoAULY4d20W57D5kbCfEhCRFthVd3AFYmU5WpwTlYCB+2l6NRghZswvq4S4RoXTuQh0T6JR0tB9kWE7oNIeWx0sV1cfirGQ6bhd1kXt1PPdKqjbd2ipNFK2aAdOGUQollIQ4+xAnKPfhw8qeMqaJXUE/hnNYk1CTX+Etv+HRJwIQLUvDH1zxRYoqDnksgYid3QZETqSZQZubnkyVsV4UKltEia8A6QMZZl6J0iB9YSWzFOG64XXT3g8JLZ1nVlPdcLx4ppzJYjgzqRmHblzNaWCldR71qdbx9snfyf155gbMaRnXS7mfGRW7Pl1mXtm6UlAntbKiQnr739iMOw5Bo41Ua904DIgtCS1utIYuIc6QFhgEAhgqmngg1UJ9pRYK703m99BwGU7MeYA1tmTGWPcOmdxkyAtLguzzxuggxmRm+Q1OuPFMPg0HYOPzQGQVUlZbeZM+Nc+wuEqxDz1fSnr0r7PRd5a4+E8tH6o2VC+2XjgaPPSOt6YWob95eW+xbDQHSQSLW8orJeM/i0v0DExHfy8RAclTndUTWUngmb2LxZ7SF2CLIptIGG86aUH7k8P2MfUmoq1VUSJydsY3zN+6myCyZoIvKEcNsMtWJMDtHt2Op7caul5MFqgqO1haxvVfP2QJ8o4WuQ/1VMU+/eVskPcgmA+cMLehr6k+hRDJJ3i9aMSHEGHLyj6fGQ/7xSYtebBV7PrDsoZszvgsIAHb7Aqc1jgs6RyP0yLm/MKxRFKfQqK9o0yJv9+rUN6kZ2qLccOZnBzwVH3pZfrZwOk0XLVF8MeSE8szUufDYj1smPsQ8BNK8eA6z/+RDzhPVJ2iPvjkZvtP9hZNCNsVrYtIJBYgq0ApDU"> 
            </div> 
            <div> 
             <input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="10C1FD69"> 
            </div> 
            <div class="header"> 
             <a name="Main"></a> 
             <a name="_articleTop" id="_articleTop"></a> 
             <div class="title"> 
              <h1 id="ctl00_ArticleTitle">Implement secure ASP.NET MVC applications</h1> 
             </div> 
             <div style="height:34px"> 
              <div class="entry float-left"> 
               <img src="https://www.codeproject.com/script/Membership/ProfileImages/{05355a84-95f8-4bdc-85e5-36d58e23ba69}.jpg" id="ctl00_avatar" class="float-left avatar"> 
               <div class="float-left"> 
                <div> 
                 <span class="author"><a href="/script/Membership/View.aspx?mid=1025738" rel="author">Jovan Popovic</a></span>, 
                 <span class="date" title="Date last updated"> 21 Jul 2014</span> 
                </div> 
                <div id="ctl00_RateArticleRow" class="float-left align-right" style="margin-top:5px"> 
                 <div id="ctl00_CurRat" class="tooltip anchorLink column" style="cursor:pointer;margin:2px 20px 0 0" name="CurRat_288631"> 
                  <table id="ctl00_ArticleRating_RatingTable" cellpadding="0" cellspacing="0" class="small-text"> 
                   <tbody>
                    <tr> 
                     <td class="nowrap"> <span id="ctl00_ArticleRating_VI"> 
                       <div class="nowrap rating-stars-medium" style="height:18px;width:80px;position:relative;"> 
                        <div class="clipped align-left float-left" style="height:16px;width:79px;"> 
                         <img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/stars-fill-md.png" style="border-width:0px;"> 
                        </div>
                        <div class="clipped" style="height:16px;width:1px;position:relative;"> 
                         <img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/stars-empty-md.png" style="border-width:0px;position:absolute;top:0;right:0;"> 
                        </div> 
                       </div> </span> </td> 
                     <td id="ctl00_ArticleRating_VR" class="nowrap"> &nbsp; <span id="ctl00_ArticleRating_VotesR">&nbsp;4.94 (115 votes)</span> </td> 
                    </tr> 
                   </tbody>
                  </table> 
                  <span id="ctl00_ArticleRating_RatingText"></span> 
                  <div id="ctl00_RB" class="speech-bubble-container-up"> 
                   <div class="speech-bubble-up" style="width:150px !important"> 
                    <div> 
                     <table class="feature" width="100%" height="50px" title="Voting Distribution. Recent data only" cellpadding="0" cellspacing="0">
                      <tbody>
                       <tr class="chart-row">
                        <td class="chart-column"><span title="0 votes">1</span></td> 
                        <td class="chart-column"><span title="0 votes">2</span></td> 
                        <td class="chart-column">
                         <div class="rating-ignore-vote" title="Votes not included in score.">
                          <img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="1px" border="0px" alt="2 votes, 1.8%" title="2 votes, 1.8%">
                         </div><span title="0 votes">3</span></td> 
                        <td class="chart-column">
                         <div>
                          <img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="3px" border="0px" alt="7 votes, 6.2%" title="7 votes, 6.2%">
                         </div><span title="7 votes">4</span></td> 
                        <td class="chart-column">
                         <div>
                          <img src="https://codeproject.global.ssl.fastly.net/script/Ratings/Images/pollcol.gif" width="20pxpx" height="50px" border="0px" alt="106 votes, 93.8%" title="106 votes, 93.8%">
                         </div><span title="106 votes">5</span></td> 
                       </tr>
                      </tbody>
                     </table>
                     <div class="small-text align-center">
                      4.94/5 - 115 votes
                     </div>
                     <div class="small-text align-center subdue">
                      2 removed
                     </div>
                     <div class="small-text align-center subdue">
                      ? 4.92, ?
                      <sub>a</sub> 1.02 [
                      <a href="/KB/FAQs/RatingReputationFAQ.aspx#noisefilter">?</a>]
                     </div> 
                    </div> 
                   </div> 
                   <div class="speech-bubble-pointer-up"> 
                    <div class="speech-bubble-pointer-up-inner"></div> 
                   </div> 
                  </div> 
                 </div> 
                 <div class="column"> 
                  <div id="ctl00_RateArticle_RateItemWrapper" class="container-rating small-text" name="RateItem_288631"> 
                   <table width="100%" cellpadding="0" cellspacing="0" class="small-text"> 
                    <tbody>
                     <tr> 
                      <td id="ctl00_RateArticle_VoteResultDiv" class="rating-result align-right"> <span class="align-right"></span> <img class="loading invisible" width="16px" alt="loading..." height="16px" src="/images/loading16.gif"> </td> 
                      <td class="voteTbl" style="white-space:nowrap" align="right"> 
                       <table class="small-text"> 
                        <tbody>
                         <tr> 
                          <td id="ctl00_RateArticle_RateText" class="rating-prompt"> Rate this: </td> 
                          <td id="ctl00_RateArticle_VoteFormDiv" class="nowrap rating-stars-voter-medium"> <span id="ctl00_RateArticle_RB" class="tooltip ajaxHist radio voting"> <span id="ctl00_RateArticle_VoteRBL"><input id="ctl00_RateArticle_VoteRBL_0" type="radio" name="ctl00$RateArticle$VoteRBL" value="1"><input id="ctl00_RateArticle_VoteRBL_1" type="radio" name="ctl00$RateArticle$VoteRBL" value="2"><input id="ctl00_RateArticle_VoteRBL_2" type="radio" name="ctl00$RateArticle$VoteRBL" value="3"><input id="ctl00_RateArticle_VoteRBL_3" type="radio" name="ctl00$RateArticle$VoteRBL" value="4"><input id="ctl00_RateArticle_VoteRBL_4" type="radio" name="ctl00$RateArticle$VoteRBL" value="5"></span> </span> </td> 
                          <td style="padding-left:5px"> <input type="submit" name="ctl00$RateArticle$SubmitRateBtn" value="Vote!" id="ctl00_RateArticle_SubmitRateBtn" class="button"> </td> 
                         </tr> 
                        </tbody>
                       </table> </td> 
                     </tr> 
                    </tbody>
                   </table> 
                   <div class="hover-container"> 
                    <div id="ctl00_RateArticle_RSU" class="rating-comment align-left float-right"> 
                     <div class="padded">
                       Please 
                      <a id="ctl00_RateArticle_SignUp" href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2farticles%2f288631%2fsecure-asp-net-mvc-applications">Sign up or sign in</a> to vote. 
                     </div> 
                    </div> 
                   </div> 
                  </div> 
                 </div> 
                </div> 
               </div> 
               <div class="float-left" style="margin: 25px 0 0 10px;"> 
               </div> 
              </div> 
              <div class="float-right align-center"> 
               <div class="msg-210x60" data-format="210x60" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Web-Development/Web-Security/Security" data-tags="C#, ASP.NET, Javascript, XML, HTML, Dev, Intermediate, MVC,rating4.5">
                <noscript>
                 <a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=210x60&amp;c=567154"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=210x60&amp;c=567154" width="210px" height="60px" target="_blank"></a>
                </noscript>
               </div> 
              </div> 
             </div> 
             <div id="ctl00_description" class="summary">
              This article discusses various aspects of ASP.NET MVC security and shows some tips to implement these elements in your applications.
             </div>
             <span id="ctl00_thumbnailUrl" class="date" content="https://www.codeproject.com/KB/web-security/ASPNET-MVC-Security/Thumb-288631.png"></span> 
            </div> 
            <div id="contentdiv" class="text"> 
             <ul class="download"> 
              <li><a href="/KB/web-security/ASPNET-MVC-Security/SecurityFilters.zip">Download source code - 989 KB </a></li> 
             </ul> 
             <h2>Table of contents</h2> 
             <ol> 
              <li><a href="#Introduction">Introduction</a></li> 
              <li><a href="#Background">Background</a></li> 
              <li><a href="#Using">User authentication</a> 
               <ol> 
                <li><a href="#Membership">Using ASP.NET membership provider for user authentication</a></li> 
                <li><a href="#SSO">Single sign on</a></li> 
                <li><a href="#OpenID">Using a third party identity provider</a></li> 
               </ol> </li> 
              <li><a href="#PAC">Page access control </a> 
               <ol> 
                <li><a href="#Standard">Secure application using the standard action filters</a></li> 
                <li><a href="#Custom">Implement custom security rules</a> 
                 <ol> 
                  <li><a href="#Create">Creating custom security action filters</a></li> 
                  <li><a href="#Error">Handling security errors</a></li> 
                  <li><a href="#Inherit">Alternative approach - Inheriting the Authorization attribute </a></li> 
                 </ol> </li> 
                <li><a href="#ThirdParty">Using third party libraries for page access control</a></li> 
                <li><a href="#CLP">Control-level protection</a> 
                 <ol> 
                  <li><a href="#ControlSecurityFilter">Control level protection using security filters</a></li> 
                 </ol> </li> 
               </ol> </li> 
              <li><a href="#CAS">Code Access Security</a> 
               <ol> 
                <li><a href="#CASSTD">Using standard security permissions</a></li> 
                <li><a href="#CASCustom">Using custom permissions</a></li> 
               </ol> </li> 
              <li><a href="#HTTPS">Forcing the HTTPS protocol</a></li> 
              <li><a href="#CSRF">Cross-site request forgery</a> 
               <ol> 
                <li><a href="#CSRFPrevention">Preventing cross-site request forgery attacks</a></li> 
               </ol> </li> 
              <li><a href="#XSS">Preventing cross-site scripting</a> 
               <ol> 
                <li><a href="#XEEExample">XSS vulnerable code - An example</a></li> 
                <li><a href="#AntiXSS">Using the Anti-XSS Library </a></li> 
               </ol> </li> 
              <li><a href="#Conclusion">Conclusion</a></li> 
             </ol> 
             <h2><a class="anchor" id="Introduction" name="Introduction" title="Introduction"></a>Introduction</h2> 
             <p>When you implement security in web applications, you will need to think about a lot of security details. Some of the standard features you will need to implement are:</p> 
             <ol> 
              <li>Authentication of the user</li> 
              <li>Page access control where you can decide what pages the user can open depending on his role or access rights</li> 
              <li>Preventing security attacks</li> 
             </ol> 
             <p>In this article, I will discuss some security elements and show you how they can be implemented in MVC applications.</p> 
             <h2><a class="anchor" id="Background" name="Background" title="Background"></a>Background</h2> 
             <p>In the code, I will implement the following security elements:</p> 
             <ol> 
              <li>Login page that logs in user and puts the user name and role in the authentication cookie.</li> 
              <li>Simulation of some custom business logic that determines whether the user can access a particular page.</li> 
              <li>Filter that checks whether the user can access a page; if the user does not have enough access, he will be redirected to the login page.</li> 
             </ol> 
             <p>This is everything that you need to have to implement access restrictions to pages in your application, and in the code, you will find a simple way to implement this using action filters.</p> 
             <p>For demonstration purpose, I have created a few actions where I will show you how access to pages is controlled. Some of the pages I have placed in the code sample are:</p> 
             <ul> 
              <li><em>/Public/Index</em> and <em>/Public/Login</em> that can be opened by everyone (public access).</li> 
              <li><em>/Registered/Index</em> and <em>/Registered/Home</em> where registered users and administrators can come.</li> 
              <li><em>/Administrator/Index</em> and <em>/Administrator/Home</em> that can be opened by the administrator.</li> 
              <li><em>/Administrator/Denied</em> that can be opened by the administrator only but when it is opened, it will throw a security exception. This page is a simulation of the case when the user can access the page but some internal component have thrown a security exception.</li> 
             </ul> 
             <p>Most of these views are fairly simple - each of them just outputs one word displaying which view is called. The login page (<em>/Public/Login</em>) contains a form that can be used for login, and <em>/Public/Index</em> is a landing page that has links to all other pages as shown in the following figure:</p> 
             <p align="center"><img alt="ASPNET-MVC-Security/SecurityFilters.png" height="589" src="/KB/web-security/ASPNET-MVC-Security/SecurityFilters.png" width="590"></p> 
             <p>Also, I will use three user roles - public, registered, and administrator, which are used to demonstrate page access control. In the code, I will show you how access can be denied on some of these actions depending on the user role.</p> 
             <p>There are also a few other pages where I have demonstrated how you can prevent some security attacks - you will see more details in the rest of the article.</p> 
             <h2><a class="anchor" id="Using" name="Using" title="Using"></a>User authentication</h2> 
             <p>In order to secure your application, you will need to enable the user to login, and you will need to determine the role of a user.</p> 
             <p>In this example, I will use forms authentication so I will need to configure this in the <em>web.config</em> and set the login page. The <em>web.config</em> is shown in the following sample:</p> 
             <pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">authentication</span><span class="code-attribute"> </span><span class="code-attribute">mode</span><span class="code-keyword">="</span><span class="code-keyword">Forms"</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">forms</span><span class="code-attribute"> </span><span class="code-attribute">loginUrl</span><span class="code-keyword">="</span><span class="code-keyword">~/Public/Login"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/authentication</span><span class="code-keyword">&gt;</span></pre> 
             <p>This part of the <em>web.config</em> file defines that I will use Forms authentication (meaning that I will provide a form for login - in this case, this will be the "<em>~/Public/Login</em>" form). As an alternative, you can use Windows authentication.</p> 
             <p>The login form will contain two fields, where the user can enter his name and a select role:</p> 
             <pre lang="html"><span class="code-keyword">&lt;</span><span class="code-leadattribute">form</span><span class="code-attribute"> </span><span class="code-attribute">method</span><span class="code-keyword">="</span><span class="code-keyword">post"</span><span class="code-attribute"> </span><span class="code-attribute">action</span><span class="code-keyword">="</span><span class="code-keyword">#"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">text"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">Username"</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">select</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">Role"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">option</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">"</span><span class="code-keyword">&gt;</span>No role<span class="code-keyword">&lt;</span><span class="code-leadattribute">/option</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">option</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Public"</span><span class="code-keyword">&gt;</span>Public<span class="code-keyword">&lt;</span><span class="code-leadattribute">/option</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">option</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Registered"</span><span class="code-keyword">&gt;</span>Registered<span class="code-keyword">&lt;</span><span class="code-leadattribute">/option</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">option</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Admin"</span><span class="code-keyword">&gt;</span>Admin<span class="code-keyword">&lt;</span><span class="code-leadattribute">/option</span><span class="code-keyword">&gt;</span>     
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">/select</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">submit"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">Login"</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Login"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/form</span><span class="code-keyword">&gt;</span></pre> 
             <p>This form does not have an identity check but in your application you will probably replace this with username/password, check they match user details, and read the role from the database. This simple simulation will be enough "security check" for this article, but if you want to see a complete solution with role based security, see something like <a href="http://www.codeproject.com/Articles/36836/Forms-Authentication-and-Role-based-Authorization">Forms Authentication and Role Based Authorization: A Quicker, Simpler, and Correct Approach</a>.</p> 
             <p>Note that I have set the action of the form to # - this way the form will be posted back to the same URL and it will include any parameter that is posted to the login form. This is handy if the parameter <code>ReturnURL="...."</code> is sent to the login page, where <code>ReturnURL</code> is the URL of the origin page where the user should be redirected after he successfully logs in to the system. If you need to put an explicit URL in the <code>action</code> attribute, then it would be good to put the <code>ReturnURL</code> as a hidden field and pass it to the controller when the login page is submitted, as shown in the following example:</p> 
             <pre lang="html"><span class="code-keyword">&lt;</span><span class="code-leadattribute">form</span><span class="code-attribute"> </span><span class="code-attribute">method</span><span class="code-keyword">="</span><span class="code-keyword">post"</span><span class="code-attribute"> </span><span class="code-attribute">action</span><span class="code-keyword">="</span><span class="code-keyword">/Public/Login"</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">hidden"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">ReturnURL"</span><span class="code-attribute"> </span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">@System.Web.HttpContext.Current.Request["</span><span class="code-attribute">ReturnURL"]"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">text"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">Username"</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">select</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">Role"</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">option</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Public"</span><span class="code-keyword">&gt;</span>Public<span class="code-keyword">&lt;</span><span class="code-leadattribute">/option</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">option</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Registered"</span><span class="code-keyword">&gt;</span>Registered<span class="code-keyword">&lt;</span><span class="code-leadattribute">/option</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">option</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Admin"</span><span class="code-keyword">&gt;</span>Admin<span class="code-keyword">&lt;</span><span class="code-leadattribute">/option</span><span class="code-keyword">&gt;</span>     
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">/select</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">submit"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">Login"</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Login"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/form</span><span class="code-keyword">&gt;</span></pre> 
             <p>In this form, I have just taken a value from the <code>ReturnURL</code> request parameter and put it into the form's hidden field.</p> 
             <p>The login form will submit the username and role to the action that will put the username and role into the authentication cookie. An example of such kind of action is shown in the following listing:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> ActionResult Login(<span class="code-keyword">string</span> Username, <span class="code-keyword">string</span> Role, <span class="code-keyword">string</span> ReturnUrl)
{
    <span class="code-keyword">if</span> (<span class="code-keyword">string</span>.IsNullOrEmpty(Username))
        Username = <span class="code-string">"</span><span class="code-string">Unknown"</span>;
        <span class="code-comment">//</span><span class="code-comment">Default value that is set if nothing is entered</span>

    <span class="code-keyword">var</span> authTicket = <span class="code-keyword">new</span> FormsAuthenticationTicket(<span class="code-digit">1</span>, Username, 
        DateTime.Now, DateTime.Now.AddMinutes(<span class="code-digit">30</span>), <span class="code-keyword">true</span>, 
        Role);
    <span class="code-keyword">string</span> cookieContents = FormsAuthentication.Encrypt(authTicket);
    <span class="code-keyword">var</span> cookie = <span class="code-keyword">new</span> HttpCookie(FormsAuthentication.FormsCookieName, cookieContents)
                                {
                                    Expires = authTicket.Expiration,
                                    Path = FormsAuthentication.FormsCookiePath
                                };
    Response.Cookies.Add(cookie);

    <span class="code-keyword">if</span>(!string.IsNullOrEmpty(ReturnUrl))
            Response.Redirect(ReturnUrl);

    <span class="code-keyword">return</span> View(<span class="code-string">"</span><span class="code-string">Index"</span>);
}</pre> 
             <p>This code creates an authentication cookie and puts the username and role to the cookie. Details of creating a forms authentication cookie are already covered in other articles, so if you are not familiar with this, you can see more details here: <a href="http://www.codeproject.com/Articles/36836/Forms-Authentication-and-Role-based-Authorization">Forms Authentication and Role Based Authorization: A Quicker, Simpler, and Correct Approach.</a> If a return URL is provided, the user will be redirected there, otherwise it will be redirected to the index page.</p> 
             <h3><a class="anchor" id="Membership" name="Membership" title="Membership"></a>Using the ASP.NET membership provider for user authentication</h3> 
             <p>In the example above, I have not implemented any code that checks if the user is valid and that takes the user details (e.g., role). However, you will need to decide where the user information is placed and implement code that reads this information.</p> 
             <p>The simplest way to implement authentication is to use the ASP.NET Membership provider to handle user accounts. With the ASP.NET Membership provider, you will get all standard operations for authentication and user management such as:</p> 
             <ul> 
              <li><code>bool Membership.ValidateUser(string username, string password)</code> that returns true if username/password are valid</li> 
              <li><code>MembershipUserCollection Membership.GetUsersByName(string username)</code> that searches for users by username</li> 
              <li><code>MembershipUserCollection Membership.GetUsersByEmail(string email)</code> that searches for users by email</li> 
              <li><code>MembershipUser Membership.CreateUser(string username, string password)</code> that creates a new user</li> 
              <li><code>void Membership.UpdateUser(MembershipUser user)</code> that updates user data</li> 
              <li><code>void Roles.AddUserToRole(string username, strig roleName)</code> that associates a user to a role</li> 
              <li><code>string[] Roles.GetRolesForUser(string username)</code> returns a set of roles for a user</li> 
              <li><code>bool Roles.IsUserInRole(string username, string roleName)</code> checks whether the user is in a particular role</li> 
             </ul> 
             <p>There are a lot of other static methods available in the <code>Membership</code> and <code>Roles</code> classes that can be used, including a number of overloads for methods that are shown above.</p> 
             <p>However, these classes are only an interface to the actual user storage, so you will need to bind the membership provided to the actual storage.</p> 
             <h4>Using the SQL Server membership provider</h4> 
             <p>When you use the ASP.NET Membership provider classes, you will need to bind it to some data source where user information is placed. As an example, you can bind your Membership provider to a SQL Server database using <code>SqlMembershipProvider</code>. In order to setup <code>SqlMembershipProvider</code>, you will need to setup a connection to the database where user accounts will be stored and bind the provider to the connection string. All these configurations can be placed in the <em>web.config</em> file as shown in the following example:</p> 
             <pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">configuration</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">connectionStrings</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">add</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">UserDatabaseConnection"</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">connectionString</span><span class="code-keyword">="</span><span class="code-keyword">CONNECTION STRING"</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">providerName</span><span class="code-keyword">="</span><span class="code-keyword">System.Data.SqlClient"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">/connectionStrings</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">system.web</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">membership</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">providers</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">clear</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">add</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">AspNetSqlMembershipProvider"</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">System.Web.Security.SqlMembershipProvider"</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">connectionStringName</span><span class="code-keyword">="</span><span class="code-keyword">UserDatabaseConnection"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">/providers</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">/membership</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">roleManager</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">providers</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">add</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">SqlProvider"</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">System.Web.Security.SqlRoleProvider"</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">connectionStringName</span><span class="code-keyword">="</span><span class="code-keyword">UserDatabaseConnection"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">/providers</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">/roleManager</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">/system.web</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/configuration</span><span class="code-keyword">&gt;</span></pre> 
             <p>You will need to define a connection string to the SQL Server database where user information will be placed (it is called <code>UserDatabaseConnection</code> in the example above) and add the Membership provider that will use this connection. If you wan to use roles associated to users for role based security, then you will need to configure the role manager too. There are a few other parameters for <code>SqlMembershipProvider</code> that can be set, but they are not shown. You can see more details about <code>SqlMembershipProvider</code> parameters and configuration in the MSDN articles about the <a href="http://msdn.microsoft.com/en-us/library/system.web.security.sqlmembershipprovider.aspx"><code>SqlMembershipProvider</code> class</a> and <a href="http://msdn.microsoft.com/en-us/library/system.web.security.sqlroleprovider.aspx"><code>SqlRoleProvider</code> class</a>.</p> 
             <p><code>SqlMembershipProvider</code> uses a predefined structure of database tables and Stored Procedures that must exist in the database so this provider can read/update user information. In the following figure are shown tables that are required by <code>SqlMembershipProvider</code>:</p> 
             <p align="center"><img alt="ASPNET-MVC-Security/aspnet.png" height="397" src="/KB/web-security/ASPNET-MVC-Security/aspnet.png" width="600"></p> 
             <p>If these tables are not present in the database, you will get an exception when you call any of the <code>Membership</code> methods. SQL membership procedures/tables can be easily added in the existing database; you just need to run the <em> <a href="http://msdn.microsoft.com/en-us/library/ms229862.aspx">Aspnet_regsql.exe</a></em> tool - see more details about this in the <a href="http://www.codeproject.com/Articles/89029/Using-SQL-Membership-with-ASP-NET-application">Using the SQL Membership with an ASP.NET Application</a> article.</p> 
             <h4>Creating a custom membership provider</h4> 
             <p>If you do not want to use the standard schema, or if you have your own data structure that you need to use, you can create your own custom membership provider. All you need to do is inherit the <code>MembershipProvider</code> class and implement static membership methods you need in the application as shown in the following example:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> MyMembershipProvider : MembershipProvider
{   
    <span class="code-keyword">public</span> <span class="code-keyword">override</span> <span class="code-keyword">bool</span> ValidateUser(<span class="code-keyword">string</span> username, <span class="code-keyword">string</span> password)
    {
        <span class="code-keyword">throw</span> <span class="code-keyword">new</span> NotImplementedException();
    }

    <span class="code-keyword">public</span> <span class="code-keyword">override</span> MembershipUser CreateUser(<span class="code-keyword">string</span> username, 
       <span class="code-keyword">string</span> password, <span class="code-keyword">string</span> email, <span class="code-keyword">string</span> passwordQuestion, 
       <span class="code-keyword">string</span> passwordAnswer, <span class="code-keyword">bool</span> isApproved, 
       <span class="code-keyword">object</span> providerUserKey, <span class="code-keyword">out</span> MembershipCreateStatus status)
    {
        <span class="code-keyword">throw</span> <span class="code-keyword">new</span> NotImplementedException();
    }

    <span class="code-keyword">public</span> <span class="code-keyword">override</span> MembershipUser GetUser()
    {
        <span class="code-keyword">throw</span> <span class="code-keyword">new</span> NotImplementedException();
    }
}</pre> 
             <p>Here you can put any custom code that handles user information (e.g., reading from file, LDAP, Web Service, etc.). Once you create your own provider, you will need to register it in the <em>web.config</em>:</p> 
             <pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">membership</span><span class="code-attribute"> </span><span class="code-attribute">defaultProvider</span><span class="code-keyword">="</span><span class="code-keyword">CustomMembershipProvider"</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">providers</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">clear/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">add</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">MyMembershipProvider"</span><span class="code-attribute"> </span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">Security.MyMembershipProvider"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">/providers</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/membership</span><span class="code-keyword">&gt;</span></pre> 
             <p>I have not included details about the implementation in this example because this is already explained in more detail in the <a href="http://www.codeproject.com/Articles/165159/Custom-Membership-Providers">Custom Membership Providers</a> article. Also, you can take a look at the <a href="http://www.codeproject.com/Articles/13032/Custom-MembershipProvider-and-RoleProvider-Impleme">Custom MembershipProvider and RoleProvider Implementations that use Web Services</a> article which shows how you can implement <code>MembershipProvider</code> and <code>RoleProvider</code> using Web Services.</p> 
             <h3><a class="anchor" id="SSO" name="SSO" title="SSO"></a>Single sign on</h3> 
             <p>There are common scenarios where your users use several applications where authentication is required but they don't want to login into each application separately. This scenario is shown in the following figure.</p> 
             <p align="center"><img alt="ASPNET-MVC-Security/sso.png" height="248" src="/KB/web-security/ASPNET-MVC-Security/sso.png" width="600"></p> 
             <p>Imagine that you have different users accessing four sites where each site requires authentication. Instead of forcing the user to login to each application, you can allow them to login to one, and then access other applications. In the example above, the first user logins to <em>www.site2.com</em> and another to <em>www.site3.com</em>, and the remaining sites trust this authentication mechanism and allows free access.</p> 
             <p>This is common scenario in practice - in various applications you might see login via Facebook, Google, MSN live, or other applications where cookies provided by these applications are accepted.</p> 
             <h4>Sharing Forms authentication cookies</h4> 
             <p>The easiest way to implement single sign on is to share forms authentication cookies. One application provides a forms authentication cookie and another accepts it as its own cookie. If you want to use a common authentication ticket, you must manually generate the <code>validationKey</code> and <code>decryptionKey</code> values of the <code>&lt;machineKey&gt;</code> element in the machine level <em>Web.config</em> file. An example of these values are shown below:</p> 
             <pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">machineKey</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">validationKey</span><span class="code-keyword">="</span><span class="code-keyword">21F090935F6E49C2C797F69BBAAD8402ABD2EE0B667A8B44EA7DD4374267A75D7
                      AD972A119482D15A4127461DB1DC347C1A63AE5F1CCFAACFF1B72A7F0A281B"</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">decryptionKey</span><span class="code-keyword">="</span><span class="code-keyword">ABAA84D7EC4BB56D75D217CECFFB9628809BDB8BF91CFCD64568A145BE59719F"</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">validation</span><span class="code-keyword">="</span><span class="code-keyword">SHA1"</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">decryption</span><span class="code-keyword">="</span><span class="code-keyword">AES"</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span></pre> 
             <p>By default values for <code>validationKey</code> and <code>decryptionKey</code> are auto-generated so they can isolate applications. Therefore you will need to generate your own values and share them across sites. See more details about configuring <code>machineKey</code> in the <a href="msdn.microsoft.com/en-us/library/ff649308.aspx">How to configure MachineKey in ASP.NET 2.0</a> MSDN article, where you can find a code sample that can be used for generating these random keys.</p> 
             <p>This will work fine if you have different applications placed on the same domain but on different virtual directories, such as:</p> 
             <ul> 
              <li><em>site1.com/app1</em></li> 
              <li><em>site1.com/app2</em></li> 
              <li><em>site1.com/app3</em></li> 
             </ul> 
             <p>In this case, all applications share the same cookies. However, this will not work if applications are placed in different sub-domains. E.g.:</p> 
             <ul> 
              <li><em>app1.site1.com</em></li> 
              <li><em>app2.site1.com</em></li> 
              <li><em>app3.site1.com</em></li> 
             </ul> 
             <p>Even if you allow different sites to decrypt the same cookies, they will be invisible to applications on other sub-domains because each application can use only their own domain cookies. To overcome this problem, you will need to define domains in the forms authentication tag in the <em>web.config</em>:</p> 
             <pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">authentication</span><span class="code-attribute"> </span><span class="code-attribute">mode</span><span class="code-keyword">="</span><span class="code-keyword">Forms"</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">forms</span><span class="code-attribute"> </span><span class="code-attribute">loginUrl</span><span class="code-keyword">="</span><span class="code-keyword">~/Public/Login"</span><span class="code-attribute"> </span><span class="code-attribute">domain</span><span class="code-keyword">="</span><span class="code-keyword">site1.com"</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/authentication</span><span class="code-keyword">&gt;</span></pre> 
             <p>This attribute specifies the domain that will be set on the outgoing forms-authentication cookies. See more details about the forms element on the <a href="http://msdn.microsoft.com/en-us/library/1d3t3c61.aspx">MSDN site</a>.</p> 
             <p>In the most complicated case, when applications are placed on completely different domains, you will need to implement your own SSO solution. Details are out of then scope of this article, so you might take a look for details in some other article such as <a href="Single%20Sign%20On%20(SSO)%20for%20cross-domain%20ASP.NET%20applications">Single Sign On (SSO) for cross-domain ASP.NET applications</a> or <a href="http://www.codeproject.com/KB/showcase/SSO.aspx">Single Sign-On (SSO) for .NET</a>.</p> 
             <h3><a class="anchor" id="OpenID" name="OpenID" title="OpenID"></a>Using a third party identity provider</h3> 
             <p>In some cases, you will not store user accounts in your system. In that case, user identities should be stored on some public identity provider such as Google, Facebook, Yahoo!, etc. Users do not want to login each time on separate systems if they are already logged in to one system. In that case, it is possible to check the user identity on the identity providers and authenticate the user on your site.</p> 
             <p>If you want a generic solution for third party authorization or if you don't want to choose a particular identity provider, then you should take a look at the <a href="http://openid.net/">OpenID</a> protocol. The OpenID protocol is a mediator between your website and identity providers such as Google, Facebook, Yahoo!, etc. A user that has an account in any of these providers can access your site if you implement OpenID authentication. When the user logs in to your website using the OpenID protocol, the scenario for login is:</p> 
             <ol> 
              <li>User enters his OpenID into a login form.</li> 
              <li>Browser then sends you to the OpenID provider to log in (e.g., Google, or Facebook).</li> 
              <li>User logs in to the OpenID provider with his username and password.</li> 
              <li>User confirms that the original website can use his identity.</li> 
              <li>User is sent back to the original website.</li> 
             </ol> 
             <p>I will not describe this in detail because there is a good article about the implementation of the OpenID protocol - you can find more information in the <a href="http://www.codeproject.com/Articles/136062/OpenID-With-Forms-Authentication">OpenID With Forms Authentication</a> article.</p> 
             <h2><a class="anchor" id="PAC" name="PAC" title="PAC"></a>Page access control</h2> 
             <p>Once you implement proper authentication, you will need to control what pages users can access depending on the role.</p> 
             <p>ASP.NET MVC has a great feature that can be used to implement page access security - action filters. Action filters are classes that can be attached to controllers or particular actions which contain methods that are executed before or after an action is called, when an error occurs, etc. Filters are usually attached to actions in controllers using annotations, as shown in the following example:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> PublicController : Controller
{
    [Authorize]
    <span class="code-keyword">public</span> <span class="code-keyword">string</span> Home()
    {
        <span class="code-keyword">return</span> <span class="code-string">"</span><span class="code-string">Home"</span>;
    }
}</pre> 
             <p>In this example, the <code>Authorize</code> filter attribute is added to Home action of <code>PublicController</code>. Now you cannot call this action if you are not authorized.</p> 
             <p>You can find various usage of filters that log errors, track IP addresses, or display ads in <a href="http://www.google.rs/url?sa=t&amp;rct=j&amp;q=mvc%20filters%20ip%20tracking&amp;source=web&amp;cd=2&amp;ved=0CCMQFjAB&amp;url=http%3A%2F%2Fwww.codeguru.com%2Fcsharp%2Farticle.php%2Fc18959&amp;ei=G3LJTtWUOcfLsgaQnfGwBw&amp;usg=AFQjCNGTG1e62DxBxXopfJ0eDZ-sh1VbAw&amp;sig2=R1beR207qR9gB31S3pjZzQ&amp;cad=rja">Creating Custom Action <em>Filters</em> in ASP.NET <em>MVC</em>- CodeGuru</a>. In this article, I demonstrate one usage of action filters - securing your application.</p> 
             <p>Action filters enable a centralized place for managing application-wide rules - one of this rules is controlling access to your application. In this article, I will create an action filter that controls whether the current user has enough permission rights to call a particular controller/actions in the application.</p> 
             <h3><a class="anchor" id="Standard" name="Standard" title="Standard"></a>Secure application using standard MVC filters</h3> 
             <p>The easiest way to implement security is to use filters that are already provided in the MVC framework. MVC comes with a number of filters that can be applied to your pages. One of the most important ones is the <code>[Authorize]</code> filter. In order to force authorization on some page, you can add the <code>Authorize</code> attribute on a particular action, something like in the following example:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> JovanController : Controller
{
    [Authorize(Users=<span class="code-string">"</span><span class="code-string">Jovan"</span>)]
    <span class="code-keyword">public</span> <span class="code-keyword">string</span> Home()
    {
        <span class="code-keyword">return</span> <span class="code-string">"</span><span class="code-string">Home"</span>;
    }
}</pre> 
             <p>This code will allow only a user with name "Jovan" to call this controller.</p> 
             <p>Another way to apply authorization is to put the attribute on the entire controller class, as shown in the following example:</p> 
             <pre lang="cs"><span class="code-bracket">[</span><span class="code-sdkkeyword">Authorize(Roles=<span class="code-string">"</span><span class="code-string">Administrator"</span>)<span class="code-none">]</span></span>
<span class="code-keyword">public</span> <span class="code-keyword">class</span> AdministratorController : Controller
{
    <span class="code-keyword">public</span> <span class="code-keyword">string</span> Home()
    {
        <span class="code-keyword">return</span> <span class="code-string">"</span><span class="code-string">Home"</span>;
    }
}</pre> 
             <p>In this case, actions in the controller can be called only if the user that calls actions has a role "Administrator".</p> 
             <p>A third way is to apply a global attribute that will be used in all controllers and all actions. You can apply filters globally by adding a filter as a global filter in the <code>RegisterGlobalFilters</code> method of the <em>Global.asax.cs</em> file - an example of the code is shown in the following listing:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> MvcApplication : System.Web.HttpApplication
{
    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(<span class="code-keyword">new</span> AuthorizeAttribute());
    }
}</pre> 
             <p>The Authorize attribute will be applied to all controllers and classes in the application.</p> 
             <h3><a class="anchor" id="Custom" name="Custom" title="Custom"></a>Implement custom security rules</h3> 
             <p>The standard MVC filters are fine if you can hard-code roles and users in the application, but if you need to create custom security like IP restricted access, you will need to define your own filter actions. In this application, I will assume that I have a class that determines whether some user that comes from some IP address can access a particular action in some controller. For demonstration purposes, I created the following class:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> PageAccessManager
{
    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">bool</span> IsAccessAllowed(<span class="code-keyword">string</span> Controller, 
           <span class="code-keyword">string</span> Action, IPrincipal User, <span class="code-keyword">string</span> IP)
    {
        <span class="code-keyword">if</span> (Controller == <span class="code-string">"</span><span class="code-string">Public"</span>)
            <span class="code-keyword">return</span> <span class="code-keyword">true</span>;
        <span class="code-keyword">if</span> (Controller == <span class="code-string">"</span><span class="code-string">Registered"</span> &amp;&amp; Action == <span class="code-string">"</span><span class="code-string">Login"</span>)
            <span class="code-keyword">return</span> <span class="code-keyword">true</span>;
        <span class="code-keyword">if</span> (Controller == <span class="code-string">"</span><span class="code-string">Registered"</span> &amp;&amp; Action != <span class="code-string">"</span><span class="code-string">Login"</span> 
                &amp;&amp; (User.IsInRole(<span class="code-string">"</span><span class="code-string">Registered"</span>) || User.IsInRole(<span class="code-string">"</span><span class="code-string">Admin"</span>)))
            <span class="code-keyword">return</span> <span class="code-keyword">true</span>;
        <span class="code-keyword">if</span> (Controller == <span class="code-string">"</span><span class="code-string">Admin"</span> &amp;&amp; User.IsInRole(<span class="code-string">"</span><span class="code-string">Admin"</span>))
            <span class="code-keyword">return</span> <span class="code-keyword">true</span>;

        <span class="code-keyword">return</span> <span class="code-keyword">false</span>;
    }
}</pre> 
             <p>This page has some custom logic that checks if a user can obtain access to certain action in the controller. In your real application, you will probably create some kind of custom code that reads these rules from the configuration files or database, but for demo purposes, this will be good enough. In this code, the IP address is passed to the class but not used in the rules (although it can be easily added if needed).</p> 
             <h4><a class="anchor" id="Create" name="Create" title="Create"></a>Creating custom action filters</h4> 
             <p>Custom action filters are simple classes derived from the <code>System.Web.MVC.FilterAttribute</code> class which implement one of the following interfaces:</p> 
             <ul class="interface"> 
              <li><code>IAuthorizationFilter</code> - if you want to authorize page access</li> 
              <li><code>IActionFilter</code> - if you wan to attach handlers before and after come action is called</li> 
              <li><code>IResultsFilter</code> - if you want to attach handlers before or after some result (view) is generated</li> 
              <li><code>IExceptionFilter</code> - if you want to handle exceptions that occur in actions</li> 
             </ul> 
             <p>You can see more details about the usage of these custom filters in <a href="http://www.google.rs/url?sa=t&amp;rct=j&amp;q=mvc%20filters%20ip%20tracking&amp;source=web&amp;cd=2&amp;ved=0CCMQFjAB&amp;url=http%3A%2F%2Fwww.codeguru.com%2Fcsharp%2Farticle.php%2Fc18959&amp;ei=G3LJTtWUOcfLsgaQnfGwBw&amp;usg=AFQjCNGTG1e62DxBxXopfJ0eDZ-sh1VbAw&amp;sig2=R1beR207qR9gB31S3pjZzQ&amp;cad=rja">Creating Custom Action <em>Filters</em> in ASP.NET <em>MVC</em>- CodeGuru</a>. I'm implementing a custom authorization rule so I will create a filter that implements the <code>IAuthorizationFilter</code> interface. This filter is shown in the following code:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> SecurityFilter : FilterAttribute, IAuthorizationFilter
{
    <span class="code-keyword">public</span> <span class="code-keyword">void</span> OnAuthorization(AuthorizationContext filterContext)
    {
        HttpCookie authCookie = 
          filterContext.HttpContext.Request.Cookies[FormsAuthentication.FormsCookieName];

        <span class="code-keyword">if</span> (authCookie != <span class="code-keyword">null</span>)
        {
            FormsAuthenticationTicket authTicket = 
                   FormsAuthentication.Decrypt(authCookie.Value);
            <span class="code-keyword">var</span> identity = <span class="code-keyword">new</span> GenericIdentity(authTicket.Name, <span class="code-string">"</span><span class="code-string">Forms"</span>);
            <span class="code-keyword">var</span> principal = <span class="code-keyword">new</span> GenericPrincipal(identity, <span class="code-keyword">new</span> string[]{ authTicket.UserData });
            filterContext.HttpContext.User = principal;
        }

        <span class="code-keyword">var</span> Controller = filterContext.ActionDescriptor.ControllerDescriptor.ControllerName;
        <span class="code-keyword">var</span> Action = filterContext.ActionDescriptor.ActionName;
        <span class="code-keyword">var</span> User = filterContext.HttpContext.User;
        <span class="code-keyword">var</span> IP = filterContext.HttpContext.Request.UserHostAddress;

        <span class="code-keyword">var</span> isAccessAllowed = PageAccessManager.IsAccessAllowed(Controller, Action, User, IP);
        <span class="code-keyword">if</span> (!isAccessAllowed)
        {
            FormsAuthentication.RedirectToLoginPage();
        }
    }
}</pre> 
             <p>This filter takes information from the authentication cookie that is populated in the login action described above and puts this information in the <code>User</code> object in the <code>HttpContext</code>. Then, information about the controller, action, and IP address are taken from the context and passed to the <code>PageSecurityManager</code> class that will determine if the access is to be allowed to the user.</p> 
             <p>If access to the controller's action is not allowed, the user will be redirected to the login page (the one that is set in the <em>web.config</em> file - see code above). The <code>FormsAuthentication.RedirectToLoginPage</code> method is useful not only because it automatically reads the login page from the config, but also because it puts the current URL as a <code>ReturnURL</code> parameter that is sent to the login page. This fits in to the logic of the login action described above - if the current page is passed as a <code>ReturnURL</code>, the login controller will redirect the request to the current page if login is successful.</p> 
             <p>This filter can be applied on the action in one of three ways described above:</p> 
             <ol> 
              <li>Adding the filter to an individual action</li> 
              <li>Adding the filter to an individual controller</li> 
              <li>Setting the filter globally</li> 
             </ol> 
             <p>In this example, I will add this filter globally as shown in the following code example:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> MvcApplication : System.Web.HttpApplication
{
    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> RegisterGlobalFilters(GlobalFilterCollection filters)
    {
        filters.Add(<span class="code-keyword">new</span> SecurityFilter());
    }
}</pre> 
             <p>Using this code, my custom security filter is applied on all actions in the application. If the page access manager does not allow access to a certain controller's action, the login page will be shown.</p> 
             <h4><a class="anchor" id="Error" name="Error" title="Error"></a>Handling security errors</h4> 
             <p>The code shown above works fine if you want to deny access to pages using one page access manager class. This way, the page/action will never be called at all. However, in your application, there are other components that can deny access to the user. As an example, some code can throw security error even if the current role has access to the page. In the code sample that you can download in this article, <em>/Administrator/DenyAccess</em> simulates this situation - if you are an administrator, you will be able to call this URL after the login, but it will immediately throw a <code>SecurityException</code>. In that case, some "access denied page" should be shown to the user.</p> 
             <p>I will handle this situation in the same filter by implementing the <code>IExceptionFilter</code> interface where I will implement a method that will handle the exception, if one is thrown. This code will check if the thrown exception is a security exception, and if is, it will redirect the user to a security error page. Additional code is shown in the following listing (code for the <code>OnAuthorization</code> method is omitted because it is shown above):</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> SecurityFilter : FilterAttribute, IAuthorizationFilter, IExceptionFilter
{
    <span class="code-keyword">public</span> <span class="code-keyword">void</span> OnAuthorization(AuthorizationContext filterContext)
    {
        ...
    }

    <span class="code-keyword">public</span> <span class="code-keyword">void</span> OnException(ExceptionContext filterContext)
    {

        <span class="code-keyword">if</span> (filterContext.Exception != <span class="code-keyword">null</span> &amp;&amp; 
              filterContext.Exception <span class="code-keyword">is</span> System.Security.SecurityException)
        {
            <span class="code-keyword">var</span> result = <span class="code-keyword">new</span> ViewResult();
            result.ViewName = <span class="code-string">"</span><span class="code-string">SecurityError"</span>;
            filterContext.Result = result;
            filterContext.ExceptionHandled = <span class="code-keyword">true</span>;
        }
    }</pre> 
             <p>As you can see, this code receives the exception that is thrown by the action, checks if it is a <code>SecurityException</code>, and if it is, it shows the <code>SecurityError</code> view to the page. The important line is the part where the <code>ExceptionHandled</code> property of <code>filterContext</code> is set to true - this line tells the context that the exception is successfully handled by this filter and that it should not propagate further.</p> 
             <p>Using this filter, I have managed security exception on one place and applied this to all actions in the application.</p> 
             <h4><a class="anchor" id="Inherit" name="Inherit" title="Inherit"></a>Alternative approach - Inheriting the Authorization attribute</h4> 
             <p>An alternative for filter implementation is creating a custom authorization attribute. In order to create a custom authorization attribute, you will need to extend the <code>AuthorizationAttribute</code> class and implement <code>AuthorizeCore</code> that should return <code>true</code> if the page is authorized and <code>HandleUnauthorizedRequest</code> that is called when an unauthorized request should be processed, as shown in the following example:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> CustomSecurityAttribute : AuthorizeAttribute
{

    <span class="code-keyword">protected</span> <span class="code-keyword">override</span> <span class="code-keyword">bool</span> AuthorizeCore(HttpContextBase httpContext)
    {           
        <span class="code-keyword">return</span> <span class="code-keyword">base</span>.AuthorizeCore(httpContext);
    }

    <span class="code-keyword">protected</span> <span class="code-keyword">override</span> <span class="code-keyword">void</span> HandleUnauthorizedRequest(AuthorizationContext context)
    {
        <span class="code-keyword">base</span>.HandleUnauthorizedRequest(context);
    }
}</pre> 
             <p>In the overridden method, you will need to add code similar to the code above and return true/false if the user has access. Code in the methods is similar to code in the custom filter so you can use any of these approaches, but it would be best to apply it as a global filter in the <em>Global.asax.cs</em> file:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> RegisterGlobalFilters(GlobalFilterCollection filters)
{
    filters.Add(<span class="code-keyword">new</span> CustomSecurityAttribute());
}</pre> 
             <p>In the sample code that you can download in the article, this attribute is not implemented because it is more-less a copy of the previous code. Also, this line of code is commented out in the <em>Global.asax.cs</em> file.</p> 
             <h3><a class="anchor" id="ThirdParty" name="ThirdParty" title="ThirdParty"></a>Using third party libraries for page access control</h3> 
             <p>When you implement page access security, you can use some of the existing third party libraries. I will show you how you can implement page access security using the Fluent Security library.</p> 
             <p>With the Fluent Security library, you can programmatically set page access rules to individual controllers/action. The following code sample shows how you can apply Fluent Security policies to controllers and actions.</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> RegisterGlobalFilters(GlobalFilterCollection filters)
{
    SecurityConfigurator.Configure(configuration =<span class="code-keyword">&gt;</span>
    {
        <span class="code-comment">//</span><span class="code-comment"> Let Fluent Security know how to get the authentication status of the current user</span>
        <span class="code-comment">//</span><span class="code-comment"> And let Fluent Security know how to get the roles for the current user</span>

        <span class="code-comment">//</span><span class="code-comment"> This is where you set up the policies you want Fluent Security to enforce</span>
    });
        <span class="code-comment">//</span><span class="code-comment">Add configured attribute as a global filter</span>
    GlobalFilters.Filters.Add(<span class="code-keyword">new</span> HandleSecurityAttribute(), <span class="code-digit">0</span>);
}</pre> 
             <p>In order to apply Fluent Security policies, you will need to attach <code>HandleSecurityAttribute</code> as a global filter in the <code>RegisterGlobalFilters</code> method in the <em>Global.asax.cs</em> file. When you attach an attribute, you will need to configure it first, which includes:</p> 
             <ol> 
              <li>Definition of method that will tell Fluent Security how to determine user roles.</li> 
              <li>Definition of security policies that will be applied to controllers and actions.</li> 
             </ol> 
             <p>In the first part of the configuration code, you will need to define how the Fluent Security library will take information about the user (e.g., is the user authenticated and what are his roles). This part of code is shown in the following listing:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> RegisterGlobalFilters(GlobalFilterCollection filters)
{
    SecurityConfigurator.Configure(configuration =<span class="code-keyword">&gt;</span>
    {
        <span class="code-comment">//</span><span class="code-comment"> Let Fluent Security know how to get the authentication status of the current user</span>
        configuration.GetAuthenticationStatusFrom(() =<span class="code-keyword">&gt;</span> 
               HttpContext.Current.User.Identity.IsAuthenticated);

        <span class="code-comment">//</span><span class="code-comment"> Let Fluent Security know how to get the roles for the current user</span>
        configuration.GetRolesFrom(() =<span class="code-keyword">&gt;</span>
        {
            <span class="code-keyword">var</span> authCookie = HttpContext.Current.Request.Cookies[FormsAuthentication.FormsCookieName];

            <span class="code-keyword">if</span> (authCookie != <span class="code-keyword">null</span>)
            {
                <span class="code-keyword">var</span> authTicket = FormsAuthentication.Decrypt(authCookie.Value);
                <span class="code-keyword">return</span> authTicket.UserData.Split(<span class="code-string">'</span><span class="code-string">,'</span>);
            }
            <span class="code-keyword">else</span>
            {
                <span class="code-keyword">return</span> new[]{<span class="code-string">"</span><span class="code-string">"</span>};
            }
        });

        <span class="code-comment">//</span><span class="code-comment"> This is where you set up the policies you want Fluent Security to enforce</span>
    });
        <span class="code-comment">//</span><span class="code-comment">Add configured attribute as a global filter</span>
    GlobalFilters.Filters.Add(<span class="code-keyword">new</span> HandleSecurityAttribute(), <span class="code-digit">0</span>);
}</pre> 
             <p>The code defines that Fluent Security will determine if the user is authenticated and where it will find an array of user roles (from the authentication cookie in this case). Code that is used to configure access policies is shown in the following example.</p> 
             <p>The part of the configuration code that applies security policies to controllers is shown in the following listing:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> RegisterGlobalFilters(GlobalFilterCollection filters)
{
    SecurityConfigurator.Configure(configuration =<span class="code-keyword">&gt;</span>
    {
        <span class="code-comment">//</span><span class="code-comment"> Let Fluent Security know how to get the authentication status of the current user</span>
        <span class="code-comment">//</span><span class="code-comment"> Let Fluent Security know how to get the roles for the current user</span>

        <span class="code-comment">//</span><span class="code-comment"> This is where you set up the policies you want Fluent Security to enforce</span>
        configuration.For&lt;PublicController&gt;().Ignore();

        configuration.For&lt;PublicController&gt;(x =<span class="code-keyword">&gt;</span> x.Dashboard()).RequireRole(<span class="code-string">"</span><span class="code-string">Public"</span>);

        configuration.For&lt;RegisteredController&gt;(x =<span class="code-keyword">&gt;</span> x.Index()).DenyAnonymousAccess();
        configuration.For&lt;RegisteredController&gt;(x =<span class="code-keyword">&gt;</span> x.Dashboard()).RequireRole(<span class="code-string">"</span><span class="code-string">Registered"</span>, <span class="code-string">"</span><span class="code-string">Admin"</span>);
        configuration.For&lt;RegisteredController&gt;(x =<span class="code-keyword">&gt;</span> x.Home()).RequireRole(<span class="code-string">"</span><span class="code-string">Registered"</span>, <span class="code-string">"</span><span class="code-string">Admin"</span>);
        configuration.For&lt;RegisteredController&gt;(x =<span class="code-keyword">&gt;</span> x.MyAge()).RequireRole(<span class="code-string">"</span><span class="code-string">Registered"</span>, <span class="code-string">"</span><span class="code-string">Admin"</span>);

        configuration.For&lt;AdminController&gt;(x =<span class="code-keyword">&gt;</span> x.Index()).DenyAnonymousAccess();
        configuration.For&lt;AdminController&gt;(x =<span class="code-keyword">&gt;</span> x.Dashboard()).RequireRole(<span class="code-string">"</span><span class="code-string">Admin"</span>);
        configuration.For&lt;AdminController&gt;(x =<span class="code-keyword">&gt;</span> x.Home()).RequireRole(<span class="code-string">"</span><span class="code-string">Admin"</span>);
        configuration.For&lt;AdminController&gt;(x =<span class="code-keyword">&gt;</span> x.Denied()).RequireRole(<span class="code-string">"</span><span class="code-string">Admin"</span>);
    });
        <span class="code-comment">//</span><span class="code-comment">Add configured attribute as a global filter</span>
    GlobalFilters.Filters.Add(<span class="code-keyword">new</span> HandleSecurityAttribute(), <span class="code-digit">0</span>);
}</pre> 
             <p>Code for initialization of user roles that is explained in the previous example in not shown here. This part of the configuration code defines that rules should not be applied to the public controller except on the dashboard action where only a user with a "Public" role can access. On all index actions, anonymous access is denied. In order to access actions in the registered controller, the user needs to have a "Registered" or "Admin" role, and to access Admin actions, he would need to have an "Admin" role.</p> 
             <p>Note that in the code sample that can be downloaded, this attribute is commented out because custom code access security is active but you can easily comment out the custom security filter and add this attribute.</p> 
             <p>There is a number of policies that can be added to the controllers/actions such as:</p> 
             <ol> 
              <li><code>DenyAnonymousAccess</code> - The user must be authenticated. Requires no specific role.</li> 
              <li><code>DenyAuthenticatedAccess</code> - The user must be anonymous.</li> 
              <li><code>RequireRole</code> - The user must be authenticated with one or more of the specified roles.</li> 
              <li><code>RequireAllRoles</code> - The user must be authenticated with all of the specified roles.</li> 
              <li><code>Ignore</code> - All users are allowed.</li> 
             </ol> 
             <p>See more details on the <a href="http://www.fluentsecurity.net/">Fluent Security website</a>.</p> 
             <h3><a class="anchor" id="CLP" name="CLP" title="CLP"></a>Control-level protection</h3> 
             <p>Sometimes you will need to create a more fine-grained permission policy where you need to allow users to see particular sections on the page. In that case, you will allow the user to access some page, but in the view, you will need to control whether some part of the page should or should not be shown. The easiest way is to simply surround parts of the pages that should be protected directly in the view. Something like the following code:</p> 
             <pre lang="aspnet">@if (User.IsInRole("Admin"))
{
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">h2</span><span class="code-keyword">&gt;</span>Admin pages<span class="code-keyword">&lt;</span><span class="code-leadattribute">/h2</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">a</span><span class="code-attribute"> </span><span class="code-attribute">href</span><span class="code-keyword">="</span><span class="code-keyword">/Admin/Index"</span><span class="code-keyword">&gt;</span>Index<span class="code-keyword">&lt;</span><span class="code-leadattribute">/a</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">a</span><span class="code-attribute"> </span><span class="code-attribute">href</span><span class="code-keyword">="</span><span class="code-keyword">/Admin/Home"</span><span class="code-keyword">&gt;</span>Home<span class="code-keyword">&lt;</span><span class="code-leadattribute">/a</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">a</span><span class="code-attribute"> </span><span class="code-attribute">href</span><span class="code-keyword">="</span><span class="code-keyword">/Admin/Dashboard"</span><span class="code-keyword">&gt;</span>Dashboard<span class="code-keyword">&lt;</span><span class="code-leadattribute">/a</span><span class="code-keyword">&gt;</span>
}
@if (User.IsInRole("Registered"))
{
    @Html.RenderPartial("SignOut");
}

@if (User.IsInRole("Public"))
{
    @Html.Action("Ad", "Public");
}</pre> 
             <p>I believe that this solution is simple enough and that you will not need any additional frameworks for control access. It is simple enough and do not require any dirty coding - you can surround any part of a page, partial view, or call to action with the appropriate condition. You can put this condition inside the partial view if you do not want to repeat it around each call.</p> 
             <h4><a class="anchor" id="ControlSecurityFilter" name="ControlSecurityFilter" title="ControlSecurityFilter"></a>Control level protection using security filters</h4> 
             <p>As an alternative, you can use filters to control whether the controller action should display results. You can use the same filters as the ones that control page access security (described above). An example of the filter that blocks output if the user does not have permission to access an action is shown in the following listing:</p> 
             <pre lang="cs"><span class="code-keyword">using</span> System.Web.Mvc;

<span class="code-keyword">public</span> <span class="code-keyword">class</span> SecurityFilter : FilterAttribute, IActionFilter
{
    <span class="code-keyword">public</span> <span class="code-keyword">void</span> OnActionExecuting(ActionExecutingContext filterContext)
    {
    }

    <span class="code-keyword">public</span> <span class="code-keyword">void</span> OnActionExecuted(ActionExecutedContext filterContext)
    {
        <span class="code-keyword">if</span> (filterContext.ActionDescriptor.ControllerDescriptor.ControllerName == <span class="code-string">"</span><span class="code-string">Admin"</span>
            &amp;&amp; filterContext.ActionDescriptor.ActionName == <span class="code-string">"</span><span class="code-string">Home"</span>
            &amp;&amp; User.IsInRole(<span class="code-string">"</span><span class="code-string">Registered"</span>))
            filterContext.Result = <span class="code-keyword">null</span>;
    }
}</pre> 
             <p>In the example above, I have created a security filter that implements the <code>IActionFilter</code> interface. This filter will be called before and after each action method call. After an action is executed, I check if the registered user tried to open the Admin/Home page. If so, this filter will set the result that is returned in the view to a null value and nothing will be generated as output.</p> 
             <p>Another way to implement security checks it to implement <code>IResultFilter</code> and define security check rules in the <code>OnResultExecuting</code> method. An example is shown in the following listing:</p> 
             <pre lang="cs"><span class="code-keyword">using</span> System.Web.Mvc;

<span class="code-keyword">public</span> <span class="code-keyword">class</span> SecurityFilter : FilterAttribute, IResultFilter
{
    <span class="code-keyword">public</span> <span class="code-keyword">void</span> OnResultExecuting(ResultExecutingContext filterContext)
    {
        <span class="code-keyword">var</span> viewResult = filterContext.Result <span class="code-keyword">as</span> ViewResult;
        <span class="code-keyword">var</span> controller = filterContext.RouteData.Values[<span class="code-string">"</span><span class="code-string">controller"</span>];
        <span class="code-keyword">var</span> action = filterContext.RouteData.Values[<span class="code-string">"</span><span class="code-string">action"</span>];
        <span class="code-keyword">var</span> view = viewResult.ViewName;
        <span class="code-keyword">if</span> (controller == <span class="code-string">"</span><span class="code-string">Admin"</span> &amp;&amp; 
            action == <span class="code-string">"</span><span class="code-string">Index"</span> &amp;&amp;
            view == <span class="code-string">"</span><span class="code-string">Blocked"</span>)
            filterContext.Cancel = <span class="code-keyword">true</span>;
    }

    <span class="code-keyword">public</span> <span class="code-keyword">void</span> OnResultExecuted(ResultExecutedContext filterContext)
    {
    }
}</pre> 
             <p>The controller action returns an <code>ActionResult</code> that will be executed to generate output. In this case, the <code>OnResultExecuting</code> method will be called before the <code>ActionResult</code> object is called to render the view. In this method, you can take the names of the controller, action, and view, and decide whether the execution result should be canceled or not.</p> 
             <p>Both of these methods will block both direct calls, AJAX calls, and <code>@Html.Action</code> method calls, but will not work with the <code>@Html.RenderPartial</code> method because this method does not call a new action. The best way to protect partial views is to set some logic conditions in the view.</p> 
             <h2><a class="anchor" id="CAS" name="CAS" title="CAS"></a>Code Access Security</h2> 
             <p>Page access security ensures that the user cannot open any restricted page if he does not have enough permissions. However, in some cases you will need to implement security constraints in the code, where you will need to check whether the user who can open some page can access some code, data, or other resources. As an example, you will need to check whether a user can open or write a file in some folder. In this section, I will make no difference between code and data access security, because I will assume that when we are protecting data, we are protecting code that accesses the data. Hence, in this overview, there is no difference between code access security and data access security - if you want to secure data, you secure the code that accesses the data.</p> 
             <p>The standard way to implement code/data access security is to implement custom rules in the code that reads/writes data. However, there is another alternative - to use .NET security permissions. Here I will show a brief overview of security, but you can find more details in <a href="http://www.codeproject.com/Articles/5724/Understanding-NET-Code-Access-Security">Understanding .NET Code Access Security</a>.</p> 
             <h3><a class="anchor" id="CASSTD" name="CASSTD" title="CASSTD"></a>Using standard security permissions</h3> 
             <p>.NET Framework provides a mechanism for demanding permissions to access code. There are a number of different built-in permissions you can use directly in your code such as:</p> 
             <ol> 
              <li><a href="http://msdn.microsoft.com/en-us/library/system.security.permissions.fileiopermission.aspx"><code>FileIOPermission</code></a> that enables you to demand that the current user has right to access some file or folder (e.g., read or write permission),</li> 
              <li><a href="http://msdn.microsoft.com/en-us/library/system.security.permissions.principalpermission.aspx"><code>PrincipalPermission</code></a> that enables you to demand that the current user has some name or role.</li> 
             </ol> 
             <p>There are two ways to perform security checks - declarative and imperative.</p> 
             <p>In declarative code access security, you can add an attribute to some method - an example is shown below:</p> 
             <pre lang="cs"><span class="code-bracket">[</span><span class="code-sdkkeyword">PrincipalPermissionAttribute(SecurityAction.Demand, Role = <span class="code-string">"</span><span class="code-string">Admin"</span>)<span class="code-none">]</span></span>
<span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> Method()
{
}</pre> 
             <p>In this example, it is demanded that the current user has the role "Admin" - otherwise a <code>SecurityException</code> will be thrown. Note that declarative security checks are hardcoded. Once compiled, you cannot change rules.</p> 
             <p>In the imperative manner, you put security demands directly in code. An example is shown in the following listing:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> SendFile(<span class="code-keyword">string</span> file)
{   
    <span class="code-keyword">var</span> f = <span class="code-keyword">new</span> FileIOPermission(FileIOPermissionAccess.Read, <span class="code-string">"</span><span class="code-string">C:\\test_r"</span>);
    f.AddPathList(FileIOPermissionAccess.Write | FileIOPermissionAccess.Read, <span class="code-string">"</span><span class="code-string">C:\\example\\out.txt"</span>);
    <span class="code-keyword">if</span>(file!=<span class="code-keyword">null</span>)
    {
        f.Demand();
    }
}</pre> 
             <p>The imperative method is more flexible because you can create complex permissions, combine them, and optionally call demand actions.</p> 
             <h3><a class="anchor" id="CASCustom" name="CASCustom" title="CASCustom"></a> Using custom permissions</h3> 
             <p>If you need to use some custom permission, you can create your own permission rules. In that case, you should create your own permission class - see more details about creating these classes in the <a href="http://msdn.microsoft.com/en-us/library/yaah0wb2.aspx" target="_blank">Implementing a Custom Permission</a> article. In shot, everything you need to do is:</p> 
             <ol> 
              <li>Create a class that extends the <code>CodeAccessPermission</code> class and implements the <code>IUnrestrictedPermission</code> interface.</li> 
              <li>Mark the class as serializable.</li> 
              <li>Override/define methods for copying, intersecting, and determining if a permission object is a subset of the current permission object.</li> 
              <li>Implement methods for serialization from and to XML.</li> 
              <li>Implement a method that will determine if permission is unrestricted.</li> 
              <li>Optionally you can define a custom security attribute class in order to use declarative security - see the <a href="http://msdn.microsoft.com/en-us/library/84kh7ht8.aspx">Adding Declarative Security Support</a> article for more details.</li> 
             </ol> 
             <p>An example of such a class is shown in the following listing - you can find a complete example in the <a href="http://msdn.microsoft.com/en-us/library/yaah0wb2.aspx">Implementing a Custom Permission</a> article.</p> 
             <pre lang="cs"><span class="code-bracket">[</span><span class="code-sdkkeyword">Serializable()<span class="code-none">]</span></span>
<span class="code-keyword">public</span> <span class="code-keyword">sealed</span> <span class="code-keyword">class</span> CustomPermission : CodeAccessPermission, IUnrestrictedPermission
{
    <span class="code-keyword">public</span> CustomPermission(PermissionState state)
    {
    }

    <span class="code-keyword">public</span> <span class="code-keyword">bool</span> IsUnrestricted()
    {
    }

    <span class="code-keyword">public</span> <span class="code-keyword">override</span> IPermission Copy()
    {
    }

    <span class="code-keyword">public</span> <span class="code-keyword">override</span> IPermission Intersect(IPermission target)
    {
    }

    <span class="code-keyword">public</span> <span class="code-keyword">override</span> <span class="code-keyword">bool</span> IsSubsetOf(IPermission target)
    {
        
    }

    <span class="code-keyword">public</span> <span class="code-keyword">override</span> <span class="code-keyword">void</span> FromXml(SecurityElement PassedElement)
    {
        <span class="code-comment">//</span><span class="code-comment">Get the unrestricted value from the XML and initialize </span>
        <span class="code-comment">//</span><span class="code-comment">the current instance of unrestricted to that value.</span>
    }

    <span class="code-keyword">public</span> <span class="code-keyword">override</span> SecurityElement ToXml()
    {
        <span class="code-comment">//</span><span class="code-comment">Encode the current permission to XML using the </span>
        <span class="code-comment">//</span><span class="code-comment">SecurityElement class.</span>
    }
}</pre> 
             <p>Once you have defined this class, you can control code access, as you can see in the following example.</p> 
             <p>If you want some code to be protected, you will need to demand that permission in the code. Demanding code in the imperative manner looks like in the following example.</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> Service
{
    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> Method1()
    {
        Method2();
    }

    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> Method2()
    {
        Method3();
    }

    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> Method3()
    {
        RequireCustomPermission();
    }

    <span class="code-keyword">public</span> <span class="code-keyword">static</span> <span class="code-keyword">void</span> RequireCustomPermission()
    {
        <span class="code-keyword">var</span> cp = <span class="code-keyword">new</span> CustomPermission(PermissionState.Unrestricted);
        cp.Demand();
    }
}</pre> 
             <p>In the <code>RequireCustomPermission()</code> method, a new instance of custom permission is created and it is demanded that a calling code has this custom permission. The <code>Demand()</code> call will go through all methods that have called this method (<code>Method3</code>, <code>Method2</code>, and <code>Method1</code>) and checks if any of them has this custom permission enabled or disabled.</p> 
             <p>If you wan to prevent some caller from executing the <code>RequireCustomPermission()</code> method, you will need to instate this permission and disallow it. The following code shows how you can deny permission in some caller:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">string</span> Protected()
{
    <span class="code-keyword">var</span> cp = <span class="code-keyword">new</span> CustomPermission(PermissionState.None);
    cp.PermitOnly();
    Service.Method1();
    <span class="code-keyword">return</span> <span class="code-string">"</span><span class="code-string">ok"</span>;
}</pre> 
             <p>This code creates a custom permission object with a <code>None</code> permission and defines that this permission is permitted. In other words, no access to the resource is set in this code - see more details about the <a href="http://msdn.microsoft.com/en-us/library/y6abcbh4%28v=VS.100%29.aspx">PermitOnly method here</a>. When this code, that has no permission to access resources, calls method <code>Method1</code>, which calls <code>Method2</code>, <code>Method3</code>, and the <code>RequireCustomPermission</code> method, once the <code>Demand</code> method is called, a <code>SecurityException</code> will be thrown, and your code in <code>RequireCustomPermission</code> will be protected. If this method is part of some controller, the following exception will be thrown:</p> 
             <p align="center"><a href="/KB/web-security/ASPNET-MVC-Security/permission_exception.png" title="Click to enlarge"><img border="0" height="357" src="/KB/web-security/ASPNET-MVC-Security/permission_exception_small.png" width="600"></a></p> 
             <p>As you can see, the security exception is thrown in the <code>.Demand()</code> call. In the stack trace, you can see the full path of the methods that are called.</p> 
             <p>There was another method in the .NET security package - <code>Deny</code>. However, this method is deprecated in .NET Framework 4.0 and calling this method will cause a runtime error.</p> 
             <p>If you are interested in more details, you might read some other articles that describe this in more details such as <a href="http://www.codeproject.com/Articles/5724/Understanding-NET-Code-Access-Security">Understanding .NET Code Access Security</a>. Code Access Security is a very wide area, so I cannot cover everything in one section. Therefore, it would be better to take a look at existing articles where this is already explained in more detail.</p> 
             <h2><a class="anchor" id="HTTPS" name="HTTPS" title="HTTPS"></a>Forcing the HTTPS protocol</h2> 
             <p>In order to protect sensitive data, the best practice is to use HTTPS instead of HTTP. The HTTPS protocol will automatically encrypt sensitive information that is posted from the client to the server, so nobody can use network sniffers to intercept and read these information.</p> 
             <p>In MVC, the <code>[RequireHttps]</code> attribute can be used to force HTTPS. If you put this attribute on a particular action, it will redirect the request to the <em>https://SITE/Controller/Action</em> URL if it is called with <em>http://SITE/Controller/Action</em>. This is useful if you want to make sure that some actions must be executed via the HTTPS protocol instead of plain HTTP. An example is shown below:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> PublicController : Controller
{
    [RequireHttps]
    <span class="code-keyword">public</span> <span class="code-keyword">string</span> Login()
    {
        <span class="code-keyword">return</span> View();
    }
}</pre> 
             <p>If you try to call the login page using <em>http://..../Public/Login</em>, you will be immediately redirected to the HTPS version of the page <em>https://..../Public/Login</em> where you can enter the login details.</p> 
             <p>Note that HTTPS needs to be configured on IIS in order to make this work (it is not enabled by default).</p> 
             <p>You can also protect your form authentication mechanism by setting that SSL is required for passing an authentication cookie. This is shown in the following example:</p> 
             <pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">configuration</span><span class="code-keyword">&gt;</span>
   <span class="code-keyword">&lt;</span><span class="code-leadattribute">system.web</span><span class="code-keyword">&gt;</span>
   <span class="code-keyword">&lt;</span><span class="code-leadattribute">authentication</span><span class="code-attribute"> </span><span class="code-attribute">mode</span><span class="code-keyword">="</span><span class="code-keyword">Forms"</span><span class="code-keyword">&gt;</span>
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">forms</span><span class="code-attribute"> </span><span class="code-attribute">requireSSL</span><span class="code-keyword">="</span><span class="code-keyword">true"</span><span class="code-attribute"> </span><span class="code-attribute">loginUrl</span><span class="code-keyword">="</span><span class="code-keyword">login.aspx"</span><span class="code-keyword">&gt;</span> 
      <span class="code-keyword">&lt;</span><span class="code-leadattribute">/forms</span><span class="code-keyword">&gt;</span>
   <span class="code-keyword">&lt;</span><span class="code-leadattribute">/authentication</span><span class="code-keyword">&gt;</span>
   <span class="code-keyword">&lt;</span><span class="code-leadattribute">/system.web</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/configuration</span><span class="code-keyword">&gt;</span></pre> 
             <p>If you set the <code>requireSSL</code> attribute to true, an authentication cookie will be encrypted using the standard SSL protocol. Se more details about this attribute in the <a href="http://msdn.microsoft.com/en-us/library/1d3t3c61.aspx">forms Element for authentication (ASP.NET Settings Schema)</a> article.</p> 
             <p>If your cookies contain sensitive information, you can require that they are transferred via secure socket layer. You will need to set the <code>requireSSL</code> attribute in the <em>web.config</em> as shown in the following example:</p> 
             <pre lang="xml"><span class="code-keyword">&lt;</span><span class="code-leadattribute">configuration</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">system.web</span><span class="code-keyword">&gt;</span>
        <span class="code-keyword">&lt;</span><span class="code-leadattribute">httpCookies</span><span class="code-attribute"> </span><span class="code-attribute">requireSSL</span><span class="code-keyword">="</span><span class="code-keyword">true"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">/system.web</span><span class="code-keyword">&gt;</span> 
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/configuration</span><span class="code-keyword">&gt;</span></pre> 
             <p>See more details about this setting on the MSDN <a href="http://msdn.microsoft.com/en-us/library/ms228262.aspx">httpCookies Element (ASP.NET Settings Schema)</a> article.</p> 
             <h2><a class="anchor" id="CSRF" name="CSRF" title="CSRF"></a>Cross-site request forgery</h2> 
             <p><a href="http://en.wikipedia.org/wiki/Cross-site_request_forgery">Cross-site request forgery</a> attack is a kind of attack where an external site/script exploits the user identity information stored in the browser (e.g., cookies).</p> 
             <p>Let us assume that you are accessing your bank site and at the same time you are browsing other sites (e.g., in another tab). You are logged in to your bank's site, authenticated, and your authentication information is placed in browser cookies. At the same time you have opened some page on another site <em>www.evil.com</em> in a second tab. In that case, you will be accessing two servers at the same time as shown in the following figure:</p> 
             <p align="center"><img alt="ASPNET-MVC-Security/CSRF.PNG" height="281" src="/KB/web-security/ASPNET-MVC-Security/CSRF.PNG" width="600"></p> 
             <p>Imagine that you have opened some page on the second site (<em>www.evil.com</em>) where is placed some form with an <code>action</code> attribute that points to your bank site and that has some script that immediately submits the form. Once you load this page from the evil site, it will post a request from your browser to your bank site. This request will take all authentication cookies from the browser and your bank server will not know whether this call is performed via the first tab (regular usage) or second tab (request forgery attack), so it will authenticate this malicious request and accept it. In this case, the script might clean your account.</p> 
             <h3><a class="anchor" id="CSRFPrevention" name="CSRFPrevention" title="CSRFPrevention"></a>Preventing cross-site request forgery attacks</h3> 
             <p>As an example, I have added a dummy link on a page that posts request to the <em>/Registered/MyAge</em> action and sets the age to 0.</p> 
             <pre lang="jscript">&lt;a id=<span class="code-string">"</span><span class="code-string">CSFR"</span>&gt;Click me to reset your age!!!!<span class="code-keyword">&lt;/</span><span class="code-leadattribute">a</span><span class="code-keyword">&gt;</span>

&lt;script type=<span class="code-string">"</span><span class="code-string">text/javascript"</span>&gt;
    $(<span class="code-string">"</span><span class="code-string">#CSFR"</span>).click(<span class="code-keyword">function</span> () {
        $.ajax({
            url: <span class="code-string">"</span><span class="code-string">/Registered/MyAge"</span>,
            data: { age: <span class="code-string">"</span><span class="code-string">0"</span> },
            type: <span class="code-string">'</span><span class="code-string">POST'</span>,
            success: <span class="code-keyword">function</span> () { alert(<span class="code-string">"</span><span class="code-string">Attack succeeded"</span>);  },
            error: <span class="code-keyword">function</span> () { alert(<span class="code-string">"</span><span class="code-string">Attack failed"</span>); }
        });
    });
&lt;/script&gt;</pre> 
             <p>If you click on the link, your age will be reset to 0 although you didn't want this, because this request sends cookies to the server. The same thing would happen if this script is on another site that you have opened in another tab (however, in that case, the <code>url</code> parameter in the AJAX code will need to have a direct URL to your application). MVC enables you to protect your pages from CSRF attacks by adding a token on the page that will be checked on the server-side. An example of a token that is added to the <code>MyAge</code> view is shown in the following code:</p> 
             <pre lang="aspnet"><span class="code-keyword">&lt;</span><span class="code-leadattribute">form</span><span class="code-attribute"> </span><span class="code-attribute">action</span><span class="code-keyword">="</span><span class="code-keyword">/Registered/MyAge"</span><span class="code-attribute"> </span><span class="code-attribute">method</span><span class="code-keyword">="</span><span class="code-keyword">post"</span><span class="code-keyword">&gt;</span>
  @Html.AntiForgeryToken()
  My Age:<span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">text"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">age"</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">@Model"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">submit"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">Save"</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Save"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/form</span><span class="code-keyword">&gt;</span></pre> 
             <p>In the controller, we should add the <code>[ValidateAntiForgeryTokenAttribute]</code> attribute that checks whether the anti-forgery token exists in the request, as shown in the following example:</p> 
             <pre lang="cs"><span class="code-bracket">[</span><span class="code-sdkkeyword">ValidateAntiForgeryTokenAttribute<span class="code-none">]</span></span>
<span class="code-keyword">public</span> ActionResult MyAge(<span class="code-keyword">string</span> age)
{
    Session[<span class="code-string">"</span><span class="code-string">age"</span>] = age;
    <span class="code-keyword">return</span> View(Session[<span class="code-string">"</span><span class="code-string">age"</span>]);
}</pre> 
             <p>If token is not sent in the request, the call will fail. If you try to click on the link, you will get an error message. However, if you try to remove this token and attribute, the AJAX call will succeed and your age will be reset.</p> 
             <h2><a class="anchor" id="XSS" name="XSS" title="XSS"></a>Preventing cross-site scripting</h2> 
             <p>Cross site scripting occurs when someone enters potentially dangerous tags that execute some JavaScript. An example of a potentially dangerous script that can be injected in a page is shown in the following listing:</p> 
             <pre lang="html"><span class="code-keyword">&lt;</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span>alert(<span class="code-string">"</span><span class="code-string">hello"</span>);<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span></pre> 
             <p>Instead of the simple alert here, any other script that takes your cookies can be added and the cookies sent to some third party site, some ads injected in the page, etc. MVC enables automatic protection of your code against XSS attacks using the following rules:</p> 
             <ol> 
              <li>Any content that is placed on pages is automatically HTML encoded so if you have some potentially dangerous script, it will be shown as text.</li> 
              <li>If a request contains a potentially dangerous script in any parameter, an error will be returned.</li> 
             </ol> 
             <p>However in most cases, you will need to turn off this default validation. Examples are:</p> 
             <ol> 
              <li>In a CMS system, raw HTML is placed in the database and it should be shown to the user as HTML because it contains a different formatting.</li> 
              <li>If you are using an HTML WYSIWYG editor (e.g., TinyMCE, XStandard) that enables the user to format text, you will need to disable HTML validation because you know that you want to receive HTML from the browser.</li> 
             </ol> 
             <p>In the following example, I will show you what could happen if you turn-off default validation and how you can implement a trade-off.</p> 
             <h3><a class="anchor" id="XEEExample" name="XEEExample" title="XEEExample"></a>XSS vulnerable code - An example</h3> 
             <p>In this section, I will show you an example of XSS vulnerable code. Let us assume that we need to create a page that enables the user to enter his profile. Also, I will assume that the profile has a rich format so it needs to allow HTML formatting. To implement this, we will need to create the two following actions:</p> 
             <pre lang="cs"><span class="code-keyword">public</span> <span class="code-keyword">class</span> RegisteredController : Controller
{
    [HttpGet]
    <span class="code-keyword">public</span> ActionResult Profile()
    {
        <span class="code-keyword">var</span> age = Convert.ToString(Session[<span class="code-string">"</span><span class="code-string">profile"</span>]);
        <span class="code-keyword">return</span> View(Session[<span class="code-string">"</span><span class="code-string">profile"</span>]);
    }

    [HttpPost]
    [ValidateInput(<span class="code-keyword">false</span>)]
    <span class="code-keyword">public</span> ActionResult Profile(<span class="code-keyword">string</span> profile)
    {
        Session[<span class="code-string">"</span><span class="code-string">profile"</span>] = profile;
        <span class="code-keyword">return</span> View(Session[<span class="code-string">"</span><span class="code-string">profile"</span>]);
    }
}</pre> 
             <p>The GET action shows the user profile from the session, and the POST action writes it back to the session. Note that I have to place the <code>ValidateInput(false)</code> attribute in order to prevent the MVC framework from throwing a "Potentially dangerous request" exception when it finds the HTML code in the profile.</p> 
             <p>The View for this action is shown in the following listing:</p> 
             <pre lang="aspnet">@model string

<span class="code-keyword">&lt;</span><span class="code-leadattribute">h2</span><span class="code-keyword">&gt;</span>Profile<span class="code-keyword">&lt;</span><span class="code-leadattribute">/h2</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">p</span><span class="code-keyword">&gt;</span>@Html.Raw(Model)<span class="code-keyword">&lt;</span><span class="code-leadattribute">/p</span><span class="code-keyword">&gt;</span>

<span class="code-keyword">&lt;</span><span class="code-leadattribute">h3</span><span class="code-keyword">&gt;</span>Update profile<span class="code-keyword">&lt;</span><span class="code-leadattribute">/h3</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">form</span><span class="code-attribute"> </span><span class="code-attribute">action</span><span class="code-keyword">="</span><span class="code-keyword">/Registered/Profile"</span><span class="code-attribute"> </span><span class="code-attribute">method</span><span class="code-keyword">="</span><span class="code-keyword">post"</span><span class="code-keyword">&gt;</span>
    Profile:<span class="code-keyword">&lt;</span><span class="code-leadattribute">textarea</span><span class="code-attribute"> </span><span class="code-attribute">id</span><span class="code-keyword">="</span><span class="code-keyword">profile"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">profile"</span><span class="code-attribute"> </span><span class="code-attribute">rows</span><span class="code-keyword">="</span><span class="code-keyword">10"</span><span class="code-attribute"> </span><span class="code-attribute">cols</span><span class="code-keyword">="</span><span class="code-keyword">40"</span><span class="code-keyword">&gt;</span>@Model<span class="code-keyword">&lt;</span><span class="code-leadattribute">/textarea</span><span class="code-keyword">&gt;</span>
    <span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">submit"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">Save"</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Save"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/form</span><span class="code-keyword">&gt;</span></pre> 
             <p>This view displays the profile as HTML and allows the user to update the profile (in a real example, I would use the TinyMCE editor instead of a plain text area). Note that I need to place <code>Html.Raw</code> in order to prevent MVC to automatically encode model content. <code>Html.Raw</code> will display it as raw HTML code.</p> 
             <p>Setting <code>ValidateInput(false)</code> makes this code vulnerable to XSS attacks. If the user enters something like the following text:</p> 
             <pre lang="html"><span class="code-keyword">&lt;</span><span class="code-leadattribute">script</span><span class="code-attribute"> </span><span class="code-attribute">src</span><span class="code-keyword">="</span><span class="code-keyword">http://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">text/javascript"</span><span class="code-keyword">&gt;</span><span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">style</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">text/css"</span><span class="code-keyword">&gt;</span>
.<span class="code-leadattribute">red</span> { <span class="code-attribute">color</span><span class="code-keyword">:</span><span class="code-keyword"> red }</span>
&lt;/style&gt;
<span class="code-leadattribute">&lt;hr</span> /&gt;
<span class="code-leadattribute">&lt;h2</span> id="title"&gt;Hello<span class="code-keyword">&lt;/</span><span class="code-leadattribute">h2</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">text"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">keyword"</span><span class="code-attribute"> </span><span class="code-attribute">id</span><span class="code-keyword">="</span><span class="code-keyword">keyword"</span><span class="code-attribute"> </span><span class="code-attribute">data-rel</span><span class="code-keyword">="</span><span class="code-keyword">Custom"</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">p</span><span class="code-attribute"> </span><span class="code-attribute">style</span><span class="code-keyword">="</span><span class="code-keyword">border:solid"</span><span class="code-keyword">&gt;</span>This is some <span class="code-keyword">&lt;</span><span class="code-leadattribute">b</span><span class="code-keyword">&gt;</span>Profile<span class="code-keyword">&lt;</span><span class="code-leadattribute">/b</span><span class="code-keyword">&gt;</span>  <span class="code-keyword">&lt;</span><span class="code-leadattribute">em</span><span class="code-keyword">&gt;</span>text<span class="code-keyword">&lt;</span><span class="code-leadattribute">/em</span><span class="code-keyword">&gt;</span>. <span class="code-keyword">&lt;</span><span class="code-leadattribute">br/</span><span class="code-keyword">&gt;</span>
Validate Input <span class="code-keyword">&lt;</span><span class="code-leadattribute">u</span><span class="code-keyword">&gt;</span>must be disabled<span class="code-keyword">&lt;</span><span class="code-leadattribute">/u</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">img</span><span class="code-attribute"> </span><span class="code-attribute">src</span><span class="code-keyword">="</span><span class="code-keyword">http://i.msdn.microsoft.com/Areas/Sto/Content/Images/ShareThis/email.gif"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
in order to <span class="code-keyword">&lt;</span><span class="code-leadattribute">span</span><span class="code-attribute"> </span><span class="code-attribute">class</span><span class="code-keyword">="</span><span class="code-keyword">red"</span><span class="code-keyword">&gt;</span>display<span class="code-keyword">&lt;</span><span class="code-leadattribute">/span</span><span class="code-keyword">&gt;</span> formatted text.<span class="code-keyword">&lt;</span><span class="code-leadattribute">/p</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">img</span><span class="code-attribute"> </span><span class="code-attribute">alt</span><span class="code-keyword">="</span><span class="code-keyword">Hello"</span><span class="code-attribute"> </span><span class="code-attribute">src</span><span class="code-keyword">="</span><span class="code-keyword">javascript:alert('Hello from image source')"</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">onload</span><span class="code-keyword">="</span><span class="code-keyword">javascript:alert('Hello after load')"</span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">onclick</span><span class="code-keyword">="</span><span class="code-keyword">javascript:alert('Hello after click')"</span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span>alert(<span class="code-string">"</span><span class="code-string">hello"</span>);<span class="code-keyword">&lt;</span><span class="code-keyword">/</span><span class="code-leadattribute">script</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">hr/</span><span class="code-keyword">&gt;</span></pre> 
             <p>You will see an alert once you reload the view because there is a potentially dangerous JavaScript that has passed .NET validation. Now we have disabled strict .NET validation, but we have opened the door for various script attacks. Although the input cannot be validated in order to accept HTML code, there should be some validation that prevents dangerous code.</p> 
             <h3><a class="anchor" id="AntiXSS" name="AntiXSS" title="AntiXSS"></a>Anti-XSS Library</h3> 
             <p>Microsoft's Anti-XSS library will enable you to clean posted HTML code with more intelligent rules than rejecting a request that has any HTML tag. You can download the Anti-XSS library <a href="http://www.microsoft.com/download/en/details.aspx?id=5242">from here</a>, and XSS libraries are included in the code sample.</p> 
             <p>If you want to clean HTML input taken from the user, you can use the <code>GetSafeHtmlFragment</code> method of the <code>Sanitizer</code> class (in version 3.1, this method is placed in the <code>AntiXSS</code> class, but it has moved since 4.0):</p> 
             <pre lang="cs"><span class="code-bracket">[</span><span class="code-sdkkeyword">HttpPost<span class="code-none">]</span></span>
[ValidateInput(<span class="code-keyword">false</span>)]
<span class="code-keyword">public</span> ActionResult Profile(<span class="code-keyword">string</span> profile)
{
      Session[<span class="code-string">"</span><span class="code-string">profile"</span>] = Sanitizer.GetSafeHtmlFragment(profile);
      <span class="code-keyword">return</span> View(Session[<span class="code-string">"</span><span class="code-string">profile"</span>]);
}</pre> 
             <p>This call will remove potentially dangerous tags (e.g., <code>&lt;script&gt;</code>) from the input text and leave just the safe ones. If you want to store the original HTML in the database or you cannot control the input, another solution might be to encode it directly in the view:</p> 
             <pre lang="aspnet">@model string

<span class="code-keyword">&lt;</span><span class="code-leadattribute">h2</span><span class="code-keyword">&gt;</span>Profile<span class="code-keyword">&lt;</span><span class="code-leadattribute">/h2</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">p</span><span class="code-keyword">&gt;</span>@Html.Raw(Sanitizer.GetSafeHtmlFragment(Model))<span class="code-keyword">&lt;</span><span class="code-leadattribute">/p</span><span class="code-keyword">&gt;</span>

<span class="code-keyword">&lt;</span><span class="code-leadattribute">h3</span><span class="code-keyword">&gt;</span>Update profile<span class="code-keyword">&lt;</span><span class="code-leadattribute">/h3</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">form</span><span class="code-attribute"> </span><span class="code-attribute">action</span><span class="code-keyword">="</span><span class="code-keyword">/Registered/Profile"</span><span class="code-attribute"> </span><span class="code-attribute">method</span><span class="code-keyword">="</span><span class="code-keyword">post"</span><span class="code-keyword">&gt;</span>
    Profile:<span class="code-keyword">&lt;</span><span class="code-leadattribute">textarea</span><span class="code-attribute"> </span><span class="code-attribute">id</span><span class="code-keyword">="</span><span class="code-keyword">profile"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">profile"</span><span class="code-attribute"> </span><span class="code-attribute"></span><span class="code-attribute">
</span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute"> </span><span class="code-attribute">rows</span><span class="code-keyword">="</span><span class="code-keyword">10"</span><span class="code-attribute"> </span><span class="code-attribute">cols</span><span class="code-keyword">="</span><span class="code-keyword">40"</span><span class="code-keyword">&gt;</span>@Model<span class="code-keyword">&lt;</span><span class="code-leadattribute">/textarea</span><span class="code-keyword">&gt;</span>
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">submit"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">Save"</span><span class="code-attribute"> </span><span class="code-attribute">value</span><span class="code-keyword">="</span><span class="code-keyword">Save"</span><span class="code-attribute"> </span><span class="code-keyword">/</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/form</span><span class="code-keyword">&gt;</span></pre> 
             <p>In this example, unsafe HTML is encoded in plain text, but left as original in the text area so the user can change it. The <code>GetSafeHtmlFragment</code> method will make the following changes to the HTML:</p> 
             <ol> 
              <li>Any script tags will be removed (both references and inline scripts)</li> 
              <li>Inline CSS styles will be wrapped with &lt;!-- and --&gt;</li> 
              <li>Inline CSS classes and values for the ID, class, and name attributes will get the prefix x_</li> 
              <li>Custom attributes will be removed (e.g., <code>data-rel</code>)</li> 
              <li>Potentially dangerous attributes will be removed (<code>onload</code>, <code>onclick</code> in the image tag)</li> 
             </ol> 
             <p>When you get safe HTML using the <code>Sanitizer</code> class from the dangerous HTML source shown in the previous section, you will get the following result:</p> 
             <pre lang="html"><span class="code-keyword">&lt;</span><span class="code-leadattribute">style</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">text/css"</span><span class="code-keyword">&gt;</span>
&lt;!--
.<span class="code-leadattribute">x_red</span>
    {<span class="code-attribute">color</span><span class="code-keyword">:</span><span class="code-keyword">red}</span>
--&gt;
&lt;/style&gt;
&lt;div&gt;
&lt;hr&gt;
<span class="code-leadattribute">&lt;h2</span> id="x_title"&gt;Hello<span class="code-keyword">&lt;/</span><span class="code-leadattribute">h2</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">input</span><span class="code-attribute"> </span><span class="code-attribute">type</span><span class="code-keyword">="</span><span class="code-keyword">text"</span><span class="code-attribute"> </span><span class="code-attribute">name</span><span class="code-keyword">="</span><span class="code-keyword">x_keyword"</span><span class="code-attribute"> </span><span class="code-attribute">id</span><span class="code-keyword">="</span><span class="code-keyword">x_keyword"</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">p</span><span class="code-attribute"> </span><span class="code-attribute">style</span><span class="code-keyword">="</span><span class="code-keyword">border:solid"</span><span class="code-keyword">&gt;</span>This is some <span class="code-keyword">&lt;</span><span class="code-leadattribute">b</span><span class="code-keyword">&gt;</span>Profile<span class="code-keyword">&lt;</span><span class="code-leadattribute">/b</span><span class="code-keyword">&gt;</span> <span class="code-keyword">&lt;</span><span class="code-leadattribute">em</span><span class="code-keyword">&gt;</span>text<span class="code-keyword">&lt;</span><span class="code-leadattribute">/em</span><span class="code-keyword">&gt;</span>. <span class="code-keyword">&lt;</span><span class="code-leadattribute">br</span><span class="code-keyword">&gt;</span>
Validate Input <span class="code-keyword">&lt;</span><span class="code-leadattribute">u</span><span class="code-keyword">&gt;</span>must be disabled<span class="code-keyword">&lt;</span><span class="code-leadattribute">/u</span><span class="code-keyword">&gt;</span> 
  <span class="code-keyword">&lt;</span><span class="code-leadattribute">img</span><span class="code-attribute"> </span><span class="code-attribute">src</span><span class="code-keyword">="</span><span class="code-keyword">http://i.msdn.microsoft.com/Areas/Sto/Content/Images/ShareThis/email.gif"</span><span class="code-keyword">&gt;</span> in order to
<span class="code-keyword">&lt;</span><span class="code-leadattribute">span</span><span class="code-attribute"> </span><span class="code-attribute">class</span><span class="code-keyword">="</span><span class="code-keyword">x_red"</span><span class="code-keyword">&gt;</span>display<span class="code-keyword">&lt;</span><span class="code-leadattribute">/span</span><span class="code-keyword">&gt;</span> formatted text.<span class="code-keyword">&lt;</span><span class="code-leadattribute">/p</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">img</span><span class="code-attribute"> </span><span class="code-attribute">alt</span><span class="code-keyword">="</span><span class="code-keyword">Hello"</span><span class="code-attribute"> </span><span class="code-attribute">src</span><span class="code-keyword">="</span><span class="code-keyword">"</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">hr</span><span class="code-keyword">&gt;</span>
<span class="code-keyword">&lt;</span><span class="code-leadattribute">/div</span><span class="code-keyword">&gt;</span></pre> 
             <p>As you can see, the HTML is safe now - all dangerous code has been removed. However, the code is a little bit messed up because the <code>Sanitizer</code> class modifies inline classes and values for name, ID, and class attributes by adding the prefix "x_" (at least in this version). This is reported as an issue on the Anti-XSS site but it has still not been resolved. If this is a problem to you, you will need to manually remove prefixes - I use the following code:</p> 
             <pre lang="cs">Session[<span class="code-string">"</span><span class="code-string">profile"</span>] = Sanitizer.GetSafeHtmlFragment(profile)
                    .Replace(<span class="code-string">"</span><span class="code-string">=\"x_"</span>,<span class="code-string">"</span><span class="code-string">=\""</span>)
                    .Replace(<span class="code-string">"</span><span class="code-string">.x_"</span>, <span class="code-string">"</span><span class="code-string">."</span>);</pre> 
             <p>I have replaced each <code>="x_</code> occurrence with <code>="</code> to revert the fix made by <code>Sanitizer</code> in attributes, and any occurrence of <code>.x_</code> with <code>.</code> in order to revert unwanted fixes in classes. The only remaining inconvenience is that custom HTML5 attributes such as <code>data-rel</code>, <code>data-text</code> are removed and cannot be reverted. I hope that this will be fixed in some future release of <code>Sanitizer</code>.</p> 
             <p>If you will use the AntiXSS library, here are a few tips for you:</p> 
             <ol> 
              <li>Do not call <code>Sanitizer.GetSafeHtmlFragment()</code> directly - create your own class that will wrap it. <code>GetSafeHtmlMethod</code> is moved from the <code>AntiXSS</code> class in version 3.1. to the <code>Sanitizer</code> class in 4.0 so it would be better to wrap this in your code and end up with less changes.</li> 
              <li>If you are using .NET 4, you can replace the default encoder with the custom one that will automatically sanitize the output. This is already covered in the <a href="http://haacked.com/archive/2010/04/06/using-antixss-as-the-default-encoder-for-asp-net.aspx">Using AntiXss as the Default Encoder for ASP.NET</a> article.</li> 
             </ol> 
             <h2><a class="anchor" id="Conclusion" name="Conclusion" title="Conclusion"></a>Conclusion</h2> 
             <p>In this article, I have shown some basic security elements in MVC applications such as:</p> 
             <ol> 
              <li>User authentication</li> 
              <li>Page access control</li> 
              <li>Script attack prevention</li> 
              <li>Cross-site request forgery prevention</li> 
             </ol> 
             <p>I believe that you can easily modify this code and apply it in your applications. Note that code in the sample is not 100% identical to the examples shown in the article. You will need to switch on/off some parts of code, but I believe that you will be able to adjust it easily and run these examples. As an example, the current code has turned on custom filter security and commented out Fluent security code, but you will be able to change this.</p> 
             <p>If you have any ideas about security that could be included here, let me know and I will update this article.</p> 
            </div> 
            <div class="float-right" style="margin:20px 0 0 10px;border:1px solid #ccc"> 
             <div class="msg-300x250" data-format="300x250" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Web-Development/Web-Security/Security" data-loadonview="true" data-tags="C#, ASP.NET, Javascript, XML, HTML, Dev, Intermediate, MVC,rating4.5">
              <noscript>
               <a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=300x250&amp;c=567154"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=300x250&amp;c=567154" width="300px" height="250px" target="_blank"></a>
              </noscript>
             </div> 
            </div> 
            <h2>License</h2> 
            <div id="LicenseTerms">
             <p>This article, along with any associated source code and files, is licensed under <a href="http://www.codeproject.com/info/cpol10.aspx" rel="license">The Code Project Open License (CPOL)</a></p>
            </div> 
            <h2>Share</h2> 
            <div class="share-list"> 
             <!-- Buttons start here. Copy this ul to your document. --> 
             <ul class="rrssb-buttons clearfix"> 
              <li class="email"> <a href="mailto:?subject=Implement%20secure%20ASP.NET%20MVC%20applications%20-%20CodeProject&amp;body=Here%27s%20an%20interesting%20article%20on%20for%20you%20on%20codeproject.com%0a%0ahttps%3a%2f%2fwww.codeproject.com%2farticles%2f288631%2fsecure-asp-net-mvc-applications%0a"> <span class="icon"> 
                 <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                  <g> 
                   <path d="M20.111 26.147c-2.336 1.051-4.361 1.401-7.125 1.401c-6.462 0-12.146-4.633-12.146-12.265 
                            c0-7.94 5.762-14.833 14.561-14.833c6.853 0 11.8 4.7 11.8 11.252c0 5.684-3.194 9.265-7.399 
                            9.3 c-1.829 0-3.153-0.934-3.347-2.997h-0.077c-1.208 1.986-2.96 2.997-5.023 2.997c-2.532 
                            0-4.361-1.868-4.361-5.062 c0-4.749 3.504-9.071 9.111-9.071c1.713 0 3.7 0.4 4.6 0.973l-1.169 
                            7.203c-0.388 2.298-0.116 3.3 1 3.4 c1.673 0 3.773-2.102 3.773-6.58c0-5.061-3.27-8.994-9.303-8.994c-5.957 
                            0-11.175 4.673-11.175 12.1 c0 6.5 4.2 10.2 10 10.201c1.986 0 4.089-0.43 5.646-1.245L20.111 
                            26.147z M16.646 10.1 c-0.311-0.078-0.701-0.155-1.207-0.155c-2.571 0-4.595 2.53-4.595 5.529c0 
                            1.5 0.7 2.4 1.9 2.4 c1.441 0 2.959-1.828 3.311-4.087L16.646 10.068z" />
                  </g> 
                 </svg> </span> <span class="text">email</span> </a> </li> 
              <li class="twitter"> 
               <!-- Replace href with your Meta and URL information  --> <a href="http://twitter.com/home?status=Implement+secure+ASP.NET+MVC+applications+-+CodeProject+-+https%3a%2f%2fwww.codeproject.com%2farticles%2f288631%2fsecure-asp-net-mvc-applications" class="popup"> <span class="icon"> 
                 <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"> 
                  <path d="M24.253,8.756C24.689,17.08,18.297,24.182,9.97,24.62c-3.122,0.162-6.219-0.646-8.861-2.32
                    c2.703,0.179,5.376-0.648,7.508-2.321c-2.072-0.247-3.818-1.661-4.489-3.638c0.801,0.128,1.62,0.076,2.399-0.155
                    C4.045,15.72,2.215,13.6,2.115,11.077c0.688,0.275,1.426,0.407,2.168,0.386c-2.135-1.65-2.729-4.621-1.394-6.965
                    C5.575,7.816,9.54,9.84,13.803,10.071c-0.842-2.739,0.694-5.64,3.434-6.482c2.018-0.623,4.212,0.044,5.546,1.683
                    c1.186-0.213,2.318-0.662,3.329-1.317c-0.385,1.256-1.247,2.312-2.399,2.942c1.048-0.106,2.069-0.394,3.019-0.851
                    C26.275,7.229,25.39,8.196,24.253,8.756z" /> 
                 </svg> </span> <span class="text">twitter</span> </a> </li> 
              <li class="facebook"> 
               <!-- Replace with your URL. For best results, make sure you page has the proper FB Open Graph tags in header: 
        https://developers.facebook.com/docs/opengraph/howtos/maximizing-distribution-media-content/ --> <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fwww.codeproject.com%2farticles%2f288631%2fsecure-asp-net-mvc-applications" class="popup"> <span class="icon"> 
                 <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"> 
                  <path d="M27.825,4.783c0-2.427-2.182-4.608-4.608-4.608H4.783c-2.422,0-4.608,2.182-4.608,4.608v18.434
                        c0,2.427,2.181,4.608,4.608,4.608H14V17.379h-3.379v-4.608H14v-1.795c0-3.089,2.335-5.885,5.192-5.885h3.718v4.608h-3.726
                        c-0.408,0-0.884,0.492-0.884,1.236v1.836h4.609v4.608h-4.609v10.446h4.916c2.422,0,4.608-2.188,4.608-4.608V4.783z" /> 
                 </svg> </span> <span class="text">facebook</span> </a> </li> 
              <li class="linkedin"> 
               <!-- Replace href with your meta and URL information --> <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2fwww.codeproject.com%2farticles%2f288631%2fsecure-asp-net-mvc-applications&amp;title=Implement+secure+ASP.NET+MVC+applications+-+CodeProject&amp;summary=&amp;source=codeproject.com" class="popup"> <span class="icon"> 
                 <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"> 
                  <path d="M25.424,15.887v8.447h-4.896v-7.882c0-1.979-0.709-3.331-2.48-3.331c-1.354,0-2.158,0.911-2.514,1.803
                        c-0.129,0.315-0.162,0.753-0.162,1.194v8.216h-4.899c0,0,0.066-13.349,0-14.731h4.899v2.088c-0.01,0.016-0.023,0.032-0.033,0.048
                        h0.033V11.69c0.65-1.002,1.812-2.435,4.414-2.435C23.008,9.254,25.424,11.361,25.424,15.887z M5.348,2.501
                        c-1.676,0-2.772,1.092-2.772,2.539c0,1.421,1.066,2.538,2.717,2.546h0.032c1.709,0,2.771-1.132,2.771-2.546
                        C8.054,3.593,7.019,2.501,5.343,2.501H5.348z M2.867,24.334h4.897V9.603H2.867V24.334z" /> 
                 </svg> </span> <span class="text">linkedin</span> </a> </li> 
              <li class="reddit"> <a href="http://www.reddit.com/submit?url=https%3a%2f%2fwww.codeproject.com%2farticles%2f288631%2fsecure-asp-net-mvc-applications&amp;title=Implement+secure+ASP.NET+MVC+applications+-+CodeProject"> <span class="icon"> 
                 <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="28px" height="28px" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve">
                  <g> 
                   <path d="M11.794 15.316c0-1.029-0.835-1.895-1.866-1.895c-1.03 0-1.893 0.865-1.893 1.895s0.863 1.9 1.9 1.9 C10.958 17.2 11.8 16.3 11.8 15.316z" /> 
                   <path d="M18.1 13.422c-1.029 0-1.895 0.864-1.895 1.895c0 1 0.9 1.9 1.9 1.865c1.031 0 1.869-0.836 1.869-1.865 C19.969 14.3 19.1 13.4 18.1 13.422z" /> 
                   <path d="M17.527 19.791c-0.678 0.678-1.826 1.006-3.514 1.006c-0.004 0-0.009 0-0.014 0c-0.004 0-0.01 0-0.015 0 
                c-1.686 0-2.834-0.328-3.51-1.005c-0.264-0.265-0.693-0.265-0.958 0c-0.264 0.265-0.264 0.7 0 1 c0.943 0.9 2.4 1.4 
                4.5 1.402c0.005 0 0 0 0 0c0.005 0 0 0 0 0c2.066 0 3.527-0.459 4.47-1.402 c0.265-0.264 0.265-0.693 0.002-0.958C18.221 
                19.5 17.8 19.5 17.5 19.791z" />
                   <path d="M27.707 13.267c0-1.785-1.453-3.237-3.236-3.237c-0.793 0-1.518 0.287-2.082 
                0.761c-2.039-1.295-4.646-2.069-7.438-2.219 l1.483-4.691l4.062 0.956c0.071 1.4 1.3 2.6 2.7 2.555c1.488 0 2.695-1.208 
                2.695-2.695C25.881 3.2 24.7 2 23.2 2 c-1.059 0-1.979 0.616-2.42 1.508l-4.633-1.091c-0.344-0.081-0.693 0.118-0.803 
                0.455l-1.793 5.7 C10.548 8.6 7.7 9.4 5.6 10.75C5.006 10.3 4.3 10 3.5 10.029c-1.785 0-3.237 1.452-3.237 3.2 c0 1.1 0.6 
                2.1 1.4 2.69c-0.04 0.272-0.061 0.551-0.061 0.831c0 2.3 1.3 4.4 3.7 5.9 c2.299 1.5 5.3 2.3 8.6 2.325c3.228 0 6.271-0.825 
                8.571-2.325c2.387-1.56 3.7-3.66 3.7-5.917 c0-0.26-0.016-0.514-0.051-0.768C27.088 15.5 27.7 14.4 27.7 13.267z M23.186 
                3.355c0.74 0 1.3 0.6 1.3 1.3 c0 0.738-0.6 1.34-1.34 1.34s-1.342-0.602-1.342-1.34C21.844 4 22.4 3.4 23.2 3.355z M1.648 
                13.3 c0-1.038 0.844-1.882 1.882-1.882c0.31 0 0.6 0.1 0.9 0.209c-1.049 0.868-1.813 1.861-2.26 2.9 C1.832 14.2 1.6 13.8 1.6 
                13.267z M21.773 21.57c-2.082 1.357-4.863 2.105-7.831 2.105c-2.967 0-5.747-0.748-7.828-2.105 
                c-1.991-1.301-3.088-3-3.088-4.782c0-1.784 1.097-3.484 3.088-4.784c2.081-1.358 4.861-2.106 7.828-2.106 c2.967 0 5.7 
                0.7 7.8 2.106c1.99 1.3 3.1 3 3.1 4.784C24.859 18.6 23.8 20.3 21.8 21.57z M25.787 14.6 
                c-0.432-1.084-1.191-2.095-2.244-2.977c0.273-0.156 0.59-0.245 0.928-0.245c1.035 0 1.9 0.8 1.9 1.9 
                C26.354 13.8 26.1 14.3 25.8 14.605z" />
                  </g>
                 </svg> </span> <span class="text">reddit</span> </a> </li> 
              <li class="googleplus"> 
               <!-- Replace href with your meta and URL information.  --> <a href="https://plus.google.com/share?url=https%3a%2f%2fwww.codeproject.com%2farticles%2f288631%2fsecure-asp-net-mvc-applications" class="popup"> <span class="icon"> 
                 <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="28px" height="28px" viewbox="0 0 28 28" enable-background="new 0 0 28 28" xml:space="preserve"> 
                  <g> 
                   <g> 
                    <path d="M14.703,15.854l-1.219-0.948c-0.372-0.308-0.88-0.715-0.88-1.459c0-0.748,0.508-1.223,0.95-1.663
                                c1.42-1.119,2.839-2.309,2.839-4.817c0-2.58-1.621-3.937-2.399-4.581h2.097l2.202-1.383h-6.67c-1.83,0-4.467,0.433-6.398,2.027
                                C3.768,4.287,3.059,6.018,3.059,7.576c0,2.634,2.022,5.328,5.604,5.328c0.339,0,0.71-0.033,1.083-0.068
                                c-0.167,0.408-0.336,0.748-0.336,1.324c0,1.04,0.551,1.685,1.011,2.297c-1.524,0.104-4.37,0.273-6.467,1.562
                                c-1.998,1.188-2.605,2.916-2.605,4.137c0,2.512,2.358,4.84,7.289,4.84c5.822,0,8.904-3.223,8.904-6.41
                                c0.008-2.327-1.359-3.489-2.829-4.731H14.703z M10.269,11.951c-2.912,0-4.231-3.765-4.231-6.037c0-0.884,0.168-1.797,0.744-2.511
                                c0.543-0.679,1.489-1.12,2.372-1.12c2.807,0,4.256,3.798,4.256,6.242c0,0.612-0.067,1.694-0.845,2.478
                                c-0.537,0.55-1.438,0.948-2.295,0.951V11.951z M10.302,25.609c-3.621,0-5.957-1.732-5.957-4.142c0-2.408,2.165-3.223,2.911-3.492
                                c1.421-0.479,3.25-0.545,3.555-0.545c0.338,0,0.52,0,0.766,0.034c2.574,1.838,3.706,2.757,3.706,4.479
                                c-0.002,2.073-1.736,3.665-4.982,3.649L10.302,25.609z" /> 
                    <polygon points="23.254,11.89 23.254,8.521 21.569,8.521 21.569,11.89 18.202,11.89 18.202,13.604 21.569,13.604 21.569,17.004
                                23.254,17.004 23.254,13.604 26.653,13.604 26.653,11.89      " /> 
                   </g> 
                  </g> 
                 </svg> </span> <span class="text">google+</span> </a> </li> 
             </ul> 
             <!-- Buttons end here --> 
            </div> 
            <h2 id="ctl00_AboutHeading">About the Author</h2> 
            <div class="author-wrapper"> 
             <div class="pic-wrapper"> 
              <img id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberPhoto" class="profile-pic" src="https://www.codeproject.com/script/Membership/ProfileImages/{05355a84-95f8-4bdc-85e5-36d58e23ba69}.jpg" style="border-width:0px;transform:rotate(-3deg);"> 
             </div> 
             <div class="container-member"> 
              <b><a id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberProfileLink" class="author" href="/Members/JocaPC">Jovan Popovic</a></b> 
              <table class="extended"> 
               <tbody>
                <tr> 
                 <td rowspan="2" nowrap valign="middle"> </td> 
                 <td width="100%"> 
                  <div class="company"> 
                   <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberJobTitle">Program Manager</span> 
                   <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberCompany">Microsoft</span> 
                  </div> </td> 
                </tr> 
                <tr> 
                 <td> <span id="ctl00_AboutAuthorRptr_ctl00_AboutAuthor_memberLocation">Serbia <img src="/script/Geo/Images/RS.gif" alt="Serbia" width="16px" height="11px"></span> </td> 
                </tr> 
               </tbody>
              </table> 
             </div> 
             <div class="description">
               Graduated from Faculty of Electrical Engineering, Department of Computer Techniques and Informatics, University of Belgrade, Serbia.
              <br> Currently working in Microsoft as Program Manager on SQL Server product.
              <br> Member of JQuery community - created few popular plugins (four popular JQuery DataTables add-ins and loadJSON template engine).
              <br> Interests: Web and databases, Software engineering process(estimation and standardization), mobile and business intelligence platforms. 
             </div> 
            </div>
            <br> 
            <div class="clearfix"></div> 
            <div style="padding-top:8px"> 
            </div> 
           </form> 
          </div> 
          <div class="bottom-promo"> 
           <div class="msg-728x90" data-format="728x90" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Web-Development/Web-Security/Security" data-loadonview="true" data-tags="C#, ASP.NET, Javascript, XML, HTML, Dev, Intermediate, MVC,rating4.5,pos_bottom">
            <noscript>
             <a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=728x90&amp;c=567154"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=728x90&amp;c=567154" width="728px" height="90px" target="_blank"></a>
            </noscript>
           </div> 
          </div> 
          <h2 id="ctl00_AlsoRead_RelatedResults_ctl00_Header" class="also-read">You may also be interested in...</h2> 
          <table class="spaced content-list also-read"> 
           <tbody>
            <tr> 
             <td class="content-list-item" width="50%" valign="top"> 
              <div id="ctl00_AlsoRead_RelatedResults_ctl01_ThumbnailContainer" class="thumbnail"> 
               <a id="ctl00_AlsoRead_RelatedResults_ctl01_Thumbnail" href="https://www.codeproject.com/ResearchLibrary/260/Designing-For-DevOps"><img src="https://www.codeproject.com/script/ResearchLibrary/Logos/LibraryItemThumbnail_260_100x130.png" alt="" style="border-width:0px;"></a> 
               <div class="pro-badge">
                Pro
               </div>
              </div> 
              <div class="text"> 
               <div class="title">
                <a id="ctl00_AlsoRead_RelatedResults_ctl01_Link" href="https://www.codeproject.com/ResearchLibrary/260/Designing-For-DevOps">Designing For DevOps</a>
               </div> 
              </div> </td> 
             <td class="content-list-item" width="50%" valign="top"> 
              <div id="ctl00_AlsoRead_RelatedResults_ctl02_ThumbnailContainer" class="thumbnail"> 
               <a id="ctl00_AlsoRead_RelatedResults_ctl02_Thumbnail" href="https://www.codeproject.com/ResearchLibrary/261/Public-Private-and-Hybrid-Cloud-Whats-the-differen"><img src="https://www.codeproject.com/script/ResearchLibrary/Logos/LibraryItemThumbnail_261_100x130.png" alt="" style="border-width:0px;"></a> 
               <div class="pro-badge">
                Pro
               </div>
              </div> 
              <div class="text"> 
               <div class="title">
                <a id="ctl00_AlsoRead_RelatedResults_ctl02_Link" href="https://www.codeproject.com/ResearchLibrary/261/Public-Private-and-Hybrid-Cloud-Whats-the-differen">Public, Private, and Hybrid Cloud: What's the difference?</a>
               </div> 
              </div> </td> 
            </tr> 
            <tr> 
             <td class="content-list-item" width="50%" valign="top"> 
              <div id="ctl00_AlsoRead_RelatedResults_ctl03_ThumbnailContainer" class="thumbnail"> 
               <a id="ctl00_AlsoRead_RelatedResults_ctl03_Thumbnail" href="//www.codeproject.com/Articles/654846/Security-In-ASP-NET-MVC"><img src="/KB/aspnet/654846/Thumb-654846.png" alt="" style="border-width:0px;"></a> 
              </div> 
              <div class="text"> 
               <div class="title">
                <a id="ctl00_AlsoRead_RelatedResults_ctl03_Link" href="//www.codeproject.com/Articles/654846/Security-In-ASP-NET-MVC">Security In ASP.NET MVC</a>
               </div> 
              </div> </td> 
             <td class="content-list-item" width="50%" valign="top"> 
              <div id="ctl00_AlsoRead_RelatedResults_ctl04_ThumbnailContainer" class="thumbnail"> 
               <a id="ctl00_AlsoRead_RelatedResults_ctl04_Thumbnail" href="/Articles/1201711/What-is-Intel-Computer-Vision-SDK"><img src="https://www.codeproject.com/script/Articles/Images/article100x80.png" alt="" style="border-width:0px;"></a> 
              </div> 
              <div class="text"> 
               <div class="title">
                <a id="ctl00_AlsoRead_RelatedResults_ctl04_Link" href="/Articles/1201711/What-is-Intel-Computer-Vision-SDK">What is Intel® Computer Vision SDK?</a>
               </div> 
              </div> </td> 
            </tr> 
            <tr> 
             <td class="content-list-item" width="50%" valign="top"> 
              <div id="ctl00_AlsoRead_RelatedResults_ctl05_ThumbnailContainer" class="thumbnail"> 
               <a id="ctl00_AlsoRead_RelatedResults_ctl05_Thumbnail" href="//www.codeproject.com/Articles/1116318/Points-to-Secure-Your-ASP-NET-MVC-Applications"><img src="/KB/aspnet/1116318/Thumb-1116318.jpg" alt="" style="border-width:0px;"></a> 
              </div> 
              <div class="text"> 
               <div class="title">
                <a id="ctl00_AlsoRead_RelatedResults_ctl05_Link" href="//www.codeproject.com/Articles/1116318/Points-to-Secure-Your-ASP-NET-MVC-Applications">10 Points to Secure Your ASP.NET MVC Applications.</a>
               </div> 
              </div> </td> 
             <td class="content-list-item" width="50%" valign="top"> 
              <div id="ctl00_AlsoRead_RelatedResults_ctl06_ThumbnailContainer" class="thumbnail"> 
               <a id="ctl00_AlsoRead_RelatedResults_ctl06_Thumbnail" href="/Articles/1201708/What-is-OpenCV"><img src="https://www.codeproject.com/script/Articles/Images/article100x80.png" alt="" style="border-width:0px;"></a> 
              </div> 
              <div class="text"> 
               <div class="title">
                <a id="ctl00_AlsoRead_RelatedResults_ctl06_Link" href="/Articles/1201708/What-is-OpenCV">What is OpenCV?</a>
               </div> 
              </div> </td> 
            </tr> 
           </tbody>
          </table> 
          <h2>Comments and Discussions</h2> 
          <a class="float-left" name="_comments" id="_comments">&nbsp;</a>
          <div id="_MessageBoardctl00_MessageBoard" onclick="return forumControl59298016.SwitchMessage(event, null)"> 
           <table id="ForumTable" class="forum tight" cellpadding="0" cellspacing="0"> 
            <tbody>
             <tr> 
              <td class="header1 callout"><b>You must <a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=%2farticles%2f288631%2fsecure-asp-net-mvc-applications%3ffid%3d1667185%26df%3d90%26mpp%3d50%26prof%3dTrue%26sort%3dPosition%26view%3dNormal%26spc%3dTight">Sign In</a> to use this message board.</b></td> 
             </tr>
             <tr> 
              <td>
               <table width="100%" border="0" cellpadding="3px" cellspacing="0"> 
                <tbody>
                 <tr class="header1"> 
                  <td colspan="2" style="white-space:nowrap;">
                   <div class="container"> 
                    <div class="float-right"> 
                     <form action="/Search.aspx?sbo=fm" method="get" class="searchbar"> 
                      <input type="hidden" name="fid" value="1667185">
                      <input type="hidden" name="sbo" value="fm">
                      <b>Search Comments </b>
                      <input type="search" class="search" name="qf">&nbsp;
                      <input type="submit" value="Go" class="button"> 
                     </form> 
                    </div> 
                   </div></td> 
                 </tr>
                 <tr class="header2"> 
                  <td></td>
                  <td style="width:100%;">
                   <div style="text-align:right;"> 
                    <form action="/script/Forums/SetOptions.aspx?fid=1667185&amp;df=90&amp;mpp=50&amp;prof=True&amp;sort=Position&amp;view=Normal&amp;spc=Tight&amp;floc=%2farticles%2f288631%2fsecure-asp-net-mvc-applications" method="get" style="margin:0;padding:0;"> 
                     <input type="hidden" name="fid" value="1667185">
                     <input type="hidden" name="currentQS" value="fid=1667185&amp;df=90&amp;mpp=50&amp;prof=True&amp;sort=Position&amp;view=Normal&amp;spc=Tight&amp;floc=%2farticles%2f288631%2fsecure-asp-net-mvc-applications">
                     <input type="hidden" name="floc" value="/articles/288631/secure-asp-net-mvc-applications">Spacing
                     <select size="1" class="dropdown" name="spc"> <option value="Relaxed">Relaxed</option><option value="Compact">Compact</option><option selected value="Tight">Tight</option> </select>&nbsp;&nbsp;Layout
                     <select size="1" class="dropdown" name="view"> <option selected value="Normal">Normal</option><option value="Topic">Open Topics</option><option value="Expanded">Open All</option><option value="Thread">Thread View</option> </select>&nbsp;&nbsp;Per page
                     <select size="1" class="dropdown" name="mpp"> <option value="10">10</option><option value="25">25</option><option selected value="50">50</option> </select>&nbsp;&nbsp;&nbsp;
                     <input type="submit" value="Update" name="SetOpt" class="button"> 
                    </form> 
                   </div></td> 
                 </tr> 
                </tbody>
               </table></td> 
             </tr>
             <tr> 
              <td><a name="xx0xx"></a>
               <table border="0" cellpadding="2px" cellspacing="0" width="100%"> 
                <tbody>
                 <tr class="navbar"> 
                  <td></td>
                  <td style="text-align:right;width:50%;"></td>
                  <td style="text-align:right;white-space:nowrap;"><span class="nav-link disabled">First</span> <span class="nav-link disabled">Prev</span> <span class="nav-link disabled">Next</span></td> 
                 </tr> 
                </tbody>
               </table></td> 
             </tr>
             <tr> 
              <td>
               <table border="0" cellpadding="0" cellspacing="0" width="100%" class="fixed-layout blank-background"> 
                <tbody>
                 <tr> 
                  <td><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" border="0" width="1px" height="5px" alt=""></td> 
                 </tr>
                 <tr id="F4957054_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4957054xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td>
                      <td class="subject hover-container"><a class="message-link" name="4957054" parent="0" thread="4957054" href="/Messages/4957054/Great.aspx">Great</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Mahsa Hassankashi</span>
                        <span class="date">4-Dec-14 11:18</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=4368110">Mahsa Hassankashi</a></span></td>
                      <td class="date"><span>4-Dec-14 11:18&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4957054_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="4368110" msgid="4957054" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Thank you , it is really complete <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)"> <br> 
                               <div class="signature">
                                http://www.technical.cosmicverse.info
                                <br> http://www.cosmicverse.info
                               </div><br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4957054" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4957054/Great.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4957054" data-ref="3_4957054" class="rating-label" name="RateItem_4957054" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4912981_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4912981xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4912981" parent="0" thread="4912981" href="/Messages/4912981/My-vote-of.aspx">My vote of 3</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Pramod-Lawate</span>
                        <span class="date">28-Sep-14 22:39</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=10310565">Pramod-Lawate</a></span></td>
                      <td class="date"><span>28-Sep-14 22:39&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4912981_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="10310565" msgid="4912981" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Its very nice article by Jovan<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4912981" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4912981/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4912981" data-ref="3_4912981" class="rating-label" name="RateItem_4912981" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4874283_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4874283xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td>
                      <td class="subject hover-container"><a class="message-link" name="4874283" parent="0" thread="4874283" href="/Messages/4874283/SSO.aspx">SSO</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">peter_Gerrard</span>
                        <span class="date">1-Aug-14 6:03</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=8194017">peter_Gerrard</a></span></td>
                      <td class="date"><span>1-Aug-14 6:03&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4874283_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="8194017" msgid="4874283" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Based on my understanding of SSO, you made a statement on single sign-on that I don't quite agree with. You said 
                               <blockquote class="quote">
                                <div class="op">
                                 Quote:
                                </div>This is common scenario in practice - in various applications you might see login via Facebook, Google, MSN live, or other applications where cookies provided by these applications are accepted.
                               </blockquote><br> This is a scenario where you identify and allow users to sign-in using trusted external identity providers. This is a shared authentication scheme that you confused with SSO, and these are achieved through techniques such OAuth and OpenID. It's possible to implement some form of SSO using these external providers but allowing Login through these external systems does not directly relates to SSO.<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4874283" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4874283/SSO.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4874283" data-ref="3_4874283" class="rating-label" name="RateItem_4874283" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4867149_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4867149xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_idea.gif" alt="Suggestion" title="Suggestion"></td>
                      <td class="subject hover-container"><a class="message-link" name="4867149" parent="0" thread="4867149" href="/Messages/4867149/Vulnerable-to-Open-Redirection-Attacks.aspx">Vulnerable to Open Redirection Attacks?</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">lecoding</span>
                        <span class="date">23-Jul-14 5:49</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=3027899">lecoding</a></span></td>
                      <td class="date"><span>23-Jul-14 5:49&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4867149_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3027899" msgid="4867149" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Good article! <br> However I think there might be a security issue in your Login() action. You are using the old Response.Redirect() call which does not validate the returnUrl provided by the client and is prone to redirection attacks (see <a href="https://www.owasp.org/index.php/Top_10_2013-A10-Unvalidated_Redirects_and_Forwards">OWASP Top10 most critical risks #10</a>)<br> <br> The MVC Framework (not MVC v1+2) provides a new method to validate the return URL: Url.IsLocal().<br> <br> So you might change<br> <pre lang="c#"><span class="code-keyword">if</span>(!string.IsNullOrEmpty(ReturnUrl))
        Response.Redirect(ReturnUrl);
</pre><br> to<br> <pre lang="c#"><span class="code-keyword">if</span>(!string.IsNullOrEmpty(ReturnUrl) &amp;&amp; Url.IsLocal(ReturnUrl))
          <span class="code-keyword">return</span> Redirect(ReturnUrl);
}
</pre><br> <br> More details are available at <a href="http://www.asp.net/mvc/tutorials/security/preventing-open-redirection-attacks">Preventing Open Redirection Attacks (C#)</a> [official MVC tutorial]<br> <br> Correct me if I`m wrong <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_wink.gif" align="top" alt="Wink | ;)"><br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4867149" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4867149/Vulnerable-to-Open-Redirection-Attacks.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4867149" data-ref="3_4867149" class="rating-label" name="RateItem_4867149" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4866551_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4866551xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td>
                      <td class="subject hover-container"><a class="message-link" name="4866551" parent="0" thread="4866551" href="/Messages/4866551/The-project-for-the-documentation-needs-a-solution.aspx">The project for the documentation needs a solution file</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">mwgilmore1</span>
                        <span class="date">22-Jul-14 11:12</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=10113066">mwgilmore1</a></span></td>
                      <td class="date"><span>22-Jul-14 11:12&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4866551_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="10113066" msgid="4866551" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Hello<br> <br> Fine article. However, the project is not loadable into VS 2010. What version of VS and MVC should I be using?<br> <br> Has anyone successfully loaded this project into Visual Studio?<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4866551" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4866551/The-project-for-the-documentation-needs-a-solution.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4866551" data-ref="3_4866551" class="rating-label" name="RateItem_4866551" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F5071897_h0" class="header hover-row"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="38px" class="indent"><a name="xx5071897xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td>
                      <td class="subject hover-container"><a class="message-link" name="5071897" parent="4866551" thread="4866551" href="/Messages/5071897/Re-The-project-for-the-documentation-needs-a-solut.aspx">Re: The project for the documentation needs a solution file</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Member 11052385</span>
                        <span class="date">9-Jun-15 20:53</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=11052385">Member 11052385</a></span></td>
                      <td class="date"><span>9-Jun-15 20:53&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F5071897_h1" class="content selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="11052385" msgid="5071897" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">
                               <div class="parent">
                                <a rel="nofollow" onclick="return forumControl59298016.SwitchMessage(null,4866551);" href="/Messages/4866551/The-project-for-the-documentation-needs-a-solution.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a>
                               </div>It is successfully loaded in VS2012<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4866551" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/5071897/Re-The-project-for-the-documentation-needs-a-solut.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF5071897" data-ref="3_5071897" class="rating-label" name="RateItem_5071897" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4865876_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4865876xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4865876" parent="0" thread="4865876" href="/Messages/4865876/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Humayun Kabir Mamun</span>
                        <span class="date">21-Jul-14 20:58</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=5336968">Humayun Kabir Mamun</a></span></td>
                      <td class="date"><span>21-Jul-14 20:58&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4865876_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5336968" msgid="4865876" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Great...<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4865876" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4865876/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4865876" data-ref="3_4865876" class="rating-label" name="RateItem_4865876" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4660886_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4660886xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4660886" parent="0" thread="4660886" href="/Messages/4660886/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Kevin Lee Garner</span>
                        <span class="date">16-Sep-13 6:17</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=10105547">Kevin Lee Garner</a></span></td>
                      <td class="date"><span>16-Sep-13 6:17&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4660886_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="10105547" msgid="4660886" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">This article could go on forever, and I'd be happy. Great stuff, and it answered questions I didn't know I had. I'm favoriting this article for future use. Thanks!<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4660886" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4660886/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4660886" data-ref="3_4660886" class="rating-label" name="RateItem_4660886" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4604562_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4604562xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4604562" parent="0" thread="4604562" href="/Messages/4604562/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Member 1459902</span>
                        <span class="date">4-Jul-13 22:30</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=1459902">Member 1459902</a></span></td>
                      <td class="date"><span>4-Jul-13 22:30&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4604562_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1459902" msgid="4604562" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Only possible vote is 5<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4604562" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4604562/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4604562" data-ref="3_4604562" class="rating-label" name="RateItem_4604562" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4588939_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4588939xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td>
                      <td class="subject hover-container"><a class="message-link" name="4588939" parent="0" thread="4588939" href="/Messages/4588939/something-more-dynamic-convention-over-configurati.aspx">something more dynamic / convention over configuration for Page Access Control</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">k~mayer</span>
                        <span class="date">14-Jun-13 9:45</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=4496393">k~mayer</a></span></td>
                      <td class="date"><span>14-Jun-13 9:45&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4588939_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="4496393" msgid="4588939" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Excellent article by the way. I like that you gave several alternate ways of setting up the Authenication/Authorization.<br> <br> I'm still learning my way around asp.net MVC, so maybe you can help me out.<br> <br> First off, is there a way to setup the Page Access Control, so that it's implemented in a dynamic fashion, as opposed to the examples you gave, which has to be done thru either a static-like configuration file, or hard-coded access rules? <br> <br> What i'd like to do, is have a super-admin tool for my application, that would list all the controllers and their actions (essentially list all possible pages a user could access), and then give the admin the ability to assign access to those pages either by role/user-type or specific users. <br> <br> I don't mind creating my own pluggin/library to accomplish this, but would rather not re-invent the wheel if there was something out there already.<br> <br> I would imagine that the rules for pages and which roles or users can access them would be stored in a database....maybe something similar to the way that CakePHP Access Control List (ACL) works. it would be awesome if something like their Auth Library existed for asp.net mvc<br> <a href="http://book.cakephp.org/2.0/en/core-libraries/components/access-control-lists.html"><br> </a>[<a href="http://book.cakephp.org/2.0/en/core-libraries/components/access-control-lists.html" target="_blank" title="New Window">^</a>]<br> <br> Second, if i had to build it myself, any pointers on an asp.net function that would return an object or list of all controllers and their actions?<br> <br> thanks,<br> Kelly<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4588939" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4588939/something-more-dynamic-convention-over-configurati.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4588939" data-ref="3_4588939" class="rating-label" name="RateItem_4588939" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4560772_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4560772xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4560772" parent="0" thread="4560772" href="/Messages/4560772/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Anupama_Agarwal</span>
                        <span class="date">9-May-13 6:30</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=8512538">Anupama_Agarwal</a></span></td>
                      <td class="date"><span>9-May-13 6:30&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4560772_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="8512538" msgid="4560772" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Excellent<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4560772" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4560772/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4560772" data-ref="3_4560772" class="rating-label" name="RateItem_4560772" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4547838_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4547838xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4547838" parent="0" thread="4547838" href="/Messages/4547838/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Prasad Khandekar</span>
                        <span class="date">23-Apr-13 0:27</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=57586">Prasad Khandekar</a></span></td>
                      <td class="date"><span>23-Apr-13 0:27&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4547838_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="57586" msgid="4547838" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/thumbs_up.gif" align="top" alt="Thumbs Up | :thumbsup:"> . Excellent artile!<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4547838" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4547838/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4547838" data-ref="3_4547838" class="rating-label" name="RateItem_4547838" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4547835_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4547835xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4547835" parent="0" thread="4547835" href="/Messages/4547835/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author"><b>@AmitGajjar</b></span>
                        <span class="date">23-Apr-13 0:25</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-pro-16.png" title="professional" alt="professional" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=4796755"><b>@AmitGajjar</b></a></span></td>
                      <td class="date"><span>23-Apr-13 0:25&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4547835_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="4796755" msgid="4547835" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">excellent work.<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4547835" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4547835/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4547835" data-ref="3_4547835" class="rating-label" name="RateItem_4547835" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4515308_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4515308xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4515308" parent="0" thread="4515308" href="/Messages/4515308/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Britteandy</span>
                        <span class="date">12-Mar-13 1:26</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=6790280">Britteandy</a></span></td>
                      <td class="date"><span>12-Mar-13 1:26&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4515308_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="6790280" msgid="4515308" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Very good article <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)"> <br> Thanks!<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4515308" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4515308/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4515308" data-ref="3_4515308" class="rating-label" name="RateItem_4515308" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4508800_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4508800xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4508800" parent="0" thread="4508800" href="/Messages/4508800/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Sarvesh Kushwaha</span>
                        <span class="date">3-Mar-13 21:40</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=7899684">Sarvesh Kushwaha</a></span></td>
                      <td class="date"><span>3-Mar-13 21:40&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4508800_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7899684" msgid="4508800" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">good <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_smile.gif" align="top" alt="Smile | :)"><br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4508800" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4508800/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4508800" data-ref="3_4508800" class="rating-label" name="RateItem_4508800" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4429403_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4429403xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td>
                      <td class="subject hover-container"><a class="message-link" name="4429403" parent="0" thread="4429403" href="/Messages/4429403/Custome-membership-Provider-in-MVC-has-error.aspx">Custome membership Provider in MVC 4 has error</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Ali_MH</span>
                        <span class="date">16-Nov-12 3:17</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=3069332">Ali_MH</a></span></td>
                      <td class="date"><span>16-Nov-12 3:17&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4429403_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3069332" msgid="4429403" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Hi Dear Jovan<br> <br> Thanks for great article. I tried to develop custom membership provider in order to use with my own database tables but I couldn't. After run project I saw red error line on web.config custom membership provider line. <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_frown.gif" align="top" alt="Frown | :("> <br> <b><i></i>type="Mvc4ApplicationTest2.Models.CustomMembershipProvider"</b> I found article that said me to add below lines to web.config and I did. <br> <b>add key="enableSimpleMembership" value="false"<br> add key="autoFormsAuthentication" value="false"</b> <br> Now application run <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_biggrin.gif" align="top" alt="Big Grin | :-D"> but after get to login page and clicked on submit i get to new error that hint me like this:<br> <b>To call this method, the "Membership.Provider" property must be an instance of "ExtendedMembershipProvider".</b> <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_sniff.gif" align="top" alt="Sniff | :^)"> <br> So What can I do? <img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/smiley_confused.gif" align="top" alt="Confused | :confused:"> Can you please help me? <br> and other question, I want to use the standard, strong and useful method to secure my web application. do you think if i must use websecurity classes or other approach? <br> <br> Sincerely<br> Ali<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4429403" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4429403/Custome-membership-Provider-in-MVC-has-error.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4429403" data-ref="3_4429403" class="rating-label" name="RateItem_4429403" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4406255_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4406255xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4406255" parent="0" thread="4406255" href="/Messages/4406255/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Peter Carrasco</span>
                        <span class="date">22-Oct-12 15:44</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=9196806">Peter Carrasco</a></span></td>
                      <td class="date"><span>22-Oct-12 15:44&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4406255_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="9196806" msgid="4406255" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Thank you for explaining SSO!<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4406255" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4406255/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4406255" data-ref="3_4406255" class="rating-label" name="RateItem_4406255" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4392296_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4392296xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td>
                      <td class="subject hover-container"><a class="message-link" name="4392296" parent="0" thread="4392296" href="/Messages/4392296/My-vote-up.aspx">My vote up 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">tidkerohit</span>
                        <span class="date">9-Oct-12 4:05</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=8311654">tidkerohit</a></span></td>
                      <td class="date"><span>9-Oct-12 4:05&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4392296_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="8311654" msgid="4392296" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Article is at par excellence. Thanks!<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4392296" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4392296/My-vote-up.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4392296" data-ref="3_4392296" class="rating-label" name="RateItem_4392296" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4392312_h0" class="header hover-row"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="38px" class="indent"><a name="xx4392312xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" alt="Answer" title="Answer"></td>
                      <td class="subject hover-container"><a class="message-link" name="4392312" parent="4392296" thread="4392296" href="/Messages/4392312/Re-My-vote-up.aspx">Re: My vote up 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Jovan Popovic</span>
                        <span class="date">9-Oct-12 4:14</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-MVP-16.gif" title="mvp" alt="mvp" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=1025738">Jovan Popovic</a></span></td>
                      <td class="date"><span>9-Oct-12 4:14&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4392312_h1" class="content selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="1025738" msgid="4392312" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">
                               <div class="parent">
                                <a rel="nofollow" onclick="return forumControl59298016.SwitchMessage(null,4392296);" href="/Messages/4392296/My-vote-up.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a>
                               </div>Thanks, I'm glad that you like it.<br> <br> Jovan<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4392296" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4392312/Re-My-vote-up.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4392312" data-ref="3_4392312" class="rating-label" name="RateItem_4392312" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4385675_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4385675xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4385675" parent="0" thread="4385675" href="/Messages/4385675/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">NGLara</span>
                        <span class="date">2-Oct-12 6:45</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=1231512">NGLara</a></span></td>
                      <td class="date"><span>2-Oct-12 6:45&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4385675_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="1231512" msgid="4385675" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Even though I'm new to MVC I was able to grasp the context of it. It was made plain and simple and it discusses real world scenarios. Thank you for this wonderful article. I find it very useful and helpful in my case.<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4385675" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4385675/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4385675" data-ref="3_4385675" class="rating-label" name="RateItem_4385675" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4242479_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4242479xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4242479" parent="0" thread="4242479" href="/Messages/4242479/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">aamir sajjad</span>
                        <span class="date">4-May-12 18:53</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=5608967">aamir sajjad</a></span></td>
                      <td class="date"><span>4-May-12 18:53&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4242479_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5608967" msgid="4242479" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">i find it very useful article<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4242479" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4242479/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4242479" data-ref="3_4242479" class="rating-label" name="RateItem_4242479" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4238318_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4238318xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td>
                      <td class="subject hover-container"><a class="message-link" name="4238318" parent="0" thread="4238318" href="/Messages/4238318/Folder-Structure-Public-Registered-Administrator-I.aspx">Folder Structure Public Registered Administrator Is it necessary??</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Member 3322881</span>
                        <span class="date">1-May-12 7:02</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=3322881">Member 3322881</a></span></td>
                      <td class="date"><span>1-May-12 7:02&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4238318_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3322881" msgid="4238318" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Hi,<br> <br> appreciate all the <b>hard work, that's great</b>. I'm in the infancy stage of MVC-3 trying my hand at securing the application, gratefully Ive found your article, my question is have we ought to maintain the folder structure as elicited, as i've already laid out my controllers and views and they are not organized in the structure as mentioned, they are straight flat default <br> out of box implementation.<br> <br> your thoughts please...<br> sabih<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4238318" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4238318/Folder-Structure-Public-Registered-Administrator-I.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4238318" data-ref="3_4238318" class="rating-label" name="RateItem_4238318" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4219889_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4219889xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4219889" parent="0" thread="4219889" href="/Messages/4219889/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">rrossenbg</span>
                        <span class="date">12-Apr-12 18:47</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=2824022">rrossenbg</a></span></td>
                      <td class="date"><span>12-Apr-12 18:47&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4219889_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2824022" msgid="4219889" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Cool! Thank you!<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4219889" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4219889/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4219889" data-ref="3_4219889" class="rating-label" name="RateItem_4219889" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4115569_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4115569xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4115569" parent="0" thread="4115569" href="/Messages/4115569/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Nemanja Trifunovic</span>
                        <span class="date">30-Dec-11 8:42</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=14112">Nemanja Trifunovic</a></span></td>
                      <td class="date"><span>30-Dec-11 8:42&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4115569_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="14112" msgid="4115569" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">??? ???.<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4115569" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4115569/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4115569" data-ref="3_4115569" class="rating-label" name="RateItem_4115569" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4102815_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4102815xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4102815" parent="0" thread="4102815" href="/Messages/4102815/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">LordGeddy</span>
                        <span class="date">13-Dec-11 16:27</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=3299016">LordGeddy</a></span></td>
                      <td class="date"><span>13-Dec-11 16:27&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4102815_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3299016" msgid="4102815" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Very nice comprehensive article. Thanks!<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4102815" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4102815/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4102815" data-ref="3_4102815" class="rating-label" name="RateItem_4102815" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4100806_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4100806xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_idea.gif" alt="Suggestion" title="Suggestion"></td>
                      <td class="subject hover-container"><a class="message-link" name="4100806" parent="0" thread="4100806" href="/Messages/4100806/Fanatabolus.aspx">Fanatabolus</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">partner99</span>
                        <span class="date">11-Dec-11 21:52</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=7276826">partner99</a></span></td>
                      <td class="date"><span>11-Dec-11 21:52&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4100806_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7276826" msgid="4100806" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Superb and Fantabolous.<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4100806" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4100806/Fanatabolus.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4100806" data-ref="3_4100806" class="rating-label" name="RateItem_4100806" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4100805_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4100805xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4100805" parent="0" thread="4100805" href="/Messages/4100805/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">partner99</span>
                        <span class="date">11-Dec-11 21:49</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=7276826">partner99</a></span></td>
                      <td class="date"><span>11-Dec-11 21:49&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4100805_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7276826" msgid="4100805" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Superb and Fantabolous.<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4100805" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4100805/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4100805" data-ref="3_4100805" class="rating-label" name="RateItem_4100805" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4100725_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4100725xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4100725" parent="0" thread="4100725" href="/Messages/4100725/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">prabhakamaji</span>
                        <span class="date">11-Dec-11 18:46</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=7988793">prabhakamaji</a></span></td>
                      <td class="date"><span>11-Dec-11 18:46&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4100725_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="7988793" msgid="4100725" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">nice<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4100725" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4100725/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4100725" data-ref="3_4100725" class="rating-label" name="RateItem_4100725" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4097091_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4097091xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td>
                      <td class="subject hover-container"><a class="message-link" name="4097091" parent="0" thread="4097091" href="/Messages/4097091/vote.aspx">vote '5'</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">shaheen_mix</span>
                        <span class="date">7-Dec-11 0:39</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=5529104">shaheen_mix</a></span></td>
                      <td class="date"><span>7-Dec-11 0:39&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4097091_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5529104" msgid="4097091" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">niceee<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4097091" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4097091/vote.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4097091" data-ref="3_4097091" class="rating-label" name="RateItem_4097091" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4094204_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4094204xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4094204" parent="0" thread="4094204" href="/Messages/4094204/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Monjurul Habib</span>
                        <span class="date">3-Dec-11 0:39</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=3500082">Monjurul Habib</a></span></td>
                      <td class="date"><span>3-Dec-11 0:39&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4094204_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3500082" msgid="4094204" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">nice article,my 5!<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4094204" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4094204/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4094204" data-ref="3_4094204" class="rating-label" name="RateItem_4094204" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4093173_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4093173xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4093173" parent="0" thread="4093173" href="/Messages/4093173/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Prasanth S</span>
                        <span class="date">1-Dec-11 17:06</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=5691284">Prasanth S</a></span></td>
                      <td class="date"><span>1-Dec-11 17:06&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4093173_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="5691284" msgid="4093173" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Good Article<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4093173" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4093173/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4093173" data-ref="3_4093173" class="rating-label" name="RateItem_4093173" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4092382_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4092382xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td>
                      <td class="subject hover-container"><a class="message-link" name="4092382" parent="0" thread="4092382" href="/Messages/4092382/Great-article.aspx">Great article</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Sacha Barber</span>
                        <span class="date">30-Nov-11 23:49</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-MVP-16.gif" title="mvp" alt="mvp" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=569009">Sacha Barber</a></span></td>
                      <td class="date"><span>30-Nov-11 23:49&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4092382_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="569009" msgid="4092382" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">well done. 5<br> 
                               <div class="signature">
                                <b>Sacha Barber</b>
                                <br> 
                                <ul>
                                 <li>Microsoft Visual C# MVP 2008-2011</li>
                                 <li>Codeproject MVP 2008-2011</li>
                                </ul>
                                <b>Open Source Projects</b>
                                <br>
                                <a href="http://cinch.codeplex.com/" target="_blank">Cinch SL/WPF MVVM</a>
                                <br>
                                <br> Your best friend is you.
                                <br> I'm my best friend too. We share the same views, and hardly ever argue
                                <br> 
                                <br> 
                                <b>My Blog : <a href="http://sachabarber.net/" target="_blank">sachabarber.net</a></b>
                               </div><br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4092382" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4092382/Great-article.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4092382" data-ref="3_4092382" class="rating-label" name="RateItem_4092382" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4090859_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4090859xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4090859" parent="0" thread="4090859" href="/Messages/4090859/My-vote-of.aspx">My vote of 5</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">andrew4582</span>
                        <span class="date">29-Nov-11 7:53</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=3877893">andrew4582</a></span></td>
                      <td class="date"><span>29-Nov-11 7:53&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4090859_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="3877893" msgid="4090859" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Great article!<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4090859" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4090859/My-vote-of.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4090859" data-ref="3_4090859" class="rating-label" name="RateItem_4090859" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4090536_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4090536xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4090536" parent="0" thread="4090536" href="/Messages/4090536/More-security-requirements.aspx">More security requirements</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">JarmoM</span>
                        <span class="date">29-Nov-11 2:35</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=790323">JarmoM</a></span></td>
                      <td class="date"><span>29-Nov-11 2:35&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4090536_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="790323" msgid="4090536" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Great article! I knew most of this and I learned few bits.<br> <br> I would like to add that some systems require more than just authenticated user and user belong to a role.<br> <br> First, in SaaS type of software you can access only the data which has been stored in your environment. The business logic should not allow user to see data from other environment.<br> <br> Second, different users have different access rights to data. You may only read the data and not update. You may have the right to create, edit and delete the data, but only the data you have created yourself. Just few examples. The access rights may have been given to roles, which user inherits, or user may override the access rights. Of course, there is a way to give the access rights to roles/users.<br><br>-- modified 30-Nov-11 1:26am.<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4090536" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4090536/More-security-requirements.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4090536" data-ref="3_4090536" class="rating-label" name="RateItem_4090536" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4091034_h0" class="header hover-row"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="38px" class="indent"><a name="xx4091034xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4091034" parent="4090536" thread="4090536" href="/Messages/4091034/Re-More-seurity-requirements.aspx">Re: More seurity requirements</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Jovan Popovic</span>
                        <span class="date">29-Nov-11 13:49</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=1025738">Jovan Popovic</a></span></td>
                      <td class="date"><span>29-Nov-11 13:49&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4091034_h1" class="content selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="1025738" msgid="4091034" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">
                               <div class="parent">
                                <a rel="nofollow" onclick="return forumControl59298016.SwitchMessage(null,4090536);" href="/Messages/4090536/More-security-requirements.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a>
                               </div>Hi,<br> <br> Thanks for these ideas I will try to incorporate some examples you have mentioned in the next version of article.<br> <br> Regards,<br> Jovan<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4090536" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4091034/Re-More-seurity-requirements.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4091034" data-ref="3_4091034" class="rating-label" name="RateItem_4091034" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4087698_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4087698xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4087698" parent="0" thread="4087698" href="/Messages/4087698/Fluent-Security.aspx">Fluent Security</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">kristofferahl</span>
                        <span class="date">24-Nov-11 23:26</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=8422608">kristofferahl</a></span></td>
                      <td class="date"><span>24-Nov-11 23:26&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4087698_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="8422608" msgid="4087698" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">Thanks for including and showcasing Fluent Security! A reminder for the folks out there:<br> <br> <b>Fluent Security</b> is <b>free</b>, <b>open source</b> and available on <a href="http://nuget.org/List/Packages/FluentSecurity">NuGet</a>.<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4087698" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4087698/Fluent-Security.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4087698" data-ref="3_4087698" class="rating-label" name="RateItem_4087698" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4087334_h0" class="header hover-row root"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="20px" class="indent"><a name="xx4087334xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" alt="Question" title="Question"></td>
                      <td class="subject hover-container"><a class="message-link" name="4087334" parent="0" thread="4087334" href="/Messages/4087334/I-see-youve-implemented-my-suggestion.aspx">I see you've implemented my suggestion?</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Simon_Whitehead</span>
                        <span class="date">24-Nov-11 14:33</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=2137634">Simon_Whitehead</a></span></td>
                      <td class="date"><span>24-Nov-11 14:33&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4087334_h1" class="content root selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:20px;"><span class="voteform vertical" ownerid="2137634" msgid="4087334" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="20px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">I noticed that you've implemented my suggestion from your previous article (that you've now deleted?). Did you enjoy playing around with that method?<br> 
                               <div class="signature">
                                If you don't succeed, redefine success!
                               </div><br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4087334" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4087334/I-see-youve-implemented-my-suggestion.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4087334" data-ref="3_4087334" class="rating-label" name="RateItem_4087334" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4087679_h0" class="header hover-row"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="38px" class="indent"><a name="xx4087679xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4087679" parent="4087334" thread="4087334" href="/Messages/4087679/Re-I-see-youve-implemented-my-suggestion.aspx">Re: I see you've implemented my suggestion?</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Jovan Popovic</span>
                        <span class="date">24-Nov-11 23:16</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=1025738">Jovan Popovic</a></span></td>
                      <td class="date"><span>24-Nov-11 23:16&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4087679_h1" class="content selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:38px;"><span class="voteform vertical" ownerid="1025738" msgid="4087679" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="38px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">
                               <div class="parent">
                                <a rel="nofollow" onclick="return forumControl59298016.SwitchMessage(null,4087334);" href="/Messages/4087334/I-see-youve-implemented-my-suggestion.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a>
                               </div>Hi Simon,<br> <br> Yes I have tried it and looks great - that is why I have included it here as an example.<br> <br> Have you any experience with more complex settings where (controller, action, roles) are placed in some database or config file? This is very useful when we can hardcode access rights, but is there any way to read these settings and apply them dynamically?<br> I didn't have enough time to explore Fluent Security in more details so I have not found this but it would be nice to have this feature.<br> <br> Regards,<br> Jovan<br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4087334" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4087679/Re-I-see-youve-implemented-my-suggestion.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4087679" data-ref="3_4087679" class="rating-label" name="RateItem_4087679" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4089045_h0" class="header hover-row"> 
                  <td class="subject-line normal " width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr> 
                      <td width="56px" class="indent"><a name="xx4089045xx"></a><img height="16px" width="16px" align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" alt="General" title="General"></td>
                      <td class="subject hover-container"><a class="message-link" name="4089045" parent="4087679" thread="4087334" href="/Messages/4089045/Re-I-see-youve-implemented-my-suggestion.aspx">Re: I see you've implemented my suggestion?</a> <a onclick="return forumControl59298016.Pin(this);" rel="nofollow" href="#" title="Click to pin message"><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/pin.png" border="0" align="top" alt="Pin" width="13px" height="13px"></a>
                       <div class="mobile-only"> 
                        <span class="author">Simon_Whitehead</span>
                        <span class="date">27-Nov-11 13:46</span> 
                       </div></td>
                      <td class="icon"><img border="0" src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/icn-member-16.gif" title="member" alt="member" height="16px"></td>
                      <td class="author"><span><a href="/script/Membership/View.aspx?mid=2137634">Simon_Whitehead</a></span></td>
                      <td class="date"><span>27-Nov-11 13:46&nbsp;</span></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr>
                 <tr id="F4089045_h1" class="content selected" style="display:none;"> 
                  <td class="normal" width="100%">
                   <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                    <tbody>
                     <tr valign="top"> 
                      <td class="indent align-right" style="width:56px;"><span class="voteform vertical" ownerid="2137634" msgid="4089045" votingtype="GoodOrBad"></span><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" height="1px" width="56px" alt=""></td>
                      <td class="text">
                       <table border="0" cellpadding="0" cellspacing="5px" width="100%"> 
                        <tbody>
                         <tr> 
                          <td>
                           <table border="0" cellpadding="0" cellspacing="0" width="100%"> 
                            <tbody>
                             <tr> 
                              <td colspan="2">
                               <div class="parent">
                                <a rel="nofollow" onclick="return forumControl59298016.SwitchMessage(null,4087679);" href="/Messages/4087679/Re-I-see-youve-implemented-my-suggestion.aspx"><img src="https://codeproject.global.ssl.fastly.net/App_Themes/CodeProject/Img/arrow-up24.png" title="Go to Parent" style="width:16px;height:16px;border:0"></a>
                               </div>Anything is possible because you're controlling everything in the AuthorizeCore method.<br> <br> Personally, in the past I have had a concatenated string of permissions for a user in the database (eg: "Administrator,Add.Users") etc, then I just check the "AllowRoles" on the current users usergroup, eg:<br> <br> <pre lang="c#">&nbsp;
<span class="code-keyword">foreach</span> (<span class="code-keyword">string</span> role <span class="code-keyword">in</span> AllowRoles)
{
    <span class="code-keyword">if</span> (CurrentUser.UserGroup.Contains(role))
        <span class="code-keyword">return</span> <span class="code-keyword">true</span>;
}
&nbsp;</pre><br> <br> ..then on each controller and action you supply tags such as:<br> <br> <pre lang="c#">&nbsp;
[AllowUser(<span class="code-string">"</span><span class="code-string">Administrator"</span>)]
<span class="code-keyword">public</span> <span class="code-keyword">class</span> AdminController : Controller
{
    <span class="code-keyword">public</span> ActionResult Index()
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
&nbsp;
    [AllowUser(<span class="code-string">"</span><span class="code-string">Add.Users"</span>)]
    <span class="code-keyword">public</span> ActionResult Add_Users()
    <span class="code-comment">//</span><span class="code-comment"> ...</span>
&nbsp;
    [AllowUser(<span class="code-string">"</span><span class="code-string">Edit.Users"</span>)]
    <span class="code-keyword">public</span> ActionResult Edit_Users()
    <span class="code-comment">//</span><span class="code-comment"> ..</span>
}
&nbsp;
<span class="code-comment">//</span><span class="code-comment"> ... etc</span></pre><br> <br> .. thats obviously a basic example, but thats the general idea.<br> <br> Note: A lot more goes on in the background, like loading the user, checking everything else against it, etc.<br> 
                               <div class="signature">
                                If you don't succeed, redefine success!
                               </div><br></td> 
                             </tr>
                             <tr class="footer" style="vertical-align:top;"> 
                              <td><a href="https://www.codeproject.com/script/Membership/LogOn.aspx?rp=/articles/288631/secure-asp-net-mvc-applications">Sign In</a>·<wbr><a href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;tid=4087334" title="View&nbsp;Thread">View&nbsp;Thread</a>·<wbr><a href="/Messages/4089045/Re-I-see-youve-implemented-my-suggestion.aspx" title="Get permanent link">Permalink</a></td>
                              <td style="text-align:right;"><span id="MVF4089045" data-ref="3_4089045" class="rating-label" name="RateItem_4089045" style="white-space:nowrap;"><span class="rating-result"><span></span></span></span></td> 
                             </tr> 
                            </tbody>
                           </table></td> 
                         </tr> 
                        </tbody>
                       </table></td> 
                     </tr> 
                    </tbody>
                   </table></td> 
                 </tr> 
                </tbody>
               </table></td> 
             </tr>
             <tr> 
              <td><img src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/t.gif" border="0" width="1px" height="5px" alt=""></td> 
             </tr>
             <tr> 
              <td>
               <table width="100%" cellpadding="2px" cellspacing="0"> 
                <tbody>
                 <tr class="footer"> 
                  <td><span class="last-visit desktop-only tablet-only">Last Visit: 31-Dec-99 18:00 &nbsp; &nbsp; Last Update: 17-Sep-17 9:18</span></td>
                  <td><a rel="nofollow" href="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;prof=True&amp;view=Normal">Refresh</a></td>
                  <td style="text-align:right;white-space:nowrap;"><input id="_mbnUrl" type="hidden" value="/articles/288631/secure-asp-net-mvc-applications?fid=1667185&amp;df=90&amp;mpp=50&amp;sort=Position&amp;spc=Tight&amp;prof=True&amp;view=Normal&amp;fr=40"><span class="nav-link selected">1</span></td> 
                 </tr> 
                </tbody>
               </table></td> 
             </tr> 
            </tbody>
           </table> 
          </div>
          <p class="small-text"><img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_general.gif" width="16px" height="16px" alt="General"> General &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_news.gif" width="16px" height="16px" alt="News"> News &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_idea.gif" width="16px" height="16px" alt="Suggestion"> Suggestion &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_question.gif" width="16px" height="16px" alt="Question"> Question &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_bug.gif" width="16px" height="16px" alt="Bug"> Bug &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_answer.gif" width="16px" height="16px" alt="Answer"> Answer &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_joke.gif" width="16px" height="16px" alt="Joke"> Joke &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_kudos.gif" width="16px" height="16px" alt="Praise"> Praise &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_rant.gif" width="16px" height="16px" alt="Rant"> Rant &nbsp;&nbsp; <img align="top" src="https://codeproject.global.ssl.fastly.net/script/Forums/Images/msg_admin.gif" width="16px" height="16px" alt="Admin"> Admin &nbsp;&nbsp; </p>
          <p class="small-text">Use Ctrl+Left/Right to switch messages, Ctrl+Up/Down to switch threads, Ctrl+Shift+Left/Right to switch pages.</p> 
         </div> </td> 
        <td width="170px" class="article-wing-right"> 
         <div id="ctl00_RightSideBar" class="container-article-info"> 
          <div id="RHSticky" class="container-article-info-sticky"> 
           <div class="article-summary"> 
           </div> 
           <div id="ctl00_SectionSponsor" class="padded-top"> 
            <div class="msg-160x200" data-format="160x200" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Web-Development/Web-Security/Security" data-tags="C#, ASP.NET, Javascript, XML, HTML, Dev, Intermediate, MVC,rating4.5">
             <noscript>
              <a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=160x200&amp;c=439844"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=160x200&amp;c=439844" width="160px" height="200px" target="_blank"></a>
             </noscript>
            </div> 
           </div> 
           <div style="width:160px;margin: 10px auto;"> 
            <div class="msg-160x600" data-format="160x600" data-type="ad" data-publisher="lqm.codeproject.site" data-zone="Web-Development/Web-Security/Security" data-tags="C#, ASP.NET, Javascript, XML, HTML, Dev, Intermediate, MVC,rating4.5">
             <noscript>
              <a href="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=160x600&amp;c=439844"><img src="https://pubads.g.doubleclick.net/gampad/jump?iu=/6839/lqm.codeproject.site/Web-Development/Web-Security/Security&amp;sz=160x600&amp;c=439844" width="160px" height="600px" target="_blank"></a>
             </noscript>
            </div> 
           </div> 
           <div class="anchorLink gototop" id="gototop"> 
            <a id="ctl00_GoToTop" href="/articles/288631/secure-asp-net-mvc-applications#_articleTop">Go to top</a> 
           </div> 
          </div> 
         </div> </td> 
       </tr>
      </tbody>
     </table> 
     <div class="theme1-background" style="height:2px" id="stickyStop"></div> 
     <div class="extended tiny-text"> 
      <div class="row"> 
       <div class="float-left"> 
        <a id="ctl00_PermaLink" href="/Articles/288631/Secure-ASP-NET-MVC-applications">Permalink</a> | 
        <a id="ctl00_AdvertiseLink" href="http://developermedia.com/">Advertise </a> | 
        <a id="ctl00_PrivacyLink" href="/info/privacy.aspx">Privacy</a> | 
        <a id="ctl00_TermsOfUseLink" href="/info/TermsOfUse.aspx">Terms of Use</a> | 
        <a id="ctl00_Mobile">Mobile</a> 
        <br> Web02 | 2.8.170915.1 | Last Updated 21 Jul 2014 
       </div> 
       <div id="ctl00_GoogleTranslate" class="translate float-left"></div> 
       <div class="float-right align-right">
         Article Copyright 2011 by Jovan Popovic
        <br>Everything else Copyright © 
        <a href="mailto:webmaster@codeproject.com">CodeProject</a>, 1999-2017 
        <br> 
       </div> 
       <div class="page-width">
         Layout: 
        <a id="ctl00_PageWidth_FixedT" title="Fixed width layout" rel="nofollow" class=" active" href="/articles/288631/secure-asp-net-mvc-applications?PageFlow=FixedWidth">fixed</a> | 
        <a id="ctl00_PageWidth_FluidT" title="Fluid layout" rel="nofollow" href="/articles/288631/secure-asp-net-mvc-applications?PageFlow=Fluid">fluid</a> 
       </div> 
      </div> 
     </div> 
     <br clear="all"> 
    </div> 
   </div> 
  </div> 
  <img id="ctl00_Audience" src="https://pubads.g.doubleclick.net/activity;dc_iu=/6839/DFPAudiencePixel;ord='636412583371012451';dc_seg=33704410?" style="border-width:0px;height:1px;width:1px;"> 
  <script type="text/javascript" language="Javascript" src="https://codeproject.global.ssl.fastly.net/script/Articles/JS/article.min.js?dt=2.8.170915.1"></script> 
  <script type="text/javascript" language="Javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script> 
  <script type="text/javascript" language="Javascript" src="/Script/Membership/JS/MemberProfilePopup.min.js?v=1.4"></script> 
  <script type="text/javascript" language="Javascript">//<![CDATA[
$(document).ready(function () { processCodeBlocks.Initialise('#contentdiv'); });
function googleTranslateElementInit() {  new google.translate.TranslateElement({   pageLanguage: 'en',   layout: google.translate.TranslateElement.InlineLayout.SIMPLE,   autoDisplay: false,   gaTrack: true,   gaId: 'UA-1735123-1'},  'ctl00_GoogleTranslate');}
$(document).ready(function() { anchorAnimate();
$('#RHSticky').sticky($('#stickyStop'));
$('#ctl00_Nav').sticky($('#stickyStop'));
});
$(document).ready(function() {   $('.alert-bar').fadeIn('slow');   $('.alert-bar a.close-notify').click(function() {      $('.alert-bar').fadeOut('fast');        return false;    });});
$(function ()
                {
                    $('.oauth').click(function () {
                        $this = $(this);
                        href = $this.attr('href');
                        var myWindow = window.open(href, 'popup',
                                    'width=800,height=600,location=0,menubar=0,resizeable=0,scrollbars=0,toolbar=0');
                        myWindow.focus();
                        var timer = setInterval(function () {
                                        if (myWindow.closed) {
                                            clearInterval(timer);
                                            // window.location.reload(); // May do a POST reload, shows a warning
                                            window.location = window.location; // force a GET reload
                                        }
                                    }, 200);
                        return false;
                    });
                });
var retrievalService=function(n){var t=!1;n=n||{};var r=n.RetrievalServiceUrl||"/script/content/webservices/RetrieveContent.aspx/GetContent",u=n.RetrievalServiceRetries||3,f=n.RetrievalServiceTimeout||5e3,e=function(){t||(t=!0,$(window).bind("resize scroll",i),i())},i=function(){if(typeof DMAds=="undefined"){var n=$('[data-type="ad"]');n.each(function(){var n=$(this),u=n.attr("data-format")||"",f=n.attr("data-publisher")||"",e=n.attr("data-zone")||"",t=n.attr("data-loadonview"),i=n.attr("data-noadx"),h=n.attr("data-tags")||"",c=n.find("iframe").length!==0||n.find("img").length!==0,r=n.attr("data-processed");t=typeof t=="string"&&t.toLowerCase()==="true";i=typeof i=="string"&&i.toLowerCase()==="true";r=typeof r=="string"&&r.toLowerCase()==="true";r||c||t&&!s(this)||(o(n,u,f,e,i,h),n.attr("data-processed","true"))})}},o=function(n,t,i,e,o,s){var h=new $.Deferred,c=JSON.stringify({format:t,publisherCode:i,zone:e,noAdX:o,keywords:s});$.ajax({url:r,cache:!1,type:"POST",data:c,contentType:"application/json; charset=utf-8",dataType:"json",tryCount:0,retryLimit:u,timeout:f}).done(function(t){var i=t?t.d:null;h.resolve(i); i && i.html && n.html(i.html)}).fail(function(n,t){h.reject(t)})},s=function(n){var t,f,e,o;if(!h(n))return!1;var u=!1,i=0,r=0;try{t=n.getBoundingClientRect();typeof innerWidth=="number"?(i=window.innerWidth,r=window.innerHeight):document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)?(i=document.documentElement.clientWidth,r=document.documentElement.clientHeight):document.body&&(document.body.clientWidth||document.body.clientHeight)&&(i=document.body.clientWidth,r=document.body.clientHeight);f=-200;t.top===t.bottom&&(f+=n.height*-1);e=t.top>=0&&t.top-200<=r||t.top<=0&&t.top>=f;o=i>t.left&&t.right>=0;u=e&&o}catch(s){u=!0}return u},h=function(n){var t=!1,i;return n&&n.style.position!=="fixed"&&n.offsetParent?t=!0:n&&n.style.position==="fixed"&&(i=window.getComputedStyle(n),t=i&&i.display!=="none"),t&&c()},c=function(){var t=!0,n="";return typeof document.hidden!="undefined"?n="hidden":typeof document.mozHidden!="undefined"?n="mozHidden":typeof document.msHidden!="undefined"?n="msHidden":typeof document.webkitHidden!="undefined"&&(n="webkitHidden"),n!==null&&document[n]&&(t=!1),t};return{init:e}};$(document).ready(function(){var n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("MSXML2.XMLHTTP"),t;n.onreadystatechange=function(){try{if(n.readyState==4)if(n.status==200){var t=document.createElement("script");t.type="text/javascript";t.innerHTML=n.responseText;document.getElementsByTagName("body")[0].appendChild(t)}else(new retrievalService).init()}catch(i){(new retrievalService).init()}};try{t=('https:' == document.location.protocol ? 'https://' : 'http://') + 'cdn2.developermedia.com/a.min.js';n.open("GET",t,!0);n.send()}catch(i){(new retrievalService).init()}});
var oSrchFlt = false, oSrchBox=false,srchBoxFoc=false;
$(document).ready(function() {
 if(InitWatermark)InitWatermark('sb_tb', 'Search for articles, questions, tips');
 var sbar = $('#sb_tb'); 
 var sfilter = $('#SearchFilter');
 if (sbar && sfilter) {
  sfilter.removeClass('popup'); sfilter.hide(); sfilter.removeClass('open');
  sbar.blur(function() {
 if (!oSrchFlt) {sfilter.hide(); sfilter.removeClass('open');}
 srchBoxFoc=false;
 });
  sbar.focus(function() {
 oSrchFlt=false; srchBoxFoc=true;
 sfilter.show(); sfilter.addClass('open');
 });
  sbar.mouseleave(function() { oSrchBox=false; });
  sbar.mouseover(function() { oSrchBox=true; });
  sfilter.mouseleave(function() { oSrchFlt=false; if (!srchBoxFoc&&!oSrchBox) { sfilter.hide(); sfilter.removeClass('open'); }});
  sfilter.mouseover(function() { oSrchFlt=true; });
 }
});
$('#clear-rate_ctl00_RateArticle_RSU').click(function () {    $('#ctl00_RateArticle_RSU').hide(); return false;});$("#ctl00_RateArticle_RateItemWrapper")   .removeClass("container-rating")   .hover( function() { $('#ctl00_RateArticle_RSU').fadeIn('fast'); },            function() { $('#ctl00_RateArticle_RSU').fadeOut('fast'); } );
function PostBack_ctl00_RateArticle_RateItemWrapper() {
  return rateItem(null, 288631,2,1,true,true,0,'MediumStars', null, ratingAjaxCallback);
}

                        function getVotesHistogram(objectId, objectTypeId, containerId, loadingId) {
                            if (!$('#' + containerId).attr('alreadyRequested')){
                                $.ajax({
                                    url: '/script/Ratings/Ajax/Histogram.aspx?obid=' + objectId + '&obtid='+objectTypeId,
                                    success: function (data) {
                                        $('#' + containerId).html(data);
                                        $('#' + loadingId).hide();
                                    }
                                });
                                $('#' + containerId).attr('alreadyRequested', 'true');
                            }
                        }
$(document).ready(function() {
  new starRating('#ctl00_RateArticle_RateItemWrapper', PostBack_ctl00_RateArticle_RateItemWrapper,'ctl00_RateArticle');
  $('#ctl00_RateArticle_RB').mouseenter(function() {     getVotesHistogram(288631,2   ,'ctl00_RateArticle_Histogram','ctl00_RateArticle_Loading');
  });
})

$(document).ready(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});

$(document).ready(function() {
  $('#ctl00_RateArticle_SubmitRateBtn').hide();
});
function ChkRtctl00_RateArticle(){}

var config59298016 = {
    objectName          : 'forumControl59298016',
    messageTypeId       : 3,
    smoothScroll        : true,
    allowReporting      : false,
    allowRating         : false,
    allowRatingDisplay  : true,
    forumDir            : '/script/Forums/',
    staticServer        : 'https://codeproject.global.ssl.fastly.net',
    switchMsgCallback   : null,
    getVoteFormMethod   : getVoteFormHtml,
    getReportFormMethod : getReportFormHtml,
    voteHiThreshold     : 5 - 0.5,
    getRatingUrl        : '/script/Ratings/Ajax/GetRatings.aspx',
    getRatingRefKey     : 'obrs',
    reportOptions       : [
       { reportTypeId : 19, name : 'Abusive / Trolling'},
       { reportTypeId : 20, name : 'Inappropriate'},
       { reportTypeId : 5, name : 'Spam'},
    ],
};
var forumControl59298016 = new ForumControl(config59298016, -1);
$(document).ready(function() {
    forumControl59298016.Initialise();
});


//]]>
</script>  
 </body>
</html>