<!doctype html>
<!--
NewMaster.master
A new master page for the aspx pages on www.cpearson.com 
By: Chip Pearson, chip@cpearson.com   www.cpearson.com
Date: 28-December-2013
Revised: 25-April-2016

===============================================================
AS OF 10-APRIL-2016 GOOGLE ADS
	Name:					GoogleUpperLeftSide
	Position:				Upper vertical banner on left side of screen
	AdUnit:					2138376294
	Last 30 Days Income:	$138.59

	----------------------------------------
	Name:					GoogleLowerLeftSide
	Position:				Lower vertical banner on left side of screen
	AdUnit:					3252264294
	Last 30 Days Income:	$64.80

	----------------------------------------
	Name:					GoogleUpperRight
	Position:				Uppper vertical banner on right side of screen
	AdUnit:					6205730690
	Last 30 Days Income:	$111.99

	----------------------------------------
	Name:					GoogleLowerRight
	Position:				Lower vertical banner on right side of screen
	AdUnit:					7682463896
	Last 30 Days Income:	$0 !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

	----------------------------------------
	Name:					BannerDec
	Position:				Fist horizontal below footer block
	AdUnit:					0765406512
	Last 30 Days Income:	

	----------------------------------------
	Name:					SecondBottom
	Position:				Third horizontal below foot block (Ligit ad is still in the middle horizontal 
	AdUnit:					7786788028
	Last 30 Day Income:

===============================================================
-->
<html xmlns="http://www.w3.org/1999/xhtml">
 <!-- =====================================================
	HTML HEAD SECTION 
===================================================== -->
 <head>
  <title>
	Ranking Data In Lists
</title>
  <link href="../favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="../CSS/Global.css" rel="stylesheet" type="text/css">
 </head> 
 <!-- =====================================================
	HTML BODY SECTION 
===================================================== --> 
 <body style="width:1300px;  max-width:1000px; min-width:800px;"> 
  <form name="aspnetForm" method="post" action="Rank.aspx" id="aspnetForm" style="margin-top:5px; width:1000px;max-width:1100px;min-width:1100px;"> 
   <div> 
    <input type="hidden" name="__VIEWSTATE" id="__VIEWSTATE" value="/wEPDwULLTE0MTExMDE5MDYPZBYCZg9kFgICAw9kFggCFQ8PFgIeBFRleHQFIHd3dy5jcGVhcnNvbi5jb20vZXhjZWwvUmFuay5hc3B4ZGQCFw8PFgIfAAULMDYtTm92LTIwMTNkZAIaDw8WAh8ABQsxNi1TZXAtMjAxN2RkAiIPZBYCAgUPZBYCAgEPDxYCHwAFRXd3dy5jcGVhcnNvbi5jb20vZXhjZWwvUmFuay5hc3B4ICAgQ29weXJpZ2h0IDIwMTMsIENoYXJsZXMgSC4gUGVhcnNvbmRkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYBBQ1jdGwwMCRidG5BRFgyY+SqR49r+j9Y1jSV9rUmwkUksFQ="> 
   </div> 
   <div> 
    <input type="hidden" name="__VIEWSTATEGENERATOR" id="__VIEWSTATEGENERATOR" value="750A3CCF"> 
    <input type="hidden" name="__EVENTVALIDATION" id="__EVENTVALIDATION" value="/wEWFQLdkaTIBAL6/q6CCgLD4rOHCALbrM+QCALnrJfFDQKwgsesCgL9n+COAgLo3ZUSAqufyNgJAqSZ+P0FArDzptUJAtush48IAra9ku0EArCCj6wKAv2fyPcOAujdrakDAt/G27wDAqSZwP0FAojbwMAHAvuK3eELArKixrMBrWsNIwg24KDNGORWVNgb/ZCG1I0="> 
   </div> 
   <!-- ===================================================== 
	divPageHeader
	This is the main header block of the page. The first
	element is a three column block for banner information,
	div HeadBlocks. Next, a div surrounds the naviation
	buttons, div TopButtonBlock. This is the complete
	divPageHeader page header block for the page.
===================================================== --> 
   <div id="ctl00_divPageHeader" class="pageheader" style="border: thin solid #800000; margin-top:10px; height: 220px;   width:inherit;"> 
    <!-- ====================================================== --> 
    <!-- BEGIN HEADER BLOCKS divHeadBlocks --> 
    <!-- HEADER BLOCKS is a div with three float:left divs, LeftBlock
		which holds logo image and text, CenterBlock which hold main title,
		and RightBlock which holds text. Navigation Buttons are NOT
		part of divHeaderBlocks.
	<!-- ====================================================== --> 
    <div style="height:90px; width: 100%;" id="divHeadBlocks"> 
     <!-- left block  --> 
     <div id="LeftBlock" style="border: 1px none maroon; padding-top:15px; padding-left:15px; float:left; height:80px; width:250px; "> 
      <img id="ctl00_asdfasdfsadfa" src="../images/CIntergarl60.png" style="border-width:0px;float:left;padding:0;margin:5px;"> 
      <span id="ctl00_Label1" style="display:inline-block;width:150px;font-family:Arial;font-size:medium;color:maroon;margin-top:3px; margin-left:5px;font-style:italic;float:left;">Advanced Software</span>
      <br> 
      <span id="ctl00_Label2" style="font-family:Arial;font-size:medium;color:maroon;margin-top:3px; margin-left:5px;font-style:italic;float:left;">Design And Development</span>
      <br> 
     </div> 
     <!-- end div LeftBlock --> 
     <!-- end left block  --> 
     <!-- center block  --> 
     <div id="CenterBlock" style="border: 1px none maroon; float:left; height:80px; width:400px; padding-top:5px;text-align:center;"> 
      <span style="font-family:Arial;font-size:30px;color:maroon;font-style:italic;text-align:center">Pearson Software Consulting</span>
      <br> 
      <span id="ctl00_Label7" style="font-family:Arial;font-size:20px;color:maroon;font-style:italic;text-align:center">www.cpearson.com</span> &nbsp;&nbsp;&nbsp;&nbsp; 
      <a id="ctl00_HyperLink1" class="main" href="mailto://chip@cpearson.com" style="font-size:16px;font-style:italic;">chip@cpearson.com</a> 
     </div> 
     <!-- end div CenterBlock --> 
     <!-- right block  --> 
     <div id="RighBlock" style="border: 1px none maroon; padding-top:5px; float:right; height:80px; width:200px; "> 
      <span id="ctl00_Label3" style="display:inline-block;width:190px;padding-right:10px; text-align:right; float:right;font-family:Arial;font-size:medium;color:maroon;margin-top:3px; font-style:italic;">Office Integration Projects</span> 
      <span id="ctl00_Label4" style="display:inline-block;width:190px;padding-right:10px; text-align:right; float:right;font-family:Arial;font-size:medium;color:maroon;margin-top:3px; font-style:italic;">NET Programming</span> 
      <span id="ctl00_Label5" style="display:inline-block;width:190px;padding-right:10px; text-align:right; float:right;font-family:Arial;font-size:medium;color:maroon;margin-top:3px; font-style:italic;">XML Development</span> 
     </div> 
     <!-- end div LeftBlock --> 
     <!-- end right block  --> 
    </div> 
    <!-- end div HeadBlocks --> 
    <!-- ====================================================== --> 
    <!-- END HEADER BLOCKS --> 
    <!-- ====================================================== --> 
    <div class="clear" style="height:3px"></div> 
    <!-- ====================================================== --> 
    <!-- START div TopButtonBlock 
		This contains the navigation button at the top of the page.
	--> 
    <!-- BEGIN NAVIGATION BUTTONS --> 
    <!-- removed height: and width: attributes from style tag. 
   
	--> 
    <!-- 
	NEW SEARCH BOX
	--> 
    <div id="SearchBox" style="align-content: center; text-align: center; margin: 0px;  height: 40px;  overflow: visible;">
      Search The Site: 
     <input name="ctl00$tbxSearchPhrase" type="text" id="ctl00_tbxSearchPhrase" class="main" style="border-color:Maroon;height:20px;width:300px;margin-left:20px;"> 
     <input type="submit" name="ctl00$btnSiteSearch" value="Search" id="ctl00_btnSiteSearch" style="width:150px;margin-left:10px;"> 
    </div> 
    <!-- 
	END NEW SEARCH BOX
	--> 
    <div id="TopButtonBlock" style="align-content: center; text-align: center; margin: 0px; height: 40px; overflow: visible;"> 
     <input type="submit" name="ctl00$btnHome" value="Home" id="ctl00_btnHome" class="button" style="margin-top: 0px"> 
     <input type="submit" name="ctl00$btnTopic" value="Topic Index" id="ctl00_btnTopic" class="button" style="margin-top: 0px"> 
     <input type="submit" name="ctl00$btnWhatsNew" value="What's New" id="ctl00_btnWhatsNew" class="button" style="margin-top: 0px"> 
     <input type="submit" name="ctl00$btnSearch" value="Search" id="ctl00_btnSearch" class="button" style="margin-top: 0px"> 
    </div> 
    <div id="BottomButtonBlock" style="align-content: center; text-align: center; margin: 0px;  height: 40px;  overflow: visible;"> 
     <input type="submit" name="ctl00$btnConsulting" value="Consulting" id="ctl00_btnConsulting" class="button" style="margin-top: 0px"> 
     <input type="submit" name="ctl00$btnDownloads" value="Downloads" id="ctl00_btnDownloads" class="button" style="margin-top: 0px"> 
     <input type="submit" name="ctl00$btnFeedback" value="Feedback" id="ctl00_btnFeedback" class="button" style="margin-top: 0px"> 
     <input type="submit" name="ctl00$btnContact" value="Contact" id="ctl00_btnContact" class="button" style="margin-top: 0px;"> 
    </div> 
    <!-- END NAVIGATION BUTTONS --> 
   </div> 
   <!-- end divPageHeader --> 
   <!-- ===================================================== --> 
   <!-- END PAGE HEADER --> 
   <!-- this is the end of the entire page heading section.
<!-- ===================================================== --> 
   <div class="clear"></div> 
   <!-- 
	The second section of the page is a div, "columns", that defines
	there horizonatlly aligned columns, divLeftColumn, divContentColumn,
	and divRightColumn. divLeftColumn and divRightColumn are 165px
	wide and each contains two vertially stacked divs to hold
	advertising scripts from Google and Lijit. The center column, 
	divCenterColumns, contians the asp:ContentPlaceHolder ID="ContentPlaceHolder1" 
	element in which the content of the aspx web forms is 
	displayed.  This is 670px wide.
--> 
   <!-- ===================================================== --> 
   <!-- START CONTENT DIV COLUMNS --> 
   <!-- ===================================================== --> 
   <div class="columns"> 
    <!-- this class sets the float:left property
							so the left, center, and right <div>
							elements line up as three vertical 
							columns. See the CSS file. --> 
    <!-- ===================================================== --> 
    <!-- START LEFT COLUMN --> 
    <!-- ===================================================== --> 
    <div id="divLeftColumn" class="leftcolumn" style="align-content:stretch;
			border-top-color:navy;  width:170px;
			border-top-style:solid;border-top-width:1px; overflow: hidden; align-items:flex-start;"> 
     <!-- ========================================= --> 
     <!-- GOOGLE AD --> 
     <!-- ========================================= --> 
     <!-- Google Scripts to disply upper ad --> 
     <!-- OLD SCRIPT 4-JAN-2014 
		<script type="text/javascript">
			google_ad_client = "ca-pub-7293698002238456";
			google_ad_slot = "2138376294";
			google_ad_width = 160;
			google_ad_height = 600;
		</script>
		--> 
     <!-- NEW SCRIPT 4-JAN-2014  --> 
     <div id="divToLeftGoogleSkyscraper"> 
      <script src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> 
      <!-- Left_Skyscraper_4_13 --> 
      <ins class="adsbygoogle" style="display:inline-block;width:160px;height:600px" data-ad-client="ca-pub-7293698002238456" data-ad-slot="2138376294"></ins> 
      <script>
				(adsbygoogle = window.adsbygoogle || []).push({});
			</script> 
      <!-- END NEW SCRIPT 4-JAN-2014  --> 
      <!-- commented 4-JAN-2014 when replacing script above 
		<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
		--> 
      <!-- END Google Scripts to disply upper ad --> 
      <!-- ========================================= --> 
      <!-- GOOGLE AD --> 
      <!-- ========================================= --> 
     </div> 
     <!-- end div  divToLeftGoogleSkyscraper --> 
     <p></p>
     <p></p> 
     <!-- spacers between ads --> 
     <!-- REMOVED LOWER LEFT LIGIT 
			REPLCED BY NEW GOOGLE AD  ON 20-July-2015 --> 
     <div id="divLowerLeftGoogleAd"> 
      <!-- ========================================= --> 
      <!-- GOOGLE AD --> 
      <!-- ========================================= --> 
      <div id="GoogleLowerLeftAdDiv" style="border-top-color:navy;border-top-width:1px;border-top-style:solid;"> 
       <script type="text/javascript">
						google_ad_client = "ca-pub-7293698002238456";
						google_ad_slot = "3252264294";
						google_ad_width = 160;
						google_ad_height = 600;
				</script> 
       <!-- GoogleLowerLeftSide --> 
       <script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js">
				</script> 
      </div> 
      <!-- ========================================= --> 
      <!-- END GOOGLE AD --> 
      <!-- ========================================= --> 
     </div> 
     <!-- end GoogleLowerLeftAdDiv --> 
     <!-- end of left column --> 
    </div> 
    <!-- ===================================================== --> 
    <!-- END LEFT COLUMN --> 
    <!-- ===================================================== --> 
    <!-- ===================================================== --> 
    <!-- START MIDDLE CONTENT COLUMN --> 
    <!-- ASPX WEB FORM CONTENT APPEARS HERE --> 
    <!-- ===================================================== --> 
    <!-- id="divContentColumn"  --> 
    <div id="divContentColumn" class="centercolumn" style="padding-top: 10px; margin-left: 10px; 
		margin-right:10px;width:617px; max-width:620px; overflow: scroll;"> 
     <!-- ============================================================================= --> 
     <!-- == BEGIN PAGE TOPIC SECTION                                                   --> 
     <!-- ============================================================================= --> 
     <p class="pagetopic"> <img src="../images/ThreeWave4.png" id="ctl00_ContentPlaceHolder1_Img1" alt="ThreeWave" style="float:left"> Ranking Data In Lists<br> </p> 
     <p class="main">This page describes worksheet formulas you can use to work with data ranking in Excel worksheets.<br> <img src="../images/ShortFadeBar.png" id="ctl00_ContentPlaceHolder1_Img2" alt="ShortFadeBar"> </p> 
     <!-- ============================================================================= --> 
     <!-- == END PAGE TOPIC SECTION                                                   --> 
     <!-- ============================================================================= --> 
     <!-- ============================================================================= --> 
     <!-- == BEGIN CONTENT SECTION                                                      --> 
     <!-- ============================================================================= --> 
     <p class="sectionheader">Introduction</p> 
     <p class="main"> Excel is often used to keep track of data that needs to be ranked. This might be anything from sports scores to sales data. Excel provides a worksheet function named <span class="formula">RANK</span> that you can use to do rudimentary ranking, but this function is rather limited. However, we can use some worksheet formulas to provide a much deeper and meaningful anlaysis of data using the <span class="formula">RANK</span> function. </p> 
     <p class="main"> You can <a href="../Zips/Rank2.zip">an example workbook</a> with the formulas described on this page. </p> 
     <p class="main" style="text-align:center"><img src="../images/SectionBreak.png" id="ctl00_ContentPlaceHolder1_Img3" alt="SectionBreak"></p> 
     <p class="sectionheader">Simple Ranking</p> 
     <p class="main"> The simplest use of ranking is to get the rank of one or more values in a list. The rank of a number in a list is the position at which the value would be placed if the data list were sorted. The <span class="formula">RANK</span> function does exactly this and it supports ranking unsorted data, assigning ranks in either ascending order or descending order. Descending order is the default for the <span class="formula">RANK</span> function. In <em>descending</em> order, the higher score is given the numerically lower rank. For example, if you have bowling scores of <span class="formula">{150, 125, 180, 175}</span>, the value <span class="formula">180</span>, the highest value in the list, is given a rank of 1 and the value <span class="formula">125</span>, the lowest value in the list, is given the rank of 4. Even though in common language usage, the highest score is said to be the "highest ranked" score, the actual numeric value of the rank is the lowest. (E.g., "the highest ranked bowling score was 180", may sound correct, but the rank of 180 is actually the lowest rank value, 1). When you rank in <em>ascending</em> order, the lower values are given the numerically lower rank. Golf scoring is an example in which you would use ascending ranking. The lower the score the better, so lower values are assigned lower numerical rankings. With the scores <span class="formula">{72, 88, 75, 82}</span>, the value 72, the lower score in the list, is given a rank of 1 and 88, the highest score in the list, is given a rank of 4. </p> 
     <p class="main"> The <span class="formula">RANK</span> function is essentailly the inverse of the <span class="formula">LARGE</span> (and <span class="formula">SMALL</span>) function. While <span class="formula">RANK</span> returns the rank of a value in a list, <span class="formula">LARGE</span> returns a value based on its rank. If cells <span class="formula">B4:B8</span> contain the values <span class="formula">{5,2,4,3,1}</span>, the formula <span class="formula">=LARGE($B$4:$B$8,RANK(B4,$B$4:$B$8,0))</span> in cells <span class="formula">C4:C8</span> returns the original data in the original order, confirming the relationship between <span class="formula">RANK</span> and <span class="formula">LARGE</span>. A similar formula can be created with the <span class="formula">SMALL</span> function: <span class="formula">=SMALL($B$4:$B$8,RANK(B4,$B$4:$B$8,1))</span>. </p> 
     <p class="main" style="text-align:center"> <img src="../images/SectionBreak.png" id="ctl00_ContentPlaceHolder1_Img4" alt="SectionBreak"></p> 
     <p class="sectionheader">Unique Ranks In Descending Order</p> 
     <p class="main"> One of the features (or failures, depending on your perspective) of the <span class="formula">RANK</span> function is that it returns the same rank value for items of equal value. For example, with the data <span class="formula">{33, 22, 44, 22, 11}</span> the <span class="formula">RANK</span> function returns a rank of 1 to the value 44, the value 2 for 33, the value 3 for <em>both</em> occurrences of 22, and then a rank of 5 for 11. No value is ranked as 4. You can use a formula to prevent this duplication of rank value. For example, the following formula entered in cell <span class="formula">B1</span> and filled down to <span class="formula">B5</span> will return unique ranks of the values in <span class="formula">A1:A5</span><br> <br> <span class="formula">=RANK(A1,$A$1:$A$5,0)+COUNTIF($A$1:A1,A1)-1</span><br> <br> To see how this formula works, enter the values <span class="formula">33, 22, 44, 22, 11</span> in cells <span class="formula">A1:A5</span> and enter the formula <span class="formula">=RANK(A1,$A$1:$A$5,0)+COUNTIF($A$1:A1,A1)</span> in cell <span class="formula">B1</span>. Fill the formula down from <span class="formula">B1</span> through <span class="formula">B5</span>. This will return the values <span class="formula">2, 3, 1, 4, 5</span> to cells <span class="formula">B1:B5</span>. Examine the formulas in cells <span class="formula">B2</span> and <span class="formula">B4</span>, the cells that are adjacent to the duplicated value 22. In <span class="formula">B2</span>, the <span class="formula">RANK</span> returns 3 (as it should), and the <span class="formula">COUNTIF</span> function is <span class="formula"> COUNTIF($A$1:A2,A2)</span> which returns 1. Subtract 1 from the result of <span class="formula">COUNTIF</span> and you'll get 0, which when added to the value 3 from <span class="formula">RANK</span> gives us 3, the correct rank of the first occurrence of 22. Now, look at the formula in cell <span class="formula">B4</span>, which is adjacent to the second occurrence of the value 22. As before, the <span class="formula">RANK</span> function returns 3, but the <span class="formula">COUNTIF</span> function is now <span class="formula">COUNTIF($A$1:A4,A4)</span> which returns 2, the number of values 22 in range <span class="formula">A1:A4</span>. Subtract 1 from that result and add that to the result of <span class="formula">RANK</span>, and you'll get 4. This formula will work with any number of duplicated values. The reason that it works is that for any value <span class="formula">V</span> that occurs <span class="formula">N</span> times in a list, with a rank of <span class="formula">R</span>, there are <span class="formula">N</span> rank values <span class="formula">R</span>, and the next <span class="formula">N-1</span> occurrences of <span class="formula">V</span> have the rank <span class="formula">R</span>. This means that <span class="formula">N-1</span> rank values are omitted and the next rank value is <span class="formula">R-N</span>. The <span class="formula">COUNTIF()-1</span> piece of the formula adds back <span class="formula">N-1</span>, and <span class="formula">R+N-1</span> is the rank of the <span class="formula">N</span>th occurrence of the value <span class="formula">V</span>. For as many occurrences <span class="formula">N</span> of <span class="formula">V</span> exist in the list, the <span class="formula">RANK</span> function omits <span class="formula">N-1</span> rank value. The <span class="formula">COUNTIF()-1</span> simply adds those missing rank values back into the ranking. In the following screen shot, the original data values to be ranked are shown in <span style="color:Blue">blue</span>, the intermediate calculated results in <span style="color:Black">black</span>, and the final results shown in <span style="color:Red"></span>. </p> 
     <p class="main"> <img alt="RankSimple" src="../images/Rank2SimpleAndUnique.png" style="margin:25px"> </p> 
     <p class="main" style="text-align:center"> <img src="../images/SectionBreak.png" id="ctl00_ContentPlaceHolder1_Img5" alt="SectionBreak"></p> 
     <p class="sectionheader">Unique Ranks In Ascending Order</p> 
     <p class="main"> The logic for unique ascending ranks is a bit different than that for descending unique ranks. With your data in the range <span class="formula">A1:A5</span>, enter the following formula in cell <span class="formula">B1</span> and fill down to cell <span class="formula">B5</span>.<br> <span class="formula">=COUNT($A$1:$A$5)-(RANK(A1,$A$1:$A$5)+COUNTIF($A$1:A1,A1)-1)+1</span><br> <br> The formula works in the following manner. The total number of elements minus the <em>descending</em> rank of a value is that value's <em>ascending</em> rank <em>as if</em> the rankings were 0-based rather than 1-based. For example, the unique <em>descending</em> rank of the value 33 is 2. Subtracting this from the total number of elements, 5, returns the zero based rank of 3. Adding 1 brings the rank to a 1-based system and therefore 33 gets the rank of 4. It is important to note that even though this formula calculates the <em>ascending</em> ranks, it uses the <em>descending</em> format of the <span class="formula">RANK</span> function. In the screen show below, the data to be ranked is shown in <span style="color:Blue">blue</span>, the intermediate calculations in <span style="color:Black">black</span>, and the final results in <span style="color:Red">red</span>.</p> 
     <p class="main"> <img alt="UniqueAscending" src="../images/Rank2UniqueAscending.png" style="margin:25px"> </p> 
     <p class="main" style="text-align:center"> <img src="../images/SectionBreak.png" alt="SectionBreak"></p> 
     <p class="sectionheader">Descending Player Rankings</p> 
     <p class="main"> While the formulas illustrated above are useful for the direct ranking of data, it is very often the case that you want to return a ranked list of the players or other entities that have ranked scores or values. For example, a ranking of bowling scores is useful really only when you can retrieve the players in scored rank. The actual scores are less useful than are the player names themselves. This section will create a list of players according to the ranked scores, in descending rank order. </p> 
     <p class="main"> In the following example, the player names are in <span class="formula">B4:B13</span> and each player's score is in <span class="formula">C4:C13</span>. We use the following formula to calculate the unique descending rankings of the players' scores. This is the same formula descibed earlier in this article.<br> <br> <span class="formula">=RANK(C4,$C$4:$C$13,0)+COUNTIF($C$4:C4,C4)-1</span><br> <br> Enter this formula in cell <span class="formula">E4</span> and fill down to <span class="formula">E13</span>. This gives us the unique rankings of the player's scores that we will use to retrieve the player names in scored order. Enter the following formula in cell <span class="formula">G4</span> and fill down to <span class="formula">G13</span>. This will list the names of the players, listed in <span class="formula">B4:B13</span> in the order of the unique ranks in <span class="formula">E4:E13</span>.<br> <br> <span class="formula">=OFFSET(B$4,MATCH(SMALL(E$4:E$13,ROW()-ROW(G$4)+1),E$4:E$13,0)-1,0)</span><br> <br> In the screen image below, the input data is shown in <span style="color:Blue">blue</span>, the unique rankings in <span style="color:Black">black</span>, and the final results in <span style="color:Red"></span>. </p> 
     <p class="main"> <img alt="RankPlayers" src="../images/Rank2Players.png" style="margin:25px"> </p> 
     <p class="main" style="text-align:center"> <img src="../images/SectionBreak.png" alt="SectionBreak"></p> 
     <p class="sectionheader">Ascending Player Rankings</p> 
     <p class="main"> The previous section display players ordered by a descending unique rank. The same players may be ordered by ascending rank order. With the player names in cells <span class="formula">B18:B27</span> and their scores in cells <span class="formula">C18:C27</span>, enter the following formula in <span class="formula">E18:E27</span><br> <br> <span class="formula">=COUNT($C$18:$C$27)-(RANK(C18,$C$18:$C$27,0)+COUNTIF($C$18:C18,C18))+2</span><br> <br> This formula will create unique player ranks in ascending order. These ranks will be used to create the order list of players. In cell <span class="formula">G18</span>, enter the following formula and fill it down to cell <span class="formula">G27</span>.<br> <br> =OFFSET(B$18,MATCH(SMALL(E$18:E$27,ROW()-ROW(G$18)+1),E$18:E$27,0)-1,0)<br> <br> This will list the players in ascending rank order. The screenshot below illustrates this. </p> 
     <p class="main"> <img alt="PlayersAscending" src="../images/Rank2PlayersAscending.png" style="margin:25px"> </p> 
     <p class="main" style="text-align:center"> <img src="../images/SectionBreak.png" alt="SectionBreak"></p> 
     <p class="sectionheader">Double Ranking And Tie Breaking</p> 
     <p class="main"> In the examples above, we had tied scores, two players having the same score. In those scenarios, there was no way to break a tie. The tied elements would appear in the result list according to their position in the input list. This section of the article describes how to use multiple tables to resolve ties. We first have a <em>primary</em> table that contains the players name and their scores. Next, we have a <em>secondary</em> table that is used to resolve ties. If two player have the same score in the primary table, those players' scores in the secondary table are used to break the tie. (If those same player have a tied score in the secondary table, the results are returned in the order in which they appear in the secondary list. </p> 
     <p class="main"> The core of working with the two lists and breaking the ties in to create a third table, called the <em>Composite</em> table. This table lists all of the player and calcualtes a composite rank that is calculated from the player's rank in the primary table and her rank in the secondardy table. Assuming you have the primary table with player names and scores in the range <span class="formula">B6:C15</span>, called <span class="formula">Table1</span>, the secondary table, also wih player names and scores, in cells <span class="formula">E6:F7</span>, named <span class="formula">Table2</span>, and the composite table in cell <span class="formula">H6:J16</span>, with Player Names in column <span class="formula">H</span>, the composite score (to be calcuated later) on column <span class="formula">I</span>, and the Composite Rank (also discussed later) in column <span class="formula">J</span>, you can list the players by score in descending rank in column <span class="formula">L</span> and the players by score in acsendning rank in column <span class="fomrula">N</span>. The basic layout of the tables is shown below. The rest of this section will discuss how write the formula and what those formulas actually do. </p> 
     <p class="definitions"> The formulas on this page are Array Formula, so you must press CTRL SHIFT ENTER rather than ENTER when you first enter the formula and whenever you edit it later. If you do this correctly, Excel will display the formulas enclosed in curly braces <span class="formula">{ }</span>. See <a href="arrayformulas.aspx">the Array Formulas</a> page for more information about working with array formulas. </p> 
     <p class="main"> <img alt="Rank2Players" src="../images/Rank2Players.png" style="margin:25px"> </p> 
     <p class="main"> In the cells of column <span class="formula">I</span> in <span class="formula">Table1</span> enter the following formula:<br> <br> <span class="formula">=(C6/MAX(ABS($C$6:$C$15)))+(F6/(10^(MAX(LEN(C$6:C$15)+1))))</span><br> <br> </p> 
     <p class="main"> This formula calculates the <em>Composite Score</em>. This score is calculated with the following formula:<br> <br> <span c="formula">=(C6/MAX(ABS($C$6:$C$15)))+(F6/(10^(MAX(LEN(C$6:C$15)+1))))</span> </p> 
     <p class="main"> For each row in the Composite Score, this calcualtes the data value divided the maximum data element. This number, <span class="formula">N</span> is subject to constraint <span class="formula">0 &lt;= N &lt;= 1</span>. Added to this is is the value of the secondary (tie breaking) rank divided by <span class="formula">(10^(MAX(LEN($C$6:$C$15)+1)</span>. This calculated value is 10 to power of <span class="formula">Z</span> where <span class="formula">Z</span> is the longtest (in terms of character length, not numeric value) of the numbers in cells <span class="formula">C6:C15</span>. If the longest number has six characters (e.g., 123.456), the formula <span class="formula">(10^(MAX(LEN($C$6:$C$15)+1)</span> reutrns 10^7. When we divide that into the cell value from the score from the secondary table, we get a fractional number that is 0's until the number of digits surpass the digit to right of the decimal point from the score value from Table2. Finally, to break ties between scores in Table2, we divide the current Row number by <span class="formula">((ROW()/(10^MAX(LEN($F$6:$F$15)+1))))</span>. This ensure that the least significant protion of the number is scaled past the end of the decimal number to which it is added. <br> </p> 
     <p class="main"> One we have composite score, which combines the scores in the primary and second tables to generate a unique, properly ordered key, we must rank the composite scores. We do this with the same formula we used earlier in this to determine unique ranks. In cell <span class="formula">J6</span>, enter the following formula and then fill down to <span class="formula">J15</span>. <br> <br> <span class="formula&quot;">=RANK(I6,$I$6:$I$15,0)+COUNTIF($I$6:I6,I6)-1</span> <br> This is just the unique rank of the composite scores. Finally, after all this, we can use the composite ranks to return the names of the players in either Descending or Ascending order. To return the list in Descending order, enter the formula in cell <span class="formula">L6</span> and fill down to <span class="formula">L15</span>.<br> <br> <span class="formula">=OFFSET(B$6,MATCH(SMALL(J$6:J$15,ROW()-ROW(J$6)+1),J$6:J$15,0)-1,0)</span><br> <br> To return the names in Ascending order, enter the following formula in cell <span class="formula">N6</span> and fill down to <span class="formula">N15</span>,<br> <br> <span class="formula">=OFFSET(B$6,MATCH(LARGE(J$6:J$15,ROW()-ROW(N$6)+1),J$6:J$15,0)-1,0)</span><br> <br> </p> 
     <p class="main"> As a practical matter, you don't need to include the player names in any table other than the primary tab. As longs as everything is in the same rows, you can simply the display to the following: <img alt="RankNoNames" src="../images/Rank2PlayerNoNames.png" style="margin:25px"> </p> 
     <p class="main"> </p> 
     <p class="main"> You can <a href="../Zips/Rank2.zip">an example workbook</a> with the formulas described on this page. </p> 
     <p class="main"> This page last updated: 19-Sept-2007 </p> 
    </div> 
    <!-- ===================================================== --> 
    <!-- END MIDDLE CONTENT COLUMN --> 
    <!-- ===================================================== --> 
    <!-- ===================================================== --> 
    <!-- PADDING TO LEFT OF RIGHT COLUMN --> 
    <!-- ===================================================== --> 
    <!-- ===================================================== --> 
    <!-- RIGHT COLUMN --> 
    <!-- ===================================================== --> 
    <!-- added float right --> 
    <div id="divRightColumn" class="rightcolumn" style="margin-left: 10px; max-width:170px; width:170px; max-width:670px;
			padding-top: 10px; margin-right: 10px; position: inherit;"> 
     <!--  ================================= --> 
     <!-- GOOGLE TOP RIGHT --> 
     <!--  ================================= --> 
     <div id="divGoogleUpperRight" style="max-width:170px;"> 
      <script type="text/javascript">
					google_ad_client = "ca-pub-7293698002238456";
					google_ad_slot = "6205730690";
					google_ad_width = 160;
					google_ad_height = 600;
			</script> 
      <!-- GoogleUpperRight --> 
      <script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js">
			</script> 
     </div> 
     <!--  ================================= --> 
     <!-- END GOOGLE AD 2 --> 
     <!--  ================================= --> 
     <!-- july 2016
		</div> <!-- end div divTopRightGoogleSkyScrape --> --&gt; 
     <div id="divGoogleLowerRightAd" style="max-width:170px;"> 
      <!--  ================================= --> 
      <!-- GOOGLE AD LOWER RIGHT --> 
      <!--  ================================= --> 
      <script type="text/javascript">
				google_ad_client = "ca-pub-7293698002238456";
				google_ad_slot = "7682463896";
				google_ad_width = 160;
				google_ad_height = 600;
			</script> 
      <!-- GoogleLowerRight --> 
      <script type="text/javascript" src="//pagead2.googlesyndication.com/pagead/show_ads.js">
			</script> 
      <!--  ================================= --> 
      <!-- END GOOGLE AD LOWER RIGHT --> 
      <!--  ================================= --> 
     </div> 
     <!-- end div   divGoogleLowerRightAd  --> 
    </div> 
    <!-- END OF RIGHT COLUMN --> 
    <!-- ===================================================== --> 
    <!-- END RIGHT COLUMN --> 
    <!-- ===================================================== --> 
    <!-- end class columns --> 
   </div> 
   <!-- ===================================================== --> 
   <!-- END CONTENT DIV COLUMNS --> 
   <!-- ===================================================== --> 
   <div class="clear" style="height:1px;"></div> 
   <!-- ===================================================== --> 
   <!-- END CONTENT SECTION --> 
   <!-- ===================================================== --> 
   <!--
	The final section of the page is the page footer section,
	div divPageFooter, which contains navigation buttons,
	informational text, and in-footer advertisements. The
	first element in the footer is 
--> 
   <!-- ===================================================== --> 
   <!-- START PAGE FOOTER --> 
   <!-- ===================================================== --> 
   <div id="divPageFooter" class="pagefooter" style="font-size:12px"> 
    <!-- ================================================= --> 
    <!-- NAVIGATION BUTTONS --> 
    <!-- ================================================= --> 
    <!-- BEGIN NAVIGATION BUTTONS --> 
    <!-- div align center --> 
    <div id="BottomButtonBorder" style="align-content:center;text-align:center; margin-top:10px;"> 
     <input type="submit" name="ctl00$btnHome2" value="Home" id="ctl00_btnHome2" class="button" style="margin-top:5px"> 
     <input type="submit" name="ctl00$btnTopic2" value="Topic Index" id="ctl00_btnTopic2" class="button" style="margin-top:5px"> 
     <input type="submit" name="ctl00$btnWhatsNew2" value="What's New" id="ctl00_btnWhatsNew2" class="button" style="margin-top:5px"> 
     <input type="submit" name="ctl00$btnSearch2" value="Search" id="ctl00_btnSearch2" class="button" style="margin-top:5px"> 
     <div id="splitLowerButtons" style="align-content: center; text-align: center; margin: 0px;  height: 40px;  overflow: visible;"></div> 
     <input type="submit" name="ctl00$btnConsulting2" value="Consulting" id="ctl00_btnConsulting2" class="button" style="margin-top:5px"> 
     <input type="submit" name="ctl00$btnDownloads2" value="Downloads" id="ctl00_btnDownloads2" class="button" style="margin-top:5px"> 
     <input type="submit" name="ctl00$btnFeedback2" value="Feedback" id="ctl00_btnFeedback2" class="button" style="margin-top:5px"> 
     <input type="submit" name="ctl00$btnLegal2" value="Legal" id="ctl00_btnLegal2" class="button" style="margin-top:5px"> 
    </div> 
    <!-- end div BottomButtonBorder --> 
    <!-- end div align center --> 
    <!-- ================================================= --> 
    <!-- END NAVIGATION BUTTONS --> 
    <!-- ================================================= --> 
    <!-- ================================================= --> 
    <!-- START FOOTER CONTENT --> 
    <!-- ================================================= --> 
    <p class="main" style="text-align:center;font-size:16px;text-decoration:underline;"> Created By Chip Pearson at Pearson Software Consulting </p> 
    <div id="BottomBlocks" style="float:left;width:100%;"> 
     <div id="LeftBottomInfo" class="main" style="width:49%; height:80px; text-align:left;float:left;"> 
      <p class="main" style="margin-left:10px;line-height:20px;"> This Page: <span id="ctl00_lblThisPage" class="code">www.cpearson.com/excel/Rank.aspx</span><br> Last Updated: <span id="ctl00_lblLastUpdated" class="code">06-Nov-2013</span><br> Copyright 1997 - 2014, Charles H. Pearson<br> <span id="ctl00_Label6" class="main">Site Last Updated: </span><span id="ctl00_lblLastSiteUpdate" class="main" style="display:inline-block;height:16px;width:225px;margin-left:10px">16-Sep-2017</span><br> </p> 
     </div> 
     <div id="RightBottomInfo" class="main" style="width:49%;height:80px; text-align:left;float:left;"> 
      <p class="main" style="margin-left:10px;line-height:20px;"> Email: <a id="ctl00_hypEMail" class="main" href="mailto://chip@cpearson.com?subject=Direct Feedbak" style="color:Blue;font-size:12px;">chip@cpearson.com</a><br> Please read <a id="ctl00_hypPleaseRead" class="main" href="EmailMe.aspx" style="color:Blue;font-size:12px;">this page</a>&nbsp;before emailing me.<br> Phone: (816) 325-9822 USA Central Time (-6:00 UTC)<br> <span style="padding-left:30px;">Between 9:00 AM and 7:00 PM</span> </p> 
     </div> 
    </div> 
    <!-- end BottomBlocks --> 
    <!-- in footer ads --> 
    <div id="InBoxAds"> 
     <div class="clear" style="height:1px;"></div>
     <br> 
     <p style="text-align:center;font-size:16px;color:maroon;"> <span style="text-decoration:underline">Essential Tools For Developers</span> </p> 
     <p style="text-align:center;font-size:16px;color:maroon;"> The world's choice for creating NET-based Commercial Quality Add-Ins for Office<br> <span style="color:red;">Add-In Express</span> Is The Most Important Tool For Creating Commerical Level Components<br><br> <input type="image" name="ctl00$btnADX2" id="ctl00_btnADX2" src="../images/adx-excel-2.jpg" style="border-width:0px;"> </p> 
     <hr> 
     <p style="text-align:center;font-size:20px;color:maroon;"> 
      <!-- ADDED FOR Excel-Easy on 9-April-2016 --> Learn more about <a href="http://www.excel-easy.com" style="font-size:20px;">Excel</a> and <a href="http://www.excel-easy.com/vba.html" style="font-size:20px;">VBA (Visual Basic for Applications)</a>. 
      <!-- END ADDED FOR Excel-Easy on 9-April-2016 --> </p> 
    </div> 
    <!-- end div InBoxAds --> 
    <div id="ctl00_citation_div" style=" margin-left:10px;padding-top:0;margin-top:0;vertical-align:top;" class="citation_div"> 
     <input type="submit" name="ctl00$btnCitation" value="Citation Information" id="ctl00_btnCitation" class="button" style="width:135px;float:right;align-content:space-around;vertical-align:top;margin-right:5px;margin-top:5px;"> 
     <span class="citethispage" style="padding-top:4px;margin-top:4px">Cite this page as:</span>
     <br> 
     <span id="ctl00_lblCitation" class="citethispagetext" style="padding-top:4px;margin-top:4px;">Source: <span id="ctl00_lblCitationPage" style="font-family:Courier New;font-size:Small;padding-top:3px;margin-top:3px;">www.cpearson.com/excel/Rank.aspx Copyright 2013, Charles H. Pearson</span></span> 
    </div> 
    <!-- end divCitation --> 
    <br> 
    <span id="ctl00_Label9" class="main" style="margin-left:10px;">This site created with Microsoft Visual Studio 2013 Premium and ASP.NET 4</span> 
    <div style="margin-left:10px;margin-bottom:10px"> 
     <br>
     <span style="display:inline-block;width:90%;text-align:center;margin-top:10px;"><a style="font-size:medium;" href="server.mappath(&quot;/Excel/Advertisehere.aspx&quot;">Advertise Your Product On This Site</a></span> 
    </div> 
    <!-- ================================================= --> 
    <!-- END FOOTER CONTENT --> 
    <!-- ================================================= --> 
   </div> 
   <!-- end <div ID="divPageFooter">    --> 
   <!-- ===================================================== --> 
   <!-- END PAGE FOOTER --> 
   <!-- ===================================================== --> 
   <!-- ===================================================== --> 
   <!-- START ADS AFTER FOOTER --> 
   <!-- ===================================================== --> 
   <div class="clear" style="height:1px;"></div> 
   <div id="AdsAfterFooter" style="align-content:center;margin-top:20px;margin-left:20px;text-align:center;"> 
    <!-- ================ --> 
    <!-- NEW GOOGLE AD #1 --> 
    <!-- ================ --> 
    <div style="align-content:center"> 
     <!-- Google Scripts --> 
     <!-- OLD SCRIPT 4-JAN-2014 
	<script type="text/javascript">
		google_ad_client = "ca-pub-7293698002238456";
		google_ad_slot = "0765406512";
		google_ad_width = 728;
		google_ad_height = 90;
	</script>
	<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
	--> 
     <!-- END OLD SCRIPT 4-JAN-2014 --> 
     <!-- NEW SCRIPT 4-JAN-2014 --> 
     <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> 
     <!-- BannerDec --> 
     <ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-7293698002238456" data-ad-slot="0765406512"></ins> 
     <script>
			(adsbygoogle = window.adsbygoogle || []).push({});
		</script> 
     <!-- END NEW SCRIPT 4-JAN-2014 --> 
     <!-- END Google Scripts --> 
    </div> 
    <!-- ================ --> 
    <!-- END NEW GOOGLE AD #1 --> 
    <!-- ================ --> 
    <p></p> 
    <!-- ================ --> 
    <!-- LIJIT AD --> 
    <!-- ================ --> 
    <div style="align-content:center"> 
     <div id="lijit_region_178120"></div> 
     <script type="text/javascript" src="http://www.lijit.com/delivery/fp?u=chippearson&amp;z=178120&amp;n=1"></script> 
    </div> 
    <!-- ================ --> 
    <!-- END LIJIT AD --> 
    <!-- ================ --> 
    <!-- ================ --> 
    <!-- NEW GOOGLE AD #2 --> 
    <!-- ================ --> 
    <!-- Google Scripts --> 
    <div style="align-content:center"> 
     <!-- OLD SCRIPT 4-JAN-2014 
	<script type="text/javascript">
		google_ad_client = "ca-pub-7293698002238456";
		google_ad_slot = "7786788028";
		google_ad_width = 728;
		google_ad_height = 90;
	</script>
	<script type="text/javascript" src="http://pagead2.googlesyndication.com/pagead/show_ads.js"></script>
	--> 
     <!--  NEW SCRIPT 4-JAN2-14 --> 
     <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> 
     <!-- Second Bottom --> 
     <ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-7293698002238456" data-ad-slot="7786788028"></ins> 
     <script>
		(adsbygoogle = window.adsbygoogle || []).push({});
	</script> 
     <!--  END NEW SCRIPT 4-JAN2-14 --> 
     <!-- End Google Scripts --> 
    </div> 
    <!-- ================ --> 
    <!-- END GOOGLE AD #2 --> 
    <!-- ================ --> 
   </div> 
   <!-- end AdsAfterFooter --> 
   <!-- ===================================================== --> 
   <!-- END ADS AFTER FOOTER --> 
   <!-- ===================================================== --> 
   <!-- ===================================================== --> 
   <!-- END OF FORM --> 
   <!-- ===================================================== --> 
  </form> 
  <!-- ===================================================== --> 
  <!-- END OF BODY --> 
  <!-- ===================================================== -->  
  <!-- ===================================================== --> 
  <!-- END OF PAGE --> 
  <!-- ===================================================== -->  
 </body>
</html>