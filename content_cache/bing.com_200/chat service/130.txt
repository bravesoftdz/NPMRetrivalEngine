<!doctype html>
<html>
 <head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Creating a Java Service Installation</title>
  <meta name="description" content="A step by step tutorial depicting the creation of a Java
      Service installation in Advanced Installer.">
  <link type="text/css" rel="stylesheet" href="../style-ug.css">
  <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-61715-1']);
      _gaq.push(['_setDomainName', 'none']);
      _gaq.push(['_setAllowLinker', true]);      
      _gaq.push(['_setAllowHash', false]);
      _gaq.push(['_trackPageview']);
      
      (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
 </head>
 <body>
  <script>
      goog_snippet_vars = function() {
          var w = window;
          w.google_conversion_id = 1042144394;
          w.google_conversion_label = "uT-NCJLzkwEQirn38AM";
          w.google_remarketing_only = false;
        }
        
        // DO NOT CHANGE THE CODE BELOW.
        goog_report_conversion = function(url) {
          goog_snippet_vars();
          window.google_conversion_format = "3";
          var opt = new Object();
          opt.onload_callback = function() {
          if (typeof(url) != 'undefined') {
            window.location = url;
          }
        }
        
        var conv_handler = window['google_trackConversion'];
        if (typeof(conv_handler) == 'function') {
          conv_handler(opt);
        }
      }
    </script>
  <script src="//www.googleadservices.com/pagead/conversion_async.js"></script>
  <div id="main">
   <!--[if lt IE 7]> 
        <script src="/js/DD_belatedPNG_0.0.8a.js" type="text/javascript"></script> 
        <script type="text/javascript">DD_belatedPNG.fix('#ai-logo, #caphyon-logo, #prod-options, #prod-options a'); </script>
      <![endif]-->
   <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
   <script type="text/javascript" src="../js/common.js"></script>
   <div id="main-menu">
    <div class="cont-width">
     <ul>
      <li class="map-first"><a href="../download.html" title="Download Advanced Installer">Download</a></li>
      <li><a href="../features.html" title="Software Installation Tool Features">Features</a></li>
      <li><a href="../analytics/index.html" title="Learn how users install, upgrade or remove your applications.">Analytics</a></li>
      <li><a href="../desktop-bridge.html" title="Get your desktop application in the Windows Store">AppX</a></li>
      <li><a href="../licenses.html" title="Licensing Advanced Installer: editions, maintenance plans">Licensing</a></li>
      <li><a href="../purchase.html" title="Purchase Advanced Installer licenses">Purchase</a></li>
      <li><a href="../blog.html" title="Advanced Installer Blog">Blog</a></li>
      <li><a href="../support.html" title="Advanced Installer Support">Support</a></li>
      <li class="map-last"><a href="/forums" title="Advanced Installer Forums">Forums</a></li>
     </ul>
     <div class="float-right" id="ai-searchbox">
      <form action="../search.html" id="cse-search-box">
       <div>
        <input type="hidden" name="cx" value="006686361644407349086:yneweleowua">
        <input type="hidden" name="cof" value="FORID:9">
        <input type="hidden" name="ie" value="UTF-8">
        <input type="text" name="q" id="gcse" onfocus="clearTextInput(this);" onblur="undoTextInput(this);">
       </div>
      </form>
     </div>
     <div class="clear"></div>
    </div>
   </div>
   <div id="pagehead-bg">
    <div id="pagehead">
     <div class="cont-width">
      <a id="ai-logo" class="float-left" title="Windows Installer" href="../index.html">Advanced Installer</a>
      <div class="float-left">
       <div id="ai-title">
        Advanced Installer User Guide 
       </div>
       <h1>Creating a Java Service Installation</h1>
      </div>
      <div id="prod-options" class="float-right">
       <a id="prod-purchase" href="../purchase.html" title="Purchase Advanced Installer licenses">Buy</a>
       <a id="prod-download" href="../download.html" title="Download Advanced Installer">Download</a>
      </div>
      <div class="clear"></div>
     </div>
    </div>
   </div>
   <table class="page">
    <tbody>
     <tr>
      <td class="topics">
       <div id="sidebar-wrapper">
        <div id="sidebar-sep">
         <ul>
          <li class="map-leaf"><a href="introduction.html" title="An introduction to the Advanced Installer software.">Introduction</a></li>
          <li class="map-closed"><a href="register-ai.html" title="Registration options for Advanced Installer.">Registration</a></li>
          <li class="map-closed"><a href="using.html" title="A guide to using Advanced Installer, from the GUI to the Command Line and Shell integration.">Using Advanced Installer</a></li>
          <li class="map-closed"><a href="features.html" title="Detailed descriptions and explanations for selected features and functionalities of the application.">Features and Functionality</a></li>
          <li class="map-open"><a href="tutorials-qa.html" title="Step by step Tutorials, detailed How-tos and various Frequently Asked Questions.">Tutorials, How-tos, FAQs</a>
           <ul>
            <li class="map-open"><a href="tutorials.html" title="Step by step tutorials that will guide you in creating different types of projects or in using certain features.">Tutorials</a>
             <ul>
              <li class="map-leaf"><a href="tutorial-simple.html" title="A step by step tutorial describing the creation of the simplest possible Windows Installer MSI package, using Advanced Installer.">Simple Installation</a></li>
              <li class="map-leaf"><a href="tutorial-professional.html" title="A step by step tutorial depicting the creation of a professional Advanced Installer installation.">Professional Installation</a></li>
              <li class="map-leaf"><a href="tutorial-professional-cli.html" title="Creating a Professional project from CLI.">Professional Installation from CLI</a></li>
              <li class="map-leaf"><a href="tutorial-transforms.html" title="A step by step tutorial describing the creation and editing of a Windows Installer transform, using Advanced Installer.">Creating transforms</a></li>
              <li class="map-leaf"><a href="tutorial-thinapp.html" title="A step by step tutorial to create a ThinApp Package in Advanced Installer.">Creating a ThinApp Package</a></li>
              <li class="map-leaf"><a href="tutorial-sharepoint-solution.html" title="Step by step tutorial on how to create a project for a SharePoint solution.">SharePoint Solution Installers</a></li>
              <li class="map-leaf"><a href="tutorial-languages.html" title="A step by step tutorial depicting the creation of Windows Installer MSI packages localized in other languages using Advanced Installer.">Other Languages</a></li>
              <li class="map-leaf"><a href="tutorial-new-language.html" title="A step by step tutorial explaining how to translate and create MSI packages in a new language.">New Language</a></li>
              <li class="map-leaf"><a href="tutorial-java.html" title="A step by step tutorial depicting the creation of a Java Product installation in Advanced Installer.">Java Product Installation</a></li>
              <li class="map-leaf map-current"><a href="tutorial-java-service.html" title="A step by step tutorial depicting the creation of a Java Service installation in Advanced Installer.">Java Service Installation</a></li>
              <li class="map-leaf"><a href="tutorial-tomcat-webapp.html" title="A step by step tutorial exposing the setup development of a Tomcat web app.">Setup package for a Tomcat web application</a></li>
              <li class="map-leaf"><a href="tutorial-MacOSX-package.html" title="A step by step tutorial depicting the creation of a Mac OS X package for a Java application.">Mac OS X package for a Java application</a></li>
              <li class="map-leaf"><a href="IntelliJ-IDEA-import.html" title="Short tutorial explaining how to import an IntelliJ IDEA project/module and create a setup package for it.">IntelliJ IDEA import</a></li>
              <li class="map-leaf"><a href="tutorial-patch.html" title="A step by step tutorial depicting the creation of a Windows Installer patch in Advanced Installer.">Patch Authoring</a></li>
              <li class="map-leaf"><a href="tutorial-appx-desktop-bridge-convertor.html" title="How to generate an AppX using the Desktop Bridge Setup Converter.">Desktop Bridge Setup Converter</a></li>
              <li class="map-leaf"><a href="tutorial-debug-desktop-bridge-applications.html" title="How to debug Desktop Bridge Apps using the Advanced Installer Visual Extension.">Debug Desktop Bridge Applications</a></li>
              <li class="map-closed"><a href="tutorial-updates-deployment.html" title="Step by step tutorials that guide you in using Advanced Updater to automatically deploy updates to your users.">Deploying Updates</a></li>
              <li class="map-closed"><a href="tutorial-dialog-editing.html" title="Step by step tutorials that guide you in using the dialogs editor from Advanced Installer.">Using the Dialog Editor</a></li>
              <li class="map-closed"><a href="tutorial-sql-databases.html" title="Step by step tutorials on how to use the SQL Databases page.">Using SQL Databases</a></li>
              <li class="map-closed"><a href="appv-tutorials.html" title="The App-V tutorials in Advanced Installer.">App-V Tutorials</a></li>
              <li class="map-closed"><a href="convert-legacy-installations.html" title="Choose the preferred project type to author an MSI installation package which installs existing EXE packages.">Convert Legacy Installations</a></li>
              <li class="map-closed"><a href="tutorial-vs.html" title="Visual Studio tutorials.">Visual Studio Tutorials</a></li>
              <li class="map-leaf"><a href="tutorial-create-new-vm.html" title="Using Advanced Installer to create a new virtual machine for testing the installation.">Creating a new VM</a></li>
              <li class="map-leaf"><a href="tutorial-rad-tools-integration.html" title="RAD Tool integration guidelines">RAD Tools Integration</a></li>
              <li class="map-leaf"><a href="tutorial-import-msi.html" title="Step by step tutorial on how to import an MSI into an Advanced Installer project.">MSI Import</a></li>
              <li class="map-leaf"><a href="tutorial-import-wise.html" title="Step by step tutorial on how to import a WISE project into an Advanced Installer project.">WISE Import</a></li>
              <li class="map-leaf"><a href="tutorial-import-appx.html" title="Importing/Creating an AppX Package">Import/Create AppX </a></li>
              <li class="map-leaf"><a href="tutorial-import-desktop-bridge-app.html" title="Importing a Desktop Bridge AppX Package">Import Desktop Bridge AppX Package</a></li>
              <li class="map-leaf"><a href="tutorial-iis.html" title="Step by step tutorial on configuring IIS Web Sites and Virtual Directories.">IIS Tutorial</a></li>
              <li class="map-leaf"><a href="tutorial-gpo.html" title="Step by step tutorial on how to deploy an MSI package through GPO.">Deploy an MSI through GPO</a></li>
              <li class="map-leaf"><a href="tutorial-licensing.html" title="Step by step tutorial on how to create a VB application that integrates the licensing functionality.">Add trial support to your VB application</a></li>
              <li class="map-leaf"><a href="tutorial-multiple-builds.html" title="Step by step tutorial on how to create a project with multiple build configurations.">Multiple Builds</a></li>
              <li class="map-leaf"><a href="tutorial-XML-locator.html" title="Step by step tutorial describing how to create an XML locator search in Advanced Installer.">XML Locator Search</a></li>
              <li class="map-leaf"><a href="tutorial-msm-configurable-parameters.html" title="A step by step tutorial detailing how to create and use basic MSM packages with configurable parameters">MSM with parameters for custom actions</a></li>
              <li class="map-leaf"><a href="tutorial-winmobile.html" title="Step by step tutorial on how to use the Advanced Installer Windows Mobile/CE features.">Windows Mobile/CE Installations</a></li>
             </ul></li>
            <li class="map-closed"><a href="questions-answers.html" title="Explanations for implementing custom features into your installation.">How-tos</a></li>
            <li class="map-closed"><a href="faq.html" title="Frequently Asked Questions.">FAQs</a></li>
           </ul></li>
          <li class="map-closed"><a href="windows-installer.html" title="Documentation of selected Windows Installer features and abilities.">Windows Installer</a></li>
          <li class="map-closed"><a href="ug-deployment-technologies.html" title="Technologies used by Advanced Installer to deploy your applications.">Deployment Technologies</a></li>
          <li class="map-closed"><a href="desktop-bridge-setup-converter.html" title="Using the Desktop Bridge Setup Converter wizard to convert legacy setups to AppX.">DBSC wizard</a></li>
          <li class="map-leaf"><a href="index.html" title="User Guide Table of Contents">Table of Contents</a></li>
         </ul>
        </div>
       </div></td>
      <td class="content ug">
       <div class="page-content-inner">
        <p class="alert alert-important"><span class="icon-placeholder" title="Important"><img width="36" height="36" src="../img/all/ico/important.png" alt="Important"></span>The following article uses options that are available starting with the <a href="/top-java-features.html" title="For Java">For Java</a> edition and project type.</p>
        <p>Let's say that we want to create a Windows Installer package for the included Java Service example. This tutorial will present in detail how to achieve this goal. In order to replicate it on your own machine, you need to have a (latest) Sun JDK installed. </p>
        <p>Before you start the tutorial download and unzip the <a href="../examples/javaserviceexample.zip" title="Java Service Example Files">Java Service Example</a>. It contains all the files necessary to accomplish this tutorial, including a sample Advanced Installer project.</p>
        <ul class="toc">
         <li>1. <a href="#preparing">Prepare a Java application for running as a service</a></li>
         <li>2. <a href="#create-project">Create project</a></li>
         <li>3. <a href="#product-details">Enter Product Details</a></li>
         <li>4. <a href="#set-parameters">Set Install Parameters</a></li>
         <li>5. <a href="#add-files">Add Installation Files</a></li>
         <li>6. <a href="#define-products">Define Java Products</a></li>
         <li>7. <a href="#define-service">Define the Service</a></li>
         <li>8. <a href="#build">Build</a></li>
         <li>9. <a href="#testing">Run, test and remove</a></li>
        </ul>
        <h2><a name="preparing"></a>1. Prepare a Java application for running as a service</h2>
        <p>You have the choice of using the supplied example application or making your own. In order for a Java application to work correctly as a service you must implement 2 methods in its main class:</p>
        <pre>
public static void main(String argv[])
{
  // implementation goes here
}

public static void stop()
{
  // implementation goes here
} </pre>
        <p>The main() method will be called when the service starts and the stop() method will be called when service must stop or the computer is shutting down. If you don't provide the stop() method which we recommend, <a href="native-java-launcher.html" title="About the Advanced Installer native Java launcher.">Advanced Installer's native Java launcher</a> will call the <span class="highlight">System.exit</span> method instead.</p>
        <h2><a name="create-project"></a>2. Create project</h2>
        <p>Start Advanced Installer by selecting it from the “Start” menu. Launching Advanced Installer automatically starts a new installation project. Choose “Java” &gt; “Java Application” as the project type.</p>
        <p><img width="704" height="277" src="../img/tutorial/java/new-project.png" alt="Start Page" title="Start Page"></p>
        <p><img width="24" height="24" src="../img/toolbar/project-save.png" alt="Save" class="float-left" title="Save"> A good idea is to save and name the project at this point. Use the “Save” menu item under the “File” menu or the <span class="shortcut">Ctrl+S</span> keyboard shortcut and let's name it javaserviceexample.aip.</p>
        <h2><a name="product-details"></a>3. Enter Product Details</h2>
        <p><img width="388" height="205" src="../img/tutorial/java-service/product-details.png" alt="Product Details" title="Product Details"></p>
        <p>Please note that these details are completely fictive.</p>
        <h2><a name="set-parameters"></a>4. Set Install Parameters</h2>
        <p><img width="24" height="24" src="../img/pages/install-parameters.png" alt="Install Parameters" class="float-left" title="Install Parameters"> Get to the Install Parameters page by clicking “Install Parameters” on the left pane. We won't change anything here, leaving everything to their default values.</p>
        <h2><a name="add-files"></a>5. Add Installation Files</h2>
        <p><img width="24" height="24" src="../img/pages/files-folders.png" alt="Files and Folders" class="float-left" title="Files and Folders"> Go to the Files and Folders page by clicking on “Files and Folders” on the left pane.</p>
        <p><img width="24" height="24" src="../img/toolbar/folder-add.png" alt="Add Folder" class="float-left" title="Add Folder"> Right click “Application Folder” and select “Add Files”. Browse to where you unzipped the Java Service example then go to the lib folder and select the Java Services example jar archive "javaservice.jar". Click <span class="shortcut">OK</span>.</p>
        <p><img width="513" height="120" src="../img/tutorial/java-service/files-folders.png" alt="Files, Folders and Shortcuts" title="Files, Folders and Shortcuts"></p>
        <h2><a name="define-products"></a>6. Define Java Products</h2>
        <p><img width="24" height="24" src="../img/pages/java.png" alt="Java Products" class="float-left" title="Java Products"> Go to the Java Products page by clicking on “Java Products” on the left side page menu.</p>
        <p><img width="24" height="24" src="../img/toolbar/java-new.png" alt="New Java Product" class="float-left" title="New Java Product"> Create a new <span class="button">[ Java Product ]</span> by clicking on the New Product toolbar button. Let's call it javaservice.</p>
        <p><img width="147" height="129" src="../img/tutorial/java-service/java-products.png" alt="Java Products" title="Java Products"></p>
        <p>Click on the <span class="button">[ Add JAR(s)... ]</span> button and browse to and select the javaservice.jar file. Click <span class="shortcut">OK</span>.</p>
        <p>Edit the Main class to: com.caphyon.service.JavaService.</p>
        <p>At the application type select “Win32 Service”.</p>
        <p><img width="713" height="897" src="../img/tutorial/java-service/product-settings.png" alt="Product Settings" title="Product Settings"></p>
        <p>Now a new file has appeared in the Files and Folders Page: javaservice.exe.</p>
        <p class="alert alert-note"><span class="icon-placeholder" title="Note"><img width="36" height="36" src="../img/all/ico/note.png" alt="Note"></span>If the service terminates unexpectedly from time to time or when the user logs off, the Java Virtual Machine may receive incorrect signals. This can be fixed by using the <b>Reduced usage of operating-system signals (-Xrs)</b> option in the <a href="edit-jvm-parameters-dialog.html" title="The &quot;Edit Java Virtual Machine Parameters&quot; dialog in Advanced Installer.">Edit JVM Parameters</a> dialog (it can be launched from the <a href="java-virtual-machine.html" title="About the Java Virtual Machine in Advanced Installer">Virtual Machine</a> tab).</p>
        <h2><a name="define-service"></a>7. Define the Service</h2>
        <p><img width="24" height="24" src="../img/pages/services.png" alt="Services" class="float-left" title="Services"> Select “Services” from “Resources” menu on the left pane. </p>
        <h3><a name="section372"></a>7.1 Install a new service</h3>
        <p><img width="24" height="24" src="../img/toolbar/service-new.png" alt="New Service" class="float-left" title="New Service"> Right click on “Services to Install” and select “New Service Installation”. In the “Select Installed File Dialog” click on “Application Folder” and select "javaservice.exe".</p>
        <p><img width="627" height="258" src="../img/tutorial/java-service/new-java-service.png" alt="New Java Service" title="New Java Service"></p>
        <h3><a name="section373"></a>7.2 Enter service properties</h3>
        <p>Leave Service Name unchanged.</p>
        <p>Edit the Display Name: Java Service Example.</p>
        <p>Edit the Description: This a Java Service Example.</p>
        <p>Leave the Service Parameters, Service context and Service Account unchanged.</p>
        <p><img width="412" height="642" src="../img/tutorial/java-service/installed-service-properties.png" alt="Installed Service Properties" title="Installed Service Properties"></p>
        <h3><a name="section374"></a>7.3 Setup the control actions</h3>
        <p><img width="24" height="24" src="../img/toolbar/service-control-new.png" alt="New Service Control Operation" class="float-left" title="New Service Control Operation">Select the newly created service control operation. </p>
        <p>Edit the Service Name to: javaservice.exe.</p>
        <p>Leave anything else unchanged.</p>
        <p><img width="360" height="279" src="../img/tutorial/java-service/service-control-parameters.png" alt="Service Control Parameters" title="Service Control Parameters"></p>
        <h2><a name="build"></a>8. Build</h2>
        <p><img width="24" height="24" src="../img/toolbar/project-build.png" alt="Build" class="float-left" title="Build"> Click on the <span class="button">[ Build ]</span> toolbar button.</p>
        <h2><a name="testing"></a>9. Run, test and remove</h2>
        <p>Click on the <span class="button">[ Run ]</span> toolbar button to run and test the MSI you created. After installation you should have a new service installed.</p>
        <p>To test the application open console and enter the following command: telnet localhost 4444. You should see:</p>
        <pre>
Java Service is running

Connection to host lost</pre>
        <p>You also can build Java Service Example msi package using ant. Open a console window and change current directory to the directory where you unzipped the Java Service example archive. Execute the following command: ant msi.</p>
        <p>To remove the installed package, simply Run it again and select Remove.</p>
        <h2>The End</h2>
        <p>This concludes our tutorial.</p>
        <p>Below there is link to a short video with the steps enumerated above.</p>
        <p><a href="https://www.youtube.com/watch?v=7-Y0Sf-dPio" title="" class=" video-link" target="_blank">Java service installation</a></p>
       </div></td>
     </tr>
    </tbody>
   </table>
   <div id="ai-footer">
    <div class="cont-width cf">
     <div class="float-left column">
      <h3>Our products</h3>
      <ul class="network">
       <li><a href="/" title="">Advanced Installer</a></li>
       <li><a href="http://www.advancedwebranking.com/" title="">AWR Cloud</a></li>
      </ul>
     </div>
     <div class="float-left column">
      <h3>Contact info</h3>
      <ul>
       <li><a href="../blog.html" title="">Blog</a></li>
       <li><a href="../case-studies/index.html" title="">Case Studies</a></li>
       <li><a href="../testimonials.html" title="">Testimonials</a></li>
       <li><a href="../contact.html" title="">Contact</a></li>
       <li><a href="../partners.html" title="">Partners</a></li>
       <li><a href="../map.html" title="">Site Map</a></li>
      </ul>
     </div>
     <div class="float-left column">
      <h3>Resources</h3>
      <ul>
       <li><a href="../download.html" title="">Download</a></li>
       <li><a href="introduction.html" title="">Documentation</a></li>
       <li><a href="../features.html" title="">Features</a></li>
       <li><a href="../purchase.html" title="">Pricing</a></li>
       <li><a href="../eula.html" title="">EULA</a></li>
       <li><a href="../support.html" title="">Support</a></li>
      </ul>
     </div>
     <div class="float-left column">
      <h3>Stay in touch</h3>
      <ul class="social-networks">
       <li><a href="/rss-feeds.html" rel="nofollow">Subscribe to our RSS</a></li>
       <li><a href="https://www.youtube.com/user/AdvancedInstaller" rel="nofollow">Subscribe on YouTube</a></li>
       <li><a href="https://twitter.com/advinst">Follow us on Twitter</a></li>
       <li><a href="https://www.facebook.com/AdvancedInstaller">Like us on Facebook</a></li>
       <li><a href="https://plus.google.com/+advancedinstaller/">Circle us on Google+</a></li>
      </ul>
     </div>
    </div>
    <div class="ai-questions cont-width centered">
     <h3>Questions? We are here to help.</h3>
     <ul class="questions-list centered">
      <li class="mail"><a href="mailto:support@advancedinstaller.com">Email</a></li>
      <li class="phone">+1 650 963 5574 United States</li>
      <li class="phone">+44 20 3608 0638 International, UK</li>
     </ul>
    </div>
    <div class="copyright">
     © 2002 - 2017 Caphyon Ltd. Trademarks belong to their respective owners. All rights reserved.
    </div>
   </div>
  </div>
 </body>
</html>