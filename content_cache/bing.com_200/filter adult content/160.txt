<!doctype html>
<html class="no-js hasSidebar hasPageActions hasBreadcrumb " lang="en-us" dir="ltr">
 <head> 
  <meta charset="utf-8"> 
  <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
  <meta property="og:title" content="Apache Storm example Java topology - Azure HDInsight"> 
  <meta property="og:image" content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png"> 
  <meta name="twitter:card" content="summary"> 
  <meta name="twitter:site" content="@docsmsft"> 
  <meta name="twitter:title" content="Apache Storm example Java topology - Azure HDInsight"> 
  <meta name="twitter:description" content="Learn how to create Apache Storm topologies in Java by creating an example word count topology."> 
  <meta name="twitter:image" content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png"> 
  <meta name="twitter:image:alt" content="Microsoft Logo"> 
  <meta name="breadcrumb_path" content="/azure/bread/toc.json"> 
  <meta name="ms.custom" content="H1Hack27Feb2017,hdinsightactive,hdiseo17may2017"> 
  <meta name="tags" content="azure-portal"> 
  <meta name="ms.devlang" content="java"> 
  <meta name="ms.tgt_pltfrm" content="na"> 
  <meta name="ms.assetid" content="a8838f29-9c08-4fd9-99ef-26655d1bf6d7"> 
  <meta name="author" content="Blackmist"> 
  <meta name="editor" content="cgronlun"> 
  <meta name="description" content="Learn how to create Apache Storm topologies in Java by creating an example word count topology."> 
  <meta name="ms.author" content="larryfr"> 
  <meta name="manager" content="jhubbard"> 
  <meta name="documentationcenter" content=""> 
  <meta name="keywords" content="apache storm,apache storm example,storm java,storm topology example"> 
  <meta name="ms.topic" content="article"> 
  <meta name="services" content="hdinsight"> 
  <meta name="ms.service" content="hdinsight"> 
  <meta name="ms.date" content="09/28/2017"> 
  <meta name="ms.workload" content="big-data"> 
  <meta name="search.ms_sitename" content="Docs"> 
  <meta name="search.ms_docsetname" content="azure-documents"> 
  <meta name="version" content="0"> 
  <meta name="locale" content="en-us"> 
  <meta name="site_name" content="Docs"> 
  <meta name="search.ms_product" content="Azure"> 
  <meta name="depot_name" content="Azure.azure-documents"> 
  <meta name="updated_at" content="2017-09-28 10:02 PM"> 
  <meta name="gitcommit" content="https://github.com/MicrosoftDocs/azure-docs-pr/blob/1ec029d01c3ee66d2d9979c455bf9b41ba640b07/articles/hdinsight/hdinsight-storm-develop-java-topology.md"> 
  <meta name="original_content_git_url" content="https://github.com/MicrosoftDocs/azure-docs-pr/blob/live/articles/hdinsight/hdinsight-storm-develop-java-topology.md"> 
  <meta name="document_id" content="bf0a85a2-1c5b-dd99-975e-04e29ca6c6e0"> 
  <meta name="pagetype" content="Conceptual"> 
  <meta name="toc_rel" content="TOC.json"> 
  <meta name="pdf_url_template" content="https://docs.microsoft.com/pdfstore/en-us/Azure.azure-documents/{branchName}{pdfName}"> 
  <meta name="word_count" content="3567"> 
  <meta name="scope" content="Azure"> 
  <link href="https://docs.microsoft.com/en-us/azure/hdinsight/hdinsight-storm-develop-java-topology" rel="canonical"> 
  <title>Apache Storm example Java topology - Azure HDInsight | Microsoft Docs</title> 
  <link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/css/870b0825531b1b071dff.site.css "> 
  <link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/css/870b0825531b1b071dff.conceptual.css "> 
  <link rel="stylesheet" href="/_themes/docs.theme/master/en-us/_themes/global/css/azureHeader.css?v=4"> 
  <link rel="stylesheet" href="https://azure.microsoft.com/en-us/asset/menucss/"> 
  <script>
	var msDocs = {
		data:{
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pathToTheme: '/_themes/docs.theme/master/en-us/_themes/',
			pageTemplate: 'Conceptual',
			brand: 'azure',
			forceVersionPicker:false		},
		functions:{},
		settings:{
			extendBreadcrumb: false
		}
	};
	if (!('Promise' in window && 'resolve' in window.Promise && 'reject' in window.Promise && 'all' in window.Promise && 'race' in window.Promise)) {
		document.write('<script src="/_themes/docs.theme/master/en-us/_themes/global/js/bluebird.min.js"><\/script>');
	}
	</script> 
  <!--[if lt IE 9]>
		<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.12.4.min.js"></script>
		<script src="/_themes/docs.theme/master/en-us/_themes/global/js/polyfills/all.js"></script>
<script src="/_themes/docs.theme/master/en-us/_themes/global/js/azureHeader/respond_and_ie8Setup_combine.js"></script>	<![endif]--> 
  <!--[if gte IE 9]><!--> 
  <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-2.2.4.min.js"></script> 
  <!--<![endif]--> 
  <script>window.jQuery || document.write('<script src="/_themes/docs.theme/master/en-us/_themes/global/js/jquery/jquery-1.12.4.min.js"><\/script>')</script> 
  <script src="/_themes/docs.theme/master/en-us/_themes/global/js/global.min.js?v=263"></script> 
  <script src="/_themes/docs.theme/master/en-us/_themes/global/js/azureHeader/loader.js?v=4"></script> 
 </head> 
 <body> 
  <div id="lca-cookie-notification" class="cookieContainer"> 
  </div> 
  <div id="headerAreaHolder" class="az_h default" ms.pgarea="header" data-bi-name="header"> 
   <div class="azure-header_holder"> 
    <div class="azure-header"> 
     <header class="azure-header_temp"> 
      <div class="row column"> 
       <a href="https://azure.microsoft.com/en-us/" class="logo" title="Microsoft Azure"> 
        <svg x="0px" y="0px" width="165px" height="20px" viewbox="0 0 165 20"> 
         <path fill="#29A5DE" d="M18,19H16V7.1C16,6.2,16,5,16.1,3.7h0c-0.2,0.8-0.4,1.4-0.5,1.7L9.5,19h-1l-6-13.5c-0.2-0.4-0.3-1-0.5-1.8
							h0C2,4.4,2,5.5,2,7.1V19H0V1.3h2.7l5.4,12.3c0.4,0.9,0.7,1.7,0.8,2.1H9c0.4-1,0.6-1.7,0.9-2.2l5.5-12.3H18V19z" /> 
         <path fill="#29A5DE" d="M22.8,3.1c-0.4,0-0.7-0.1-0.9-0.4s-0.4-0.6-0.4-0.9s0.1-0.7,0.4-0.9c0.3-0.3,0.6-0.4,0.9-0.4
							c0.4,0,0.7,0.1,0.9,0.4c0.3,0.3,0.4,0.6,0.4,0.9c0,0.4-0.1,0.7-0.4,0.9C23.5,3,23.2,3.1,22.8,3.1z M23.8,19h-2V6.3h2V19z" /> 
         <path fill="#29A5DE" d="M35.8,18.4c-1,0.6-2.1,0.9-3.5,0.9c-1.8,0-3.3-0.6-4.4-1.8c-1.1-1.2-1.7-2.7-1.7-4.6c0-2.1,0.6-3.7,1.8-5
							C29.4,6.7,30.9,6,32.9,6C34,6,35,6.2,35.9,6.7v2.1c-0.9-0.7-1.9-1-3-1c-1.3,0-2.3,0.5-3.2,1.4c-0.8,0.9-1.2,2.1-1.2,3.6
							c0,1.5,0.4,2.6,1.2,3.5c0.8,0.9,1.8,1.3,3.1,1.3c1.1,0,2.1-0.4,3.1-1.1V18.4z" /> 
         <path fill="#29A5DE" d="M44.9,8.4C44.5,8.1,44,8,43.3,8c-0.9,0-1.6,0.4-2.2,1.2c-0.6,0.8-0.9,1.9-0.9,3.3V19h-2V6.3h2v2.6h0
							c0.3-0.9,0.7-1.6,1.3-2.1c0.6-0.5,1.3-0.7,2-0.7c0.5,0,0.9,0.1,1.2,0.2V8.4z" /> 
         <path fill="#29A5DE" d="M51.4,19.3c-1.9,0-3.4-0.6-4.5-1.8c-1.1-1.2-1.7-2.7-1.7-4.7c0-2.1,0.6-3.8,1.7-5S49.7,6,51.7,6
							c1.9,0,3.4,0.6,4.4,1.7c1.1,1.2,1.6,2.8,1.6,4.8c0,2-0.6,3.6-1.7,4.8C54.8,18.6,53.3,19.3,51.4,19.3z M51.5,7.7
							c-1.3,0-2.3,0.4-3.1,1.3c-0.8,0.9-1.1,2.1-1.1,3.7c0,1.5,0.4,2.7,1.1,3.5c0.8,0.9,1.8,1.3,3.1,1.3c1.3,0,2.3-0.4,3-1.3
							c0.7-0.8,1.1-2,1.1-3.6c0-1.6-0.4-2.8-1.1-3.6C53.8,8.2,52.8,7.7,51.5,7.7z" /> 
         <path fill="#29A5DE" d="M59.5,18.5v-2.2c1.1,0.8,2.3,1.2,3.6,1.2c1.8,0,2.7-0.6,2.7-1.8c0-0.3-0.1-0.6-0.2-0.9
							c-0.2-0.2-0.4-0.4-0.6-0.6c-0.3-0.2-0.6-0.3-0.9-0.5c-0.3-0.1-0.7-0.3-1.1-0.4c-0.6-0.2-1-0.4-1.5-0.7c-0.4-0.2-0.8-0.5-1.1-0.8
							c-0.3-0.3-0.5-0.6-0.6-1c-0.1-0.4-0.2-0.8-0.2-1.3c0-0.6,0.1-1.1,0.4-1.6C60.2,7.7,60.5,7.3,61,7c0.5-0.3,1-0.5,1.5-0.7
							C63.1,6.1,63.7,6,64.3,6c1.1,0,2.1,0.2,2.9,0.6v2c-0.9-0.6-2-0.9-3.2-0.9c-0.4,0-0.7,0-1,0.1c-0.3,0.1-0.6,0.2-0.8,0.4
							c-0.2,0.2-0.4,0.3-0.5,0.6c-0.1,0.2-0.2,0.5-0.2,0.7c0,0.3,0.1,0.6,0.2,0.8c0.1,0.2,0.3,0.4,0.5,0.6c0.2,0.2,0.5,0.3,0.8,0.5
							c0.3,0.1,0.7,0.3,1.1,0.5c0.6,0.2,1.1,0.4,1.5,0.7c0.4,0.2,0.8,0.5,1.1,0.8c0.3,0.3,0.6,0.6,0.7,1c0.2,0.4,0.3,0.8,0.3,1.3
							c0,0.6-0.1,1.2-0.4,1.6c-0.3,0.5-0.6,0.8-1.1,1.1c-0.5,0.3-1,0.5-1.6,0.7c-0.6,0.1-1.2,0.2-1.9,0.2C61.6,19.3,60.4,19,59.5,18.5z" /> 
         <path fill="#29A5DE" d="M75.6,19.3c-1.9,0-3.4-0.6-4.5-1.8c-1.1-1.2-1.7-2.7-1.7-4.7c0-2.1,0.6-3.8,1.7-5C72.4,6.6,73.9,6,75.9,6
							c1.9,0,3.4,0.6,4.4,1.7c1.1,1.2,1.6,2.8,1.6,4.8c0,2-0.6,3.6-1.7,4.8C79,18.6,77.5,19.3,75.6,19.3z M75.7,7.7
							c-1.3,0-2.3,0.4-3.1,1.3c-0.8,0.9-1.1,2.1-1.1,3.7c0,1.5,0.4,2.7,1.1,3.5c0.8,0.9,1.8,1.3,3.1,1.3c1.3,0,2.3-0.4,3-1.3
							c0.7-0.8,1.1-2,1.1-3.6c0-1.6-0.4-2.8-1.1-3.6C78.1,8.2,77,7.7,75.7,7.7z" /> 
         <path fill="#29A5DE" d="M97.6,8.1V6.3h-3.2V2.6l-2,0.7v3.1h-2.6h-1.5h-1.4V4.4c0-1.8,0.7-2.7,2.1-2.7c0.5,0,0.9,0.1,1.3,0.3V0.2
							C89.9,0.1,89.4,0,88.8,0c-1.1,0-2.1,0.4-2.9,1.2c-0.8,0.8-1.1,1.8-1.1,3.1v2h-2.2v1.7h2.2V19h2V8.1h1.4h1.5h2.6v7.5
							c0,2.5,1.1,3.7,3.3,3.7c0.8,0,1.4-0.1,1.9-0.4v-1.7c-0.4,0.3-0.8,0.4-1.3,0.4c-0.7,0-1.1-0.2-1.4-0.5c-0.3-0.4-0.4-1-0.4-1.8V8.1
							H97.6z" /> 
         <path fill="#29A5DE" d="M119.9,19h-2.3l-1.9-5h-7.5l-1.8,5h-2.3L111,1.3h2.1L119.9,19z M115.1,12.1l-2.8-7.5
							c-0.1-0.2-0.2-0.6-0.3-1.2h0c-0.1,0.5-0.2,0.9-0.3,1.2l-2.7,7.5H115.1z" /> 
         <path fill="#29A5DE" d="M130.4,6.9l-7.5,10.3h7.4V19H120v-0.6l7.5-10.3h-6.8V6.3h9.7V6.9z" /> 
         <path fill="#29A5DE" d="M142.6,19h-2v-2h0c-0.8,1.5-2.1,2.3-3.9,2.3c-3,0-4.5-1.8-4.5-5.4V6.3h2v7.2c0,2.7,1,4,3.1,4
							c1,0,1.8-0.4,2.4-1.1c0.6-0.7,1-1.7,1-2.9V6.3h2V19z" /> 
         <path fill="#29A5DE" d="M152.6,8.4c-0.4-0.3-0.9-0.4-1.5-0.4c-0.9,0-1.6,0.4-2.2,1.2c-0.6,0.8-0.9,1.9-0.9,3.3V19h-2V6.3h2v2.6h0
							c0.3-0.9,0.7-1.6,1.3-2.1c0.6-0.5,1.3-0.7,2-0.7c0.5,0,0.9,0.1,1.2,0.2V8.4z" /> 
         <path fill="#29A5DE" d="M164,13.1h-8.9c0,1.4,0.4,2.5,1.1,3.3c0.7,0.8,1.7,1.1,3,1.1c1.4,0,2.7-0.5,3.9-1.4V18
							c-1.1,0.8-2.6,1.2-4.4,1.2c-1.8,0-3.2-0.6-4.2-1.7c-1-1.1-1.5-2.8-1.5-4.8c0-2,0.6-3.6,1.7-4.8c1.1-1.2,2.5-1.9,4.1-1.9
							s2.9,0.5,3.8,1.6s1.4,2.6,1.4,4.4V13.1z M161.9,11.4c0-1.2-0.3-2.1-0.8-2.7c-0.6-0.6-1.3-1-2.3-1c-1,0-1.8,0.3-2.4,1
							c-0.7,0.7-1.1,1.6-1.2,2.7H161.9z" /> 
        </svg> </a> 
       <a href="#" class="small-search" onclick="return false"><span class="icon icon-search"></span></a> 
      </div> 
     </header> 
    </div> 
   </div> 
  </div> 
  <div class="container mainContainer" lang="en-us" dir="ltr" ms.pgarea="body" data-bi-name="body"> 
   <main role="main" ms.cmpgrp="content" data-bi-name="content"> 
    <div id="main"> 
     <h1 id="create-an-apache-storm-topology-in-java" sourcefile="articles/hdinsight/hdinsight-storm-develop-java-topology.md" sourcestartlinenumber="23" sourceendlinenumber="23">Create an Apache Storm topology in Java</h1> 
     <div class="metadata loading" ms.cmpgrp="page info" data-bi-name="page info"> 
      <div> 
       <time class="date" datetime="9/28/2017 12:00:00 AM">2017-9-28</time> 
       <span class="reading-time">17 minutes to read</span> 
       <span class="contributors-text">Contributors</span> 
       <ul class="contributors" ms.cmpgrp="contributors" data-bi-name="contributors"> 
        <li><a href="https://github.com/Blackmist" title="Larry Franks" ms.cmpnm="contributorprofile" data-bi-name="contributorprofile"><img src="https://github.com/Blackmist.png?size=16" alt="Larry Franks"></a></li> 
        <li><a href="https://github.com/MaurGi" title="Mauro Giusti" ms.cmpnm="contributorprofile" data-bi-name="contributorprofile"><img src="https://github.com/MaurGi.png?size=16" alt="Mauro Giusti"></a></li> 
        <li><a href="https://github.com/JimVance" title="Jim Vance" ms.cmpnm="contributorprofile" data-bi-name="contributorprofile"><img src="https://github.com/JimVance.png?size=16" alt="Jim Vance"></a></li> 
       </ul> 
      </div> 
      <nav id="center-doc-outline" class="doc-outline" ms.cmpgrp="intopic toc" data-bi-name="intopic toc" role="navigation" aria-label="On page navigation"> 
       <h3>In this article</h3> 
      </nav> 
     </div> 
     <div>
      <div class="content"> 
       <p>Learn how to create a Java-based topology for Apache Storm. You create a Storm topology that implements a word-count application. You use Maven to build and package the project. Then, you learn how to define the topology using the Flux framework.</p> 
       <div class="NOTE">
        <h5>Note</h5>
        <p>The Flux framework is available in Storm 0.10.0 or later. Storm 0.10.0 is available with HDInsight 3.3 and 3.4.</p> 
       </div> 
       <p>After completing the steps in this document, you can deploy the topology to Apache Storm on HDInsight.</p> 
       <div class="NOTE">
        <h5>Note</h5>
        <p>A completed version of the Storm topology examples created in this document is available at <a href="https://github.com/Azure-Samples/hdinsight-java-storm-wordcount" data-linktype="external">https://github.com/Azure-Samples/hdinsight-java-storm-wordcount</a>.</p> 
       </div> 
       <h2 id="prerequisites">Prerequisites</h2> 
       <ul> 
        <li><p><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html" data-linktype="external">Java Developer Kit (JDK) version 8</a></p> </li> 
        <li><p><a href="https://maven.apache.org/download.cgi" data-linktype="external">Maven (https://maven.apache.org/download.cgi)</a>: Maven is a project build system for Java projects.</p> </li> 
        <li><p>A text editor or IDE.</p> </li> 
       </ul> 
       <h2 id="configure-environment-variables">Configure environment variables</h2> 
       <p>The following environment variables may be set when you install Java and the JDK. However, you should check that they exist and that they contain the correct values for your system.</p> 
       <ul> 
        <li><p><strong>JAVA_HOME</strong> - should point to the directory where the Java runtime environment (JRE) is installed. For example, in a Unix or Linux distribution, it should have a value similar to <code>/usr/lib/jvm/java-8-oracle</code>. In Windows, it would have a value similar to <code>c:\Program Files (x86)\Java\jre1.8</code></p> </li> 
        <li><p><strong>PATH</strong> - should contain the following paths:</p> 
         <ul> 
          <li><p><strong>JAVA_HOME</strong> (or the equivalent path)</p> </li> 
          <li><p><strong>JAVA_HOME\bin</strong> (or the equivalent path)</p> </li> 
          <li><p>The directory where Maven is installed</p> </li> 
         </ul> </li> 
       </ul> 
       <h2 id="create-a-maven-project">Create a Maven project</h2> 
       <p>From the command line, use the following command to create a Maven project named <strong>WordCount</strong>:</p> 
       <pre><code class="lang-bash">mvn archetype:generate -DarchetypeArtifactId=maven-archetype-quickstart -DgroupId=com.microsoft.example -DartifactId=WordCount -DinteractiveMode=false
</code></pre>
       <div class="NOTE">
        <h5>Note</h5>
        <p>If you are using PowerShell, you must surround the<code>-D</code> parameters with double quotes.</p> 
        <p><code>mvn archetype:generate "-DarchetypeArtifactId=maven-archetype-quickstart" "-DgroupId=com.microsoft.example" "-DartifactId=WordCount" "-DinteractiveMode=false"</code></p> 
       </div> 
       <p>This command creates a directory named <code>WordCount</code> at the current location, which contains a basic Maven project. The <code>WordCount</code> directory contains the following items:</p> 
       <ul> 
        <li><code>pom.xml</code>: Contains settings for the Maven project.</li> 
        <li><code>src\main\java\com\microsoft\example</code>: Contains your application code.</li> 
        <li><code>src\test\java\com\microsoft\example</code>: Contains tests for your application. </li> 
       </ul> 
       <h3 id="remove-the-generated-example-code">Remove the generated example code</h3> 
       <p>Delete the generated test and the application files:</p> 
       <ul> 
        <li><strong>src\test\java\com\microsoft\example\AppTest.java</strong></li> 
        <li><strong>src\main\java\com\microsoft\example\App.java</strong></li> 
       </ul> 
       <h2 id="add-maven-repositories">Add Maven repositories</h2> 
       <p>HDInsight is based on the Hortonworks Data Platform (HDP), so we recommend using the Hortonworks repository to download dependencies for your Apache Storm projects. In the <strong>pom.xml</strong> file, add the following XML after the <code>&lt;url&gt;http://maven.apache.org&lt;/url&gt;</code> line:</p> 
       <pre><code class="lang-xml">&lt;repositories&gt;
    &lt;repository&gt;
        &lt;releases&gt;
            &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;updatePolicy&gt;always&lt;/updatePolicy&gt;
            &lt;checksumPolicy&gt;warn&lt;/checksumPolicy&gt;
        &lt;/releases&gt;
        &lt;snapshots&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;updatePolicy&gt;never&lt;/updatePolicy&gt;
            &lt;checksumPolicy&gt;fail&lt;/checksumPolicy&gt;
        &lt;/snapshots&gt;
        &lt;id&gt;HDPReleases&lt;/id&gt;
        &lt;name&gt;HDP Releases&lt;/name&gt;
        &lt;url&gt;http://repo.hortonworks.com/content/repositories/releases/&lt;/url&gt;
        &lt;layout&gt;default&lt;/layout&gt;
    &lt;/repository&gt;
    &lt;repository&gt;
        &lt;releases&gt;
            &lt;enabled&gt;true&lt;/enabled&gt;
            &lt;updatePolicy&gt;always&lt;/updatePolicy&gt;
            &lt;checksumPolicy&gt;warn&lt;/checksumPolicy&gt;
        &lt;/releases&gt;
        &lt;snapshots&gt;
            &lt;enabled&gt;false&lt;/enabled&gt;
            &lt;updatePolicy&gt;never&lt;/updatePolicy&gt;
            &lt;checksumPolicy&gt;fail&lt;/checksumPolicy&gt;
        &lt;/snapshots&gt;
        &lt;id&gt;HDPJetty&lt;/id&gt;
        &lt;name&gt;Hadoop Jetty&lt;/name&gt;
        &lt;url&gt;http://repo.hortonworks.com/content/repositories/jetty-hadoop/&lt;/url&gt;
        &lt;layout&gt;default&lt;/layout&gt;
    &lt;/repository&gt;
&lt;/repositories&gt;
</code></pre>
       <h2 id="add-properties">Add properties</h2> 
       <p>Maven allows you to define project-level values called properties. In the <strong>pom.xml</strong>, add the following text after the <code>&lt;/repositories&gt;</code> line:</p> 
       <pre><code class="lang-xml">&lt;properties&gt;
    &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
    &lt;!--
    This is a version of Storm from the Hortonworks repository that is compatible with HDInsight 3.5.
    --&gt;
    &lt;storm.version&gt;1.1.0.2.6.1.9-1&lt;/storm.version&gt;
&lt;/properties&gt;
</code></pre>
       <p>You can now use this value in other sections of the <code>pom.xml</code>. For example, when specifying the version of Storm components, you can use <code>${storm.version}</code> instead of hard coding a value.</p> 
       <h2 id="add-dependencies">Add dependencies</h2> 
       <p>Add a dependency for Storm components. Open the <code>pom.xml</code> file and add the following code in the <code>&lt;dependencies&gt;</code> section:</p> 
       <pre><code class="lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.apache.storm&lt;/groupId&gt;
    &lt;artifactId&gt;storm-core&lt;/artifactId&gt;
    &lt;version&gt;${storm.version}&lt;/version&gt;
    &lt;!-- keep storm out of the jar-with-dependencies --&gt;
    &lt;scope&gt;provided&lt;/scope&gt;
&lt;/dependency&gt;
</code></pre>
       <p>At compile time, Maven uses this information to look up <code>storm-core</code> in the Maven repository. It first looks in the repository on your local computer. If the files aren't there, Maven downloads them from the public Maven repository and stores them in the local repository.</p> 
       <div class="NOTE">
        <h5>Note</h5>
        <p>Notice the <code>&lt;scope&gt;provided&lt;/scope&gt;</code> line in this section. This setting tells Maven to exclude <strong>storm-core</strong> from any JAR files that are created, because it is provided by the system.</p> 
       </div> 
       <h2 id="build-configuration">Build configuration</h2> 
       <p>Maven plug-ins allow you to customize the build stages of the project. For example, how the project is compiled or how to package it into a JAR file. Open the <code>pom.xml</code> file and add the following code directly above the <code>&lt;/project&gt;</code> line.</p> 
       <pre><code class="lang-xml">&lt;build&gt;
    &lt;plugins&gt;
    &lt;/plugins&gt;
    &lt;resources&gt;
    &lt;/resources&gt;
&lt;/build&gt;
</code></pre>
       <p>This section is used to add plug-ins, resources, and other build configuration options. For a full reference of the <strong>pom.xml</strong> file, see <a href="http://maven.apache.org/pom.html" data-linktype="external">http://maven.apache.org/pom.html</a>.</p> 
       <h3 id="add-plug-ins">Add plug-ins</h3> 
       <p>For Apache Storm topologies implemented in Java, the <a href="http://www.mojohaus.org/exec-maven-plugin/" data-linktype="external">Exec Maven Plugin</a> is useful because it allows you to easily run the topology locally in your development environment. Add the following to the <code>&lt;plugins&gt;</code> section of the <code>pom.xml</code> file to include the Exec Maven plugin:</p> 
       <pre><code class="lang-xml">&lt;plugin&gt;
    &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
    &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.4.0&lt;/version&gt;
    &lt;executions&gt;
    &lt;execution&gt;
    &lt;goals&gt;
        &lt;goal&gt;exec&lt;/goal&gt;
    &lt;/goals&gt;
    &lt;/execution&gt;
    &lt;/executions&gt;
    &lt;configuration&gt;
    &lt;executable&gt;java&lt;/executable&gt;
    &lt;includeProjectDependencies&gt;true&lt;/includeProjectDependencies&gt;
    &lt;includePluginDependencies&gt;false&lt;/includePluginDependencies&gt;
    &lt;classpathScope&gt;compile&lt;/classpathScope&gt;
    &lt;mainClass&gt;${storm.topology}&lt;/mainClass&gt;
    &lt;cleanupDaemonThreads&gt;false&lt;/cleanupDaemonThreads&gt; 
    &lt;/configuration&gt;
&lt;/plugin&gt;
</code></pre>
       <p>Another useful plug-in is the <a href="http://maven.apache.org/plugins/maven-compiler-plugin/" data-linktype="external">Apache Maven Compiler Plugin</a>, which is used to change compilation options. The changes the Java version that Maven uses for the source and target for your application.</p> 
       <ul> 
        <li><p>For HDInsight <strong>3.4 or earlier</strong>, set the source and target Java version to <strong>1.7</strong>.</p> </li> 
        <li><p>For HDInsight <strong>3.5</strong>, set the source and target Java version to <strong>1.8</strong>.</p> </li> 
       </ul> 
       <p>Add the following text in the <code>&lt;plugins&gt;</code> section of the <code>pom.xml</code> file to include the Apache Maven Compiler plugin. This example specifies 1.8, so the target HDInsight version is 3.5.</p> 
       <pre><code class="lang-xml">&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;
    &lt;version&gt;3.3&lt;/version&gt;
    &lt;configuration&gt;
    &lt;source&gt;1.8&lt;/source&gt;
    &lt;target&gt;1.8&lt;/target&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</code></pre>
       <h3 id="configure-resources">Configure resources</h3> 
       <p>The resources section allows you to include non-code resources such as configuration files needed by components in the topology. For this example, add the following text in the <code>&lt;resources&gt;</code> section of the `pom.xml file.</p> 
       <pre><code class="lang-xml">&lt;resource&gt;
    &lt;directory&gt;${basedir}/resources&lt;/directory&gt;
    &lt;filtering&gt;false&lt;/filtering&gt;
    &lt;includes&gt;
        &lt;include&gt;log4j2.xml&lt;/include&gt;
    &lt;/includes&gt;
&lt;/resource&gt;
</code></pre>
       <p>This example adds the resources directory in the root of the project (<code>${basedir}</code>) as a location that contains resources, and includes the file named <code>log4j2.xml</code>. This file is used to configure what information is logged by the topology.</p> 
       <h2 id="create-the-topology">Create the topology</h2> 
       <p>A Java-based Apache Storm topology consists of three components that you must author (or reference) as a dependency.</p> 
       <ul> 
        <li><p><strong>Spouts</strong>: Reads data from external sources and emits streams of data into the topology.</p> </li> 
        <li><p><strong>Bolts</strong>: Performs processing on streams emitted by spouts or other bolts, and emits one or more streams.</p> </li> 
        <li><p><strong>Topology</strong>: Defines how the spouts and bolts are arranged, and provides the entry point for the topology.</p> </li> 
       </ul> 
       <h3 id="create-the-spout">Create the spout</h3> 
       <p>To reduce requirements for setting up external data sources, the following spout simply emits random sentences. It is a modified version of a spout that is provided with the <a href="https://github.com/apache/storm/blob/0.10.x-branch/examples/storm-starter/src/jvm/storm/starter" data-linktype="external">Storm-Starter examples</a>.</p> 
       <div class="NOTE">
        <h5>Note</h5>
        <p>For an example of a spout that reads from an external data source, see one of the following examples:</p> 
        <ul> 
         <li><a href="https://github.com/apache/storm/blob/0.10.x-branch/examples/storm-starter/src/jvm/storm/starter/spout/TwitterSampleSpout.java" data-linktype="external">TwitterSampleSPout</a>: An example spout that reads from Twitter</li> 
         <li><a href="https://github.com/apache/storm/tree/0.10.x-branch/external/storm-kafka" data-linktype="external">Storm-Kafka</a>: A spout that reads from Kafka</li> 
        </ul> 
       </div> 
       <p>For the spout, create a file named <code>RandomSentenceSpout.java</code> in the <code>src\main\java\com\microsoft\example</code> directory and use the following Java code as the contents:</p> 
       <pre><code class="lang-java">package com.microsoft.example;

import org.apache.storm.spout.SpoutOutputCollector;
import org.apache.storm.task.TopologyContext;
import org.apache.storm.topology.OutputFieldsDeclarer;
import org.apache.storm.topology.base.BaseRichSpout;
import org.apache.storm.tuple.Fields;
import org.apache.storm.tuple.Values;
import org.apache.storm.utils.Utils;

import java.util.Map;
import java.util.Random;

//This spout randomly emits sentences
public class RandomSentenceSpout extends BaseRichSpout {
  //Collector used to emit output
  SpoutOutputCollector _collector;
  //Used to generate a random number
  Random _rand;

  //Open is called when an instance of the class is created
  @Override
  public void open(Map conf, TopologyContext context, SpoutOutputCollector collector) {
  //Set the instance collector to the one passed in
    _collector = collector;
    //For randomness
    _rand = new Random();
  }

  //Emit data to the stream
  @Override
  public void nextTuple() {
  //Sleep for a bit
    Utils.sleep(100);
    //The sentences that are randomly emitted
    String[] sentences = new String[]{ "the cow jumped over the moon", "an apple a day keeps the doctor away",
        "four score and seven years ago", "snow white and the seven dwarfs", "i am at two with nature" };
    //Randomly pick a sentence
    String sentence = sentences[_rand.nextInt(sentences.length)];
    //Emit the sentence
    _collector.emit(new Values(sentence));
  }

  //Ack is not implemented since this is a basic example
  @Override
  public void ack(Object id) {
  }

  //Fail is not implemented since this is a basic example
  @Override
  public void fail(Object id) {
  }

  //Declare the output fields. In this case, an sentence
  @Override
  public void declareOutputFields(OutputFieldsDeclarer declarer) {
    declarer.declare(new Fields("sentence"));
  }
}
</code></pre>
       <div class="NOTE">
        <h5>Note</h5>
        <p>Although this topology uses only one spout, others may have several that feed data from different sources into the topology.</p> 
       </div> 
       <h3 id="create-the-bolts">Create the bolts</h3> 
       <p>Bolts handle the data processing. This topology uses two bolts:</p> 
       <ul> 
        <li><p><strong>SplitSentence</strong>: Splits the sentences emitted by <strong>RandomSentenceSpout</strong> into individual words.</p> </li> 
        <li><p><strong>WordCount</strong>: Counts how many times each word has occurred.</p> </li> 
       </ul> 
       <div class="NOTE">
        <h5>Note</h5>
        <p>Bolts can do anything, for example, computation, persistence, or talking to external components.</p> 
       </div> 
       <p>Create two new files, <code>SplitSentence.java</code> and <code>WordCount.java</code> in the <code>src\main\java\com\microsoft\example</code> directory. Use the following text as the contents for the files:</p> 
       <h4 id="splitsentence">SplitSentence</h4> 
       <pre><code class="lang-java">package com.microsoft.example;

import java.text.BreakIterator;

import org.apache.storm.topology.BasicOutputCollector;
import org.apache.storm.topology.OutputFieldsDeclarer;
import org.apache.storm.topology.base.BaseBasicBolt;
import org.apache.storm.tuple.Fields;
import org.apache.storm.tuple.Tuple;
import org.apache.storm.tuple.Values;

//There are a variety of bolt types. In this case, use BaseBasicBolt
public class SplitSentence extends BaseBasicBolt {

  //Execute is called to process tuples
  @Override
  public void execute(Tuple tuple, BasicOutputCollector collector) {
    //Get the sentence content from the tuple
    String sentence = tuple.getString(0);
    //An iterator to get each word
    BreakIterator boundary=BreakIterator.getWordInstance();
    //Give the iterator the sentence
    boundary.setText(sentence);
    //Find the beginning first word
    int start=boundary.first();
    //Iterate over each word and emit it to the output stream
    for (int end=boundary.next(); end != BreakIterator.DONE; start=end, end=boundary.next()) {
      //get the word
      String word=sentence.substring(start,end);
      //If a word is whitespace characters, replace it with empty
      word=word.replaceAll("\\s+","");
      //if it's an actual word, emit it
      if (!word.equals("")) {
        collector.emit(new Values(word));
      }
    }
  }

  //Declare that emitted tuples contain a word field
  @Override
  public void declareOutputFields(OutputFieldsDeclarer declarer) {
    declarer.declare(new Fields("word"));
  }
}
</code></pre>
       <h4 id="wordcount">WordCount</h4> 
       <pre><code class="lang-java">package com.microsoft.example;

import java.util.HashMap;
import java.util.Map;
import java.util.Iterator;

import org.apache.storm.Constants;
import org.apache.storm.topology.BasicOutputCollector;
import org.apache.storm.topology.OutputFieldsDeclarer;
import org.apache.storm.topology.base.BaseBasicBolt;
import org.apache.storm.tuple.Fields;
import org.apache.storm.tuple.Tuple;
import org.apache.storm.tuple.Values;
import org.apache.storm.Config;

// For logging
import org.apache.logging.log4j.Logger;
import org.apache.logging.log4j.LogManager;

//There are a variety of bolt types. In this case, use BaseBasicBolt
public class WordCount extends BaseBasicBolt {
  //Create logger for this class
  private static final Logger logger = LogManager.getLogger(WordCount.class);
  //For holding words and counts
  Map&lt;String, Integer&gt; counts = new HashMap&lt;String, Integer&gt;();
  //How often to emit a count of words
  private Integer emitFrequency;

  // Default constructor
  public WordCount() {
      emitFrequency=5; // Default to 60 seconds
  }

  // Constructor that sets emit frequency
  public WordCount(Integer frequency) {
      emitFrequency=frequency;
  }

  //Configure frequency of tick tuples for this bolt
  //This delivers a 'tick' tuple on a specific interval,
  //which is used to trigger certain actions
  @Override
  public Map&lt;String, Object&gt; getComponentConfiguration() {
      Config conf = new Config();
      conf.put(Config.TOPOLOGY_TICK_TUPLE_FREQ_SECS, emitFrequency);
      return conf;
  }

  //execute is called to process tuples
  @Override
  public void execute(Tuple tuple, BasicOutputCollector collector) {
    //If it's a tick tuple, emit all words and counts
    if(tuple.getSourceComponent().equals(Constants.SYSTEM_COMPONENT_ID)
            &amp;&amp; tuple.getSourceStreamId().equals(Constants.SYSTEM_TICK_STREAM_ID)) {
      for(String word : counts.keySet()) {
        Integer count = counts.get(word);
        collector.emit(new Values(word, count));
        logger.info("Emitting a count of " + count + " for word " + word);
      }
    } else {
      //Get the word contents from the tuple
      String word = tuple.getString(0);
      //Have we counted any already?
      Integer count = counts.get(word);
      if (count == null)
        count = 0;
      //Increment the count and store it
      count++;
      counts.put(word, count);
    }
  }

  //Declare that this emits a tuple containing two fields; word and count
  @Override
  public void declareOutputFields(OutputFieldsDeclarer declarer) {
    declarer.declare(new Fields("word", "count"));
  }
}
</code></pre>
       <h3 id="define-the-topology">Define the topology</h3> 
       <p>The topology ties the spouts and bolts together into a graph, which defines how data flows between the components. It also provides parallelism hints that Storm uses when creating instances of the components within the cluster.</p> 
       <p>The following image is a basic diagram of the graph of components for this topology.</p> 
       <p><img src="media/hdinsight-storm-develop-java-topology/wordcount-topology.png" alt="diagram showing the spouts and bolts arrangement" data-linktype="relative-path"></p> 
       <p>To implement the topology, create a file named <code>WordCountTopology.java</code> in the <code>src\main\java\com\microsoft\example</code> directory. Use the following Java code as the contents of the file:</p> 
       <pre><code class="lang-java">package com.microsoft.example;

import org.apache.storm.Config;
import org.apache.storm.LocalCluster;
import org.apache.storm.StormSubmitter;
import org.apache.storm.topology.TopologyBuilder;
import org.apache.storm.tuple.Fields;

import com.microsoft.example.RandomSentenceSpout;

public class WordCountTopology {

  //Entry point for the topology
  public static void main(String[] args) throws Exception {
  //Used to build the topology
    TopologyBuilder builder = new TopologyBuilder();
    //Add the spout, with a name of 'spout'
    //and parallelism hint of 5 executors
    builder.setSpout("spout", new RandomSentenceSpout(), 5);
    //Add the SplitSentence bolt, with a name of 'split'
    //and parallelism hint of 8 executors
    //shufflegrouping subscribes to the spout, and equally distributes
    //tuples (sentences) across instances of the SplitSentence bolt
    builder.setBolt("split", new SplitSentence(), 8).shuffleGrouping("spout");
    //Add the counter, with a name of 'count'
    //and parallelism hint of 12 executors
    //fieldsgrouping subscribes to the split bolt, and
    //ensures that the same word is sent to the same instance (group by field 'word')
    builder.setBolt("count", new WordCount(), 12).fieldsGrouping("split", new Fields("word"));

    //new configuration
    Config conf = new Config();
    //Set to false to disable debug information when
    // running in production on a cluster
    conf.setDebug(false);

    //If there are arguments, we are running on a cluster
    if (args != null &amp;&amp; args.length &gt; 0) {
      //parallelism hint to set the number of workers
      conf.setNumWorkers(3);
      //submit the topology
      StormSubmitter.submitTopology(args[0], conf, builder.createTopology());
    }
    //Otherwise, we are running locally
    else {
      //Cap the maximum number of executors that can be spawned
      //for a component to 3
      conf.setMaxTaskParallelism(3);
      //LocalCluster is used to run locally
      LocalCluster cluster = new LocalCluster();
      //submit the topology
      cluster.submitTopology("word-count", conf, builder.createTopology());
      //sleep
      Thread.sleep(10000);
      //shut down the cluster
      cluster.shutdown();
    }
  }
}
</code></pre>
       <h3 id="configure-logging">Configure logging</h3> 
       <p>Storm uses Apache Log4j to log information. If you do not configure logging, the topology emits diagnostic information. To control what is logged, create a file named <code>log4j2.xml</code> in the <code>resources</code> directory. Use the following XML as the contents of the file.</p> 
       <pre><code class="lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration&gt;
&lt;Appenders&gt;
    &lt;Console name="STDOUT" target="SYSTEM_OUT"&gt;
        &lt;PatternLayout pattern="%d{HH:mm:ss} [%t] %-5level %logger{36} - %msg%n"/&gt;
    &lt;/Console&gt;
&lt;/Appenders&gt;
&lt;Loggers&gt;
    &lt;Logger name="com.microsoft.example" level="trace" additivity="false"&gt;
        &lt;AppenderRef ref="STDOUT"/&gt;
    &lt;/Logger&gt;
    &lt;Root level="error"&gt;
        &lt;Appender-Ref ref="STDOUT"/&gt;
    &lt;/Root&gt;
&lt;/Loggers&gt;
&lt;/Configuration&gt;
</code></pre>
       <p>This XML configures a new logger for the <code>com.microsoft.example</code> class, which includes the components in this example topology. The level is set to trace for this logger, which captures any logging information emitted by components in this topology.</p> 
       <p>The <code>&lt;Root level="error"&gt;</code> section configures the root level of logging (everything not in <code>com.microsoft.example</code>) to only log error information.</p> 
       <p>For more information on configuring logging for Log4j, see <a href="http://logging.apache.org/log4j/2.x/manual/configuration.html" data-linktype="external">http://logging.apache.org/log4j/2.x/manual/configuration.html</a>.</p> 
       <div class="NOTE">
        <h5>Note</h5>
        <p>Storm version 0.10.0 and higher use Log4j 2.x. Older versions of storm used Log4j 1.x, which used a different format for log configuration. For information on the older configuration, see <a href="http://wiki.apache.org/logging-log4j/Log4jXmlFormat" data-linktype="external">http://wiki.apache.org/logging-log4j/Log4jXmlFormat</a>.</p> 
       </div> 
       <h2 id="test-the-topology-locally">Test the topology locally</h2> 
       <p>After you save the files, use the following command to test the topology locally.</p> 
       <pre><code class="lang-bash">mvn compile exec:java -Dstorm.topology=com.microsoft.example.WordCountTopology
</code></pre>
       <p>As it runs, the topology displays startup information. The following text is an example of the word count output:</p> 
       <pre><code>17:33:27 [Thread-12-count] INFO  com.microsoft.example.WordCount - Emitting a count of 56 for word snow
17:33:27 [Thread-12-count] INFO  com.microsoft.example.WordCount - Emitting a count of 56 for word white
17:33:27 [Thread-12-count] INFO  com.microsoft.example.WordCount - Emitting a count of 112 for word seven
17:33:27 [Thread-16-count] INFO  com.microsoft.example.WordCount - Emitting a count of 195 for word the
17:33:27 [Thread-30-count] INFO  com.microsoft.example.WordCount - Emitting a count of 113 for word and
17:33:27 [Thread-30-count] INFO  com.microsoft.example.WordCount - Emitting a count of 57 for word dwarfs
17:33:27 [Thread-12-count] INFO  com.microsoft.example.WordCount - Emitting a count of 57 for word snow
</code></pre>
       <p>This example log indicates that the word 'and' has been emitted 113 times. The count continues to go up as long as the topology runs because the spout continuously emits the same sentences.</p> 
       <p>There is a 5-second interval between emission of words and counts. The <strong>WordCount</strong> component is configured to only emit information when a tick tuple arrives. It requests that tick tuples are only delivered every five seconds.</p> 
       <h2 id="convert-the-topology-to-flux">Convert the topology to Flux</h2> 
       <p>Flux is a new framework available with Storm 0.10.0 and higher, which allows you to separate configuration from implementation. Your components are still defined in Java, but the topology is defined using a YAML file. You can package a default topology definition with your project, or use a standalone file when submitting the topology. When submitting the topology to Storm, you can use environment variables or configuration files to populate values in the YAML topology definition.</p> 
       <p>The YAML file defines the components to use for the topology and the data flow between them. You can include a YAML file as part of the jar file or you can use an external YAML file.</p> 
       <p>For more information on Flux, see <a href="https://storm.apache.org/releases/0.10.0/flux.html" data-linktype="external">Flux framework (https://storm.apache.org/releases/0.10.0/flux.html)</a>.</p> 
       <div class="WARNING">
        <h5>Warning</h5>
        <p>Due to a <a href="https://issues.apache.org/jira/browse/STORM-2055" data-linktype="external">bug (https://issues.apache.org/jira/browse/STORM-2055)</a> with Storm 1.0.1, you may need to install a <a href="https://storm.apache.org/releases/1.0.1/Setting-up-development-environment.html" data-linktype="external">Storm development environment</a> to run Flux topologies locally.</p> 
       </div> 
       <ol> 
        <li><p>Move the <code>WordCountTopology.java</code> file out of the project. Previously, this file defined the topology, but isn't needed with Flux.</p> </li> 
        <li><p>In the <code>resources</code> directory, create a file named <code>topology.yaml</code>. Use the following text as the contents of this file.</p> <pre><code class="lang-yaml">name: "wordcount"       # friendly name for the topology

config:                 # Topology configuration
  topology.workers: 1     # Hint for the number of workers to create

spouts:                 # Spout definitions
- id: "sentence-spout"
  className: "com.microsoft.example.RandomSentenceSpout"
  parallelism: 1      # parallelism hint

bolts:                  # Bolt definitions
- id: "splitter-bolt"
  className: "com.microsoft.example.SplitSentence"
  parallelism: 1

- id: "counter-bolt"
  className: "com.microsoft.example.WordCount"
  constructorArgs:
    - 10
  parallelism: 1

streams:                # Stream definitions
- name: "Spout --&gt; Splitter" # name isn't used (placeholder for logging, UI, etc.)
  from: "sentence-spout"       # The stream emitter
  to: "splitter-bolt"          # The stream consumer
  grouping:                    # Grouping type
    type: SHUFFLE

- name: "Splitter -&gt; Counter"
  from: "splitter-bolt"
  to: "counter-bolt"
  grouping:
    type: FIELDS
    args: ["word"]           # field(s) to group on
</code></pre></li> 
        <li><p>Make the following changes to the <code>pom.xml</code> file.</p> 
         <ul> 
          <li><p>Add the following new dependency in the <code>&lt;dependencies&gt;</code> section:</p> <pre><code class="lang-xml">&lt;!-- Add a dependency on the Flux framework --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.storm&lt;/groupId&gt;
    &lt;artifactId&gt;flux-core&lt;/artifactId&gt;
    &lt;version&gt;${storm.version}&lt;/version&gt;
&lt;/dependency&gt;
</code></pre></li> 
          <li><p>Add the following plugin to the <code>&lt;plugins&gt;</code> section. This plugin handles the creation of a package (jar file) for the project, and applies some transformations specific to Flux when creating the package.</p> <pre><code class="lang-xml">&lt;!-- build an uber jar --&gt;
&lt;plugin&gt;
    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
    &lt;artifactId&gt;maven-shade-plugin&lt;/artifactId&gt;
    &lt;version&gt;2.3&lt;/version&gt;
    &lt;configuration&gt;
        &lt;transformers&gt;
            &lt;!-- Keep us from getting a "can't overwrite file error" --&gt;
            &lt;transformer implementation="org.apache.maven.plugins.shade.resource.ApacheLicenseResourceTransformer" /&gt;
            &lt;transformer implementation="org.apache.maven.plugins.shade.resource.ServicesResourceTransformer" /&gt;
            &lt;!-- We're using Flux, so refer to it as main --&gt;
            &lt;transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer"&gt;
                &lt;mainClass&gt;org.apache.storm.flux.Flux&lt;/mainClass&gt;
            &lt;/transformer&gt;
        &lt;/transformers&gt;
        &lt;!-- Keep us from getting a bad signature error --&gt;
        &lt;filters&gt;
            &lt;filter&gt;
                &lt;artifact&gt;*:*&lt;/artifact&gt;
                &lt;excludes&gt;
                    &lt;exclude&gt;META-INF/*.SF&lt;/exclude&gt;
                    &lt;exclude&gt;META-INF/*.DSA&lt;/exclude&gt;
                    &lt;exclude&gt;META-INF/*.RSA&lt;/exclude&gt;
                &lt;/excludes&gt;
            &lt;/filter&gt;
        &lt;/filters&gt;
    &lt;/configuration&gt;
    &lt;executions&gt;
        &lt;execution&gt;
            &lt;phase&gt;package&lt;/phase&gt;
            &lt;goals&gt;
                &lt;goal&gt;shade&lt;/goal&gt;
            &lt;/goals&gt;
        &lt;/execution&gt;
    &lt;/executions&gt;
&lt;/plugin&gt;
</code></pre></li> 
          <li><p>In the <strong>exec-maven-plugin</strong> <code>&lt;configuration&gt;</code> section, change the value for <code>&lt;mainClass&gt;</code> to <code>org.apache.storm.flux.Flux</code>. This setting allows Flux to handle running the topology locally in development.</p> </li> 
          <li><p>In the <code>&lt;resources&gt;</code> section, add the following to the <code>&lt;includes&gt;</code>. This XML includes the YAML file that defines the topology as part of the project.</p> <pre><code class="lang-xml">&lt;include&gt;topology.yaml&lt;/include&gt;
</code></pre></li> 
         </ul> </li> 
       </ol> 
       <h2 id="test-the-flux-topology-locally">Test the flux topology locally</h2> 
       <ol> 
        <li><p>Use the following to compile and execute the Flux topology using Maven:</p> <pre><code class="lang-bash">mvn compile exec:java -Dexec.args="--local -R /topology.yaml"
</code></pre><p> If you are using PowerShell, use the following command:</p> <pre><code class="lang-bash">mvn compile exec:java "-Dexec.args=--local -R /topology.yaml"
</code></pre>
         <div class="WARNING">
          <h5>Warning</h5>
          <p>If your topology uses Storm 1.0.1 bits, this command fails. This failure is caused by <a href="https://issues.apache.org/jira/browse/STORM-2055" data-linktype="external">https://issues.apache.org/jira/browse/STORM-2055</a>. Instead, <a href="http://storm.apache.org/releases/0.10.0/Setting-up-development-environment.html" data-linktype="external">install Storm in your development environment</a> and use the following steps:</p> 
          <p>If you have <a href="http://storm.apache.org/releases/0.10.0/Setting-up-development-environment.html" data-linktype="external">installed Storm in your development environment</a>, you can use the following commands instead:</p> 
          <pre><code class="lang-bash">mvn compile package
storm jar target/WordCount-1.0-SNAPSHOT.jar org.apache.storm.flux.Flux --local -R /topology.yaml
</code></pre>
         </div> <p> The <code>--local</code> parameter runs the topology in local mode on your development environment. The <code>-R /topology.yaml</code> parameter uses the <code>topology.yaml</code> file resource from the jar file to define the topology.</p> <p> As it runs, the topology displays startup information. The following text is an example of the output:</p> <pre><code> 17:33:27 [Thread-12-count] INFO  com.microsoft.example.WordCount - Emitting a count of 56 for word snow
 17:33:27 [Thread-12-count] INFO  com.microsoft.example.WordCount - Emitting a count of 56 for word white
 17:33:27 [Thread-12-count] INFO  com.microsoft.example.WordCount - Emitting a count of 112 for word seven
 17:33:27 [Thread-16-count] INFO  com.microsoft.example.WordCount - Emitting a count of 195 for word the
 17:33:27 [Thread-30-count] INFO  com.microsoft.example.WordCount - Emitting a count of 113 for word and
 17:33:27 [Thread-30-count] INFO  com.microsoft.example.WordCount - Emitting a count of 57 for word dwarfs
</code></pre><p> There is a 10-second delay between batches of logged information.</p> </li> 
        <li><p>Make a copy of the <code>topology.yaml</code> file from the project. Name the new file <code>newtopology.yaml</code>. In the <code>newtopology.yaml</code> file, find the following section and change the value of <code>10</code> to <code>5</code>. This modification changes the interval between emitting batches of word counts from 10 seconds to 5.</p> <pre><code class="lang-yaml">- id: "counter-bolt"
className: "com.microsoft.example.WordCount"
constructorArgs:
- 5
parallelism: 1
```yaml

</code></pre></li> 
        <li><p>To run the topology, use the following command:</p> <pre><code class="lang-bash">mvn exec:java -Dexec.args="--local /path/to/newtopology.yaml"
</code></pre><p> Or, if you have Storm on your development environment:</p> <pre><code class="lang-bash">storm jar target/WordCount-1.0-SNAPSHOT.jar org.apache.storm.flux.Flux --local /path/to/newtopology.yaml
</code></pre><p> Change the <code>/path/to/newtopology.yaml</code> to the path to the newtopology.yaml file you created in the previous step. This command uses the newtopology.yaml as the topology definition. Since we didn't include the <code>compile</code> parameter, Maven uses the version of the project built in previous steps.</p> <p> Once the topology starts, you should notice that the time between emitted batches has changed to reflect the value in newtopology.yaml. So you can see that you can change your configuration through a YAML file without having to recompile the topology.</p> </li> 
       </ol> 
       <p>For more information on these and other features of the Flux framework, see <a href="https://storm.apache.org/releases/0.10.0/flux.html" data-linktype="external">Flux (https://storm.apache.org/releases/0.10.0/flux.html)</a>.</p> 
       <h2 id="trident">Trident</h2> 
       <p>Trident is a high-level abstraction that is provided by Storm. It supports stateful processing. The primary advantage of Trident is that it can guarantee that every message that enters the topology is processed only once. Without using Trident, your topology can only guarantee that messages are processed at least once. There are also other differences, such as built-in components that can be used instead of creating bolts. In fact, bolts are replaced by less-generic components, such as filters, projections, and functions.</p> 
       <p>Trident applications can be created by using Maven projects. You use the same basic steps as presented earlier in this articleonly the code is different. Trident also cannot (currently) be used with the Flux framework.</p> 
       <p>For more information about Trident, see the <a href="http://storm.apache.org/documentation/Trident-API-Overview.html" data-linktype="external">Trident API Overview</a>.</p> 
       <p>For an example of a Trident application, see <a href="hdinsight-storm-twitter-trending" data-linktype="relative-path">Twitter trending topics with Apache Storm on HDInsight</a>.</p> 
       <h2 id="next-steps">Next Steps</h2> 
       <p>You have learned how to create a Storm topology by using Java. Now learn how to:</p> 
       <ul> 
        <li><p><a href="hdinsight-storm-deploy-monitor-topology" data-linktype="relative-path">Deploy and manage Apache Storm topologies on HDInsight</a></p> </li> 
        <li><p><a href="hdinsight-storm-develop-csharp-visual-studio-topology" data-linktype="relative-path">Develop C# topologies for Apache Storm on HDInsight using Visual Studio</a></p> </li> 
       </ul> 
       <p>You can find more example Storm topologies by visiting <a href="hdinsight-storm-example-topology" data-linktype="relative-path">Example topologies for Storm on HDInsight</a>.</p> 
      </div>
     </div> 
     <div id="comments-container" ms.cmpgrp="comments" data-bi-name="comments" role="form"></div> 
    </div> 
   </main> 
   <div class="pageActions"> 
    <div id="page-actions" ms.cmpgrp="pageactions" data-bi-name="pageactions" role="complementary"> 
     <div id="page-actions-content"> 
      <ul class="action-list"> 
       <li> <a href="#comments-container" id="comments-link" ms.cmpnm="comments" data-bi-name="comments"> <i class="icon icon-comments"></i>Comments </a> </li> 
       <li id="contenteditbtn"> <a href="https://github.com/Microsoft/azure-docs/blob/master/articles/hdinsight/hdinsight-storm-develop-java-topology.md" title="Edit This Document" ms.cmpnm="edit" data-bi-name="edit"> <i class="icon icon-editor"></i>Edit </a> </li> 
       <li> <a href="#" class="sharebutton" title="Share This Document" ms.cmpnm="share" data-bi-name="share"><i class="icon icon-share"></i>Share</a> 
        <div class="share-container"> 
         <div>
          <a href="" class="share-twitter" ms.cmpnm="twitter" data-bi-name="twitter"><i class="icon icon-twitter"></i>Twitter</a>
         </div> 
         <div>
          <a href="" class="share-linkedin" ms.cmpnm="share-linkedin" data-bi-name="linkedin"><i class="icon icon-linkedin"></i>LinkedIn</a>
         </div> 
         <div>
          <a href="" class="share-facebook" ms.cmpnm="facebook" data-bi-name="facebook"><i class="icon icon-facebook"></i>Facebook</a>
         </div> 
         <div>
          <a href="" class="share-email" ms.cmpnm="email" data-bi-name="email"><i class="icon icon-email"></i>Email</a>
         </div> 
        </div> </li> 
       <li class="typeSep">|</li> 
       <li> <label for="theme-selector">Theme</label> <select id="theme-selector" data-bi-name="select-theme"> <option value="" class="removedOnload"></option> <option value="">Light</option> <option value="theme_night">Dark</option> </select> </li> 
      </ul> 
      <nav id="side-doc-outline" class="doc-outline" ms.cmpnm="intopic toc" data-bi-name="intopic toc" role="navigation" aria-label="On page navigation"> 
       <h3>In this article</h3> 
      </nav> 
     </div> 
    </div> 
   </div> 
   <ul class="breadcrumbs" ms.cmpgrp="breadcrumb" data-bi-name="breadcrumb" itemscope itemtype="http://schema.org/BreadcrumbList" role="navigation" aria-label="Breadcrumb">
    <li></li>
   </ul> 
   <div class="sidebar" id="sidebar" ms.cmpgrp="left toc" data-bi-name="left toc" role="navigation" aria-label="Main Navigation" lang="en-us" dir="ltr"> 
    <div id="sidebarContent"> 
     <div class="filterHolder"> 
     </div> 
     <nav class="toc"></nav> 
     <div class="pdfDownloadHolder"></div> 
    </div> 
    <div class="tocSpace"></div> 
   </div> 
   <div id="menu-nav" class="dropdown-container" lang="en-us" dir="ltr"> 
    <div class="dropdown dropdown-full mobilenavi"> 
     <select> </select> 
    </div> 
   </div> 
  </div> 
  <div id="openFeedbackContainer" class="openfeedback-container footer-layout"></div> 
  <div class="container footerContainer"> 
   <footer id="footer" ms.pgarea="footer" data-bi-name="footer" class="footer-layout"> 
    <div class="container" role="contentinfo"> 
     <a data-mscc-ic="false" id="locale-selector-link" href="#" data-bi-name="select-locale" ms.cmpnm="select-locale"></a> 
     <ul class="links" ms.cmpgrp="footerlinks" data-bi-name="footerlinks"> 
      <li><a data-mscc-ic="false" href="https://docs.microsoft.com/teamblog" ms.cmpnm="bloglink" data-bi-name="bloglink">Blog</a></li> 
      <li><a data-mscc-ic="false" href="//privacy.microsoft.com/en-us/" ms.cmpnm="privacy" data-bi-name="privacy">Privacy &amp; Cookies</a></li> 
      <li><a data-mscc-ic="false" href="/en-us/legal/termsofuse" ms.cmpnm="termsofuse" data-bi-name="termsofuse">Terms of Use</a></li> 
      <li><a data-mscc-ic="false" href="//aka.ms/sitefeedback" ms.cmpnm="feedback" data-bi-name="feedback">Feedback</a></li> 
      <li id="impressum-section" hidden><a data-mscc-ic="false" id="impressum-link" href="#" ms.cmpnm="impressum" data-bi-name="impressum">Impressum</a></li> 
      <li><a data-mscc-ic="false" href="https://www.microsoft.com/en-us/legal/intellectualproperty/Trademarks/EN-US.aspx" ms.cmpnm="trademarks" data-bi-name="trademarks">Trademarks</a></li> 
     </ul> 
    </div> 
   </footer> 
  </div> 
  <script src="/_themes/docs.theme/master/en-us/_themes/javascript/870b0825531b1b071dff.conceptual.js"></script>  
 </body>
</html>