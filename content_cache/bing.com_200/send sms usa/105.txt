<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope itemtype="http://schema.org/WebPage">
 <head> 
  <meta http-equiv="content-type" content="text/html; charset=UTF-8"> 
  <meta http-equiv="X-UA-Compatible" content="chrome=1"> 
  <script type="text/javascript">/* Copyright 2008 Google. */ (function() { (function(){function e(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp("CSI/"+a)}catch(h){}};this.tick("start",null,a)}var a;if(window.performance)var d=(a=window.performance.timing)&&a.responseStart;var f=0<d?new e(d):new e;window.jstiming={Timer:e,load:f};if(a){var c=a.navigationStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick("_wtsrt",void 0,c),b.tick("wtsrt_","_wtsrt",
d),b.tick("tbsd_","wtsrt_"))}try{a=null,window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick("_tbnd",void 0,window.chrome.csi().startE),b.tick("tbnd_","_tbnd",c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick("_tbnd",void 0,window.external.startE),b.tick("tbnd_","_tbnd",c))),a&&(window.jstiming.pt=a)}catch(g){}})(); })()
</script> 
  <link rel="shortcut icon" type="image/x-icon" href="//www.google.com/images/icons/product/sites-16.ico"> 
  <link rel="apple-touch-icon" href="http://www.gstatic.com/sites/p/99027b/system/app/images/apple-touch-icon.png" type="image/png"> 
  <script type="text/javascript">/* Copyright 2008 Google. */ (function() { function d(a){return document.getElementById(a)}window.byId=d;function g(a){return a.replace(/^\s+|\s+$/g,"")}window.trim=g;var h=[],k=0;window.JOT_addListener=function(a,b,c){var f=new String(k++);a={eventName:a,handler:b,compId:c,key:f};h.push(a);return f};window.JOT_removeListenerByKey=function(a){for(var b=0;b<h.length;b++)if(h[b].key==a){h.splice(b,1);break}};window.JOT_removeAllListenersForName=function(a){for(var b=0;b<h.length;b++)h[b].eventName==a&&h.splice(b,1)};
window.JOT_postEvent=function(a,b,c){var f={eventName:a,eventSrc:b||{},payload:c||{}};if(window.JOT_fullyLoaded)for(b=h.length,c=0;c<b&&c<h.length;c++){var e=h[c];e&&e.eventName==a&&(f.listenerCompId=e.compId||"",(e="function"==typeof e.handler?e.handler:window[e.handler])&&e(f))}else window.JOT_delayedEvents.push({eventName:a,eventSrc:b,payload:c})};window.JOT_delayedEvents=[];window.JOT_fullyLoaded=!1;
window.JOT_formatRelativeToNow=function(a,b){a=((new Date).getTime()-a)/6E4;if(1440<=a||0>a)return null;var c=0;60<=a&&(a/=60,c=2);2<=a&&c++;return b?window.JOT_siteRelTimeStrs[c].replace("__duration__",Math.floor(a)):window.JOT_userRelTimeStrs[c].replace("__duration__",Math.floor(a))}; })()
</script> 
  <script>

  

  var breadcrumbs = [{"path":"/tools","deleted":false,"title":"Tools and Tips for SCCM and SCOM","dir":"ltr"},{"path":"/tools/sccm-sms-and-batch-scripting","deleted":false,"title":"SCCM / SMS and BATCH Scripting","dir":"ltr"}];
  var JOT_clearDotPath = 'http://www.gstatic.com/sites/p/99027b/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"gvizGstaticVersion":"current","enableAnalytics":false,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED","siteTitle":"NTCenter.ca","onepickUrl":"https://docs.google.com/picker","adsensePublisherId":null,"features":{"oAuthForChartsApi":true,"contactStoreMigrationPollForGapi":true,"gapiLoaderUtil":true,"moreMobileStyleImprovements":null,"googleChartsOverGstatic":false,"picasaAlbumInsert":false,"pageDrafts":false,"plusBadge":false,"pdfEmbedSupport":false},"isPublic":true,"isConsumer":true,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://accounts.google.com/AccountChooser?continue\u003dhttp://sites.google.com/site/ntconsultingca/tools/sccm-sms-and-batch-scripting\u0026service\u003djotspot","analyticsAccountId":"","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"http://csi.gstatic.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["http://www.gstatic.com/sites/p/99027b/system/app/css/sitelayouteditor.css"],"text":["http://www.gstatic.com/sites/p/99027b/system/js/codemirror.js","http://www.gstatic.com/sites/p/99027b/system/app/css/codemirror_css.css","http://www.gstatic.com/sites/p/99027b/system/js/trog_edit__en.js","http://www.gstatic.com/sites/p/99027b/system/app/css/trogedit.css","/_/rsrc/1505980136000/system/app/css/editor.css","http://www.gstatic.com/sites/p/99027b/system/app/css/codeeditor.css","/_/rsrc/1505980136000/system/app/css/camelot/editor-jfk.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"defaultdomain","baseUri":"","name":"ntconsultingca","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/tools","parentWuid":"wuid:gx:462bed31a9efd853","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"SCCM / SMS and BATCH Scripting","locale":"en","wuid":"wuid:gx:7d1433603b8eec83","revision":7,"path":"/tools/sccm-sms-and-batch-scripting","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"sccm-sms-and-batch-scripting","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","onePickToken":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script> 
  <script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script> 
  <link rel="canonical" href="http://www.ntcenter.ca/tools/sccm-sms-and-batch-scripting"> 
  <meta name="title" content="SCCM / SMS and BATCH Scripting - NTCenter.ca"> 
  <meta itemprop="name" content="SCCM / SMS and BATCH Scripting - NTCenter.ca"> 
  <meta property="og:title" content="SCCM / SMS and BATCH Scripting - NTCenter.ca"> 
  <meta name="description" content="This site is offical web presense of NT Consulting Inc, Toronto System Menagment Consulting Company."> 
  <meta itemprop="description" content="This site is offical web presense of NT Consulting Inc, Toronto System Menagment Consulting Company."> 
  <meta id="meta-tag-description" property="og:description" content="This site is offical web presense of NT Consulting Inc, Toronto System Menagment Consulting Company."> 
  <style type="text/css">
</style> 
  <link rel="stylesheet" type="text/css" href="http://www.gstatic.com/sites/p/99027b/system/app/themes/iceberg/standard-css-iceberg-ltr-ltr.css"> 
  <link rel="stylesheet" type="text/css" href="/_/rsrc/1505980136000/system/app/css/camelot/allthemes-view.css"> 
  <!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]--> 
  <title>SCCM / SMS and BATCH Scripting - NTCenter.ca</title> 
  <script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script> 
 </head> 
 <body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            "> 
  <div id="sites-page-toolbar" class="sites-header-divider"> 
   <div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;">
    <div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> 
    </div>
   </div> 
  </div> 
  <div id="sites-chrome-everything-scrollbar"> 
   <div id="sites-chrome-everything" class=""> 
    <div id="sites-chrome-page-wrapper" style="direction: ltr"> 
     <div id="sites-chrome-page-wrapper-inside"> 
      <div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style=""> 
       <table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style=""> 
        <tbody>
         <tr class="sites-header-primary-row" id="sites-chrome-userheader"> 
          <td id="sites-header-title" class="" role="banner">
           <div class="sites-header-cell-buffer-wrapper">
            <h2><a href="http://www.ntcenter.ca/" dir="ltr" id="sites-chrome-userheader-title">NTCenter.ca</a></h2>
           </div></td>
          <td class="sites-layout-searchbox  ">
           <div class="sites-header-cell-buffer-wrapper">
            <form id="sites-searchbox-form" action="/system/app/pages/search" role="search">
             <input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site">
             <input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site">
             <div id="sites-searchbox-button-set" class="goog-inline-block">
              <div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">
               Search this site
              </div>
             </div>
            </form>
           </div></td> 
         </tr> 
         <tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav"> 
          <td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation"> </td> 
         </tr> 
        </tbody>
       </table> 
      </div> 
      <div id="sites-chrome-main-wrapper"> 
       <div id="sites-chrome-main-wrapper-inside"> 
        <table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0"> 
         <tbody>
          <tr> 
           <td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px"> 
            <div xmlns="http://www.w3.org/1999/xhtml" id="COMP_2bd" class="sites-embed" role="navigation">
             <h4 class="sites-embed-title">Navigation</h4>
             <div class="sites-embed-content sites-sidebar-nav">
              <ul role="navigation" jotid="navList" class="has-expander">
               <li class="topLevel nav-first ">
                <div dir="ltr" style="padding-left: 19px;">
                 <a href="/home" jotid="wuid:gx:65fdf66e8b4c35d5" class="sites-navigation-link topLevel">Home</a>
                </div></li>
               <li class="topLevel ">
                <div dir="ltr" style="padding-left: 19px;">
                 <a href="/about-me" jotid="wuid:gx:7c28c5b915f14a34" class="sites-navigation-link topLevel">About Me</a>
                </div></li>
               <li class="topLevel parent " wuid="gx:4b3099162b028bc2">
                <div dir="ltr" style="padding-left: 0px;">
                 <div class="expander"></div>
                 <a href="/after-hard-working-day" jotid="wuid:gx:4b3099162b028bc2" class="sites-navigation-link topLevel">After Hard Working Day</a>
                </div>
                <ul role="navigation" class="has-expander">
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/after-hard-working-day/if-you-like-tennis" jotid="wuid:gx:2c647ab93c5b48ae" class="sites-navigation-link">If you like Tennis...</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/after-hard-working-day/photo-geotagging" jotid="wuid:gx:d6e2a67d2f34b8d" class="sites-navigation-link">Photo geotagging</a>
                  </div></li>
                </ul></li>
               <li class="topLevel parent " wuid="gx:2acfc05b92e8bfa2">
                <div dir="ltr" style="padding-left: 0px;">
                 <div class="expander"></div>
                 <a href="/Priv-tools" jotid="wuid:gx:2acfc05b92e8bfa2" class="sites-navigation-link topLevel">Mis Tools</a>
                </div>
                <ul role="navigation" class="has-expander">
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/Priv-tools/ad-administration-scripts" jotid="wuid:gx:244cb5fd226e176" class="sites-navigation-link">AD Administration Scripts</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/Priv-tools/batch-coding-examples" jotid="wuid:gx:55e22fb690cef4b6" class="sites-navigation-link">BATCH Coding Examples</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/Priv-tools/excel-tips-and-vba-subs" jotid="wuid:gx:118edb0c4adb7825" class="sites-navigation-link">Excel tips and VBA SUBs</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/Priv-tools/getemailfromad" jotid="wuid:gx:640bd13dbaddb185" class="sites-navigation-link">GetEmailFromAD</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/Priv-tools/handy-cmd-command" jotid="wuid:gx:2ecb54a952de3dca" class="sites-navigation-link">Handy CMD commands</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/Priv-tools/handy-ad-ldap-query" jotid="wuid:gx:30f1a7e50649e5b7" class="sites-navigation-link">HANDY-AD-LDAP-QUERY</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/Priv-tools/send-email-from-a-script" jotid="wuid:gx:73672930b8dfde1f" class="sites-navigation-link">Send Email from a Script</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/Priv-tools/vb-script-error" jotid="wuid:gx:3acca9942a6235d" class="sites-navigation-link">VB Script Error Code Description</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/Priv-tools/vb-subs-funtins" jotid="wuid:gx:6686cfc1aafbcae4" class="sites-navigation-link">VB SUBs &amp; Functions</a>
                  </div></li>
                </ul></li>
               <li class="topLevel ">
                <div dir="ltr" style="padding-left: 19px;">
                 <a href="/patching-with-sccm" jotid="wuid:gx:589ad1ae1f70f466" class="sites-navigation-link topLevel">Patching with SCCM</a>
                </div></li>
               <li class="topLevel ">
                <div dir="ltr" style="padding-left: 19px;">
                 <a href="/sccm-flowecharts-and-references" jotid="wuid:gx:50c967c989ce2dda" class="sites-navigation-link topLevel">SCCM-07-Flowecharts and References</a>
                </div></li>
               <li class="topLevel ">
                <div dir="ltr" style="padding-left: 19px;">
                 <a href="/sms-and-sccm-overlapping-boundary" jotid="wuid:gx:40cbb42fd66b8e33" class="sites-navigation-link topLevel">SMS and SCCM Overlapping boundary</a>
                </div></li>
               <li class="topLevel ">
                <div dir="ltr" style="padding-left: 19px;">
                 <a href="/sum---software-update-managment" jotid="wuid:gx:1dd24d8af703ef8" class="sites-navigation-link topLevel">SUM - Software Update Managment - Tools</a>
                </div></li>
               <li class="topLevel parent " wuid="gx:462bed31a9efd853">
                <div dir="ltr" style="padding-left: 0px;">
                 <div class="expander"></div>
                 <a href="/tools" jotid="wuid:gx:462bed31a9efd853" class="sites-navigation-link topLevel">Tools and Tips for SCCM and SCOM</a>
                </div>
                <ul role="navigation" class="has-expander">
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/tools/beyond-sccm-build-in-reports" jotid="wuid:gx:415cdf74d32071fb" class="sites-navigation-link">Beyond SCCM build in reports</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/tools/how-to-automate-sccm" jotid="wuid:gx:32faa2c077c0f539" class="sites-navigation-link">How to automate SCCM administration</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/tools/osd" jotid="wuid:gx:65fceee5d38182c8" class="sites-navigation-link">OSD</a>
                  </div></li>
                 <li class="">
                  <div class="current-bg" jotid="wuid:gx:7d1433603b8eec83" dir="ltr" style="padding-left: 38px;">
                   SCCM / SMS and BATCH Scripting
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/tools/sccm-client-install" jotid="wuid:gx:1e4cb0bbbf591222" class="sites-navigation-link">SCCM Client Install</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/tools/sccm-faq" jotid="wuid:gx:27e9bebbf76e4181" class="sites-navigation-link">SCCM FAQ</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/tools/sccm-security" jotid="wuid:gx:12096d13bd1fb9e4" class="sites-navigation-link">SCCM Security Tips</a>
                  </div></li>
                 <li class="">
                  <div dir="ltr" style="padding-left: 38px;">
                   <a href="/tools/sql-wql" jotid="wuid:gx:47166dc9de05cd15" class="sites-navigation-link">SQL-WQL</a>
                  </div></li>
                </ul></li>
               <li class="topLevel ">
                <div dir="ltr" style="padding-left: 19px;">
                 <a href="/windows-7" jotid="wuid:gx:b133e3d9e2371a5" class="sites-navigation-link topLevel">Windows 7 Tips and notes</a>
                </div></li>
               <li class="topLevel ">
                <div dir="ltr" style="padding-left: 19px;">
                 <a href="/windows-remote-execution" jotid="wuid:gx:5f0d8ca63c00b6ef" class="sites-navigation-link topLevel">Windows Remote Execution</a>
                </div></li>
               <li class="topLevel ">
                <div dir="ltr" style="padding-left: 19px;">
                 <a href="/windows-server-2008-tips-and-notes" jotid="wuid:gx:50b288da7d6dc1b0" class="sites-navigation-link topLevel">Windows Server 2008 Tips and notes</a>
                </div></li>
               <li class="topLevel ">
                <div dir="ltr" style="padding-left: 19px;">
                 <a href="/system/app/pages/sitemap/hierarchy" jotid="wuid:gx:30c56482d84ba8b4" class="sites-navigation-link topLevel">Sitemap</a>
                </div></li>
              </ul>
             </div>
            </div> 
            <div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7387593637376826" class="sites-embed" role="navigation">
             <h4 class="sites-embed-title">Navigation</h4>
             <div class="sites-embed-content sites-sidebar-nav">
              <ul role="navigation" jotid="navList">
               <li class="nav-first ">
                <div dir="ltr" style="padding-left: 5px;">
                 <a href="/about-me" jotid="wuid:gx:7c28c5b915f14a34" class="sites-navigation-link">About Me</a>
                </div></li>
               <li class="">
                <div dir="ltr" style="padding-left: 5px;">
                 <a href="/system/app/pages/recentChanges" jotid="wuid:gx:15ce4d2405530a29" class="sites-navigation-link">Recent site activity</a>
                </div></li>
              </ul>
             </div>
            </div> </td> 
           <td id="sites-canvas-wrapper"> 
            <div id="sites-canvas" role="main"> 
             <div id="goog-ws-editor-toolbar-container"> 
             </div> 
             <div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style=""> 
              <a href="/tools" dir="ltr">Tools and Tips for SCCM and SCOM</a>? &gt; ? 
             </div> 
             <h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left"> <span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">SCCM / SMS and BATCH Scripting</span> </h3> 
             <div id="sites-canvas-main" class="sites-canvas-main"> 
              <div id="sites-canvas-main-content"> 
               <table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox">
                <tbody>
                 <tr>
                  <td class="sites-layout-tile sites-tile-name-content-1"> 
                   <div dir="ltr"> 
                    <h2 style="MARGIN:0in 0in 0pt"><a name="TOC-1"></a><span style="COLOR:#3366ff"><span style="COLOR:#3366ff">
                       <div class="sites-embed-align-left-wrapping-off">
                        <div class="sites-embed-border-off sites-embed" style="width:250px;">
                         <div class="sites-embed-content sites-embed-type-toc">
                          <div class="goog-toc sites-embed-toc-maxdepth-6">
                           <p>Contents</p>
                           <ol class="goog-toc">
                            <li class="goog-toc"><a href="#TOC-SMS-SCCM-Batch-Files"><strong>1 </strong>SMS/SCCM &amp; Batch Files</a></li>
                            <li class="goog-toc"><a href="#TOC-An-typical-example-of-SMS-SCCM-and-Batch-script:"><strong>2 </strong>An typical example of SMS/SCCM&nbsp;and Batch script:</a></li>
                            <li class="goog-toc"><a href="#TOC-An-typical-example-of-software-app-install"><strong>3 </strong>An typical example of software app&nbsp;install</a></li>
                            <li class="goog-toc"><a href="#TOC-Scripting-for-64-bit-machines-with-SCCM"><strong>4 </strong>Scripting for 64-bit machines with SCCM</a></li>
                           </ol>
                          </div>
                         </div>
                        </div>
                       </div></span></span></h2> 
                    <h2 style="MARGIN:0in 0in 0pt"><a name="TOC--"></a>&nbsp;</h2> 
                    <h2 style="MARGIN:0in 0in 0pt"><a name="TOC-SMS-SCCM-Batch-Files"></a><span style="COLOR:#3366ff"><span style="COLOR:#3366ff">SMS/SCCM &amp; Batch Files</span></span></h2> 
                    <div style="MARGIN:0in 0in 0pt">
                     &nbsp;
                    </div> 
                    <div style="MARGIN:0in 0in 0pt">
                     <span style="COLOR:#3366ff"><font face="Times New Roman" size="3">SMS/SCCM &amp; Batch Files &amp; running .BAT files from UNC in SMS/SCCM – and How to use it whit in OSD and TS</font></span>
                    </div> 
                    <p><b><font face="Times New Roman" size="3">THE PROBLEM</font></b></p> 
                    <p><font face="arial,sans-serif">When you run a .BAT file from a UNC path, the first thing you might notice is the warning about "UNC paths are not supported.&nbsp; Defaulting to the Windows Directory"</font></p> 
                    <p><font face="arial,sans-serif">All this really means is that the current working folder is your Windows folder, and not the UNC path to where the script is sitting.</font></p> 
                    <p><font face="arial,sans-serif">The problem with this is that <b>any commands inside your .</b>bat file that try to call or reference a file that you know is in the same UNC path as the .bat<b> file will come up empty</b> because the directory is now Windows.</font></p> 
                    <p><font face="arial,sans-serif">Notice that the batch files can be used within WinPE and with full OS trough CM client.</font></p> 
                    <p><font face="arial,sans-serif">Once CM Client execute program form SCCM DP (even though it is set as UNC), it treat is as LOCAL Path (C:\Somthing..)</font></p> 
                    <p><font face="arial,sans-serif">Also it is important to know it TS are executed within WinPE and if looking for Fix Drive letter, it is different drive later than later in full OS.</font></p> 
                    <p><font face="Times New Roman" size="3">&nbsp;</font><font face="Times New Roman"><b><font size="4">Recommended approach</font></b></font></p> 
                    <p><font face="arial,sans-serif">You can get the folder from where the script is being run by using <b><span style="BACKGROUND:yellow">%~dp0</span></b>.</font></p> 
                    <p><font face="arial,sans-serif">When a .BAT file is being executed, %0 evaluates to the full drive, path, filename and extension of the .bat file itself.&nbsp; %1 refers to the first parameter passed in, %2 to the second parameter and so on.&nbsp; So if you had a .bat file that looked like this:</font></p> 
                    <p><font face="Times New Roman">SNIPPET #1 - .BAT FILE THAT ECHO'S IT'S OWN FILENAME </font></p> 
                    <p><span style="FONT-FAMILY:Courier New">@ECHO OFF<br>ECHO %</span><font face="Times New Roman">0</font><span style="FONT-FAMILY:Courier New"><br>PAUSE</span></p> 
                    <p><font size="3"><font face="Times New Roman"><b>OUTPUT #1</b><br></font><font face="arial,sans-serif" size="2">When you run it you would get the drive, path, filename and extension of the .bat file right there in the output<br></font></font><a href="http://www.google.com/url?q=http%3A%2F%2Fmyitforum.com%2Fcs2%2Fblogs%2Fjnelson%2FUNC_WorkingDir2.gif&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzchKsTEzwLn2TEU128EGi1G2i72PQ"></a></p> 
                    <p><font face="arial,sans-serif">Now, since we have the full drive and path, let's just use some Windows Shell scripting magic to remove the filename and extension and just return the drive and path:</font></p> 
                    <p><font face="arial,sans-serif">Here are the commands you can use to modify that %0 (which contains a drive, path, filename and extension) </font></p> 
                    <p><font face="arial,sans-serif">(taken from the syntax help on the FOR command...run FOR /? from a command prompt, and replace %I with %0) </font></p> 
                    <p><span style="FONT-FAMILY:Courier New">%~I - expands %I removing any surrounding quotes (")<br>&nbsp;%~fI- expands %I to a fully qualified path name<br>&nbsp;%~dI- expands %I to a drive letter only<br>&nbsp;%~pI- expands %I to a path only<br>&nbsp;%~nI- expands %I to a file name only<br>&nbsp;%~xI- expands %I to a file extension only<br>&nbsp;%~sI- expanded path contains short names only<br>&nbsp;%~aI- expands %I to file attributes of file<br>&nbsp;%~tI- expands %I to date/time of file<br>&nbsp;%~zI- expands %I to size of file<br>&nbsp;%~$PATH:I&nbsp;&nbsp; - searches the directories listed in the PATH environment variable and expands %I to the fully qualified name of the first one found. If the environment variable name is not defined or the file is not found by the search, then this modifier expands to the empty string</span></p> 
                    <p><span style="FONT-FAMILY:Courier New">The modifiers can be combined to get compound results:<br><br>&nbsp;%~dpI - expands %I to a drive letter and path only<br>&nbsp;%~nxI - expands %I to a file name and extension only<br>&nbsp;%~fsI - expands %I to a full path name with short names only<br>&nbsp;%~dp$PATH:I - searches the directories listed in the PATH<br>&nbsp;environment variable for %I and expands to the drive letter and path of the first one found.<br>&nbsp;%~ftzaI - expands %I to a DIR like output line</span> </p> 
                    <p><font face="Times New Roman">So, let's combine the "d" and "p" to get the drive and path </font></p> 
                    <p><font size="3"><font face="Times New Roman"><b>SNIPPET #2</b> - .BAT FILE THAT ECHO'S IT'S OWN PATH </font></font></p> 
                    <p><span style="FONT-FAMILY:Courier New"><font face="arial,sans-serif">@ECHO OFF<br>ECHO %~dp0<br>PAUSE</font></span></p> 
                    <p><font size="3"><font face="Times New Roman"><b>OUTPUT #2</b><br><font size="2">When you run this, you'll get just the drive (in the case of UNC's that's a \\) and path<br></font></font></font><a href="http://www.google.com/url?q=http%3A%2F%2Fmyitforum.com%2Fcs2%2Fblogs%2Fjnelson%2FUNC_WorkingDir3.gif&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzc02WTPN65qWIG6kpuLlcuo9SwBog"></a></p> 
                    <p><font face="Times New Roman">So, if you have a more complex .BAT file and want to execute any programs that exist in the same folder as the .BAT file sits, you simply need to reference %~dp0.&nbsp; Perhaps it would be easier to understand if we set a variable called THISDIR... </font></p> 
                    <p><font face="Times New Roman">SNIPPET #3 - .BAT FILE THAT SETS VARIABLE AND CALLS PROGRAMS </font></p> 
                    <p><span style="FONT-FAMILY:Courier New">@ECHO OFF<br>SETLOCAL<br><br>Set THISDIR = %~dp0<br><br>"%THISDIR%file.exe"<br>"%THISDIR%myFile.exe" /f1"%THISDIR%myINI.ini"<br><br></span><font face="Times New Roman">NOTES: </font><font face="Times New Roman">You need quotes around your files if there are spaces in the path. </font></p> 
                    <ol> 
                     <li style="MARGIN:0in 0in 0pt"><font face="Times New Roman">%~dp0 includes the trailing backslash \ so you use %THISDIR%File.exe instead of %THISDIR%\File.exe </font> </li>
                     <li style="MARGIN:0in 0in 0pt"><font face="Times New Roman">SETLOCAL is just something that I use to make sure we're only changing variables in the current script's scope. </font> </li>
                     <li style="MARGIN:0in 0in 0pt"><font face="Times New Roman">Obviously you wouldn't have a PAUSE in a real script that you send to a bunch of machines or it will hang :)</font></li>
                    </ol> 
                    <p><b><font face="Times New Roman" size="3">SUMMARY:</font></b></p> 
                    <ol> 
                     <li style="MARGIN:0in 0in 0pt"><span style="BACKGROUND:yellow"><font size="3"><font face="Times New Roman">When you run a .bat file from a UNC path, the current working directory gets set to c:\Windows. </font></font></span> </li>
                     <li style="MARGIN:0in 0in 0pt"><font face="Times New Roman" size="3">%0 evaluates to the full drive, path, filename and extension of the .bat file. (%1, %2, etc refer to the parameters) </font> </li>
                     <li style="MARGIN:0in 0in 0pt"><font size="3"><font face="Times New Roman"><b>%~dp0</b> evaluates to the drive &amp; path of the current .bat file, essentially <u>to what the current working directory WOULD be if UNC paths were supported.</u> </font></font> </li>
                     <li style="MARGIN:0in 0in 0pt"><font face="Times New Roman" size="3">%~dp0 includes the trailing backslash so if you're going to use it to reference files, use<br><span style="BACKGROUND:lime">%~dp0FILENAME.EXE</span> <b>not</b> %~dp0<span style="BACKGROUND:red">\</span>FILENAME.EXE <br>&nbsp;or, if you put %~dp0 into a variable called THISDIR, use<br><span style="BACKGROUND:lime">%THISDIR%FILENAME.EXE</span> <b>not</b> %THISDIR%<span style="BACKGROUND:red">\</span>FILENAME.EXE </font> </li>
                     <li style="MARGIN:0in 0in 0pt"><font face="Times New Roman" size="3">If your path contains spaces, you'll need quotes around things.&nbsp;</font></li>
                    </ol> 
                    <div style="MARGIN:0in 0in 0pt">
                     &nbsp;
                    </div> 
                    <h2 style="MARGIN:0in 0in 0pt"><a name="TOC-An-typical-example-of-SMS-SCCM-and-Batch-script:"></a>An typical example of SMS/SCCM&nbsp;and Batch script:</h2> 
                    <div style="MARGIN:0in 0in 0pt">
                     &nbsp;
                    </div> 
                    <div style="MARGIN:0in 0in 0pt">
                     &nbsp;
                    </div> 
                    <div class="sites-codeblock sites-codesnippet-block"> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>@echo off</code>
                      <br>
                      <code>REM CLM Install for XP</code>
                      <br>
                      <code>CLS</code>
                      <br>
                      <code>PUSHD %~dp0</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>IF EXIST "C:\PROGRAM FILES(x86)" (GOTO :x64) ELSE (GOTO :x86)</code>
                      <br>
                      <code>:x64</code>
                      <br>
                      <code>REM CLM Isn't installed on XP 64</code>
                      <br>
                      <code>GOTO :EOF</code>
                      <br>
                      <code>:x86</code>
                      <br>
                      <code>if exist "C:\Program Files\Microsoft Certificate Lifecycle Manager Client\Pin\changepin.cmd" (GOTO :UPDATE) Else (GOTO :INSTALL)</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <br>
                      <code>:UPDATE</code>
                      <br>
                      <code>echo ***UPDATING Microsoft Certificate Lifecycle Manager Client**</code>
                      <br>
                      <code>(MsiExec.exe /X{1741E3D4-0118-4D1C-9C6E-10AE88E690D9} /qb!-)</code>
                      <br>
                      <code>(MsiExec.exe /X{1741E3D4-0118-4D1C-9C6E-10AE88E690D8} /qb!-)</code>
                      <br>
                      <code>(MsiExec.exe /X{C2522022-5137-407E-95B7-536BB35438BF} /qb!-)</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>(msiexec.EXE /I "CLM.msi" ALLUSERS=1 /qb!-)</code>
                      <br>
                      <code>GOTO :EOF</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>:INSTALL</code>
                      <br>
                      <code>ECHO ***Installing Microsoft Certificate Lifecycle Manager Client***</code>
                      <br>
                      <code>(msiexec.EXE /I "CLM.msi" ALLUSERS=1 /qb!-)</code>
                      <br>
                      <code>GOTO :EOF</code>
                     </div>
                    </div> 
                    <div style="MARGIN:0in 0in 0pt">
                     &nbsp;
                    </div> 
                    <div style="MARGIN:0in 0in 0pt">
                     &nbsp;
                    </div> 
                    <h2 style="MARGIN:0in 0in 0pt"><a name="TOC-An-typical-example-of-software-app-install"></a>An typical example of software app&nbsp;install</h2> 
                    <div style="MARGIN:0in 0in 0pt">
                     &nbsp;
                    </div> 
                    <div style="MARGIN:0in 0in 0pt">
                     &nbsp;
                    </div> 
                    <div class="sites-codeblock sites-codesnippet-block"> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>::@echo off</code>
                      <br>
                      <code>setlocal ENABLEDELAYEDEXPANSION</code>
                      <br>
                      <code>set LogDir=C:\XME\Base\System</code>
                      <br>
                      <code>if "%AllUsersProfile%"=="C:\ProgramData" set LogDir=C:\XOM\Logs\System</code>
                      <br>
                      <code>if not exist %LogDir% md %LogDir%</code>
                      <br>
                      <code>set LogFile=%LogDir%\FlashPlayer_10.2.159.1.log</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>if "%AllUsersProfile%"=="C:\ProgramData" (</code>
                      <br>
                      <code>&nbsp;"%~dp0subinacl.exe" /regkey HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{1171A62F-05D2-11D1-83FC-00A0C9089C5A} /grant=SYSTEM=F&gt;&gt;%LogFile%</code>
                      <br>
                      <code>&nbsp;"%~dp0subinacl.exe" /regkey HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{1171A62F-05D2-11D1-83FC-00A0C9089C5A} /revoke=Everyone&gt;&gt;%LogFile%</code>
                      <br>
                      <code>&nbsp;"%~dp0subinacl.exe" /regkey HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{1171A62F-05D2-11D1-83FC-00A0C9089C5A} /revoke="Anonymous Logon"&gt;&gt;%LogFile%</code>
                      <br>
                      <code>&nbsp;"%~dp0subinacl.exe" /regkey HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{1171A62F-05D2-11D1-83FC-00A0C9089C5A}\Programmable /grant=SYSTEM=F&gt;&gt;%LogFile%</code>
                      <br>
                      <code>&nbsp;"%~dp0subinacl.exe" /regkey HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{1171A62F-05D2-11D1-83FC-00A0C9089C5A}\Programmable /revoke=Everyone&gt;&gt;%LogFile%</code>
                      <br>
                      <code>&nbsp;"%~dp0subinacl.exe" /regkey HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{1171A62F-05D2-11D1-83FC-00A0C9089C5A}\Programmable /revoke="Anonymous Logon"&gt;&gt;%LogFile%</code>
                      <br>
                      <code>&nbsp;"%~dp0subinacl.exe" /regkey HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{D27CDB6E-AE6D-11cf-96B8-444553540000} /revoke=Everyone&gt;&gt;%LogFile%</code>
                      <br>
                      <code>&nbsp;"%~dp0subinacl.exe" /regkey HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{D27CDB6E-AE6D-11cf-96B8-444553540000} /revoke="Anonymous Logon"&gt;&gt;%LogFile%</code>
                      <br>
                      <code>&nbsp;"%~dp0subinacl.exe" /regkey HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{D27CDB70-AE6D-11cf-96B8-444553540000} /revoke=Everyone&gt;&gt;%LogFile%</code>
                      <br>
                      <code>&nbsp;"%~dp0subinacl.exe" /regkey HKEY_LOCAL_MACHINE\Software\Classes\CLSID\{D27CDB70-AE6D-11cf-96B8-444553540000} /revoke="Anonymous Logon"&gt;&gt;%LogFile%</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>&nbsp;"%~dp0uninstall_flash_player.exe" -uninstall</code>
                      <br>
                      <code>)</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>:: Uninstall all previous versions that don't share our upgrade code</code>
                      <br>
                      <code>MsiExec.exe /x {0050A2A6-651B-46A4-9D54-397A71CEBAE5} /quiet /norestart REBOOT=ReallySuppress</code>
                      <br>
                      <code>MsiExec.exe /x {5BC1A414-8A9B-4FBA-A179-F90629C58662} /quiet /norestart REBOOT=ReallySuppress</code>
                      <br>
                      <code>MsiExec.exe /x {9327F829-C030-40D3-9B32-0B099956F700} /quiet /norestart REBOOT=ReallySuppress</code>
                      <br>
                      <code>MsiExec.exe /x {EDB7AFE8-7495-4083-AE43-41C2C4696C72} /quiet /norestart REBOOT=ReallySuppress</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>:: Uninstall this version</code>
                      <br>
                      <code>MsiExec.exe /x {716C9261-D85A-4C9F-88E3-B696579B95B0} /quiet /norestart</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>:: Install this version.&nbsp; Upgrade code should remain unchanged, thereby causing recent older versions to uninstall automatically</code>
                      <br>
                      <code>"%~dp0Flash.msi" /q /norestart /l*vx "%LogFile%" ALLUSERS=1</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>set ExitCode=%ErrorLevel%</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>if not "%AllUsersProfile%"=="C:\ProgramData" call :FixIE</code>
                      <br>
                      <code>exit %ExitCode%</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      &nbsp;
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>:FixIE</code>
                      <br>
                      <code>&nbsp;regsvr32 /s actxprxy.dll</code>
                      <br>
                      <code>&nbsp;regsvr32 /s shdocvw.dll</code>
                      <br>
                      <code>&nbsp;regsvr32 /s urlmon.dll</code>
                      <br>
                      <code>&nbsp;regsvr32 /s oleaut32.dll</code>
                      <br>
                      <code>&nbsp;regsvr32 /s mshtml.dll</code>
                      <br>
                      <code>&nbsp;regsvr32 /s browseui.dll</code>
                      <br>
                      <code>&nbsp;regsvr32 /s shell32.dll</code>
                      <br>
                      <code>&nbsp;regsvr32 /s msjava.dll</code>
                      <br>
                      <code>&nbsp;regsvr32 /s dispex.dll</code>
                      <br>
                      <code>&nbsp;regsvr32 /s vbscript.dll</code>
                      <br>
                      <code>&nbsp;regsvr32 /s scrrun.dll</code>
                     </div> 
                     <div style="MARGIN:0in 0in 0pt">
                      <code>&nbsp;for /f "tokens=3" %%i in ('reg query "HKLM\SOFTWARE\Microsoft\Internet Explorer" /v "Version"^|find /i "REG_SZ"') do @set IEVersion=%%i</code>
                      <br>
                      <code>&nbsp;if "%IEVersion:~0,1%"=="8" reg add "HKCR\TypeLib\{EAB22AC0-30C1-11CF-A7EB-0000C05BAE0B}\1.1\0\win32" /ve /t REG_SZ /d %SystemRoot%\system32\ieframe.dll /f</code>
                      <br>
                      <code>&nbsp;goto :EOF</code>
                     </div>
                    </div>
                    <br> 
                    <div style="MARGIN:0in 0in 0pt">
                     &nbsp;
                    </div> 
                    <h2 style="MARGIN:0in 0in 10pt"><a name="TOC-Scripting-for-64-bit-machines-with-SCCM"></a>Scripting for 64-bit machines with SCCM</h2> 
                    <p style="MARGIN:0in 0in 10pt"><font color="#000000" size="3">&nbsp;</font><font color="#000000">Whenever a 32-bit application attempts to access %windir%\System32, the access is redirected to %windir%\SysWOW64 – because the SCCM client is 32-bit.</font><font color="#000000">&nbsp;</font></p> 
                    <p style="MARGIN:0in 0in 10pt"><font color="#000000">Therefore the 32-bit applications can access the native system directory by substituting %windir%\<font style="BACKGROUND-COLOR:#ffff00">Sysnative</font> for %windir%\System32. WOW64 recognizes Sysnative as a special alias used to indicate that the file system should not redirect to 32 bit sub-system. </font></p> 
                    <p style="MARGIN:0in 0in 10pt"><font color="#000000" size="3">Some of MS links about this are <a href="http://msdn.microsoft.com/en-us/library/aa384187(v=vs.85).aspx" target="_blank">here</a>.</font></p> 
                    <p style="MARGIN:0in 0in 10pt"><font color="#000000" size="3">&nbsp;</font></p> 
                    <div style="MARGIN:0in 0in 0pt">
                     &nbsp;
                    </div>
                   </div></td>
                 </tr>
                </tbody>
               </table> 
              </div> 
             </div> 
             <div id="sites-canvas-bottom-panel"> 
              <div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> 
              </div> 
              <div id="sites-attachments-container"> 
              </div> 
              <a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a> 
              <div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments">
               <div class="sites-comment-docos-wrapper">
                <div class="sites-comment-docos">
                 <div class="sites-comment-docos-background"></div>
                 <div class="sites-comment-docos-header">
                  <div class="sites-comment-docos-header-title">
                   Comments
                  </div>
                 </div>
                 <div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div>
                </div>
               </div>
              </div> 
             </div> 
            </div> </td> 
          </tr> 
         </tbody>
        </table> 
       </div> 
      </div> 
      <div id="sites-chrome-footer-wrapper"> 
       <div id="sites-chrome-footer-wrapper-inside"> 
        <div id="sites-chrome-footer"> 
        </div> 
       </div> 
      </div> 
     </div> 
    </div> 
    <div id="sites-chrome-adminfooter-container"> 
     <div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation">
      <p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?continue=http://sites.google.com/site/ntconsultingca/tools/sccm-sms-and-batch-scripting&amp;service=jotspot">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="http://sites.google.com/site/ntconsultingca/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p>
     </div> 
    </div> 
   </div> 
  </div> 
  <div id="sites-chrome-onebar-footer"> 
  </div> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script> 
  <script xmlns="http://www.w3.org/1999/xhtml" src="http://www.gstatic.com/sites/p/99027b/system/js/jot_min_view__en.js"></script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script> 
  <script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("2bd", "Navigation", true);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_2bd');
          </script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7387593637376826", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7387593637376826');
          </script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXuj-DFPFSie3egVkMai3-ZOMiEmRuLH43N1yLV7GpSOyotrSi5XaqvH7Jy2nQZ26eWKw8kyq13RMMn9HT6TDRSP8nJvUpM9IajyaJfL3dti-0TfZVVUs-vAa7OJ5GDk--MNY31f/api/js?anon=true',
                  false, false);
            </script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([1109635200000, 1128902400000, 1130657000000, 1143333000000, 1143806400000, 1145000000000, 1146380000000, 1152489600000, 1159800000000, 1159500000000, 1162095000000, 1162075000000, 1162105500000]);
    gsites.Xhr.send('http://www.ntcenter.ca/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script> 
  <script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'http://csi.gstatic.com/csi');
                    }
                  </script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script> 
  <script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script> 
  <script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script> 
  <script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script> 
  <div id="server-timer-div" style="display:none"> 
  </div> 
  <script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>   
 </body>
</html>