<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
 <head profile="http://gmpg.org/xfn/11"> 
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> 
  <title>ReCaptcha login form with Spring Security | DuyHai's Java Blog</title> 
  <link rel="pingback" href="https://doanduyhai.wordpress.com/xmlrpc.php"> 
  <meta name="google-site-verification" content="GzYY19tjuwTz1_GF9ONPqLJ0gq6ZhbSUk8RvbW06Lw0"> 
  <link rel="dns-prefetch" href="//s2.wp.com"> 
  <link rel="dns-prefetch" href="//s1.wp.com"> 
  <link rel="dns-prefetch" href="//s0.wp.com"> 
  <link rel="dns-prefetch" href="//s.pubmine.com"> 
  <link rel="dns-prefetch" href="//x.bidswitch.net"> 
  <link rel="dns-prefetch" href="//static.criteo.net"> 
  <link rel="dns-prefetch" href="//ib.adnxs.com"> 
  <link rel="dns-prefetch" href="//aax.amazon-adsystem.com"> 
  <link rel="dns-prefetch" href="//bidder.criteo.com"> 
  <link rel="dns-prefetch" href="//cas.criteo.com"> 
  <link rel="dns-prefetch" href="//gum.criteo.com"> 
  <link rel="dns-prefetch" href="//ads.pubmatic.com"> 
  <link rel="dns-prefetch" href="//gads.pubmatic.com"> 
  <link rel="dns-prefetch" href="//tpc.googlesyndication.com"> 
  <link rel="dns-prefetch" href="//ad.doubleclick.net"> 
  <link rel="dns-prefetch" href="//googleads.g.doubleclick.net"> 
  <link rel="dns-prefetch" href="//www.googletagservices.com"> 
  <link rel="dns-prefetch" href="//cdn.switchadhub.com"> 
  <link rel="dns-prefetch" href="//delivery.g.switchadhub.com"> 
  <link rel="dns-prefetch" href="//delivery.swid.switchadhub.com"> 
  <link rel="alternate" type="application/rss+xml" title="DuyHai's Java Blog » Feed" href="https://doanduyhai.wordpress.com/feed/"> 
  <link rel="alternate" type="application/rss+xml" title="DuyHai's Java Blog » Comments Feed" href="https://doanduyhai.wordpress.com/comments/feed/"> 
  <link rel="alternate" type="application/rss+xml" title="DuyHai's Java Blog » ReCaptcha login form with Spring&nbsp;Security Comments Feed" href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/feed/"> 
  <script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script> 
  <script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s0.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1505864856h&ver=4.8.2"}};
			!function(a,b,c){function d(a){var b,c,d,e,f=String.fromCharCode;if(!k||!k.fillText)return!1;switch(k.clearRect(0,0,j.width,j.height),k.textBaseline="top",k.font="600 32px Arial",a){case"flag":return k.fillText(f(55356,56826,55356,56819),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,56826,8203,55356,56819),0,0),c=j.toDataURL(),b!==c&&(k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447),0,0),b=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447),0,0),c=j.toDataURL(),b!==c);case"emoji4":return k.fillText(f(55358,56794,8205,9794,65039),0,0),d=j.toDataURL(),k.clearRect(0,0,j.width,j.height),k.fillText(f(55358,56794,8203,9794,65039),0,0),e=j.toDataURL(),d!==e}return!1}function e(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i,j=b.createElement("canvas"),k=j.getContext&&j.getContext("2d");for(i=Array("flag","emoji4"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script> 
  <style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style> 
  <link rel="stylesheet" id="all-css-0-1" href="https://s2.wp.com/_static/??-eJyNUdluAzEI/KFSa9Oqx0PVb/FBHRJsLONNlL+vt6uoOSqrLxYDM4wBcyzgJTfMzaQZCs+Rsppj8ZJAEzGebtCjV30wf8uY9qhmh61Yv4cfdEd3LPHXR2qwQU1kcZb/x+0FrKWSIhw2o99UZNswQBFtN2gk81Kx51OxbWEkDGSRMXXaSJbKy1m1hNu+gaHNulTnSkVV6G+iOUHbdqN73Zo2ZXYX4xttJ8ahB4WIfXYVT5aBOuUarGIyWdpaPAejrhEFWLxtJPkKwBdbquOTLCftYTSddQEX0Wf6mJ7fXzdv0/Q07b4BbOT64A==" type="text/css" media="all"> 
  <link rel="stylesheet" id="print-css-1-1" href="https://s0.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h" type="text/css" media="print"> 
  <link rel="stylesheet" id="all-css-2-1" href="https://s2.wp.com/_static/??-eJx9i9EKwjAMRX/IGoVN54P4LVnp2kialCbD3xcfRGTi0z0XzoFHC1HFkzjUNTReM4kBRieVGfuH9tFsB7/1puZhYaQOVrCT5Pf+q0wjIQfWrN9nE3lJNRmUATLrjPwSbvV6HC6H83Qap/H+BMWZScE=" type="text/css" media="all"> 
  <script type="text/javascript">
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script> 
  <script type="text/javascript" src="https://s1.wp.com/_static/??-eJyFj90KwjAMhV/IrAw6xQvxWWoXS2r/bNoNfXo70At1KARCTr4cTsScgIJ2dUQWttW1Yr49W2d5I34B4MlkVbDzFF6wjqFgKAvr44kcQmXMyjStGZ3jCpciF4/MDVrZvkeiMBHOfzGLJSl9gYxM9y9XXyG5aiiwyOjaAyMsGT6mdnX0h17uh36Qcre1DyuucHk="></script> 
  <link rel="stylesheet" id="all-css-0-2" href="https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style.css?m=1377793621h" type="text/css" media="all"> 
  <!--[if lt IE 8]>
<link rel='stylesheet' id='highlander-comments-ie7-css'  href='https://s1.wp.com/wp-content/mu-plugins/highlander-comments/style-ie7.css?m=1351637563h&#038;ver=20110606' type='text/css' media='all' />
<![endif]--> 
  <link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://doanduyhai.wordpress.com/xmlrpc.php?rsd"> 
  <link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml"> 
  <link rel="prev" title="Design Pattern: the Asynchronous&nbsp;Dispatcher" href="https://doanduyhai.wordpress.com/2012/08/04/design-pattern-the-asynchronous-dispatcher/"> 
  <link rel="next" title="Feedback from SF Cassandra&nbsp;Summit" href="https://doanduyhai.wordpress.com/2014/09/17/feedback-from-sf-cassandra-summit/"> 
  <meta name="generator" content="WordPress.com"> 
  <link rel="canonical" href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/"> 
  <link rel="shortlink" href="http://wp.me/p1In1r-pY"> 
  <link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/?format=json&amp;url=https%3A%2F%2Fdoanduyhai.wordpress.com%2F2012%2F08%2F26%2Frecaptcha-login-form-with-spring-security%2F&amp;for=wpcom-auto-discovery">
  <link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/?format=xml&amp;url=https%3A%2F%2Fdoanduyhai.wordpress.com%2F2012%2F08%2F26%2Frecaptcha-login-form-with-spring-security%2F&amp;for=wpcom-auto-discovery"> 
  <!-- Jetpack Open Graph Tags --> 
  <meta property="og:type" content="article"> 
  <meta property="og:title" content="ReCaptcha login form with Spring Security"> 
  <meta property="og:url" content="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/"> 
  <meta property="og:description" content="Today I’ll show you how to customize Spring Security to create a login form with ReCaptcha verification The captcha is based on Google ReCaptcha plugin. More info on ReCaptcha here"> 
  <meta property="article:published_time" content="2012-08-26T14:37:29+00:00"> 
  <meta property="article:modified_time" content="2012-08-26T15:19:52+00:00"> 
  <meta property="og:site_name" content="DuyHai's Java Blog"> 
  <meta property="og:image" content="https://doanduyhai.files.wordpress.com/2012/08/recaptcha_login.png"> 
  <meta property="og:locale" content="en_US"> 
  <meta name="twitter:site" content="@wordpressdotcom"> 
  <meta name="twitter:text:title" content="ReCaptcha login form with Spring&nbsp;Security"> 
  <meta name="twitter:image" content="https://doanduyhai.files.wordpress.com/2012/08/recaptcha_login.png?w=240"> 
  <meta name="twitter:card" content="summary"> 
  <meta property="fb:app_id" content="249643311490"> 
  <meta property="article:publisher" content="https://www.facebook.com/WordPresscom"> 
  <link rel="shortcut icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48"> 
  <link rel="icon" type="image/x-icon" href="https://s2.wp.com/i/favicon.ico" sizes="16x16 24x24 32x32 48x48"> 
  <link rel="apple-touch-icon-precomposed" href="https://s0.wp.com/i/webclip.png"> 
  <link rel="openid.server" href="https://doanduyhai.wordpress.com/?openidserver=1"> 
  <link rel="openid.delegate" href="https://doanduyhai.wordpress.com/"> 
  <link rel="search" type="application/opensearchdescription+xml" href="https://doanduyhai.wordpress.com/osd.xml" title="DuyHai's Java Blog"> 
  <link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com"> 
  <meta name="theme-color" content="#000000"> 
  <style id="wpcom-hotfix-masterbar-style">
			@media screen and (min-width: 783px) {
				#wpadminbar .quicklinks li#wp-admin-bar-my-account.with-avatar > a img {
					margin-top: 5px;
				}
			}
		</style> 
  <meta name="application-name" content="DuyHai's Java Blog">
  <meta name="msapplication-window" content="width=device-width;height=device-height">
  <meta name="msapplication-tooltip" content="Just another random Java blog">
  <meta name="msapplication-task" content="name=Subscribe;action-uri=https://doanduyhai.wordpress.com/feed/;icon-uri=https://s2.wp.com/i/favicon.ico">
  <meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s2.wp.com/i/favicon.ico">
  <meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico">
  <meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico">
  <meta name="title" content="ReCaptcha login form with Spring&nbsp;Security | DuyHai's Java Blog on WordPress.com"> 
  <meta name="description" content="Today I'll show you how to customize Spring Security to create a login form with ReCaptcha verification The captcha is based on Google ReCaptcha plugin. More info on ReCaptcha here The following implementation is based on Spring MVC &amp; ThymeLeaf. If you are using another web framework, you'll need to adapt a little bit the…"> 
  <style type="text/css">
			#header h1,
			#header h1 a,
			#header h1 a:visited,
			#header h4,
			#header h4 a,
			#header h4 a:visited,
			.header-left {
				color: #333333;
			}
		</style> 
  <style type="text/css" id="custom-background-css">
body.custom-background { background-color: #000000; }
</style> 
  <script type="text/javascript">
		var __ATA_PP = { pt: 1, ht: 0, tn: 'enterprise', amp: false };
		</script> 
  <script type="text/javascript" src="//s.pubmine.com/head.js"></script> 
  <script type="text/javascript" src="https://static.criteo.net/js/ld/publishertag.js"></script>
  <link rel="amphtml" href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/amp/">
  <style type="text/css" id="syntaxhighlighteranchor"></style> 
  <script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script> 
  <script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script> 
 </head> 
 <body class="post-template-default single single-post postid-1610 single-format-standard custom-background mp6 customizer-styles-applied highlander-enabled highlander-light"> 
  <div id="header"> 
   <div class="header-left"> 
    <h4><a href="https://doanduyhai.wordpress.com/">DuyHai's Java Blog</a></h4> 
    <p id="description">Just another random Java blog</p> 
   </div> 
   <div class="header-right"> 
    <form method="get" id="searchform" action="https://doanduyhai.wordpress.com/"> 
     <div>
      <label class="hidden" for="s">Search:</label> 
      <input type="text" value="" name="s" id="s"> 
      <input type="submit" id="searchsubmit" value="Go">
     </div> 
    </form> 
   </div> 
  </div> 
  <div id="access"> 
   <div id="nav"> 
    <div id="supernav" class="navleft nav"> 
     <div class="menu-topmenu-container">
      <ul id="menu-topmenu" class="menu">
       <li id="menu-item-563" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-563"><a href="https://doanduyhai.wordpress.com/">Home</a></li> 
       <li id="menu-item-564" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-564"><a href="https://doanduyhai.wordpress.com/about/">About</a></li> 
      </ul>
     </div> 
    </div> 
    <div class="navright"> 
     <a class="rsslink" rel="nofollow" href="https://doanduyhai.wordpress.com/feed/">Posts</a> 
     <a class="rsslink" rel="nofollow" href="https://doanduyhai.wordpress.com/comments/feed/">Comments</a> 
    </div> 
   </div> 
   <div id="subnav" class="subnav nav"> 
    <div class="menu-mainmenu-container">
     <ul id="menu-mainmenu" class="menu">
      <li id="menu-item-1275" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1275"><a href="https://doanduyhai.wordpress.com/category/nosql-bigdata/">NoSQL – BigData</a></li> 
      <li id="menu-item-568" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-568"><a href="https://doanduyhai.wordpress.com/category/java/">Java</a> 
       <ul class="sub-menu"> 
        <li id="menu-item-569" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-569"><a href="https://doanduyhai.wordpress.com/category/java/core-java/">Core Java</a></li> 
        <li id="menu-item-1379" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1379"><a href="https://doanduyhai.wordpress.com/category/java/lambda-expression/">Lambda Expression</a></li> 
       </ul> </li> 
      <li id="menu-item-565" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-has-children menu-item-565"><a href="https://doanduyhai.wordpress.com/category/spring/">Spring</a> 
       <ul class="sub-menu"> 
        <li id="menu-item-566" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-566"><a href="https://doanduyhai.wordpress.com/category/spring/aop/">AOP</a></li> 
        <li id="menu-item-567" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-567"><a href="https://doanduyhai.wordpress.com/category/spring/transactional/">Transactional</a></li> 
        <li id="menu-item-590" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-590"><a href="https://doanduyhai.wordpress.com/category/spring/persistencecontext/">PersistenceContext</a></li> 
        <li id="menu-item-691" class="menu-item menu-item-type-taxonomy menu-item-object-category current-post-ancestor current-menu-parent current-post-parent menu-item-691"><a href="https://doanduyhai.wordpress.com/category/spring/security/">Security</a></li> 
        <li id="menu-item-1226" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1226"><a href="https://doanduyhai.wordpress.com/category/spring/cache/">Cache</a></li> 
       </ul> </li> 
      <li id="menu-item-581" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-581"><a href="https://doanduyhai.wordpress.com/category/jpahibernate/">JPA/Hibernate</a> 
       <ul class="sub-menu"> 
        <li id="menu-item-656" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-656"><a href="https://doanduyhai.wordpress.com/category/jpahibernate/global-conversation/">Global Conversation</a></li> 
        <li id="menu-item-652" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-652"><a href="https://doanduyhai.wordpress.com/category/jpahibernate/temporary-conversation/">Temporary Conversation</a></li> 
       </ul> </li> 
      <li id="menu-item-583" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-583"><a href="https://doanduyhai.wordpress.com/category/aspectj/">AspectJ</a> 
       <ul class="sub-menu"> 
        <li id="menu-item-584" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-584"><a href="https://doanduyhai.wordpress.com/category/aspectj/instanciation-model/">Instanciation Model</a></li> 
        <li id="menu-item-585" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-585"><a href="https://doanduyhai.wordpress.com/category/aspectj/inter-type-declaration/">Inter Type Declaration</a></li> 
        <li id="menu-item-586" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-586"><a href="https://doanduyhai.wordpress.com/category/aspectj/non-kinded-pointcut/">Non-Kinded Pointcut</a></li> 
        <li id="menu-item-587" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-587"><a href="https://doanduyhai.wordpress.com/category/aspectj/precedence/">Precedence</a></li> 
        <li id="menu-item-588" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-588"><a href="https://doanduyhai.wordpress.com/category/aspectj/spring-integration/">Spring Integration</a></li> 
       </ul> </li> 
      <li id="menu-item-589" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-589"><a href="https://doanduyhai.wordpress.com/category/regular-expressions/">Regular Expressions</a></li> 
      <li id="menu-item-763" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-763"><a href="https://doanduyhai.wordpress.com/category/web/">Web</a> 
       <ul class="sub-menu"> 
        <li id="menu-item-765" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-765"><a href="https://doanduyhai.wordpress.com/category/web/spring-mvc/">Spring MVC</a></li> 
        <li id="menu-item-1552" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1552"><a href="https://doanduyhai.wordpress.com/category/web/gwt/">GWT</a></li> 
       </ul> </li> 
      <li id="menu-item-989" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-989"><a href="https://doanduyhai.wordpress.com/category/architecture/">Architecture</a></li> 
      <li id="menu-item-1091" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-has-children menu-item-1091"><a href="https://doanduyhai.wordpress.com/category/ria/">RIA</a> 
       <ul class="sub-menu"> 
        <li id="menu-item-1092" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1092"><a href="https://doanduyhai.wordpress.com/category/ria/jquery/">JQUERY</a></li> 
        <li id="menu-item-1152" class="menu-item menu-item-type-taxonomy menu-item-object-category menu-item-1152"><a href="https://doanduyhai.wordpress.com/category/ria/html5/">HTML5</a></li> 
       </ul> </li> 
     </ul>
    </div> 
   </div> 
  </div> 
  <div id="wrap"> 
   <div id="content"> 
    <div id="content-left"> 
     <div id="nav-above"> 
      <div class="nav-previous">
       <a href="https://doanduyhai.wordpress.com/2012/08/04/design-pattern-the-asynchronous-dispatcher/" rel="prev"><span class="meta-nav">?</span> Design Pattern: the Asynchronous&nbsp;Dispatcher</a>
      </div> 
      <div class="nav-next">
       <a href="https://doanduyhai.wordpress.com/2014/09/17/feedback-from-sf-cassandra-summit/" rel="next">Feedback from SF Cassandra&nbsp;Summit <span class="meta-nav">?</span></a>
      </div> 
     </div> 
     <div class="post-1610 post type-post status-publish format-standard hentry category-security category-spring"> 
      <div class="entry"> 
       <h1>ReCaptcha login form with Spring&nbsp;Security</h1> 
       <div class="post-info"> 
        <p> <span class="time">26/08/2012</span> <span class="post-comments"><a href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/#comments">1 Comment</a></span> </p> 
       </div> 
       <p>Today I’ll show you how to customize Spring Security to create a login form with ReCaptcha verification</p> 
       <p> The captcha is based on <strong>Google ReCaptcha</strong> plugin. More info on ReCaptcha <a href="http://www.google.com/recaptcha" title="http://www.google.com/recaptcha" target="_blank">here</a> </p> 
       <p><span id="more-1610"></span></p> 
       <blockquote>
        <p>The following implementation is based on <strong>Spring MVC</strong> &amp; <strong>ThymeLeaf</strong>. If you are using another web framework, you’ll need to adapt a little bit the code</p>
       </blockquote> 
       <h1>I Features description</h1> 
       <p> The final login form looks like this:</p> 
       <p><a href="https://doanduyhai.files.wordpress.com/2012/08/recaptcha_login.png"><img data-attachment-id="1612" data-permalink="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/recaptcha_login/" data-orig-file="https://doanduyhai.files.wordpress.com/2012/08/recaptcha_login.png?w=630" data-orig-size="385,429" data-comments-opened="1" data-image-meta="{&quot;aperture&quot;:&quot;0&quot;,&quot;credit&quot;:&quot;&quot;,&quot;camera&quot;:&quot;&quot;,&quot;caption&quot;:&quot;&quot;,&quot;created_timestamp&quot;:&quot;0&quot;,&quot;copyright&quot;:&quot;&quot;,&quot;focal_length&quot;:&quot;0&quot;,&quot;iso&quot;:&quot;0&quot;,&quot;shutter_speed&quot;:&quot;0&quot;,&quot;title&quot;:&quot;&quot;}" data-image-title="ReCaptcha_Login" data-image-description="" data-medium-file="https://doanduyhai.files.wordpress.com/2012/08/recaptcha_login.png?w=630?w=269" data-large-file="https://doanduyhai.files.wordpress.com/2012/08/recaptcha_login.png?w=630?w=385" src="https://doanduyhai.files.wordpress.com/2012/08/recaptcha_login.png?w=630" alt="ReCaptcha_Login" title="ReCaptcha_Login" class="aligncenter size-full wp-image-1612" srcset="https://doanduyhai.files.wordpress.com/2012/08/recaptcha_login.png 385w, https://doanduyhai.files.wordpress.com/2012/08/recaptcha_login.png?w=135 135w, https://doanduyhai.files.wordpress.com/2012/08/recaptcha_login.png?w=269 269w" sizes="(max-width: 385px) 100vw, 385px"></a></p> 
       <p> Below is the functional requirements for such a login form:</p> 
       <ul> 
        <li>Do not attempt to verify ReCaptcha response if the user input is blank</li> 
        <li>Check ReCaptcha first before any attempt to verify login/password</li> 
        <li>Return a default error message if the Recaptcha verification fails. Pre-fill the login field with previous value but reset the password field</li> 
        <li>Return a default error message if login/password verification fails</li> 
       </ul> 
       <p> The requirements are quite simple. I will not explain in details the ReCaptcha verification process because it is out of the scope of this post. You can have more details on their <a href="https://developers.google.com/recaptcha/?hl=fr" title="https://developers.google.com/recaptcha/?hl=fr" target="_blank">documentation</a> page</p> 
       <p>&nbsp;</p> 
       <h1>II Code Implementation</h1> 
       <h3>A Custom Authentication filter</h3> 
       <p> Let’s see how we can implements the requirement with a custom Authentication filter, extending the existing <strong>UsernamePasswordAuthenticationFilter</strong></p> 
       <pre class="brush: java; highlight: [10,85]; title: ; wrap-lines: false; notranslate" title="">
public class ReCaptchaAuthenticationFilter extends UsernamePasswordAuthenticationFilter implements InitializingBean
{
	private final String CAPTCHA_CHALLENGE_FIELD = "recaptcha_challenge_field";
	private final String CAPTCHA_RESPONSE_FIELD = "recaptcha_response_field";
	private final ReCaptchaImpl reCaptcha;
	private String privateKey;
	private final Logger log = LoggerFactory.getLogger(ReCaptchaAuthenticationFilter.class);

	public ReCaptchaAuthenticationFilter() {
		this.reCaptcha = new ReCaptchaImpl();
	}

	public Authentication attemptAuthentication(HttpServletRequest request, HttpServletResponse response) throws AuthenticationException
	{

		String reCaptchaChallenge = request.getParameter(CAPTCHA_CHALLENGE_FIELD);
		String reCaptchaResponse = request.getParameter(CAPTCHA_RESPONSE_FIELD);
		String remoteAddress = request.getRemoteAddr();

		if (!StringUtils.isEmpty(reCaptchaChallenge))
		{
			log.debug("ReCaptcha Challenge not null");
			if (!StringUtils.isEmpty(reCaptchaResponse))
			{
				log.debug("ReCaptcha Answser not null, call ReCaptcha to verify it");
				ReCaptchaResponse reCaptchaCheck = reCaptcha.checkAnswer(remoteAddress, reCaptchaChallenge, reCaptchaResponse);

				if (reCaptchaCheck.isValid())
				{
					log.debug("ReCaptcha answer is valid, attempt authentication");
					return super.attemptAuthentication(request, response);
				}
				else
				{
					this.reCaptchaError(request, response, "ReCaptcha failed : " + reCaptchaCheck.getErrorMessage());
					return null;
				}
			}
			else
			{
				this.reCaptchaError(request, response, "ReCaptcha failed : empty answer");
				return null;
			}

		}
		else
		{
			return super.attemptAuthentication(request, response);
		}
	}

	private void reCaptchaError(HttpServletRequest request, HttpServletResponse response, String errorMsg)
	{
		log.error("ReCaptcha failed : " + errorMsg);
		try
		{

			RequestDispatcher dispatcher = request.getRequestDispatcher("/login?error=2");

			dispatcher.forward(request, response);
		}
		catch (ServletException e)
		{
			throw new AuthenticationServiceException("ReCaptcha failed : " + errorMsg);
		}
		catch (IOException e)
		{
			throw new AuthenticationServiceException("Recaptcha failed : " + errorMsg);
		}
	}

	public void setPrivateKey(String privateKey)
	{
		this.privateKey = privateKey;
	}

	public void afterPropertiesSet()
	{
		if (StringUtils.isEmpty(this.privateKey))
		{
			throw new IllegalArgumentException("The 'privateKey' should be set for the bean type 'ReCaptchaAuthenticationFilter'");
		}
		else
		{
			reCaptcha.setPrivateKey(this.privateKey);
		}
	}
}
</pre> 
       <p> The implementation is quite simple.</p> 
       <ul> 
        <li>If <strong>CAPTCHA_CHALLENGE_FIELD</strong> is blank (the requested page is not the login page), call the <strong>super</strong>.<em>attemptAuthentication()</em> method</li> 
        <li> Else<p></p> 
         <ul> 
          <li> If the <strong>CAPTCHA_RESPONSE_FIELD</strong> is empty (the user does not answer the <strong>ReCaptcha</strong>), forward the user to the login page with the <strong>error code 2</strong> </li> 
          <li> Else<p></p> 
           <ul> 
            <li>If the <strong>ReCaptcha</strong> verification fails, forward the user to the login page with the <strong>error code 2</strong></li> 
            <li>Else call the <strong>super</strong>.<em>attemptAuthentication()</em> method</li> 
           </ul> </li> 
         </ul> </li> 
       </ul> 
       <p>Please note the injection of the <strong>private key</strong> for <strong>ReCaptcha</strong> plugin and the initialization of the <strong>ReCaptchaImpl</strong> instance in the constructor.</p> 
       <p>&nbsp;</p> 
       <h3>B Spring MVC Controller for login page</h3> 
       <pre class="brush: java; highlight: [7,9,11,14]; title: ; wrap-lines: false; notranslate" title="">
@RequestMapping("/login")
public String loginPage(@RequestParam(value = "error", required = false) Integer errorCode, Model model, HttpServletRequest servletRequest)
{
	log.info("Is current device mobile : " + currentDevice.isMobile());
	if (errorCode != null)
	{
		if (errorCode.equals(1))
		{
			model.addAttribute("authenticationError", true);
		}
		else if (errorCode.equals(2))
		{
			String login = servletRequest.getParameter("j_username");
			model.addAttribute("reCaptchaError", true);
			model.addAttribute("login", login);
		}
	}

	return "pages/login.html";
}
</pre> 
       <p> In the controller class, we extract the request parameter <strong>error</strong> (if any) and, depending on its value, set the <em>authenticationError</em> or <em>reCaptchaError</em> value to the model to be passed to the view handler.</p> 
       <p> Please notice the <strong>required</strong> = <em>false</em> setting on the <em>@RequestParam(<strong>value</strong> = “error”, <strong>required</strong> = false)</em>. If not set (default value is <strong>true</strong>) <strong>Spring MVC</strong> will raise an error if the parameter is not found, which we don’t want.</p> 
       <p>&nbsp;</p> 
       <h3>C Login form design</h3> 
       <p> Below is the design of the login form. Please notice that I use <a href="http://www.thymeleaf.org/" title="http://www.thymeleaf.org/" target="_blank">ThymeLeaf</a> and <a href="http://twitter.github.com/bootstrap/" title="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>. </p> 
       <pre class="brush: xml; highlight: [5,11]; title: ; wrap-lines: false; notranslate" title="">
            &lt;h1&gt;Authentication&lt;/h1&gt;
            &lt;form action="authentication" th:action="@{/authentication}" method="post" class="well center"&gt;
            	
            	&lt;br th:if="${authenticationError}"/&gt;
            	&lt;div th:if="${authenticationError}" class="alert alert-error"&gt;
            		Incorrect Login/Password
            	&lt;/div&gt;
            	&lt;br th:if="${authenticationError}"/&gt;
            	
            	&lt;br th:if="${reCaptchaError}"/&gt;
            	&lt;div th:if="${reCaptchaError}" class="alert alert-error"&gt;
            		Incorrect reCaptcha
            	&lt;/div&gt;
            	&lt;br th:if="${reCaptchaError}"/&gt;
            	
                &lt;fieldset&gt;
                    &lt;label&gt;Login :&lt;/label&gt; 
                    	&lt;input id="j_username" name="j_username"
                        	type="text" required="required" autofocus="autofocus" class="input span3"
                        	th:value="${login}"
                            placeholder="Your login..."/&gt;
                    &lt;label&gt;Password :&lt;/label&gt; 
                    	&lt;input id="j_password" name="j_password"
                        	type="password" required="required" class="input span3"
                            placeholder="Your password..."/&gt;
				&lt;label class="checkbox left"&gt;
	                &lt;input type="checkbox"
	                       name="_spring_security_remember_me" 
	                       id="_spring_security_remember_me"
	                       value="true" /&gt;&amp;nbsp;Remember me
            	&lt;/label&gt;
                                                     
                &lt;/fieldset&gt;
                &lt;br/&gt;
                Additional anti-bot authentication
                &lt;br/&gt;
                &lt;script type="text/javascript"
     				src="http://www.google.com/recaptcha/api/challenge?k=your_public_recaptcha_key"&gt;
                &lt;/script&gt;
                &lt;noscript&gt;
					&lt; iframe src="http://www.google.com/recaptcha/api/noscript?k=your_public_recaptcha_key" height="300" width="500" &gt; &lt; /iframe &gt;
					&lt;br/&gt;
					&lt;textarea name="recaptcha_challenge_field" rows="3" cols="40"&gt;&lt;/textarea&gt;
					&lt;input type="hidden" name="recaptcha_response_field" value="manual_challenge"&gt;&lt;/input&gt;
				&lt;/noscript&gt;
				&lt;br/&gt;
				&lt;button type="submit" class="btn btn-success"&gt;Authenticate&lt;/button&gt;
            &lt;/form&gt;
</pre> 
       <p> Notice the check for <em>authenticationError</em> and <em>reCaptchaError</em> attribute for error message display (<strong>lines 5 &amp; 11</strong>)<br> &nbsp;</p> 
       <h1>III Spring Security configuration</h1> 
       <h3>A Full XML config</h3> 
       <p> Below is the full XML config to use the above custom <strong>ReCaptchaAuthenticationFilter</strong></p> 
       <pre class="brush: xml; highlight: [12,15]; title: ; wrap-lines: false; notranslate" title="">
	&lt;bean id="authenticationProcessingFilter" class="fr.doan.security.ReCaptchaAuthenticationFilter"&gt;
  		&lt;property name="authenticationManager" ref="authenticationManager"/&gt;
  		&lt;property name="filterProcessesUrl" value="/authentication"/&gt;
  		&lt;property name="authenticationSuccessHandler"&gt;
	        &lt;bean class="org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler"&gt;
	        	&lt;property name="alwaysUseDefaultTargetUrl" value="true"/&gt;
	            &lt;property name="defaultTargetUrl" value="/home" /&gt;
	        &lt;/bean&gt;
	    &lt;/property&gt;
	    &lt;property name="authenticationFailureHandler"&gt;
	    	&lt;bean class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler"&gt;
	            &lt;property name="defaultFailureUrl" value="/login?error=1" /&gt;
	        &lt;/bean&gt;
	    &lt;/property&gt;
	    &lt;property name="privateKey" value="your_private_recaptcha_key"/&gt;
	&lt;/bean&gt; 
</pre> 
       <p> The configuration is quite straightforward. The only major difference with a “classic” <strong>UsernamePasswordAuthenticationFilter</strong> is the injection of the privateKey (<strong>line 15</strong>).</p> 
       <p>&nbsp;</p> 
       <h3>B Spring Security namespace config</h3> 
       <p>If you’re using the Spring Security namespace, the configuration is a little bit trickier</p> 
       <pre class="brush: xml; highlight: [3,4,7,8,9,10,11,12,13,20,25,26,42]; title: ; wrap-lines: false; notranslate" title="">
   &lt;http auto-config="false" 
    	use-expressions="true"
    	entry-point-ref="loginUrlAuthenticationEntryPoint"&gt;
    	&lt;custom-filter ref="authenticationProcessingFilter" position="FORM_LOGIN_FILTER"/&gt;
        &lt;intercept-url pattern="/**" access="isAuthenticated()" /&gt;
        &lt;!-- 
        &lt;form-login
                login-processing-url="/authentication"
                login-page="/login"
                authentication-failure-url="/login?error=1"
                default-target-url="/home"
                always-use-default-target="true"
		/&gt;
		 --&gt;
        &lt;remember-me user-service-ref="userDetailsService"/&gt;
        &lt;logout logout-url="/logout"
                logout-success-url="/login"/&gt;
    &lt;/http&gt;
	
	&lt;beans:bean id="loginUrlAuthenticationEntryPoint"
  		class="org.springframework.security.web.authentication.LoginUrlAuthenticationEntryPoint"&gt;
  		&lt;beans:property name="loginFormUrl" value="/login" /&gt;
	&lt;/beans:bean&gt;
	
	&lt;beans:bean id="authenticationProcessingFilter" class="fr.doan.security.ReCaptchaAuthenticationFilter"&gt;
  		&lt;beans:property name="authenticationManager" ref="authenticationManager"/&gt;
  		&lt;beans:property name="filterProcessesUrl" value="/authentication"/&gt;
  		&lt;beans:property name="authenticationSuccessHandler"&gt;
	        &lt;beans:bean class="org.springframework.security.web.authentication.SavedRequestAwareAuthenticationSuccessHandler"&gt;
	        	&lt;beans:property name="alwaysUseDefaultTargetUrl" value="true"/&gt;
	            &lt;beans:property name="defaultTargetUrl" value="/home" /&gt;
	        &lt;/beans:bean&gt;
	    &lt;/beans:property&gt;
	    &lt;beans:property name="authenticationFailureHandler"&gt;
	    	&lt;beans:bean class="org.springframework.security.web.authentication.SimpleUrlAuthenticationFailureHandler"&gt;
	            &lt;beans:property name="defaultFailureUrl" value="/login?error=1" /&gt;
	        &lt;/beans:bean&gt;
	    &lt;/beans:property&gt;
	    &lt;beans:property name="privateKey" value="your_private_recaptcha_keyword"/&gt;
	&lt;/beans:bean&gt; 
		
    &lt;authentication-manager alias="authenticationManager"&gt;
        &lt;authentication-provider user-service-ref="userDetailsService"/&gt;
    &lt;/authentication-manager&gt;
</pre> 
       <p>First, we need to declare the same <strong>ReCaptchaAuthenticationFilter</strong> as previously (<strong>line 25</strong>). No big change here.</p> 
       <p> To inject this filter into the security chain, we need to</p> 
       <ul> 
        <li>Add a custom filter at the same position as the <strong>FORM_LOGIN_FILTER</strong></li> 
        <li>Remove the <strong>&lt;form-login&gt;</strong> tag (<strong>lines 7 to 13</strong>) otherwise you’ll end up having the <strong>ReCaptchaAuthenticationFilter</strong> and the <strong>UsernamePasswordAuthenticationFilter</strong> at the same time ( the <strong>&lt;form-login&gt;</strong> tag is translated by <strong>Spring Security</strong> into a <strong>UsernamePasswordAuthenticationFilter</strong>)</li> 
       </ul> 
       <p> Since the <strong>&lt;form-login&gt;</strong> tag is removed, we need to define an entry point for the login process (<strong>line 3</strong>) by instanciating the <strong>LoginUrlAuthenticationEntryPoint</strong> separately (<strong>line 20</strong>)</p> 
       <p> Last but not least, we need to give an alias to the AuthenticationManager defined with the <strong>&lt;authentication-manager&gt;</strong> tag. By default this tag is read and converted into a bean declaration with the default name <em>‘org.springframework.security.authenticationManager’</em>.</p> 
       <p> Either we use this default name and inject it into our custom <strong>RecaptchaAuthenticationFilter</strong>, or we define an alias and use this alias for injection (<strong>lines 26 &amp; 42</strong>).</p> 
       <p>&nbsp;<br> &nbsp;</p> 
       <style type="text/css">
			div.wpmrec2x{max-width:610px;}
			div.wpmrec2x div.u > div{float:left;margin-right:10px;}
			div.wpmrec2x div.u > div:nth-child(3n){margin-right:0px;}
			</style> 
       <div class="wpcnt"> 
        <div class="wpa wpmrec wpmrec2x"> 
         <span class="wpa-about">Advertisements</span> 
         <div class="u"> 
          <script type="text/javascript" id="s26942">
						(function(g,$){if("undefined"!=typeof g.__ATA){
							g.__ATA.initAd({collapseEmpty:'after', sectionId:26942, width:300, height:250});
							g.__ATA.initAd({collapseEmpty:'after', sectionId:114160, width:300, height:250});
						}})(window,jQuery);
					</script> 
         </div> 
         <div id="crt-1801980790" style="width:300px;height:250px;"></div> 
         <script type="text/javascript">
		var o = document.getElementById('crt-1801980790');
		if ("undefined"!=typeof Criteo) {
			var p = o.parentNode;
			p.style.setProperty('display', 'inline-block', 'important');
			o.style.setProperty('display', 'block', 'important');
			Criteo.DisplayAcceptableAdIfAdblocked({zoneid:388248,containerid:"crt-1801980790",collapseContainerIfNotAdblocked:true,"callifnotadblocked": function () {var o = document.getElementById('crt-1801980790'); o.style.setProperty('display','none','important');o.style.setProperty('visbility','hidden','important'); } });
		} else {
			o.style.setProperty('display', 'none', 'important');
			o.style.setProperty('visibility', 'hidden', 'important');
		}
		</script> 
         <div id="crt-142209856" style="width:300px;height:250px;"></div> 
         <script type="text/javascript">
		var o = document.getElementById('crt-142209856');
		if ("undefined"!=typeof Criteo) {
			var p = o.parentNode;
			p.style.setProperty('display', 'inline-block', 'important');
			o.style.setProperty('display', 'block', 'important');
			Criteo.DisplayAcceptableAdIfAdblocked({zoneid:837497,containerid:"crt-142209856",collapseContainerIfNotAdblocked:true,"callifnotadblocked": function () {var o = document.getElementById('crt-142209856'); o.style.setProperty('display','none','important');o.style.setProperty('visbility','hidden','important'); } });
		} else {
			o.style.setProperty('display', 'none', 'important');
			o.style.setProperty('visibility', 'hidden', 'important');
		}
		</script> 
        </div> 
       </div>
       <div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled">
        <div class="sharedaddy sd-sharing-enabled">
         <div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing">
          <h3 class="sd-title">Share this:</h3>
          <div class="sd-content">
           <ul>
            <li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-1610" class="share-google-plus-1 sd-button share-icon" href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/?share=google-plus-1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li>
            <li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-1610" class="share-facebook sd-button share-icon" href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/?share=facebook" target="_blank" title="Share on Facebook"><span>Facebook</span></a></li>
            <li class="share-linkedin"><a rel="nofollow" data-shared="sharing-linkedin-1610" class="share-linkedin sd-button share-icon" href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/?share=linkedin" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li>
            <li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-1610" class="share-twitter sd-button share-icon" href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li>
            <li class="share-email"><a rel="nofollow" data-shared="" class="share-email sd-button share-icon" href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/?share=email" target="_blank" title="Click to email"><span>Email</span></a></li>
            <li class="share-end"></li>
           </ul>
          </div>
         </div>
        </div>
        <div class="sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded" id="like-post-wrapper-25351269-1610-59d3d1b761600" data-src="//widgets.wp.com/likes/#blog_id=25351269&amp;post_id=1610&amp;origin=doanduyhai.wordpress.com&amp;obj_id=25351269-1610-59d3d1b761600" data-name="like-post-frame-25351269-1610-59d3d1b761600">
         <h3 class="sd-title">Like this:</h3>
         <div class="likes-widget-placeholder post-likes-widget-placeholder" style="height: 55px;">
          <span class="button"><span>Like</span></span> 
          <span class="loading">Loading...</span>
         </div>
         <span class="sd-text-color"></span>
         <a class="sd-link-color"></a>
        </div> 
        <div id="jp-relatedposts" class="jp-relatedposts"> 
         <h3 class="jp-relatedposts-headline"><em>Related</em></h3> 
        </div>
       </div>
       <div class="clear"></div> 
       <!--
					<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
			xmlns:dc="http://purl.org/dc/elements/1.1/"
			xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
		<rdf:Description rdf:about="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/"
    dc:identifier="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/"
    dc:title="ReCaptcha login form with Spring&nbsp;Security"
    trackback:ping="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/trackback/" />
</rdf:RDF>					--> 
      </div> 
      <div class="post-meta"> 
       <p> <span class="categories">Filed under <a href="https://doanduyhai.wordpress.com/category/spring/security/" rel="category tag">Security</a>, <a href="https://doanduyhai.wordpress.com/category/spring/" rel="category tag">Spring</a></span> </p> 
      </div> 
     </div> 
     <div class="author-box"> 
      <p><img alt="" src="https://0.gravatar.com/avatar/ffa96040bb4211cad1c66f385d8cb77b?s=70&amp;d=identicon&amp;r=G" class="avatar avatar-70" height="70" width="70"><strong>About DuyHai DOAN</strong><br>Cassandra Technical Evangelist. LinkedIn profile : http://fr.linkedin.com/pub/duyhai-doan/2/224/848. Follow me on Twitter: @doanduyhai for latest updates on Cassandra</p> 
     </div> 
     <p></p> 
     <div id="comments"> 
      <h3 id="comments-title">One Response to <em>ReCaptcha login form with Spring&nbsp;Security</em> </h3> 
      <ol class="commentlist snap_preview"> 
       <li class="comment even thread-even depth-1 highlander-comment" id="li-comment-444"> 
        <div id="comment-444"> 
         <div class="comment-author vcard"> 
          <img alt="" src="https://1.gravatar.com/avatar/116511310ca7f786b69eed374df216c6?s=40&amp;d=identicon&amp;r=G" class="avatar avatar-40" height="40" width="40"> 
          <cite class="fn"><a href="http://gravatar.com/geoffreydv" rel="external nofollow" class="url">geoffreydv</a></cite> 
          <span class="says">says:</span> 
         </div> 
         <div class="comment-meta commentmetadata">
          <a href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/#comment-444">11/02/2013 at 09:12</a>
         </div> 
         <div class="comment-body">
          <p>Thanks for this great tutorial. I had to tweak the redirect as it was not working for me. I have changed:</p> 
          <p>RequestDispatcher dispatcher = request.getRequestDispatcher(“/login?error=2”);<br> dispatcher.forward(request, response);</p> 
          <p>to:</p> 
          <p>response.sendRedirect(“/login?error=2”);</p> 
         </div> 
         <div class="reply"> 
          <a rel="nofollow" class="comment-reply-link" href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/?replytocom=444#respond" onclick="return addComment.moveForm( &quot;comment-444&quot;, &quot;444&quot;, &quot;respond&quot;, &quot;1610&quot; )" aria-label="Reply to geoffreydv">Reply</a> 
         </div> 
        </div> </li>
       <!-- #comment-## --> 
      </ol> 
      <div id="respond" class="comment-respond"> 
       <h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="/2012/08/26/recaptcha-login-form-with-spring-security/#respond" style="display:none;">Cancel reply</a></small></h3> 
       <form action="https://doanduyhai.wordpress.com/wp-comments-post.php" method="post" id="commentform" class="comment-form"> 
        <input type="hidden" id="highlander_comment_nonce" name="highlander_comment_nonce" value="1108b94dbf">
        <input type="hidden" name="_wp_http_referer" value="/2012/08/26/recaptcha-login-form-with-spring-security/"> 
        <input type="hidden" name="hc_post_as" id="hc_post_as" value="guest"> 
        <div class="comment-form-field comment-textarea"> 
         <label for="comment">Enter your comment here...</label> 
         <div id="comment-form-comment">
          <textarea id="comment" name="comment" title="Enter your comment here..."></textarea>
         </div> 
        </div> 
        <div id="comment-form-identity"> 
         <div id="comment-form-nascar"> 
          <p>Fill in your details below or click an icon to log in:</p> 
          <ul> 
           <li class="selected" style="display:none;"> <a href="#comment-form-guest" id="postas-guest" title="Guest"> <span></span> </a> </li> 
           <li> <a href="#comment-form-load-service:WordPress.com" id="postas-wordpress" title="WordPress.com"> <span></span> </a> </li> 
           <li> <a href="#comment-form-load-service:Twitter" id="postas-twitter" title="Twitter"> <span></span> </a> </li> 
           <li> <a href="#comment-form-load-service:Facebook" id="postas-facebook" title="Facebook"> <span></span> </a> </li> 
           <li> <iframe id="googleplus-sign-in" name="googleplus-sign-in" src="https://public-api.wordpress.com/connect/?googleplus-sign-in=https%3A%2F%2Fdoanduyhai.wordpress.com" width="24" height="24" scrolling="no" allowtransparency="true" seamless frameborder="0"></iframe> </li> 
          </ul> 
         </div> 
         <div id="comment-form-guest" class="comment-form-service selected"> 
          <div class="comment-form-padder"> 
           <div class="comment-form-avatar"> 
            <a href="https://gravatar.com/site/signup/" target="_blank"> <img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Gravatar" width="25" class="no-grav"> </a> 
           </div> 
           <div class="comment-form-fields"> 
            <div class="comment-form-field comment-form-email"> 
             <label for="email">Email <span class="required">(required)</span> <span class="nopublish">(Address never made public)</span></label> 
             <div class="comment-form-input">
              <input id="email" name="email" type="email" value="">
             </div> 
            </div> 
            <div class="comment-form-field comment-form-author"> 
             <label for="author">Name <span class="required">(required)</span></label> 
             <div class="comment-form-input">
              <input id="author" name="author" type="text" value="">
             </div> 
            </div> 
            <div class="comment-form-field comment-form-url"> 
             <label for="url">Website</label> 
             <div class="comment-form-input">
              <input id="url" name="url" type="url" value="">
             </div> 
            </div> 
           </div> 
          </div> 
         </div> 
         <div id="comment-form-wordpress" class="comment-form-service"> 
          <div class="comment-form-padder"> 
           <div class="comment-form-avatar"> 
            <img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="WordPress.com Logo" width="25" class="no-grav"> 
           </div> 
           <div class="comment-form-fields"> 
            <input type="hidden" name="wp_avatar" id="wordpress-avatar" class="comment-meta-wordpress" value=""> 
            <input type="hidden" name="wp_user_id" id="wordpress-user_id" class="comment-meta-wordpress" value=""> 
            <input type="hidden" name="wp_access_token" id="wordpress-access_token" class="comment-meta-wordpress" value=""> 
            <p class="comment-form-posting-as pa-wordpress"><strong></strong> You are commenting using your WordPress.com account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'wordpress' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p> 
           </div> 
          </div> 
         </div> 
         <div id="comment-form-twitter" class="comment-form-service"> 
          <div class="comment-form-padder"> 
           <div class="comment-form-avatar"> 
            <img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Twitter picture" width="25" class="no-grav"> 
           </div> 
           <div class="comment-form-fields"> 
            <input type="hidden" name="twitter_avatar" id="twitter-avatar" class="comment-meta-twitter" value=""> 
            <input type="hidden" name="twitter_user_id" id="twitter-user_id" class="comment-meta-twitter" value=""> 
            <input type="hidden" name="twitter_access_token" id="twitter-access_token" class="comment-meta-twitter" value=""> 
            <p class="comment-form-posting-as pa-twitter"><strong></strong> You are commenting using your Twitter account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'twitter' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p> 
           </div> 
          </div> 
         </div> 
         <div id="comment-form-facebook" class="comment-form-service"> 
          <div class="comment-form-padder"> 
           <div class="comment-form-avatar"> 
            <img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Facebook photo" width="25" class="no-grav"> 
           </div> 
           <div class="comment-form-fields"> 
            <input type="hidden" name="fb_avatar" id="facebook-avatar" class="comment-meta-facebook" value=""> 
            <input type="hidden" name="fb_user_id" id="facebook-user_id" class="comment-meta-facebook" value=""> 
            <input type="hidden" name="fb_access_token" id="facebook-access_token" class="comment-meta-facebook" value=""> 
            <p class="comment-form-posting-as pa-facebook"><strong></strong> You are commenting using your Facebook account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'facebook' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p> 
           </div> 
          </div> 
         </div> 
         <div id="comment-form-googleplus" class="comment-form-service"> 
          <div class="comment-form-padder"> 
           <div class="comment-form-avatar"> 
            <img src="https://1.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=25&amp;d=identicon&amp;forcedefault=y&amp;r=G" alt="Google+ photo" width="25" class="no-grav"> 
           </div> 
           <div class="comment-form-fields"> 
            <input type="hidden" name="googleplus_avatar" id="googleplus-avatar" class="comment-meta-googleplus" value=""> 
            <input type="hidden" name="googleplus_user_id" id="googleplus-user_id" class="comment-meta-googleplus" value=""> 
            <input type="hidden" name="googleplus_access_token" id="googleplus-access_token" class="comment-meta-googleplus" value=""> 
            <p class="comment-form-posting-as pa-googleplus"><strong></strong> You are commenting using your Google+ account. <span class="comment-form-log-out">(&nbsp;<a href="javascript:HighlanderComments.doExternalLogout( 'googleplus' );">Log&nbsp;Out</a>&nbsp;/&nbsp;<a href="#" onclick="javascript:HighlanderComments.switchAccount();return false;">Change</a>&nbsp;)</span></p> 
           </div> 
          </div> 
         </div> 
         <div id="comment-form-load-service" class="comment-form-service"> 
          <div class="comment-form-posting-as-cancel">
           <a href="javascript:HighlanderComments.cancelExternalWindow();">Cancel</a>
          </div> 
          <p>Connecting to %s</p> 
         </div> 
        </div> 
        <script type="text/javascript">
var highlander_expando_javascript = function(){
	var input = document.createElement( 'input' ),
	    comment = jQuery( '#comment' );

	if ( 'placeholder' in input ) {
		comment.attr( 'placeholder', jQuery( '.comment-textarea label' ).remove().text() );
	}

	// Expando Mode: start small, then auto-resize on first click + text length
	jQuery( '#comment-form-identity' ).hide();
	jQuery( '#comment-form-subscribe' ).hide();
	jQuery( '#commentform .form-submit' ).hide();

	comment.css( { 'height':'10px' } ).one( 'focus', function() {
		var timer = setInterval( HighlanderComments.resizeCallback, 10 )
		jQuery( this ).animate( { 'height': HighlanderComments.initialHeight } ).delay( 100 ).queue( function(n) { clearInterval( timer ); HighlanderComments.resizeCallback(); n(); } );
		jQuery( '#comment-form-identity' ).slideDown();
		jQuery( '#comment-form-subscribe' ).slideDown();
		jQuery( '#commentform .form-submit' ).slideDown();
	});
}
jQuery(document).ready( highlander_expando_javascript );
</script> 
        <div id="comment-form-subscribe"> 
         <p class="comment-subscription-form"><input type="checkbox" name="subscribe" id="subscribe" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-label" for="subscribe" style="display: inline;">Notify me of new comments via email.</label></p>
         <p class="post-subscription-form"><input type="checkbox" name="subscribe_blog" id="subscribe_blog" value="subscribe" style="width: auto;"> <label class="subscribe-label" id="subscribe-blog-label" for="subscribe_blog" style="display: inline;">Notify me of new posts via email.</label></p>
        </div> 
        <p class="form-submit"><input name="submit" type="submit" id="comment-submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="1610" id="comment_post_ID"> <input type="hidden" name="comment_parent" id="comment_parent" value="0"> </p>
        <p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="49b8dbb29e"></p> 
        <input type="hidden" name="genseq" value="1507054007"> 
        <p style="display: none;"><input type="hidden" id="ak_js" name="ak_js" value="82"></p> 
       </form> 
      </div>
      <!-- #respond --> 
      <div style="clear: both"></div> 
     </div>
     <!-- #comments --> 
    </div> 
    <div id="sidebar"> 
     <div class="widget widget_categories"> 
      <h4>Categories</h4> 
      <select name="cat" id="cat" class="postform"> <option value="-1">Select category</option> <option class="level-0" value="2290">Architecture</option> <option class="level-0" value="535101">AspectJ</option> <option class="level-1" value="71424194">&nbsp;&nbsp;&nbsp;Instanciation Model</option> <option class="level-1" value="32907062">&nbsp;&nbsp;&nbsp;Inter Type Declaration</option> <option class="level-1" value="73919822">&nbsp;&nbsp;&nbsp;Non-Kinded Pointcut</option> <option class="level-1" value="334710">&nbsp;&nbsp;&nbsp;Precedence</option> <option class="level-1" value="5915024">&nbsp;&nbsp;&nbsp;Spring Integration</option> <option class="level-0" value="1017">Java</option> <option class="level-1" value="49273">&nbsp;&nbsp;&nbsp;Core Java</option> <option class="level-1" value="11167654">&nbsp;&nbsp;&nbsp;Lambda Expression</option> <option class="level-0" value="5702067">JPA/Hibernate</option> <option class="level-1" value="387719">&nbsp;&nbsp;&nbsp;Global Conversation</option> <option class="level-1" value="75029048">&nbsp;&nbsp;&nbsp;Temporary Conversation</option> <option class="level-0" value="26315268">NoSQL – BigData</option> <option class="level-0" value="44443">Regular Expressions</option> <option class="level-0" value="35888">RIA</option> <option class="level-1" value="53242">&nbsp;&nbsp;&nbsp;HTML5</option> <option class="level-1" value="203308">&nbsp;&nbsp;&nbsp;JQUERY</option> <option class="level-0" value="9486">Spring</option> <option class="level-1" value="16749">&nbsp;&nbsp;&nbsp;AOP</option> <option class="level-1" value="29733">&nbsp;&nbsp;&nbsp;Cache</option> <option class="level-1" value="44821109">&nbsp;&nbsp;&nbsp;PersistenceContext</option> <option class="level-1" value="801">&nbsp;&nbsp;&nbsp;Security</option> <option class="level-1" value="5748322">&nbsp;&nbsp;&nbsp;Transactional</option> <option class="level-0" value="151">Web</option> <option class="level-1" value="173823">&nbsp;&nbsp;&nbsp;GWT</option> <option class="level-1" value="465938">&nbsp;&nbsp;&nbsp;Spring MVC</option> </select> 
      <script type="text/javascript">
			/* <![CDATA[ */
                var dropdown = document.getElementById("cat");
                function onCatChange() {
                    if ( dropdown.options[dropdown.selectedIndex].value > 0 ) {
                        location.href = "https://doanduyhai.wordpress.com/?cat="+dropdown.options[dropdown.selectedIndex].value;
                    }
                }
                dropdown.onchange = onCatChange;
            /* ]]> */
            </script> 
     </div> 
     <div class="widget widget_recent_entries"> 
      <h4>Recent Posts</h4> 
      <ul> 
       <li><a href="https://doanduyhai.wordpress.com/2015/01/07/feedback-from-eu-cassandra-summit/">Feedback from EU Cassandra&nbsp;Summit</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2014/09/17/feedback-from-sf-cassandra-summit/">Feedback from SF Cassandra&nbsp;Summit</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2012/08/26/recaptcha-login-form-with-spring-security/">ReCaptcha login form with Spring&nbsp;Security</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2012/08/04/design-pattern-the-asynchronous-dispatcher/">Design Pattern: the Asynchronous&nbsp;Dispatcher</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2012/07/29/gwt-json-integration-with-spring-mvc/">GWT JSON integration with Spring&nbsp;MVC</a></li> 
      </ul> 
     </div> 
     <div class="widget widget_archive"> 
      <h4>Archives</h4> 
      <ul> 
       <li><a href="https://doanduyhai.wordpress.com/2015/01/">January 2015</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2014/09/">September 2014</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2012/08/">August 2012</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2012/07/">July 2012</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2012/05/">May 2012</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2012/04/">April 2012</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2012/03/">March 2012</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2012/02/">February 2012</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2012/01/">January 2012</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2011/12/">December 2011</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2011/11/">November 2011</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2011/10/">October 2011</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2011/08/">August 2011</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/2011/07/">July 2011</a></li> 
      </ul> 
     </div> 
     <div class="widget widget_links"> 
      <h4>Blogroll</h4> 
      <ul> 
       <li><a href="http://en.forums.wordpress.com/">Discuss</a></li> 
       <li><a href="http://www.plinky.com/">Get Inspired</a></li> 
       <li><a href="http://polldaddy.com/">Get Polling</a></li> 
       <li><a href="http://en.support.wordpress.com/">Get Support</a></li> 
       <li><a href="http://learn.wordpress.com/">Learn WordPress.com</a></li> 
       <li><a href="http://planet.wordpress.org/">WordPress Planet</a></li> 
       <li><a href="http://en.blog.wordpress.com/">WordPress.com News</a></li> 
      </ul> 
     </div> 
     <div class="widget widget_meta"> 
      <h4>Meta</h4> 
      <ul> 
       <li><a href="https://wordpress.com/start?ref=wplogin">Register</a></li> 
       <li><a href="https://doanduyhai.wordpress.com/wp-login.php">Log in</a></li> 
       <li><a href="http://www.wordpress.org/">WordPress</a></li> 
       <li><a href="http://validator.w3.org/check?uri=referer">XHTML</a></li> 
      </ul> 
     </div> 
    </div> 
   </div> 
   <div id="footer"> 
    <div class="footerleft"> 
     <p><a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a></p> 
    </div> 
    <div class="footerright"> 
    </div> 
   </div> 
  </div> 
  <!--  --> 
  <script type="text/javascript" src="//0.gravatar.com/js/gprofiles.js?ver=201740y"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script> 
  <script type="text/javascript" src="https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781h"></script> 
  <script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script> 
  <div style="display:none"> 
   <div class="grofile-hash-map-ffa96040bb4211cad1c66f385d8cb77b"> 
   </div> 
   <div class="grofile-hash-map-116511310ca7f786b69eed374df216c6"> 
   </div> 
  </div> 
  <script type="text/javascript">
/* <![CDATA[ */
var HighlanderComments = {"loggingInText":"Logging In\u2026","submittingText":"Posting Comment\u2026","postCommentText":"Post Comment","connectingToText":"Connecting to %s","commentingAsText":"%1$s: You are commenting using your %2$s account.","logoutText":"Log Out","loginText":"Log In","connectURL":"https:\/\/doanduyhai.wordpress.com\/public.api\/connect\/?action=request","logoutURL":"https:\/\/doanduyhai.wordpress.com\/wp-login.php?action=logout&_wpnonce=49b7d1126c","homeURL":"https:\/\/doanduyhai.wordpress.com\/","postID":"1610","gravDefault":"identicon","enterACommentError":"Please enter a comment","enterEmailError":"Please enter your email address here","invalidEmailError":"Invalid email address","enterAuthorError":"Please enter your name here","gravatarFromEmail":"This picture will show whenever you leave a comment. Click to customize it.","logInToExternalAccount":"Log in to use details from one of these accounts.","change":"Change","changeAccount":"Change Account","comment_registration":"","userIsLoggedIn":"","isJetpack":"0","text_direction":"ltr"};
/* ]]> */
</script> 
  <script type="text/javascript" src="https://s2.wp.com/_static/??/wp-content/js/jquery/jquery.autoresize.js,/wp-content/mu-plugins/highlander-comments/script.js?m=1479964158j"></script> 
  <div id="carousel-reblog-box"> 
   <form action="#" name="carousel-reblog"> 
    <textarea id="carousel-reblog-content" name="carousel-reblog-content" placeholder="Add your thoughts here... (optional)"></textarea> 
    <label for="carousel-reblog-to-blog-id" id="carousel-reblog-lblogid">Post to</label> 
    <select name="carousel-reblog-to-blog-id" id="carousel-reblog-to-blog-id"> </select> 
    <div class="submit"> 
     <span class="canceltext"><a href="#" class="cancel">Cancel</a></span> 
     <input type="submit" name="carousel-reblog-submit" class="button" id="carousel-reblog-submit" value="Reblog Post"> 
     <input type="hidden" id="carousel-reblog-blog-id" value="25351269"> 
     <input type="hidden" id="carousel-reblog-blog-url" value="https://doanduyhai.wordpress.com"> 
     <input type="hidden" id="carousel-reblog-blog-title" value="DuyHai's Java Blog"> 
     <input type="hidden" id="carousel-reblog-post-url" value=""> 
     <input type="hidden" id="carousel-reblog-post-title" value=""> 
    </div> 
    <input type="hidden" id="_wpnonce" name="_wpnonce" value="a108bdcde1">
    <input type="hidden" name="_wp_http_referer" value="/2012/08/26/recaptcha-login-form-with-spring-security/"> 
   </form> 
   <div class="arrow"></div> 
  </div> 
  <script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/doanduyhai.wordpress.com\/2012\/08\/26\/recaptcha-login-form-with-spring-security\/":1610};
	</script> 
  <script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script> 
  <script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script> 
  <script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-linkedin' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
				return false;
			});
		});
		</script> 
  <script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script> 
  <div id="sharing_email" style="display: none;"> 
   <form action="/2012/08/26/recaptcha-login-form-with-spring-security/" method="post"> 
    <label for="target_email">Send to Email Address</label> 
    <input type="email" name="target_email" id="target_email" value=""> 
    <label for="source_name">Your Name</label> 
    <input type="text" name="source_name" id="source_name" value=""> 
    <label for="source_email">Your Email Address</label> 
    <input type="email" name="source_email" id="source_email" value=""> 
    <input type="text" id="jetpack-source_f_name" name="source_f_name" class="input" value="" size="25" autocomplete="off"> 
    <script> document.getElementById('jetpack-source_f_name').value = ''; </script> 
    <div class="recaptcha" id="sharing_recaptcha"></div>
    <input type="hidden" name="recaptcha_public_key" id="recaptcha_public_key" value="6LcYW8MSAAAAADBAuEH9yaPcF7lWh11Iq62ZKtoo"> 
    <img style="float: right; display: none" class="loading" src="https://s2.wp.com/wp-content/mu-plugins/post-flair/sharing/images/loading.gif" alt="loading" width="16" height="16"> 
    <input type="submit" value="Send Email" class="sharing_send"> 
    <a rel="nofollow" href="#cancel" class="sharing_cancel">Cancel</a> 
    <div class="errors errors-1" style="display: none;">
      Post was not sent - check your email addresses! 
    </div> 
    <div class="errors errors-2" style="display: none;">
      Email check failed, please try again 
    </div> 
    <div class="errors errors-3" style="display: none;">
      Sorry, your blog cannot share posts by email. 
    </div> 
   </form> 
  </div> 
  <script type="text/javascript" src="https://s0.wp.com/_static/??-eJzTLy/QTc7PK0nNK9EvyClNz8wr1i+uzCtJrMjITM/IAeKS1CJMEWP94uSizIISoOIM5/yiVL2sYh19yo1yKiotzvBKLEukpnkRuTlA4+xzbQ1NjIyMTYwMjU2yABMCXxI="></script> 
  <script type="text/javascript">
	(function(){
		var corecss = document.createElement('link');
		var themecss = document.createElement('link');
		var corecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shCore.css?ver=3.0.9b";
		if ( corecss.setAttribute ) {
				corecss.setAttribute( "rel", "stylesheet" );
				corecss.setAttribute( "type", "text/css" );
				corecss.setAttribute( "href", corecssurl );
		} else {
				corecss.rel = "stylesheet";
				corecss.href = corecssurl;
		}
		document.getElementsByTagName("head")[0].insertBefore( corecss, document.getElementById("syntaxhighlighteranchor") );
		var themecssurl = "https://s0.wp.com/wp-content/plugins/syntaxhighlighter/syntaxhighlighter3/styles/shThemeDefault.css?m=1363304414h&amp;ver=3.0.9b";
		if ( themecss.setAttribute ) {
				themecss.setAttribute( "rel", "stylesheet" );
				themecss.setAttribute( "type", "text/css" );
				themecss.setAttribute( "href", themecssurl );
		} else {
				themecss.rel = "stylesheet";
				themecss.href = themecssurl;
		}
		//document.getElementById("syntaxhighlighteranchor").appendChild(themecss);
		document.getElementsByTagName("head")[0].insertBefore( themecss, document.getElementById("syntaxhighlighteranchor") );
	})();
	SyntaxHighlighter.config.strings.expandSource = '+ expand source';
	SyntaxHighlighter.config.strings.help = '?';
	SyntaxHighlighter.config.strings.alert = 'SyntaxHighlighter\n\n';
	SyntaxHighlighter.config.strings.noBrush = 'Can\'t find brush for: ';
	SyntaxHighlighter.config.strings.brushNotHtmlScript = 'Brush wasn\'t configured for html-script option: ';
	SyntaxHighlighter.defaults['pad-line-numbers'] = false;
	SyntaxHighlighter.defaults['toolbar'] = false;
	SyntaxHighlighter.all();

// Infinite scroll support
jQuery( function( $ ) {
	$( document.body ).on( 'post-load', function() {
		SyntaxHighlighter.highlight();
	} );
} );
</script> 
  <link rel="stylesheet" id="all-css-0-3" href="https://s1.wp.com/wp-content/mu-plugins/carousel/jetpack-carousel.css?m=1481571546h" type="text/css" media="all"> 
  <!--[if lte IE 8]>
<link rel='stylesheet' id='jetpack-carousel-ie8fix-css'  href='https://s1.wp.com/wp-content/mu-plugins/carousel/jetpack-carousel-ie8fix.css?m=1412618825h&#038;ver=20121024' type='text/css' media='all' />
<![endif]--> 
  <script type="text/javascript">
/* <![CDATA[ */
var actionbardata = {"siteID":"25351269","siteName":"DuyHai's Java Blog","siteURL":"http:\/\/doanduyhai.wordpress.com","icon":"<img alt='' src='https:\/\/s1.wp.com\/i\/logo\/wpcom-gray-white.png' class='avatar avatar-50' height='50' width='50' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/enterprise","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/doanduyhai.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fdoanduyhai.wordpress.com%2F2012%2F08%2F26%2Frecaptcha-login-form-with-spring-security%2F","themeURL":"","xhrURL":"https:\/\/doanduyhai.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"c71ad1571e","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"47c9673ae4\" \/>","referer":"https:\/\/doanduyhai.wordpress.com\/2012\/08\/26\/recaptcha-login-form-with-spring-security\/","canFollow":"1","feedID":"1580917","statusMessage":"","customizeLink":"https:\/\/doanduyhai.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fdoanduyhai.wordpress.com%2F2012%2F08%2F26%2Frecaptcha-login-form-with-spring-security%2F","postID":"1610","shortlink":"http:\/\/wp.me\/p1In1r-pY","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/doanduyhai.wordpress.com\/1610","statsLink":"https:\/\/wordpress.com\/stats\/post\/1610\/doanduyhai.wordpress.com","i18n":{"view":"View site","follow":"Follow","following":"Following","edit":"Edit","login":"Log in","signup":"Sign up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Enterprise","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editSubs":"Manage subscriptions","viewReader":"View site in Reader","viewReadPost":"View post in Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"Join 71 other followers","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/doanduyhai.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fdoanduyhai.wordpress.com%2F2012%2F08%2F26%2Frecaptcha-login-form-with-spring-security%2F\">Log in now.<\/a>","stats":"Stats"}};
/* ]]> */
</script> 
  <script type="text/javascript">
/* <![CDATA[ */
var jetpackCarouselStrings = {"widths":[370,700,1000,1200,1400,2000],"is_logged_in":"","lang":"en","ajaxurl":"https:\/\/doanduyhai.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"f3ca80e632","display_exif":"1","display_geo":"1","single_image_gallery":"1","single_image_gallery_media_file":"","background_color":"black","comment":"Comment","post_comment":"Post Comment","write_comment":"Write a Comment...","loading_comments":"Loading Comments...","download_original":"View full size <span class=\"photo-size\">{0}<span class=\"photo-size-times\">\u00d7<\/span>{1}<\/span>","no_comment_text":"Please be sure to submit some text with your comment.","no_comment_email":"Please provide an email address to comment.","no_comment_author":"Please provide your name to comment.","comment_post_error":"Sorry, but there was an error posting your comment. Please try again later.","comment_approved":"Your comment was approved.","comment_unapproved":"Your comment is in moderation.","camera":"Camera","aperture":"Aperture","shutter_speed":"Shutter Speed","focal_length":"Focal Length","comment_registration":"0","require_name_email":"1","login_url":"https:\/\/doanduyhai.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fdoanduyhai.wordpress.com%2F2012%2F08%2F26%2Frecaptcha-login-form-with-spring-security%2F","blog_id":"25351269","local_comments_commenting_as":"<fieldset><label for=\"email\">Email (Required)<\/label> <input type=\"text\" name=\"email\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-email-field\" \/><\/fieldset><fieldset><label for=\"author\">Name (Required)<\/label> <input type=\"text\" name=\"author\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-author-field\" \/><\/fieldset><fieldset><label for=\"url\">Website<\/label> <input type=\"text\" name=\"url\" class=\"jp-carousel-comment-form-field jp-carousel-comment-form-text-field\" id=\"jp-carousel-comment-form-url-field\" \/><\/fieldset>","reblog":"Reblog","reblogged":"Reblogged","reblog_add_thoughts":"Add your thoughts here... (optional)","reblogging":"Reblogging...","post_reblog":"Post Reblog","stats_query_args":"blog=25351269&v=wpcom&tz=2&user_id=0&subd=doanduyhai","is_public":"1","reblog_enabled":""};
/* ]]> */
</script> 
  <script type="text/javascript">
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script> 
  <script type="text/javascript" src="https://s1.wp.com/_static/??-eJx9T0kOwjAM/BCpC4jlgngKCqkBp9mwE5bfEyQKPaCebM2MZ8ZwT8rEkDFksAId3shgejRWZjCifFHJlTMFAUc9ClwLFrzo0DnkQUzBuNJVshqZ6H09VIzJPRtPYcJRd5VXR83gtWTkuql4Q2Z6m32xKQeTKYa3w3f7V0rSr8cYt/Ubfn5GM1b9yTKaYxF0YDEnbXo1AFP9ehKPWS2bFg41GU6R/YQ+Rcnq5DQxyEUzhfMw69He7+ardrHezjeL1r4A2AKnLQ=="></script> 
  <script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script> 
  <iframe src="https://widgets.wp.com/likes/master.html?ver=20170206#ver=20170206" scrolling="no" id="likes-master" name="likes-master" style="display:none;"></iframe> 
  <div id="likes-other-gravatars">
   <div class="likes-text">
    <span>%d</span> bloggers like this:
   </div>
   <ul class="wpl-avatars sd-like-gravatars"></ul>
  </div> 
  <script src="//stats.wp.com/w.js?56" type="text/javascript" async defer></script> 
  <script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'25351269','blog_tz':'2','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'25351269','v':'wpcom','tz':'2','user_id':'0','post':'1610','subd':'doanduyhai'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdTdvUG14Q2VDQTR4LlUsLi82dU1mai9BMlVKPytqWkpxbS9HWmh2azJDfltRbklGdyssejJQTGRRfHM3NFJ+cEJqeF1hN1szNFJqS3d+X0szNmUwODg4anRFL1lOcG96STVHalBPZnpNMFFDbHddfD9mXVUmbCxCTy8xUFdPc2pQLTlaeXhCSnVMK2w3QSswW1poJU58NmMsaDNvNEsuNHc4SW1zMWZTd19LdjFQJVB8OEYxNixoeldrPTMycmJZRV90SHllUC02LGpMQ3F3SXllNnJWLXhzT2YydU5IdU4lZiZpV25yXUJn'}]);
_stq.push([ 'clickTrackerInit', '25351269', '1610' ]);
	</script> 
  <noscript>
   <img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="">
  </noscript> 
  <script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>  
 </body>
</html>