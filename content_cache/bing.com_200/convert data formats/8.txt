<!doctype html>
<html>
 <head> 
  <meta charset="utf-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
  <title>Convert a SharePoint date/time field to a javascript Date() object</title> 
  <meta name="viewport" content="width=device-width"> 
  <meta name="google-site-verification" content="B16FdNO2mJuOCht715qWJtylE4x209VapV7n88y_aqQ"> 
  <meta name="Description" content=""> 
  <!-- feed --> 
  <link href="http://www.bentedder.com/feed.xml" rel="alternate" type="application/atom+xml"> 
  <!-- Custom CSS --> 
  <link rel="stylesheet" href="/css/blog.min.css"> 
  <link rel="stylesheet" href="/prism.css"> 
  <!-- <link rel="stylesheet" href="/css/blog.min.css"> --> 
  <link rel="author" href="https://plus.google.com/116492212021849312483/posts"> 
  <link rel="canonical" href="/convert-a-sharepoint-datetime-field-to-a-javascript-date-object/"> 
  <link href="https://plus.google.com/+BenTedder" rel="publisher"> 
  <meta property="twitter:account_id" content="14756042"> 
 </head> 
 <body> 
  <div id="wrapper"> 
   <div id="mainbody"> 
    <h1 id="site-title"> <a href="/">ben tedder</a> : code things </h1> 
    <div id="content"> 
     <h2 class="post-title">Convert a SharePoint date/time field to a javascript Date() object</h2> 
     <p itemprop="datePublished" content="2013-03-11 00:00:00 -0400" class="meta">11 Mar 2013</p> 
     <div class="post"> 
      <p>In a recent project I was looking for a way to sort an array of dates brought back from SharePoint. This worked fine in Chrome, but then I realized it didn't work in any other browsers! So, by writing a few console.log() lines to test with Safari &amp; FireFox, I discovered that the date that SharePoint passes is seen to javascript as an "invalid date" to almost all browsers. So, here's a small helper function that just converts what you get from SharePoint into a true javascript Date() object. Hope you find it helpful! I've also included it in my code section as a Gist, so grab just the function there if you'd like.</p> 
      <figure class="highlight">
       <pre><code class="language-js" data-lang="js"><span class="kd">function</span> <span class="nx">convertSPDate</span><span class="p">(</span><span class="nx">d</span><span class="p">)</span> <span class="p">{</span>
<span class="cm">/*</span>
<span class="cm">* A function to convert a standard SharePoint</span>
<span class="cm">* date/time field (YYYY-MM-DD HH:MM:SS) to a</span>
<span class="cm">* javascript Date() object</span>
<span class="cm">*</span>
<span class="cm">* Author: Ben Tedder (www.bentedder.com)</span>
<span class="cm">*/</span>
    <span class="c1">// split apart the date and time</span>
    <span class="kd">var</span> <span class="nx">xDate</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">xTime</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">" "</span><span class="p">)[</span><span class="mi">1</span><span class="p">];</span>

    <span class="c1">// split apart the hour, minute, &amp; second</span>
    <span class="kd">var</span> <span class="nx">xTimeParts</span> <span class="o">=</span> <span class="nx">xTime</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">":"</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">xHour</span> <span class="o">=</span> <span class="nx">xTimeParts</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">xMin</span> <span class="o">=</span> <span class="nx">xTimeParts</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">xSec</span> <span class="o">=</span> <span class="nx">xTimeParts</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

    <span class="c1">// split apart the year, month, &amp; day</span>
    <span class="kd">var</span> <span class="nx">xDateParts</span> <span class="o">=</span> <span class="nx">xDate</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">"-"</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">xYear</span> <span class="o">=</span> <span class="nx">xDateParts</span><span class="p">[</span><span class="mi">0</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">xMonth</span> <span class="o">=</span> <span class="nx">xDateParts</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
    <span class="kd">var</span> <span class="nx">xDay</span> <span class="o">=</span> <span class="nx">xDateParts</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>

    <span class="kd">var</span> <span class="nx">dDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">xYear</span><span class="p">,</span> <span class="nx">xMonth</span><span class="p">,</span> <span class="nx">xDay</span><span class="p">,</span> <span class="nx">xHour</span><span class="p">,</span> <span class="nx">xMin</span><span class="p">,</span> <span class="nx">xSec</span><span class="p">);</span>
    <span class="k">return</span> <span class="nx">dDate</span><span class="p">;</span>
<span class="p">}</span>

    <span class="c1">// create a couple of variables</span>
    <span class="kd">var</span> <span class="nx">startTime</span><span class="p">;</span>
    <span class="kd">var</span> <span class="nx">convertedStartTime</span><span class="p">;</span>

    <span class="c1">// a standard SPServices call</span>
    <span class="nx">$</span><span class="p">().</span><span class="nx">SPServices</span><span class="p">({</span>
        <span class="nx">operation</span><span class="o">:</span> <span class="s2">"GetListItems"</span><span class="p">,</span>
        <span class="nx">webURL</span><span class="o">:</span> <span class="nx">myListURL</span><span class="p">,</span>
        <span class="nx">async</span><span class="o">:</span><span class="kc">false</span><span class="p">,</span>
        <span class="nx">listName</span><span class="o">:</span> <span class="nx">myListName</span><span class="p">,</span>
        <span class="nx">CAMLRowLimit</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">completefunc</span><span class="o">:</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">xData</span><span class="p">,</span> <span class="nx">Status</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">$</span><span class="p">(</span><span class="nx">xData</span><span class="p">.</span><span class="nx">responseXML</span><span class="p">).</span><span class="nx">SPFilterNode</span><span class="p">(</span><span class="s2">"z:row"</span><span class="p">).</span><span class="nx">each</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">i</span><span class="p">){</span>
                <span class="c1">// set the value of startTime to standard SP date/time field</span>
                <span class="nx">startTime</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="k">this</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s2">"ows_startTime"</span><span class="p">);</span>
            <span class="p">})</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="c1">// set the convertedStartTime to a true javascript date</span>
    <span class="nx">convertedStartTime</span> <span class="o">=</span> <span class="nx">convertSPDate</span><span class="p">(</span><span class="nx">startTime</span><span class="p">);</span></code></pre>
      </figure> 
      <br> 
      <!-- <div class="social">
  <div class="social__item">Share on: </div>
  <a class="social__item social__item--facebook sharePopup" href="https://www.facebook.com/sharer/sharer.php?u=http://www.bentedder.com/convert-a-sharepoint-datetime-field-to-a-javascript-date-object/" id="facebookShare" target="_blank">
  <span class="accessibility">Facebook</span>
  </a>
  <a class="social__item social__item--google-plus sharePopup" href="https://plus.google.com/share?url=http://www.bentedder.com/convert-a-sharepoint-datetime-field-to-a-javascript-date-object/" id="googleShare" target="_blank">
  <span class="accessibility">Google</span>
  </a>
  <a class="social__item social__item--twitter sharePopup" href="https://twitter.com/intent/tweet?text=Convert a SharePoint date/time field to a javascript Date() object&url=http://www.bentedder.com/convert-a-sharepoint-datetime-field-to-a-javascript-date-object/&via=bentedder" id="twitterShare" target="_blank">
  <span class="accessibility">Twitter</span>
  </a>
</div> --> 
      <div id="page-navigation"> 
       <div class="clear">
        &nbsp;
       </div> 
       <div class="left">
         previous: 
        <a href="/quick-fix-set-password-for-phpmyadmin-on-wamp/" title="Previous Post: 
    Quick Fix: Set password for phpMyAdmin on WAMP">« Quick Fix: Set password for phpMyAdmin on WAMP</a>
        <br> 
       </div> 
       <div class="right">
         next: 
        <a href="/part-2-sort-a-javascript-array-of-dates-from-sharepoint/" title="next Post: 
    Part 2: Sort a javascript array of dates from SharePoint">Part 2: Sort a javascript array of dates from SharePoint » </a> 
       </div> 
       <div class="clear">
        &nbsp;
       </div> 
      </div> 
      <br>
      <br> 
      <div id="disqus_thread"></div> 
     </div> 
    </div> 
   </div> 
   <div id="footer"> 
    <div class="social"> 
     <span itemprop="author" itemscope itemtype="http://schema.org/Person"> I'm <span itemprop="name">Ben Tedder</span>. Probably easiest to contact me on <a href="https://www.linkedin.com/in/bentedder/">LinkedIn</a>.</span> 
     <br>
     <br> 
     <a class="social__item social__item--github" href="https://github.com/bentedder" target="_blank"> <span class="accessibility">Github</span> </a> 
    </div> 
   </div> 
  </div> 
  <script>
      var disqus_shortname = 'bentedder';
      var disqus_config = function () {
          this.page.url = 'http://www.bentedder.com/convert-a-sharepoint-datetime-field-to-a-javascript-date-object/';
      };
      (function() {
          var d = document, s = d.createElement('script');
          
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';

          s.setAttribute('data-timestamp', +new Date());
          (d.head || d.body).appendChild(s);
      })();
  </script> 
  <script src="/prism.js"></script> 
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-5753416-10', {'siteSpeedSampleRate': 100, 'cookieDomain': 'bentedder.com'});
    ga('send', 'pageview');
  </script>   
 </body>
</html>