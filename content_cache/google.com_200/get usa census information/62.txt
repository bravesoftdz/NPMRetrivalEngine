<!doctype html>
<html class="no-js">
 <head> 
  <title>Making the WNYC Census Map - johnkeefe.net</title> 
  <meta content="width=device-width,initial-scale=1" name="viewport"> 
  <meta name="description" content="When the New York census numbers arrived this week, we were ready. WNYC quickly published an interactive, sharable map so New Yorkers -- and our reporters -- could explore the new data and see the..."> 
  <meta property="og:title" content="Making the WNYC Census Map"> 
  <meta property="og:type" content="article"> 
  <meta property="og:url" content="http://johnkeefe.net/47474697"> 
  <meta property="og:site_name" content="johnkeefe.net"> 
  <meta property="og:description" content="When the New York census numbers arrived this week, we were ready. WNYC quickly published an interactive, sharable map so New Yorkers -- and our reporters -- could explore the new data and see the..."> 
  <link href="https://phthemes.s3.amazonaws.com/1/lpmGCkGbHyh0vsId/images/favicon.ico?v=1471395768" rel="shortcut icon" type="image/x-icon"> 
  <link href="//fonts.googleapis.com/css?family=Oxygen:400,700,300|Crimson+Text:400,400italic&amp;subset=latin,latin-ext" media="screen" rel="stylesheet" type="text/css"> 
  <link rel="stylesheet" href="https://phthemes.s3.amazonaws.com/1/lpmGCkGbHyh0vsId/blog.css?v=1471395767"> 
  <link rel="alternate" type="application/atom+xml" href="http://johnkeefe.net/posts.atom"> 
  <script>
        window.Posthaven = window.Posthaven || {};
        window.Posthaven.currentPage = {"postIds":"481448","pageCounter":"post-481448"};
        window.Posthaven.domain = 'posthaven.com';
        window.Posthaven.strings = {"archive.no_results":"No results found.","date":null,"forms.comment.anon_error":"Please enter your name and email.","forms.subscribe.after_subscribe_notice":"You have been subscribed. Check your email to confirm your subscription.","forms.subscribe.after_follow_notice":"You're now following this blog.","forms.subscribe.after_unfollow_notice":"You've unfollowed this blog.","gallery.of":"of","relative_date":null};
      </script> 
  <link href="//posthaven-assets.s3.amazonaws.com/assets/blog-internal-10466eee3eaf71179266acc37f118fb8.css" media="all" rel="stylesheet"> 
  <style type="text/css">img { width: 70%; height: 70%; }

code {font-size: 12pt;}

.stats {display: none;}</style> 
 </head> 
 <body id="site_4198"> 
  <div id="container"> 
   <nav class="posthaven-user-menu posthaven-control"> 
    <span class="posthaven-user-required" style="display: none;"> <span class="posthaven-admin-required" style="display: none;"> <a href="https://posthaven.com/dashboard#sites/4198">Manage</a> <a href="https://posthaven.com/dashboard#sites/4198/posts/481448/edit">Edit Post</a> <a href="https://posthaven.com/dashboard#sites/4198/posts/481448/comments">Comments</a> </span> <a href="/posthaven/xd/logout" data-posthaven-method="delete">Logout</a> </span> 
    <span class="posthaven-anon"> <a href="https://posthaven.com/users/sign_in?return_host=johnkeefe.net" class="posthaven-login">Login</a> </span> 
   </nav> 
   <header id="topbar"> 
    <a href="https://posthaven.com/">
     <div class="posthaven-tab"></div></a> 
   </header> 
   <div id="flash"> 
   </div> 
   <header id="header"> 
    <h1> <a href="http://johnkeefe.net/">johnkeefe.net</a> </h1> 
    <h2>bots + journalism + diy hackery</h2> 
    <div class="back-to-blog"> 
     <a href="http://johnkeefe.net/">«&nbsp;Back to blog</a> 
    </div> 
   </header> 
   <div id="main_container"> 
    <div id="main"> 
     <article class="post"> 
      <header> 
       <div class="post-title"> 
        <h2><a href="http://johnkeefe.net/47474697">Making the WNYC Census Map</a></h2> 
       </div> 
      </header> 
      <div class="post-body" id="post_body_481448"> 
       <div class="posthaven-post-body">
        <p>When the New York census numbers arrived this week, we were ready. WNYC quickly published an <a href="http://project.wnyc.org/census-maps/2010pop.html">interactive, sharable map</a> so New Yorkers -- and our reporters -- could explore the new data and see the stories.</p> 
        <p>We built the map with free tools and timely help from some smart, kind people.</p> 
        <p><iframe src="http://project.wnyc.org/census-maps/2010pop.html?lat=40.7739&amp;lon=-73.9456&amp;zoom=12&amp;sel=6" frameborder="0" height="700" width="610"> &amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;lt;p&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;gt;scrolling="no"&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;gt;</iframe> &amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;lt;p&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;gt;scrolling="no"&amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;amp;gt;</p> 
        <p>The short story is that we mashed together population numbers and geographic shapes using <a href="http://www.google.com/fusiontables/Home">Google Fusion Tables</a>, and then used JavaScript and Fusion Tables' mapping features to make things pretty and interactive.</p> 
        <p>The long story is meandering and full of wrong turns. But here are the highlights, should anyone need a little navigation. Don't hesitate to contact me for more help and insight; I'm due to pay some forward.</p> 
        <p><strong>Getting in Shape</strong></p> 
        <p>First up: Shapes of the census tracts plotted on Earth. I downloaded New York's tracts from the U.S. Census Bureau's&nbsp;<a href="http://www.census.gov/geo/www/tiger/tgrshp2010/tgrshp2010.html">TIGER/Line Shapefile page</a>. They also have counties, blocks, zip codes, and more.</p> 
        <p>Then I uploaded this "shapefile" -- actually collection of related files zipped together -- to Fusion Tables with a free, online tool called <a href="http://shpescape.com/">Shpescape</a>. (Thanks to Google's <a href="http://www.rebeccashapley.com/">Rebecca Shapley</a> for sharing this key to my puzzle.)</p> 
        <p><strong>Hello, Data</strong></p> 
        <p>Census data is publicly available, but can be a hassle to handle. In fact, on the day each state's info was released, the files were available in a set that&nbsp;<a href="http://www.census.gov/rdo/tech_tips/">apparently requires</a>&nbsp;one of two pricey programs -- SAS or Microsoft Access -- to assemble.&nbsp;</p> 
        <p>So I got clean, assembled, comma-delimited files -- complete with 2000-to-2010 comparisons -- from the <a href="http://www.usatoday.com/news/nation/census/default.htm">USA Today census team</a>, which provided them <a href="http://www.ire.org/census-workshop/census-data-available-to-ire-members">as a courtesy</a> to members of Investigative Reporters and Editors. Huge props to <a href="http://www.anthonydebarros.com/">Anthony DeBarros</a>&nbsp;and <a href="http://twitter.com/#!/poverberg">Paul Overberg</a>, who crunched the New York numbers in a blazing 30 minutes.</p> 
        <p>By the way, <a href="http://www.ire.org/join/apply.html">IRE membership</a> is $60 for professionals and $25 for students. Well worth it, and cheaper than either of those programs. If you're digging into census numbers and qualify, I recommend this route.</p> 
        <p>That said, every state's 2010 data is now available free from the Census Bureau's <a href="http://factfinder2.census.gov/">American Fact Finder</a>. Navigating the site is a little tricky, and worth a separate post, but the bureau provides <a href="http://factfinder.census.gov/home/saff/aff2.html">some tutorials</a>, and there's very <a href="http://www.census.gov/prod/cen2010/doc/pl94-171.pdf%20">detailed PDF</a> about each data field.</p> 
        <p>With data in hand, I uploaded it to Google Fusion Tables in another table.</p> 
        <p><strong>Map Making</strong></p> 
        <p>Next, I merged the shapes table and population table, using the unique tract ID to marry the data (the shape file calls it GEOID10. the IRE data calls it FULLTRACT). Note that the GEOID10 is <a href="http://www.census.gov/rdo/pdf/0GEOID_Construction_for_Matching.pdf">formatted differently</a> depending on whether you're using tracts, blocks, counties, etc., so be sure you've got the right match in both files.</p> 
        <p>Clicking <em>Visualize -&gt; Map</em> shows a map. It'll be all default-red until you click on <em>Configure Styles -&gt; Fill Colors -&gt; Gradient</em> (or -&gt;Buckets) and make different colors appear depending on values in the column of your choice.</p> 
        <p>Using the Share button makes the map viewable by others, and "Get embeddable link" does just that.</p> 
        <p><strong>Adding Prettiness</strong></p> 
        <p>I used the Fusion Tables "Configure info window" option to make custom pop-up bubbles on our maps. This actually required some nicer-looking data, such as a columns with rounded percentages and + or – signs. I added these using the free <a href="http://www.r-project.org/">R statistical program</a>, which I learned how to do from The New York Times' <a href="http://amandacox.tumblr.com/">Amanda Cox</a> at the 2011 <a href="http://www.ire.org/training/conference/">Computer Assisted Reporting conference</a>.)</p> 
        <p>Census tracts officially extend to the state lines, which made it look like a <em>lot</em> of people live in the Hudson River. So I had trimmed those tracts to the shorelines with a free mapping program called <a href="http://www.qgis.org/">QGIS</a>, using water shapefiles as a reference (those are <a href="http://www.census.gov/cgi-bin/geo/shapefiles2010/main">here</a>, in the drop-down menu).</p> 
        <p>After creating 12 merged Fusion Tables, I pulled them into one page using JavaScript and jQuery, with fantastic guidance from <a href="http://twitter.com/#!/JoeGermuska">Joe Germuska</a> at the Chicago Tribune (part of the team that built <a href="http://media.apps.chicagotribune.com/census-2010/population-change/index.html">this great map</a>).</p> 
        <p>The "Share/Embed this view" feature came together in two parts: 1) The JavaScript turns the current the latitude, longitude, zoom level and current map choice into a long URL that pops up when you click the Share/Embed link. 2) Using a <a href="https://github.com/allmarkedup/jQuery-URL-Parser">nifty jQuery plug-in</a>&nbsp;<em>(updated link Dec. 2011)</em>,&nbsp;the map looks for those values in the URL that summoned it, and reorients to that map if they exist.</p> 
        <p><strong>Prep Work</strong></p> 
        <p>Clearly, not all of this could happen in a couple of hours on Data Day. I'd been tinkering, testing and tweaking for a few weeks using New Jersey's data, which came out much earlier.</p> 
        <p>I also wrote down, edited and revised every step I took to make the maps. So when the adrenaline was running I had a script to follow.</p> 
        <p>The WNYC Web Team also set up a slick, fresh project server, at project.wnyc.org, to host the html pages and track the traffic.</p> 
        <p><strong>Fusion Function</strong></p> 
        <p>Using Google Fusion Tables made it super easy to manage, map and serve up a lot of data. And the FT feedback team was fantastic about responding to questions and glitches I encountered along the way.</p> 
        <p>I did run into a couple of hiccups: slow load times and pop-up bubbles that failed to pop up. The first was a product of displaying so much data -- and I knew I was pushing things. The second was a Google glitch that their engineers managed to fix within a few hours, but was still spotty at times afterward.</p> 
        <p>Also, the Google Map engine starts dropping shapes when there are too many to show. So I funneled different counties' data into almost a dozen <a href="http://code.google.com/apis/maps/documentation/javascript/overlays.html#FusionTables">different layers</a>, a workaround the Google folks showed me ahead of time.</p> 
        <p>That said, I had time to code and tweak lots of neat things because I didn't have to focus on building or running a database engine. Google's free services took care of that.</p> 
        <p><strong>What Could Be Better?</strong></p> 
        <p>Probably a lot. I wanted to let people to add comments, right on the map, but didn't have the chops or time to pull that off.</p> 
        <p>Another good thing would be a "Loading ..." indicator displayed while the map data is pulled into your browser, which I may yet add.</p> 
        <p>But what <em>couldn't</em> have been better was everything I learned, the help I got from other data folks and the support from my WNYC colleagues. Plus we gave New Yorkers a pretty nifty service and several great stories.</p> 
        <p>Need more details? Feel free to ask questions in the comments. Or drop me a line. I'll try to help, too.</p>
       </div> 
      </div> 
     </article> 
     <footer id="post_responses" class="post-responses"> 
      <div class="post-responses"> 
       <div class="posthaven-share-links"> 
        <div class="posthaven-share-item posthaven-twitter-share"> 
         <a class="twitter-share-button share-item" data-text="Making the WNYC Census Map" data-url="http://johnkeefe.net/47474697" href="https://twitter.com/share">Tweet</a> 
        </div> 
       </div> 
       <div class="count"> 
        <span class="comment-icon"></span> 6 responses 
       </div> 
       <div class="responses"> 
        <div class="response"> 
         <div class="comment"> 
          <div class="posthaven-comment-body">
           John,
           <p>Perfect timing. Just Friday I was puzzling over how to do something very similar with school district information. I've got the data, including shapefiles, but it looked like it was going to be a slog figuring out how to get from there to something interactive.</p>
           <p>Thanks for the tips.</p>
           <p>Best,</p>
           <p>Bill Wareham</p>
          </div> 
         </div> 
         <div class="byline"> 
          <span class="mdash">—</span> Bill Wareham 
          <span class="time-ago"><span class="posthaven-formatted-date" data-format="RELATIVE" data-unix-time="1301324537"></span></span> 
         </div> 
        </div> 
        <div class="response"> 
         <div class="comment"> 
          <div class="posthaven-comment-body">
           John,
           <p>Perfect timing. Just Friday I was puzzling over how to do something very similar with school district information. I've got the data, including shapefiles, but it looked like it was going to be a slog figuring out how to get from there to something interactive.</p>
           <p>Thanks for the tips.</p>
           <p>Best,</p>
           <p>Bill Wareham</p>
          </div> 
         </div> 
         <div class="byline"> 
          <span class="mdash">—</span> Bill Wareham 
          <span class="time-ago"><span class="posthaven-formatted-date" data-format="RELATIVE" data-unix-time="1301324602"></span></span> 
         </div> 
        </div> 
        <div class="response"> 
         <div class="comment"> 
          <div class="posthaven-comment-body">
           would like a link on a step by step to add a legend thanks
          </div> 
         </div> 
         <div class="byline"> 
          <span class="mdash">—</span> Bob 
          <span class="time-ago"><span class="posthaven-formatted-date" data-format="RELATIVE" data-unix-time="1327421364"></span></span> 
         </div> 
        </div> 
        <div class="response"> 
         <div class="comment"> 
          <div class="posthaven-comment-body">
           By listening to music and songs 4 worship country video seekers. When completed play your compact disc. I had a kid. 18 Olivia Wilde left her hotel dressed to impress in London, England. I love R&amp;B I played song music from songs 4 worship country the 90's. Then by counting up four full notes from the tonic chord, C D, E then F you arrive at the subdominant of the C Key. The songs 4 worship country street sounds of Africa have always found a home in Paris and there are a few ideas for lesson beginnings regarding teaching songs.
          </div> 
         </div> 
         <div class="byline"> 
          <span class="mdash">—</span> Flora 
          <span class="time-ago"><span class="posthaven-formatted-date" data-format="RELATIVE" data-unix-time="1379306120"></span></span> 
         </div> 
        </div> 
        <div class="response"> 
         <div class="comment"> 
          <div class="posthaven-comment-body">
           Now when our group approaches a binary options broker's trading platform that act as a option trading strategies binary trader. When you buy you pay the market price does or does not attain the target price, prior to you can even apply for a binary signals service?
          </div> 
         </div> 
         <div class="byline"> 
          <span class="mdash">—</span> Hans 
          <span class="time-ago"><span class="posthaven-formatted-date" data-format="RELATIVE" data-unix-time="1382064048"></span></span> 
         </div> 
        </div> 
        <div class="response"> 
         <div class="comment"> 
          <div class="posthaven-comment-body">
           Numerous people today will tell you that may binary trading is certainly a real scam and this is usually simply because they have been burned in the past years. Binary options trading is actually not necessarily gambling. If most people trade on binary options you actually already have every possibility to research your own chosen market not to mention come up with appropriate estimations regarding your latest trends regarding products. Whih simply being thought, you shouldn't get involved in binary trade unless you have succesfully done enough analysis to take a position with self-confidence.
          </div> 
         </div> 
         <div class="byline"> 
          <span class="mdash">—</span> Melvin 
          <span class="time-ago"><span class="posthaven-formatted-date" data-format="RELATIVE" data-unix-time="1382652527"></span></span> 
         </div> 
        </div> 
       </div> 
      </div> 
      <form accept-charset="UTF-8" action="/posthaven/posts/481448/comments" class="posthaven-comment-form posthaven-control" method="post">
       <div style="margin:0;padding:0;display:inline"></div> 
       <div class="posthaven-anon"> 
        <input disabled id="recaptcha_challenge" name="recaptcha_challenge" type="hidden"> 
        <input disabled id="recaptcha_response" name="recaptcha_response" type="hidden"> 
        <div class="posthaven-field posthaven-comment-name-field"> 
         <label for="response_commenter_name">Your Name</label> 
         <input id="response_commenter_name" name="response[commenter_name]" type="text"> 
        </div> 
        <div class="posthaven-field posthaven-comment-email-field"> 
         <label for="response_commenter_email">Email</label> 
         <input id="response_commenter_email" name="response[commenter_email]" type="text"> 
        </div> 
        <div class="posthaven-field posthaven-comment-url-field" style="display: none"> 
         <label for="response_commenter_url">URL</label> 
         <input id="response_commenter_url" name="response[commenter_url]" type="text"> 
        </div> 
        <div class="posthaven-comment-add-url"> 
         <a href="javascript:void(0)">Add Website URL&nbsp;»</a> 
        </div> 
       </div> 
       <div class="posthaven-field posthaven-comment-body-field"> 
        <label for="response_body">Your Comment</label> 
        <textarea id="response_body" name="response[body]">
</textarea> 
       </div> 
       <div class="posthaven-field posthaven-comment-notify-field posthaven-checkbox-field"> 
        <input id="response_notify_commenter" name="response[notify_commenter]" type="checkbox" value="true"> 
        <label for="response_notify_commenter">Notify me by email when new comments are added</label> 
       </div> 
       <div class="posthaven-comment-verification"></div> 
       <div class="posthaven-comment-loading" style="display: none"> 
        <div class="posthaven-loader"></div> 
       </div> 
       <input class="posthaven-comment-submit" name="commit" type="submit" value="Comment"> 
      </form> 
     </footer> 
    </div> 
    <aside id="sidebar"> 
     <section> 
      <nav id="menu_navigation"> 
       <ul> 
        <li id="menu_item_38415" class="menu-item "> <a href="http://johnkeefe.net/more-about-me">About</a> </li> 
        <li id="menu_item_42722" class="menu-item "> <a href="http://johnkeefe.net/contacting-me">Contact</a> </li> 
        <li id="menu_item_13826" class="menu-item "> <a href="http://twitter.com/jkeefe">Twitter</a> </li> 
        <li id="menu_item_35421" class="menu-item "> <a href="https://github.com/jkeefe?tab=repositories">Github</a> </li> 
       </ul> 
      </nav> 
     </section> 
     <section id="bio"> 
      <h3>John Keefe</h3> 
      <p><img src="https://s3.amazonaws.com/media.johnkeefe.net/john+28-square_200px.png"></p> 
      <p>• Bot developer and app product manager at <a href="https://qz.com/">Quartz</a><br>• Author, <em><a href="http://amzn.to/2cY2PAH">Family Projects for Smart Objects: Tabletop Projects That Respond to Your World</a></em><br>• Founder, <a href="http://reallygoodsmarts.nyc">Really Good Smarts LLC</a></p>
      <p>Here's my <a href="http://johnkeefe.net/more-about-me">full bio</a></p> 
      <p>My PGP fingerprint: 30D1 B2EF ECD0 BCA9 EBFA E13A CC77 A709 6A9C 5F59</p> 
      <p><a href="http://www.studiokairos.co/network/john-keefe">Book me</a> for workshop and presentations.</p> 
      <p> </p>
      <div id="mc_embed_signup"> 
       <form action="//johnkeefe.us12.list-manage.com/subscribe/post?u=14c21eac4a523b26973f13bd6&amp;id=ec307b82ad" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank"> 
        <div id="mc_embed_signup_scroll"> 
         <h2>Get Occasional News About My Projects</h2> 
         <div class="mc-field-group"> 
          <p>There are lots of things cooking. Don't miss 'em!</p> Your Email 
          <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL"> 
         </div> 
         <div id="mce-responses" class="clear"> 
          <div class="response" id="mce-error-response"></div> 
          <div class="response" id="mce-success-response"></div> 
         </div> 
         <div>
          <input type="hidden" name="b_14c21eac4a523b26973f13bd6_ec307b82ad" value="">
         </div> 
         <br> 
         <div class="clear">
          <input type="submit" value="Add Me" name="subscribe" id="mc-embedded-subscribe" class="button">
         </div> 
        </div> 
       </form> 
      </div> 
      <p></p> 
     </section> 
     <section class="post-date"> 
      <div class="display-date">
        Posted 
       <a href="http://johnkeefe.net/47474697"><span class="posthaven-formatted-date" data-format="RELATIVE" data-unix-time="1301198160"></span></a> 
       <div class="actual-date"> 
        <span class="posthaven-formatted-date" data-format="%B %e, %Y at %l:%M %p" data-unix-time="1301198160"></span> 
       </div> 
      </div> 
     </section> 
     <section class="stats"> 
      <div class="stat"> 
       <span class="posthaven-post-count-placeholder" data-post-id="481448" data-singular="view" data-plural="views"></span> 
      </div> 
     </section> 
     <section class="tag-list"> 
      <h3>Tags</h3> 
      <ul> 
       <li> <a href="/tag/breaking%20news">breaking news</a> </li> 
       <li> <a href="/tag/feeling%20data">feeling data</a> </li> 
       <li> <a href="/tag/mapping">mapping</a> </li> 
       <li> <a href="/tag/mashups">mashups</a> </li> 
       <li> <a href="/tag/news%20applications">news applications</a> </li> 
       <li> <a href="/tag/visual%20information">visual information</a> </li> 
      </ul> 
     </section> 
    </aside> 
   </div> 
  </div> 
  <script async src="//platform.twitter.com/widgets.js" type="text/javascript"></script> 
  <script src="//posthaven-assets.s3.amazonaws.com/assets/blog-8768e918592bb9fd3b158a85bf5b28be.js" type="text/javascript"></script> 
  <script type="text/javascript">
          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-38525690-2']);
          _gaq.push(['_setAllowLinker', true]);
          _gaq.push(['_trackPageview']);
        </script> 
  <script>
          _gaq.push(['b._setAccount', 'UA-48619517-1']);
          _gaq.push(['b._trackPageview']);
        </script> 
  <script>
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') +
                    '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        </script>   
 </body>
</html>