<!doctype html>
<!--[if lt IE 7]><html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]><html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]><html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
 <!--<![endif]-->
 <head> 
  <meta charset="UTF-8"> 
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"> 
  <meta name="viewport" content="width=device-width"> 
  <meta name="theme-color" content="#FF523B"> 
  <title>
		   Deploying a Node app on Digital Ocean using Nginx. - Ryan Christiani - Front-End Developer - Ryan Christiani – Front-End Developer	</title> 
  <link rel="shortcut icon" href="/favicon.ico"> 
  <link href="http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,400,700,300" rel="stylesheet" type="text/css"> 
  <link rel="stylesheet" href="http://ryanchristiani.com/wp-content/themes/Blog_Theme/css/normalize.css"> 
  <link rel="pingback" href="http://ryanchristiani.com/xmlrpc.php"> 
  <!-- This site is optimized with the Yoast SEO plugin v3.0.7 - https://yoast.com/wordpress/plugins/seo/ --> 
  <meta name="description" content="Learn about deploying a node app on Digital Ocean using Nginx. Learn how to make it fast and easy, so you can spend less time configuring."> 
  <meta name="robots" content="noodp"> 
  <link rel="canonical" href="http://ryanchristiani.com/deploying-a-node-app-on-digital-ocean-using-nginx/"> 
  <meta property="og:locale" content="en_US"> 
  <meta property="og:type" content="article"> 
  <meta property="og:title" content="Deploying a Node app on Digital Ocean using Nginx. - Ryan Christiani - Front-End Developer"> 
  <meta property="og:description" content="Learn about deploying a node app on Digital Ocean using Nginx. Learn how to make it fast and easy, so you can spend less time configuring."> 
  <meta property="og:url" content="http://ryanchristiani.com/deploying-a-node-app-on-digital-ocean-using-nginx/"> 
  <meta property="og:site_name" content="Ryan Christiani - Front-End Developer"> 
  <meta property="article:tag" content="command line"> 
  <meta property="article:tag" content="digital ocean"> 
  <meta property="article:tag" content="nginx"> 
  <meta property="article:tag" content="node"> 
  <meta property="article:tag" content="npm"> 
  <meta property="article:section" content="Code"> 
  <meta property="article:published_time" content="2015-07-04T21:22:12+00:00"> 
  <meta property="article:modified_time" content="2015-07-27T20:32:39+00:00"> 
  <meta property="og:updated_time" content="2015-07-27T20:32:39+00:00"> 
  <meta property="og:image" content="http://ryanchristiani.com/wp-content/uploads/2015/07/do_node.png"> 
  <!-- / Yoast SEO plugin. --> 
  <link rel="alternate" type="application/rss+xml" title="Ryan Christiani - Front-End Developer » Feed" href="http://ryanchristiani.com/feed/"> 
  <link rel="alternate" type="application/rss+xml" title="Ryan Christiani - Front-End Developer » Comments Feed" href="http://ryanchristiani.com/comments/feed/"> 
  <script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/72x72\/","ext":".png","source":{"concatemoji":"http:\/\/ryanchristiani.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.5.10"}};
			!function(a,b,c){function d(a){var c,d,e,f=b.createElement("canvas"),g=f.getContext&&f.getContext("2d"),h=String.fromCharCode;if(!g||!g.fillText)return!1;switch(g.textBaseline="top",g.font="600 32px Arial",a){case"flag":return g.fillText(h(55356,56806,55356,56826),0,0),f.toDataURL().length>3e3;case"diversity":return g.fillText(h(55356,57221),0,0),c=g.getImageData(16,16,1,1).data,d=c[0]+","+c[1]+","+c[2]+","+c[3],g.fillText(h(55356,57221,55356,57343),0,0),c=g.getImageData(16,16,1,1).data,e=c[0]+","+c[1]+","+c[2]+","+c[3],d!==e;case"simple":return g.fillText(h(55357,56835),0,0),0!==g.getImageData(16,16,1,1).data[0];case"unicode8":return g.fillText(h(55356,57135),0,0),0!==g.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script> 
  <style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style> 
  <link rel="stylesheet" id="prismjs-css" href="http://ryanchristiani.com/wp-content/plugins/prism-syntax-highlighter/prism/default.css?ver=1.0" type="text/css" media="all"> 
  <link rel="stylesheet" id="style-css" href="http://ryanchristiani.com/wp-content/themes/Blog_Theme/style.css?ver=4.5.10" type="text/css" media="all"> 
  <link rel="stylesheet" id="fontawesome-css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css?ver=4.5.10" type="text/css" media="all"> 
  <link rel="stylesheet" id="jetpack_css-css" href="http://ryanchristiani.com/wp-content/plugins/jetpack/css/jetpack.css?ver=3.9.7" type="text/css" media="all"> 
  <link rel="https://api.w.org/" href="http://ryanchristiani.com/wp-json/"> 
  <link rel="shortlink" href="http://wp.me/p66SeF-d2"> 
  <link rel="alternate" type="application/json+oembed" href="http://ryanchristiani.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fryanchristiani.com%2Fdeploying-a-node-app-on-digital-ocean-using-nginx%2F"> 
  <link rel="alternate" type="text/xml+oembed" href="http://ryanchristiani.com/wp-json/oembed/1.0/embed?url=http%3A%2F%2Fryanchristiani.com%2Fdeploying-a-node-app-on-digital-ocean-using-nginx%2F&amp;format=xml"> 
  <style type="text/css">img#wpstats{display:none}</style>
 </head> 
 <body class="single single-post postid-808 single-format-standard"> 
  <nav> 
   <section class="lets-learn"> 
    <p>I just released a book called <a href="https://letslearnes6.com/">Let's Learn ES6</a>. <strong>Get comfortable</strong> with new syntax, <br><strong>Master</strong> new features &amp; become a <strong>better JavaScript Developer.</strong> </p> 
   </section> 
  </nav> 
  <div class="wrapper main clearfix"> 
   <header class="main"> 
    <a href="http://ryanchristiani.com/"> <img src="http://ryanchristiani.com/wp-content/themes/Blog_Theme/images/logo.png"> </a> 
    <div class="ad-area"> 
     <script async type="text/javascript" src="//cdn.carbonads.com/carbon.js?zoneid=1673&amp;serve=C6AILKT&amp;placement=ryanchristiani" id="_carbonads_js"></script> 
    </div> 
   </header> 
   <article> 
    <section class="blogpost clearfix post-808 post type-post status-publish format-standard hentry category-code tag-command-line tag-digital-ocean tag-nginx tag-node tag-npm" id="post-808"> 
     <header> 
      <div class="postType code"></div> 
      <h1><a href="http://ryanchristiani.com/deploying-a-node-app-on-digital-ocean-using-nginx/">Deploying a Node app on Digital Ocean using Nginx.</a></h1> 
      <p class="date"> July 4th, 2015 </p> 
     </header> 
     <div class="entry"> 
      <p><img src="http://ryanchristiani.com/wp-content/uploads/2015/07/do_node.png" alt="do_node" class="aligncenter center-img size-full wp-image-813" srcset="http://ryanchristiani.com/wp-content/uploads/2015/07/do_node.png 873w, http://ryanchristiani.com/wp-content/uploads/2015/07/do_node-300x73.png 300w" sizes="(max-width: 873px) 100vw, 873px"></p> 
      <p>This post will show you how to deploy to <a href="https://www.digitalocean.com/?refcode=a9a01be877f0">Digital Ocean</a>, if you need to sign up click the link there! First things first, select an image to use, I have been using Ubuntu and I find it nice and easy to use, so this post will be focused around that system. </p> 
      <p>Once you get an image selected you will now need to login to it. You will get an email with the IP and the password for the server. You need to use <code class="language-markup">shh</code> to login to this server. This is not as hard as it sounds. In your terminal:</p> 
      <pre>
<code class="language-markup">
    ssh root@ipaddress_here
</code>
</pre> 
      <p><span id="more-808"></span></p> 
      <p>It will prompt you to you enter the provided password and then ask you to create a new password from there. A note, when creating a new server you have the option to add and ssh key, so you can prevent the need for passwords. You might also want to create a new user and not use the <code class="language-markup">root</code> account, in this case we will just stick with the root user.</p> 
      <p>Once you are in there are a few things you will want to do. I prefer to use Nginx as a server and reverse proxy my node app through there. </p> 
      <pre>
<code class="language-markup">
apt-get update
apt-get install nginx
</code>
</pre> 
      <p>This will install Nginx on the computer, there is a few locations we need to worry ourselves with here. The first is <code class="language-markup">/usr/share/nginx/html</code>, this is where you will put your node app files. </p> 
      <pre>
<code class="language-markup">
cd /
cd /usr/share/nginx/html
</code>
</pre> 
      <p>Inside this folder I would use <code class="language-markup">git clone URL .</code> so you only get the contents of the git repo not a new folder with the repo name.</p> 
      <p>The next folder you will need to be concerned with <code class="language-markup">/etc/nginx/sites-available</code>, inside of here there is a file called <code class="language-markup">default</code>. This is our sever configuration file. Open it up in your editor of choice from the command line, I prefer nano. </p> 
      <pre>
<code class="language-markup">
nano default
</code>
</pre> 
      <p>There will be a bunch of configuration options already set up, but we need to concern ourselves with only a few, if you want you can also delete all the options here and apply just these.</p> 
      <pre>
<code class="language-markup">
server {
    listen 80;
		
    server_name yoursite.com;

    location / {
        proxy_pass http://127.0.0.1:4500;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
</code>
</pre> 
      <p>Inside of the <code class="language-markup">server</code> block we need to make sure that our Nginx sever is listening on port 80, set up the server name based on your url. </p> 
      <p>And then set up the location, the <code class="language-markup">/</code> will be the root location. Inside here we set up our <code class="language-markup">proxy_pass</code> variable to point to the port our node server is on. In this case we just use the internal IP for the server. A more secure method would to actually have two servers, one for the proxy and one for our app, and you would use the ip for that server in the <code class="language-markup">proxy_pass</code> variable. We will just us the one at the moment. To exit out of nano press <code class="language-markup">ctrl x</code> type <code class="language-markup">Y</code> and then enter. Make sure that nginx is up by running</p> 
      <pre>
<code class="language-makrup">
    service nginx start
</code>
</pre> 
      <p>If the server was running and you made changes to the config file you can run <code class="language-markup">nginx -s reload</code> and this will reload the config file for the server.</p> 
      <p>Now lets set up the the node app. <code class="language-markup">cd</code> into <code class="language-markup">/usr/share/nginx/html</code>. First things first, make sure we have node installed. </p> 
      <pre>
<code class="language-markup">
apt-get install nodejs
apt-get install npm

ln -s /usr/bin/nodejs /usr/bin/node
</code>
</pre> 
      <p>This allows us to just use the `node` command. Run `npm install` to install all of your packages, and also run `npm install -g forever`.</p> 
      <p>A side note, you can update Node using npm([source](http://davidwalsh.name/upgrade-nodejs)).</p> 
      <pre>
<code class="language-markup">
npm cache clean -f
npm install -g n
n stable
</code>
</pre> 
      <p>At the time of writing this there was a security patch set in 0.12.6 that is important, so I suggest you update if you are running an earlier version. </p> 
      <p>We will use the <code class="language-markup">forever</code> package for running our app, I would also suggest looking at the <code class="language-markup">pm2</code> package. </p> 
      <pre>
<code class="language-markup">
forever -w  --watchDirectory . start server.js
</code>
</pre> 
      <p>Using <code class="language-markup">forever</code> and the <code class="language-markup">-w</code> and the <code class="language-markup">--watchDirectory .</code> flag we can watch the file system for any changes. Running <code class="language-markup">forever list</code> you can see that the servers running from there.</p> 
      <p>And that is all you need for a simple application set up, there are more sophisticated deploys out there, but this is great for simple applications! I hope that helps you getting started deploying a node app on <a href="https://www.digitalocean.com/?refcode=a9a01be877f0">Digital Ocean</a>.</p> 
     </div> 
     <div class="postmetadata"> 
      <ul class="metaData">
       <li><a href="http://ryanchristiani.com/tag/command-line/" rel="tag">command line</a></li>
       <li><a href="http://ryanchristiani.com/tag/digital-ocean/" rel="tag">digital ocean</a></li>
       <li><a href="http://ryanchristiani.com/tag/nginx/" rel="tag">nginx</a></li>
       <li><a href="http://ryanchristiani.com/tag/node/" rel="tag">node</a></li>
       <li><a href="http://ryanchristiani.com/tag/npm/" rel="tag">npm</a></li>
      </ul> 
      <ul class="post-categories"> 
       <li><a href="http://ryanchristiani.com/category/code/" rel="category tag">Code</a></li>
      </ul> 
     </div> 
    </section> 
    <div class="clearright comments"> 
     <a href="https://twitter.com/RChristiani" class="twitter-follow-button" data-show-count="false">Follow @RChristiani</a> 
     <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script> 
     <div id="disqus_thread"> 
      <div id="dsq-content"> 
       <ul id="dsq-comments"> 
        <li class="post pingback"> <p>Pingback: <a href="http://ryanchristiani.com/setting-up-ssl-on-digital-ocean-with-node-and-nginx/" rel="external nofollow" class="url">Setting up SSL on Digital Ocean with Node and Nginx - Ryan Christiani - Front-End Developer - Ryan Christiani – Front-End Developer</a>()</p> </li> 
        <!-- #comment-## --> 
        <li class="comment even thread-even depth-1" id="dsq-comment-225"> 
         <div id="dsq-comment-header-225" class="dsq-comment-header"> 
          <cite id="dsq-cite-225"> <span id="dsq-author-user-225">sudeep</span> </cite> 
         </div> 
         <div id="dsq-comment-body-225" class="dsq-comment-body"> 
          <div id="dsq-comment-message-225" class="dsq-comment-message">
           <p>thanks but we can use PM2 insted of forever</p> 
          </div> 
         </div> 
         <ul class="children"> 
          <li class="comment odd alt depth-2" id="dsq-comment-243"> 
           <div id="dsq-comment-header-243" class="dsq-comment-header"> 
            <cite id="dsq-cite-243"> http://google.com/+Nkansahrexford <span id="dsq-author-user-243">Nkansah Rexford</span> </cite> 
           </div> 
           <div id="dsq-comment-body-243" class="dsq-comment-body"> 
            <div id="dsq-comment-message-243" class="dsq-comment-message">
             <p>I think you can use whatever you want, just get comfortable with the commands for the specific tool you wish to use. I’m gonna use supervisor or upstart for this.</p> 
            </div> 
           </div> </li>
          <!-- #comment-## --> 
         </ul>
         <!-- .children --> </li>
        <!-- #comment-## --> 
        <li class="comment even thread-odd thread-alt depth-1" id="dsq-comment-248"> 
         <div id="dsq-comment-header-248" class="dsq-comment-header"> 
          <cite id="dsq-cite-248"> <span id="dsq-author-user-248">Alvin Lin</span> </cite> 
         </div> 
         <div id="dsq-comment-body-248" class="dsq-comment-body"> 
          <div id="dsq-comment-message-248" class="dsq-comment-message">
           <p>Both forever and pm2 have issues with mangling the response data from the server. I had to deal with this obscure tidbit when I was writing a news summarizer for terminal. Apparently, forever and pm2 strip out ANSI color codes from the response data. If you’re curious, my project is hosted at nycurl.sytes.net<br> If you:<br> curl nycurl.sytes.net<br> in your terminal, you should get formatted news headlines with color. I solved this by hosting the server using screen and node instead. Although it doesn’t have the features that forever and pm2 offer, I figure it’s worth a mention.<br> screen<br> cd path/to/server<br> node server.js<br> Ctrl-A D</p> 
          </div> 
         </div> </li>
        <!-- #comment-## --> 
       </ul> 
      </div> 
     </div> 
     <script type="text/javascript">
var disqus_url = 'http://ryanchristiani.com/deploying-a-node-app-on-digital-ocean-using-nginx/';
var disqus_identifier = '808 http://ryanchristiani.com/?p=808';
var disqus_container_id = 'disqus_thread';
var disqus_shortname = 'ryanchristiani';
var disqus_title = "Deploying a Node app on Digital Ocean using Nginx.";
var disqus_config_custom = window.disqus_config;
var disqus_config = function () {
    /*
    All currently supported events:
    onReady: fires when everything is ready,
    onNewComment: fires when a new comment is posted,
    onIdentify: fires when user is authenticated
    */
    
    
    this.language = '';
        this.callbacks.onReady.push(function () {

        // sync comments in the background so we don't block the page
        var script = document.createElement('script');
        script.async = true;
        script.src = '?cf_action=sync_comments&post_id=808';

        var firstScript = document.getElementsByTagName('script')[0];
        firstScript.parentNode.insertBefore(script, firstScript);
    });
    
    if (disqus_config_custom) {
        disqus_config_custom.call(this);
    }
};

(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script> 
    </div> 
   </article> 
  </div> 
  <footer> 
   <div class="wrapper clearfix"> 
    <div class="innerwrapper clearfix"> 
     <div class="about"> 
      <p>Ryan Christiani is the Head Instructor &amp; Development Lead at HackerYou in Toronto. He is passionate about pizza, his teaching, and is committed to making tech education as accessible and exciting to others as it is to him. He is a man of many talents, and even more sneakers.</p> 
     </div> 
     <div class="contact clearfix"> 
      <ul> 
       <li> <a href="mailto:ryan@ryanchristiani.com" target="_blank"> <p> <i class="fa fa-envelope"></i> Email </p> </a> </li> 
       <li> <a href="https://github.com/Rchristiani" target="_blank"> <p> <i class="fa fa-github"></i> GitHub </p> </a> </li> 
       <li> <a href="https://twitter.com/RChristiani" target="_blank"> <p> <i class="fa fa-twitter"></i> Twitter </p> </a> </li> 
      </ul> 
     </div> 
     <p class="copy">©2017 Ryan Christiani</p> 
    </div> 
   </div> 
  </footer> 
  <script type="text/javascript">
        // <![CDATA[
        var disqus_shortname = 'ryanchristiani';
        (function () {
            var nodes = document.getElementsByTagName('span');
            for (var i = 0, url; i < nodes.length; i++) {
                if (nodes[i].className.indexOf('dsq-postid') != -1) {
                    nodes[i].parentNode.setAttribute('data-disqus-identifier', nodes[i].getAttribute('data-dsqidentifier'));
                    url = nodes[i].parentNode.href.split('#', 1);
                    if (url.length == 1) { url = url[0]; }
                    else { url = url[1]; }
                    nodes[i].parentNode.href = url + '#disqus_thread';
                }
            }
            var s = document.createElement('script'); 
            s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
        // ]]>
        </script> 
  <div style="display:none"> 
  </div> 
  <script type="text/javascript" src="http://ryanchristiani.com/wp-content/plugins/prism-syntax-highlighter/prism/prism.js?ver=1.0"></script> 
  <script type="text/javascript" src="http://ryanchristiani.com/wp-content/plugins/prism-syntax-highlighter/prism/prism-line-highlight.js?ver=1.0"></script> 
  <script type="text/javascript" src="http://ryanchristiani.com/wp-includes/js/comment-reply.min.js?ver=4.5.10"></script> 
  <script type="text/javascript" src="http://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201740"></script> 
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script> 
  <script type="text/javascript" src="http://s.gravatar.com/js/gprofiles.js?ver=2017Octaa"></script> 
  <script type="text/javascript">
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script> 
  <script type="text/javascript" src="http://ryanchristiani.com/wp-content/plugins/jetpack/modules/wpgroho.js?ver=4.5.10"></script> 
  <script type="text/javascript" src="http://ryanchristiani.com/wp-content/themes/Blog_Theme/js/plugins.js"></script> 
  <script type="text/javascript" src="http://ryanchristiani.com/wp-content/themes/Blog_Theme/js/main.min.js"></script> 
  <script type="text/javascript" src="http://ryanchristiani.com/wp-includes/js/wp-embed.min.js?ver=4.5.10"></script> 
  <script type="text/javascript" src="http://stats.wp.com/e-201740.js" async defer></script> 
  <script type="text/javascript">
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:3.9.7',blog:'90296469',post:'808',tz:'0',srv:'ryanchristiani.com'} ]);
	_stq.push([ 'clickTrackerInit', '90296469', '808' ]);
</script> 
  <!-- Don't forget analytics --> 
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-3980322-2', 'auto');
  ga('send', 'pageview');

</script>   
 </body>
</html>