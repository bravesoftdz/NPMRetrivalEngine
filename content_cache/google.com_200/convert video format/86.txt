<!doctype html>
<html ?>
 <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
  <link rel="canonical" href="https://code.lengstorf.com/learn-rollup-js/">
  <title>How to Bundle JavaScript With Rollup — Step-by-Step Tutorial
</title>
  <meta name="description" content="Learn how to use Rollup as a smaller, more efficient alternative  to webpack and Browserify to bundle JavaScript files in this  step-by-step tutorial series.
">
  <link rel="apple-touch-icon" sizes="57x57" href="https://code.lengstorf.com/apple-touch-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="https://code.lengstorf.com/apple-touch-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="https://code.lengstorf.com/apple-touch-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="https://code.lengstorf.com/apple-touch-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="https://code.lengstorf.com/apple-touch-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="https://code.lengstorf.com/apple-touch-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="https://code.lengstorf.com/apple-touch-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="https://code.lengstorf.com/apple-touch-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://code.lengstorf.com/apple-touch-icon-180x180.png">
  <link rel="icon" type="image/png" href="https://code.lengstorf.com/favicon-32x32.png?v=2" sizes="32x32">
  <link rel="icon" type="image/png" href="https://code.lengstorf.com/favicon-194x194.png?v=2" sizes="194x194">
  <link rel="icon" type="image/png" href="https://code.lengstorf.com/favicon-96x96.png?v=2" sizes="96x96">
  <link rel="icon" type="image/png" href="https://code.lengstorf.com/android-chrome-192x192.png?v=2" sizes="192x192">
  <link rel="icon" type="image/png" href="https://code.lengstorf.com/favicon-16x16.png?v=2" sizes="16x16">
  <link rel="manifest" href="https://code.lengstorf.com/manifest.json">
  <link rel="mask-icon" href="https://code.lengstorf.com/safari-pinned-tab.svg" color="#c319ff">
  <meta name="msapplication-TileColor" content="#c319ff">
  <meta name="msapplication-TileImage" content="/mstile-144x144.png">
  <meta name="theme-color" content="#faf8fd">
  <meta itemprop="wordCount" content="3814">
  <script type="application/ld+json">{
  "@context": "http://schema.org",
  "@type": "NewsArticle",
  "mainEntityOfPage": "https://code.lengstorf.com/learn-rollup-js/",
  "headline": "How to Bundle JavaScript With Rollup — Step-by-Step Tutorial\n",
  "datePublished": "2016-08-19T00:00:00Z",
  "dateModified": "2016-08-19T00:00:00Z",
  "description": "Learn how to use Rollup as a smaller, more efficient alternative  to webpack and Browserify to bundle JavaScript files in this  step-by-step tutorial series.\n",
  "author": {
    "@type": "Person",
    "name": "Jason Lengstorf"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Jason Lengstorf",
    "logo": {
      "@type": "ImageObject",
      "url": "https://code.lengstorf.com/images/code-lengstorf-logo.jpg",
      "width": 600,
      "height": 60
    }
  },
  "image": {
    "@type": "ImageObject",
    "url": "https://code.lengstorf.com/images/learn-rollup-js.jpg",
    "width": 1380,
    "height": 690
  }
}</script>
  <meta property="og:title" content="How to Bundle JavaScript With Rollup — Step-by-Step Tutorial
">
  <meta property="og:description" content="Learn how to use Rollup as a smaller, more efficient alternative  to webpack and Browserify to bundle JavaScript files in this  step-by-step tutorial series.
">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://code.lengstorf.com/learn-rollup-js/">
  <meta property="og:image" content="https://code.lengstorf.com/images/learn-rollup-js.jpg">
  <meta property="og:updated_time" content="2016-08-19T00:00:00Z">
  <meta property="article:author" content="https://www.facebook.com/jlengstorf">
  <meta property="article:publisher" content="https://www.facebook.com/jlengstorf">
  <meta property="article:published_time" content="2016-08-19T00:00:00Z">
  <meta property="article:modified_time" content="2016-08-19T00:00:00Z">
  <meta property="article:section" content="blog">
  <meta property="fb:admins" content="1468448880">
  <meta name="twitter:card" content="player">
  <meta name="twitter:player" content="https://www.youtube.com/embed/ICYLOZuFMz8">
  <meta name="twitter:player:width" content="480">
  <meta name="twitter:player:height" content="300">
  <meta name="twitter:image" content="https://code.lengstorf.com/images/learn-rollup-js.jpg">
  <meta name="twitter:title" content="How to Bundle JavaScript With Rollup — Step-by-Step Tutorial
">
  <meta name="twitter:description" content="Learn how to use Rollup as a smaller, more efficient alternative  to webpack and Browserify to bundle JavaScript files in this  step-by-step tutorial series.
">
  <style amp-custom>body{background:#fff;color:#110117}@font-face{font-family:mallory;src:url(/fonts/Mallory-Book.eot);src:url(/fonts/Mallory-Book.eot?#iefix) format('embedded-opentype'),url(/fonts/Mallory-Book.woff) format('woff');font-weight:400;font-style:normal}@font-face{font-family:mallory;src:url(/fonts/Mallory-Bold.eot);src:url(/fonts/Mallory-Bold.eot?#iefix) format('embedded-opentype'),url(/fonts/Mallory-Bold.woff) format('woff');font-weight:700;font-style:normal}@font-face{font-family:mallory;src:url(/fonts/Mallory-Black.eot);src:url(/fonts/Mallory-Black.eot?#iefix) format('embedded-opentype'),url(/fonts/Mallory-Black.woff) format('woff');font-weight:800;font-style:normal}@font-face{font-family:mallory-microplus;src:url(/fonts/MalloryMP-Book.eot);src:url(/fonts/MalloryMP-Book.eot?#iefix) format('embedded-opentype'),url(/fonts/MalloryMP-Book.woff) format('woff');font-weight:400;font-style:normal}@font-face{font-family:mallory-microplus;src:url(/fonts/MalloryMP-BookItalic.eot);src:url(/fonts/MalloryMP-BookItalic.eot?#iefix) format('embedded-opentype'),url(/fonts/MalloryMP-BookItalic.woff) format('woff');font-weight:400;font-style:italic}@font-face{font-family:mallory-microplus;src:url(/fonts/MalloryMP-Bold.eot);src:url(/fonts/MalloryMP-Bold.eot?#iefix) format('embedded-opentype'),url(/fonts/MalloryMP-Bold.woff) format('woff');font-weight:700;font-style:normal}@font-face{font-family:mallory-microplus;src:url(/fonts/MalloryMP-BoldItalic.eot);src:url(/fonts/MalloryMP-BoldItalic.eot?#iefix) format('embedded-opentype'),url(/fonts/MalloryMP-BoldItalic.woff) format('woff');font-weight:700;font-style:italic}body,html{color:#584d5d;font-family:mallory-microplus,sans-serif;font-size:14px;line-height:1.75;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}@media (min-width:768px){body,html{font-size:17.5px}}code,pre{font-family:monospace;text-transform:none}h1,h2,h3,h4,h5,h6{color:#110117;font-family:mallory,sans-serif;line-height:1}h2+*,h3+*{margin-top:8px;margin-top:.5rem}@media (min-width:768px){h2+*,h3+*{margin-top:.33333rem}}:not(.figure)+h2:not([class]),:not(.figure)+h3:not([class]),:not(.figure)+h4:not([class]),:not(.figure)+h5:not([class]),:not(.figure)+h6:not([class]){margin-top:32px;margin-top:2rem}h1{font-size:275%}h2{font-size:175%;font-weight:700}h2 strong{font-weight:400}h3{font-size:125%;font-weight:800}h3,h4{text-transform:uppercase}h4{color:#8a828e;font-size:115%;font-weight:400;letter-spacing:.05em}sup{position:relative;top:-8px;top:-.5rem;margin:0 .25em;font-size:10.5px;line-height:.75;vertical-align:baseline}sup>a[rel]{display:inline-block;height:14px;width:14px;background-color:#8a828e;border:0;border-radius:50%;color:#fff;font-size:9px;font-style:normal;font-weight:700;line-height:16px;text-align:center;text-decoration:none;-webkit-transition:background-color .2s linear;transition:background-color .2s linear}sup>a[rel]:active,sup>a[rel]:focus,sup>a[rel]:hover{background-color:#110117;border:0;outline:none}ol ol,ol ul,ul ol,ul ul{margin-bottom:8px;margin-bottom:.5rem}li,ol ol,ol ul,ul ol,ul ul{margin-top:4px;margin-top:.25rem}aside{font-family:mallory-microplus,sans-serif}code{display:inline-block;margin-top:0;padding:0 .25em;background:#faf8fd;border:1px solid #e1dfe4;border-radius:4px;font-size:100%;line-height:1.375}.code-caption{margin-top:-28px;margin-top:-1.75rem;color:#8a828e;font-size:9px;letter-spacing:.05em;line-height:1.2;text-transform:uppercase}.code-caption a{color:inherit}*{margin:0;box-sizing:border-box}*+*{margin-top:12px;margin-top:.75rem}@media (min-width:768px){*+*{margin-top:1.25rem}}body{margin:0}.sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.highlight{background-color:#272822}.highlight code{background:transparent;border:0}.highlight .hll{background-color:#49483e}.highlight .c{color:#75715e}.highlight .err{color:#960050;background-color:#1e0010}.highlight .k{color:#66d9ef}.highlight .l{color:#ae81ff}.highlight .n{color:#f8f8f2}.highlight .o{color:#f92672}.highlight .p{color:#f8f8f2}.highlight .c1,.highlight .cm,.highlight .cp,.highlight .cs{color:#75715e}.highlight .ge{font-style:italic}.highlight .gs{font-weight:700}.highlight .kc,.highlight .kd{color:#66d9ef}.highlight .kn{color:#f92672}.highlight .kp,.highlight .kr,.highlight .kt{color:#66d9ef}.highlight .ld{color:#e6db74}.highlight .m{color:#ae81ff}.highlight .s{color:#e6db74}.highlight .na{color:#a6e22e}.highlight .nb{color:#f8f8f2}.highlight .nc{color:#a6e22e}.highlight .no{color:#66d9ef}.highlight .nd{color:#a6e22e}.highlight .ni{color:#f8f8f2}.highlight .ne,.highlight .nf{color:#a6e22e}.highlight .nl,.highlight .nn{color:#f8f8f2}.highlight .nx{color:#a6e22e}.highlight .py{color:#f8f8f2}.highlight .nt{color:#f92672}.highlight .nv{color:#f8f8f2}.highlight .ow{color:#f92672}.highlight .w{color:#f8f8f2}.highlight .mf,.highlight .mh,.highlight .mi,.highlight .mo{color:#ae81ff}.highlight .s2,.highlight .sb,.highlight .sc,.highlight .sd{color:#e6db74}.highlight .se{color:#ae81ff}.highlight .s1,.highlight .sh,.highlight .si,.highlight .sr,.highlight .ss,.highlight .sx{color:#e6db74}.highlight .bp,.highlight .vc,.highlight .vg,.highlight .vi{color:#f8f8f2}.highlight .il{color:#ae81ff}.highlight .gu{color:#75715e}.highlight .gd{color:#f92672}.highlight .gi{color:#a6e22e}.article{display:block}@supports (display:flex){.article{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}}.article__header{overflow:hidden}@supports (display:flex){.article__header{-webkit-box-flex:3;-ms-flex:3 100%;flex:3 100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}}@media (min-width:768px){.article__header{-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}}.article__header--front-end{color:#c319ff}.article__header--api{color:#1999ff}.article__header--build-tools{color:#65e200}.article__header--devops{color:#ff8a00}.article__header--cms{color:#ff2414}.article__heading-group{-webkit-box-ordinal-group:3;-ms-flex-order:2;order:2;min-width:300px;padding:24px 5vw;padding:1.5rem 5vw}@media (min-width:768px){.article__heading-group{-webkit-box-flex:2;-ms-flex:2 75%;flex:2 75%;max-width:75vw;padding:4rem 2rem 1rem}}.article__heading{display:block;color:#110117;font-size:8vw}@media (min-width:480px){.article__heading{font-size:6vw}}@media (min-width:768px){.article__heading{max-width:750px;font-size:250%}}.article__heading-link{color:inherit;text-decoration:none}.article__subheading{margin-top:8px;margin-top:.5rem;font-family:mallory-microplus,sans-serif;font-size:4.75vw;font-weight:700;line-height:1.25}@media (min-width:480px){.article__subheading{font-size:3.25vw}}@media (min-width:768px){.article__subheading{max-width:750px;font-size:125%;line-height:1.1}}.article__meta-group{-webkit-box-ordinal-group:2;-ms-flex-order:1;order:1;margin:0;min-width:25vw}@media (min-width:768px){.article__video{padding-right:5vw}}.article__table-of-contents-heading{padding-left:.5vw;border-left:2px solid transparent;color:#9b949e;font-size:62.5%;font-weight:400;letter-spacing:.05em;line-height:1;text-transform:uppercase}.article__table-of-contents{display:none;float:left;max-width:26vw;min-width:25vw;padding:24px 5vw;padding:1.5rem 5vw;line-height:1.5}@supports (display:flex){.article__table-of-contents{-webkit-box-flex:1;-ms-flex:1 25%;flex:1 25%;max-width:25vw;float:none}}@media (min-width:768px){.article__table-of-contents{display:block}}.article__table-of-contents nav{margin-top:0}.article__table-of-contents-list,.article__table-of-contents ul{list-style:none;margin:0;padding:0}ul.article__table-of-contents-list{border-bottom:2px solid transparent;padding-bottom:16px;padding-bottom:1rem}.article--front-end ul.article__table-of-contents-list{border-color:#c319ff}.article--api ul.article__table-of-contents-list{border-color:#1999ff}.article--build-tools ul.article__table-of-contents-list{border-color:#65e200}.article--devops ul.article__table-of-contents-list{border-color:#ff8a00}.article--cms ul.article__table-of-contents-list{border-color:#ff2414}.article__table-of-contents-list-item,.article__table-of-contents li li li{margin-top:4px;margin-top:.25rem;padding-left:.75vw;color:#8a828e;font-size:85%;font-weight:400}.article__table-of-contents-link,.article__table-of-contents nav>ul>li>ul>li{margin-top:8px;margin-top:.5rem;color:#584d5d;font-size:75%;font-weight:700}.article__table-of-contents-link{font-weight:400}.article__table-of-contents-link--selected{font-weight:700}.article__table-of-contents nav>ul>li>ul>li>ul>li{color:#695f6d}.article__table-of-contents nav>ul>li>ul>li>ul>li>ul>li{letter-spacing:.05em;line-height:1.2;text-transform:uppercase}.article__table-of-contents-link,.article__table-of-contents a{display:block;padding:0 .25vw 0 .5vw;color:inherit;text-decoration:none;border-left:2px solid transparent}.article__table-of-contents-link--selected,.article__table-of-contents-link:active,.article__table-of-contents-link:focus,.article__table-of-contents-link:hover,.article__table-of-contents a--selected,.article__table-of-contents a:active,.article__table-of-contents a:focus,.article__table-of-contents a:hover{background-color:#faf8fd;border-color:#e1dfe4;outline:none}.article--front-end .article__table-of-contents-link--selected,.article--front-end .article__table-of-contents-link:active,.article--front-end .article__table-of-contents-link:focus,.article--front-end .article__table-of-contents-link:hover,.article--front-end .article__table-of-contents a--selected,.article--front-end .article__table-of-contents a:active,.article--front-end .article__table-of-contents a:focus,.article--front-end .article__table-of-contents a:hover{background-color:#f9e8ff;border-color:#c319ff}.article--api .article__table-of-contents-link--selected,.article--api .article__table-of-contents-link:active,.article--api .article__table-of-contents-link:focus,.article--api .article__table-of-contents-link:hover,.article--api .article__table-of-contents a--selected,.article--api .article__table-of-contents a:active,.article--api .article__table-of-contents a:focus,.article--api .article__table-of-contents a:hover{background-color:#e8f5ff;border-color:#1999ff}.article--build-tools .article__table-of-contents-link--selected,.article--build-tools .article__table-of-contents-link:active,.article--build-tools .article__table-of-contents-link:focus,.article--build-tools .article__table-of-contents-link:hover,.article--build-tools .article__table-of-contents a--selected,.article--build-tools .article__table-of-contents a:active,.article--build-tools .article__table-of-contents a:focus,.article--build-tools .article__table-of-contents a:hover{background-color:#f0fce6;border-color:#65e200}.article--devops .article__table-of-contents-link--selected,.article--devops .article__table-of-contents-link:active,.article--devops .article__table-of-contents-link:focus,.article--devops .article__table-of-contents-link:hover,.article--devops .article__table-of-contents a--selected,.article--devops .article__table-of-contents a:active,.article--devops .article__table-of-contents a:focus,.article--devops .article__table-of-contents a:hover{background-color:#fff3e6;border-color:#ff8a00}.article--cms .article__table-of-contents-link--selected,.article--cms .article__table-of-contents-link:active,.article--cms .article__table-of-contents-link:focus,.article--cms .article__table-of-contents-link:hover,.article--cms .article__table-of-contents a--selected,.article--cms .article__table-of-contents a:active,.article--cms .article__table-of-contents a:focus,.article--cms .article__table-of-contents a:hover{background-color:#ffe9e8;border-color:#ff2414}.article__content{float:left;min-width:70vw;margin:0;padding:32px 5vw;padding:2rem 5vw;background-image:-webkit-linear-gradient(285deg,#fbf9fd,rgba(251,249,253,0) 50vw);background-image:linear-gradient(165deg,#fbf9fd,rgba(251,249,253,0) 50vw)}@supports (display:flex){.article__content{-webkit-box-flex:2;-ms-flex:2 100%;flex:2 100%;float:none}}@media (min-width:768px){.article__content{max-width:75vw;padding:3rem 0 5rem 2rem;border-left:2px solid #fff;border-top:2px solid #fff}@supports (display:flex){.article__content{-webkit-box-flex:2;-ms-flex:2 74%;flex:2 74%;min-width:0;max-width:75%}}}.article__content--front-end{background-image:-webkit-linear-gradient(285deg,#f9e8ff,rgba(249,232,255,0) 50vw);background-image:linear-gradient(165deg,#f9e8ff,rgba(249,232,255,0) 50vw)}.article__content--api{background-image:-webkit-linear-gradient(285deg,#e8f5ff,rgba(232,245,255,0) 50vw);background-image:linear-gradient(165deg,#e8f5ff,rgba(232,245,255,0) 50vw)}.article__content--build-tools{background-image:-webkit-linear-gradient(285deg,#f0fce6,hsla(93,79%,95%,0) 50vw);background-image:linear-gradient(165deg,#f0fce6,hsla(93,79%,95%,0) 50vw)}.article__content--devops{background-image:-webkit-linear-gradient(285deg,#fff3e6,rgba(255,243,230,0) 50vw);background-image:linear-gradient(165deg,#fff3e6,rgba(255,243,230,0) 50vw)}.article__content--cms{background-image:-webkit-linear-gradient(285deg,#ffe9e8,hsla(3,100%,95%,0) 50vw);background-image:linear-gradient(165deg,#ffe9e8,hsla(3,100%,95%,0) 50vw)}.article__content .codepen,.article__content>:not([class]){max-width:750px}@media (min-width:768px){.article__content .codepen,.article__content>:not([class]){margin-right:5vw}}.article__aside{display:block;max-width:750px;padding:16px 2vw;padding:1rem 2vw;font-size:75%;line-height:1.5;background:#faf8fd;border:1px solid #eeecf0}@media (min-width:768px){.article__aside{margin-right:5vw}}.article--front-end .article__aside{background-color:#f9e8ff;border-color:#f3d1ff}.article--api .article__aside{background-color:#e8f5ff;border-color:#d1ebff}.article--build-tools .article__aside{background-color:#f0fce6;border-color:#e0f9cc}.article--devops .article__aside{background-color:#fff3e6;border-color:#ffe8cc}.article--cms .article__aside{background-color:#ffe9e8;border-color:#ffd3d0}.article amp-youtube{max-width:950px;border:1px solid #eeecf0}.article amp-img{background:#eeecf0;border:1px solid #eeecf0;border-radius:50%}.article i-amp-scroll-container{margin-top:0}.article__discussion{max-width:750px;margin-top:48px;margin-top:3rem}.aside{display:inline-block;margin:0;background:#e6e6e6;line-height:1.25;text-decoration:none}.aside:before{content:'';right:calc(1vw * 5 + 200px);width:100px;height:.625em;border-bottom:1px dashed #ccc}.aside:after,.aside:before{position:absolute;display:block}.aside:after{content:attr(data-aside);right:5vw;-webkit-transform:translateY(-55%);transform:translateY(-55%);width:200px;margin:0;padding:16px;padding:1rem;font-size:75%;background:#e6e6e6;border:1px dashed #ccc}.figure{max-width:100%}.figure--alignright{display:block;max-width:300px;margin-left:auto;margin-right:auto;margin-bottom:32px;margin-bottom:2rem}@media (min-width:600px){.figure--alignright{float:right;margin-left:2rem;margin-right:2rem}}@media (min-width:768px){.figure--alignright{max-width:200px}}@media (min-width:1024px){.figure--alignright{max-width:300px}}@media (min-width:1500px){.figure--alignright{margin-right:calc(100% - 1050px)}}amp-img.figure__image{border-radius:0;max-width:100%}.figure__caption{margin-top:4px;margin-top:.25rem;color:#8a828e;font-size:9px;letter-spacing:.05em;line-height:1.2;text-transform:uppercase}.footer{display:block;width:100%;padding:32px 5vw;padding:2rem 5vw;background-color:#faf8fd;border-bottom:1px solid #eeecf0;border-top:1px solid #eeecf0;text-align:center}@media (min-width:650px){.footer{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;padding-left:0;padding-right:0}.footer__meta{-webkit-box-flex:1;-ms-flex:1 25%;flex:1 25%;min-width:25vw;padding-right:1rem;text-align:right}.footer__bio{-webkit-box-flex:2;-ms-flex:2 75%;flex:2 75%;min-width:75vw;margin-top:0;padding:0 2rem;text-align:left}}.footer__image{display:inline-block;width:150px;height:150px;border-radius:50%}.footer__links{max-width:750px;margin-left:auto;margin-right:auto}@media (min-width:650px){.footer__links{display:block;max-width:125px;margin-top:0;margin-right:0;text-align:center}}.footer__link{display:inline-block;max-width:30px;margin:0 16px;margin:0 1rem}@media (min-width:650px){.footer__link{max-width:20px;margin:0 .5rem}}.footer__link:active,.footer__link:focus,.footer__link:hover{outline:0}.footer__link:active path,.footer__link:focus path,.footer__link:hover path{fill:#110117}.footer__icon{width:100%}.footer__icon path{fill:#584d5d;-webkit-transition:fill .2s ease-in-out;transition:fill .2s ease-in-out}h3.footer__heading{max-width:750px;margin-left:auto;margin-right:auto;margin-top:8px;margin-top:.5rem}@media (min-width:650px){h3.footer__heading{margin:0}}.footer__worked-with{color:#8a828e;font-size:8px;font-weight:400;letter-spacing:.1em;text-transform:uppercase}amp-img.footer__worked-with-image{margin-top:0;background-color:transparent;border:0;border-radius:0;max-width:100%}.footer__blurb{max-width:750px;margin-left:auto;margin-right:auto}@media (min-width:650px){.footer__blurb{margin-left:0;margin-right:0}}@media (min-width:768px){.footer__blurb{font-size:85%}}.footnotes{max-width:750px;color:#8a828e;font-size:87.5%}.footnotes hr{border-top:1px solid #faf8fd}.footnotes ol{padding-left:0;counter-reset:a;list-style:none}.footnotes li{position:relative;margin:0;padding:7px;padding-left:28px;border:1px solid transparent;border-radius:7px;-webkit-transition:all .2s ease-in-out;transition:all .2s ease-in-out}.footnotes li:before{counter-increment:a;content:counter(a);position:absolute;left:7px;top:10px;display:inline-block;width:14px;height:14px;background-color:#8a828e;border:0;border-radius:50%;color:#fff;font-size:9px;font-weight:700;line-height:16px;text-align:center;text-decoration:none;-webkit-transition:background-color .2s linear;transition:background-color .2s linear}.highlight{clear:both;margin-bottom:32px;margin-bottom:2rem;margin-top:32px;margin-top:2rem;padding:16px 5vw;padding:1rem 5vw;border-right:20px solid #272822;overflow-x:scroll}@media (min-width:768px){.highlight{padding-left:20px;padding-right:20px}}.highlight pre{width:410px;color:#fff;font-size:80%}@media (min-width:768px){.highlight pre{width:600px;font-size:95%}}.meta{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row;background:#faf8fd;padding:8px 16px;padding:.5rem 1rem;text-align:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}@media (min-width:768px){.meta{-webkit-box-align:stretch;-ms-flex-align:stretch;align-items:stretch;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;padding:1rem;text-align:right}}.meta--front-end{background-color:#c319ff}.meta--api{background-color:#1999ff}.meta--build-tools{background-color:#65e200}.meta--devops{background-color:#ff8a00}.meta--cms{background-color:#ff2414}.meta__item{display:inline-block;-webkit-box-flex:1;-ms-flex:1 20%;flex:1 20%;margin:0 2vw;color:#fff;font-family:mallory-microplus,sans-serif;font-size:62.5%;line-height:1.375}@media (min-width:768px){.meta__item{-webkit-box-flex:0;-ms-flex:none;flex:none;display:block;margin:0;line-height:1.75}}.meta__item--date{font-weight:700}@media (min-width:768px){.meta__item--date{margin-top:0;font-size:100%;line-height:2.5}@supports (display:flex){.meta__item--date{margin-top:auto}}}.meta__item--category:before{content:'Posted in '}.meta__tag{color:inherit;text-decoration:none;text-transform:lowercase}.meta__tag:before{content:'#'}.meta__tag:active,.meta__tag:focus,.meta__tag:hover{outline:0;text-decoration:underline}.nav{position:relative;display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap;justify-conent:space-between;z-index:10}.nav__link{-webkit-box-flex:1;-ms-flex:1;flex:1;margin:0;margin-left:2px;padding:8px 1vw;padding:.5rem 1vw;min-width:55px;max-width:calc(1vw * 15 - 2px);background-color:#e7e6e8;border-bottom:4px solid #110117;color:#110117;font-family:mallory-microplus,sans-serif;font-size:62.5%;font-weight:700;line-height:1.2;text-align:center;text-decoration:none;-webkit-transition:all .25s ease-in-out;transition:all .25s ease-in-out}@media (min-width:768px){.nav__link{padding:.25rem 1vw;line-height:1.75;text-align:right}}.nav__link:active,.nav__link:focus,.nav__link:hover{outline:0;padding-bottom:8px;padding-bottom:.5rem;padding-top:8px;padding-top:.5rem;margin-bottom:-8px;margin-bottom:-.5rem}.nav__link--home{-webkit-box-flex:1;-ms-flex:1;flex:1;max-width:25vw;min-width:20px;margin-left:0;color:#fff;background-color:#110117;font-family:monospace;font-weight:400}.nav__link--home:active,.nav__link--home:focus,.nav__link--home:hover{margin-bottom:0;padding-bottom:4px;padding-bottom:.25rem;padding-top:4px;padding-top:.25rem;color:#ff2414}.nav__link--front-end{background-color:#f9e8ff;border-color:#c319ff}.nav__link--api{background-color:#e8f5ff;border-color:#1999ff}.nav__link--build-tools{background-color:#f0fce6;border-color:#65e200}.nav__link--devops{background-color:#fff3e6;border-color:#ff8a00}.nav__link--cms{background-color:#ffe9e8;border-color:#ff2414}.pagination{list-style:none;padding:0;text-align:center}.pagination__item{display:inline-block;margin:0 4px;margin:0 .25rem}.pagination__link{display:block;width:20px;width:1.25rem;background-color:transparent;border-radius:50%;color:#584d5d;font-size:10px;font-weight:700;line-height:20px;line-height:1.25rem;text-decoration:none;-webkit-transition:all .2s linear;transition:all .2s linear}.pagination__link--current,.pagination__link:active,.pagination__link:focus,.pagination__link:hover{background-color:#584d5d;color:#fff}.post-list__header{padding:8px 5vw;padding:.5rem 5vw;background-color:#faf8fd;text-align:center}.post-list__heading{font-size:75%;font-weight:400;letter-spacing:.1em;text-transform:uppercase}.post-list__article{margin-top:2px;border-bottom:2px solid #faf8fd}.post-list__article:first-child{margin-top:0}.post-list__article--front-end{border-color:#c319ff}.post-list__article--api{border-color:#1999ff}.post-list__article--build-tools{border-color:#65e200}.post-list__article--devops{border-color:#ff8a00}.post-list__article--cms{border-color:#ff2414}.post-list__read-more{display:block;margin-top:16px;margin-top:1rem;padding:4px 16px 2px;padding:.25rem 1rem .125rem;text-align:center;background:rgba(250,248,253,0);border:2px solid #110117;border-radius:8px;color:#110117;font-family:mallory-microplus,sans-serif;font-size:90%;font-weight:700;letter-spacing:.1em;line-height:1.5;text-decoration:none;text-transform:uppercase;-webkit-transition:all .1s linear;transition:all .1s linear}@media (min-width:360px){.post-list__read-more{max-width:240px;margin-left:auto;margin-right:auto}}@media (min-width:640px){.post-list__read-more{margin-left:0;margin-right:0}}.post-list__read-more--front-end{border-color:#c319ff;color:#c319ff}.post-list__read-more--front-end:active,.post-list__read-more--front-end:focus,.post-list__read-more--front-end:hover{background-color:#c319ff}.post-list__read-more--api{border-color:#1999ff;color:#1999ff}.post-list__read-more--api:active,.post-list__read-more--api:focus,.post-list__read-more--api:hover{background-color:#1999ff}.post-list__read-more--build-tools{border-color:#65e200;color:#65e200}.post-list__read-more--build-tools:active,.post-list__read-more--build-tools:focus,.post-list__read-more--build-tools:hover{background-color:#65e200}.post-list__read-more--devops{border-color:#ff8a00;color:#ff8a00}.post-list__read-more--devops:active,.post-list__read-more--devops:focus,.post-list__read-more--devops:hover{background-color:#ff8a00}.post-list__read-more--cms{border-color:#ff2414;color:#ff2414}.post-list__read-more--cms:active,.post-list__read-more--cms:focus,.post-list__read-more--cms:hover{background-color:#ff2414}.post-list__read-more:active,.post-list__read-more:focus,.post-list__read-more:hover{color:#fff;outline:0}.series-nav{padding:0}.series-nav__item{position:relative;display:block;max-width:750px;margin-top:16px;margin-top:1rem;line-height:1.25}.series-nav__item--current{padding-right:85px;font-weight:700}.series-nav__item--current a{text-decoration:none}.series-nav__item--current:after{content:'? YOU ARE HERE';position:absolute;right:0;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);width:80px;padding:2px 0 2px 4px;background-color:#584d5d;border-radius:.125rem;color:#fff;font-size:8px}.article--front-end .series-nav__item--current:after{background-color:#c319ff}.article--api .series-nav__item--current:after{background-color:#1999ff}.article--build-tools .series-nav__item--current:after{background-color:#65e200}.article--devops .series-nav__item--current:after{background-color:#ff8a00}.article--cms .series-nav__item--current:after{background-color:#ff2414}@media (min-width:650px){.series-nav__item{margin-left:85px}.series-nav__item--current{padding-right:0}.series-nav__item--current:after{content:'YOU ARE HERE ?';right:auto;left:-90px}}.site-footer{margin:0;padding:32px 5vw;padding:2rem 5vw;color:#9b949e;font-family:mallory-microplus,sans-serif;text-align:center}.site-footer__nav-links{margin-top:8px;margin-top:.5rem}.site-footer__nav-link{display:inline-block;margin:0;padding:0 .5vw;color:inherit;font-size:70%;text-decoration:none}.site-footer__nav-link:active,.site-footer__nav-link:focus,.site-footer__nav-link:hover{outline:none;text-decoration:underline}.site-footer__credits{font-size:75%}.site-footer__credits a{color:inherit;text-decoration:none}.site-footer__credits a:active,.site-footer__credits a:focus,.site-footer__credits a:hover{outline:none;text-decoration:underline}.site-header{margin-top:0;background-color:#fff;border-bottom:2px solid #fff}.site-content{margin-top:0}.site-content__article{position:relative}
 
</style>
  <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}
</style>
  <noscript>
   <style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style>
  </noscript>
  <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
  <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
  <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
  <script async src="https://cdn.ampproject.org/v0.js"></script>
 </head>
 <body class="no-js">
  <amp-analytics type="googleanalytics" id="analytics1">
   <script type="application/json">{
  "vars": {
    "account": "UA-39001606-2"
  },
  "triggers": {
    "trackPageview": {
      "on": "visible",
      "request": "pageview"
    }
  }
}</script>
  </amp-analytics>
  <header class="site-header">
   <nav class="site-header__nav nav nav--main">
    <a class="nav__link nav__link--home" href="https://code.lengstorf.com/" title="Jason Lengstorf on code">&lt;jl/&gt;</a> 
    <a class="nav__link nav__link--front-end" href="https://code.lengstorf.com/category/front-end/" title="">Front-End</a> 
    <a class="nav__link nav__link--api" href="https://code.lengstorf.com/category/api/" title="">APIs</a> 
    <a class="nav__link nav__link--build-tools" href="https://code.lengstorf.com/category/build-tools/" title="">Build Tools</a> 
    <a class="nav__link nav__link--devops" href="https://code.lengstorf.com/category/devops/" title="">DevOps</a> 
    <a class="nav__link nav__link--cms" href="https://code.lengstorf.com/category/cms/" title="">CMS</a> 
   </nav>
  </header>
  <main class="site-content">
   <article class="site-content__article article article--build-tools">
    <header class="article__header article__header--build-tools">
     <div class="article__heading-group">
      <h1 class="article__heading">Rollup.js Tutorial, Part 1: How to Set Up Smaller, More Efficient JavaScript Bundling Using Rollup </h1>
      <p class="article__subheading">Learn how to use Rollup as a smaller, more efficient alternative to webpack and Browserify to bundle JavaScript files in this step-by-step tutorial series.</p>
     </div>
     <dl class="article__meta-group meta meta--build-tools">
      <dt class="meta__label sr-only">
       Date:
      </dt>
      <dl class="meta__item meta__item--date">
       <time datetime="2016-08-19T00:00:00Z">Aug 19, 2016</time>
      </dl>
      <dt class="meta__label sr-only">
       Main Topic:
      </dt>
      <dl class="meta__item meta__item--category">
       Build Tools &amp; Automation
      </dl>
      <dt class="meta__label sr-only">
       Tags:
      </dt>
      <dl class="meta__item meta__item--tags">
       <a class="meta__tag" href="https://code.lengstorf.com/tag/rollup/">rollup</a> 
       <a class="meta__tag" href="https://code.lengstorf.com/tag/javascript/">javascript</a> 
       <a class="meta__tag" href="https://code.lengstorf.com/tag/babel/">babel</a> 
       <a class="meta__tag" href="https://code.lengstorf.com/tag/modules/">modules</a> 
      </dl>
     </dl>
    </header>
    <aside class="article__table-of-contents">
     <h4 class="article__table-of-contents-heading">In This Series:</h4>
     <ul class="article__table-of-contents-list">
      <li class="article__table-of-contents-item"><a class="article__table-of-contents-link article__table-of-contents-link--selected" href="https://code.lengstorf.com/learn-rollup-js/">How to Set Up Smaller, More Efficient JavaScript Bundling Using Rollup </a></li>
      <li class="article__table-of-contents-item"><a class="article__table-of-contents-link " href="https://code.lengstorf.com/learn-rollup-css/">How to Bundle Stylesheets and Add LiveReload With Rollup</a></li>
     </ul>
     <h4 class="article__table-of-contents-heading">In This Article:</h4>
     <nav id="TableOfContents"> 
      <ul> 
       <li> 
        <ul> 
         <li><a href="#prerequisites">Prerequisites</a></li> 
         <li><a href="#series-navigation">Series Navigation</a></li> 
         <li><a href="#what-is-rollup">What Is Rollup?</a> 
          <ul> 
           <li><a href="#why-should-you-care-about-rollup">Why should you care about Rollup?</a></li> 
          </ul></li> 
         <li><a href="#part-i-how-to-use-rollup-to-process-and-bundle-javascript-files">Part I: How to Use Rollup to Process and Bundle JavaScript Files</a> 
          <ul> 
           <li><a href="#step-0-create-a-project-with-javascript-and-css-to-be-compiled">Step 0: Create a project with JavaScript and CSS to be compiled.</a></li> 
           <li><a href="#step-1-install-rollup-and-create-a-configuration-file">Step 1: Install Rollup and create a configuration file.</a> 
            <ul> 
             <li><a href="#test-the-rollup-configuration">Test the Rollup configuration.</a></li> 
             <li><a href="#look-at-the-bundled-output">Look at the Bundled Output</a></li> 
            </ul></li> 
           <li><a href="#step-2-set-up-babel-so-we-can-use-new-javascript-features-now">Step 2: Set up Babel so we can use new JavaScript features now.</a> 
            <ul> 
             <li><a href="#install-the-necessary-modules">Install the necessary modules.</a></li> 
             <li><a href="#create-a-babelrc">Create a <code>.babelrc</code>.</a></li> 
             <li><a href="#update-rollup-config-js">Update <code>rollup.config.js</code>.</a></li> 
             <li><a href="#check-the-bundle-output">Check the bundle output.</a></li> 
            </ul></li> 
           <li><a href="#step-3-add-eslint-to-check-for-common-javascript-errors">Step 3: Add ESLint to check for common JavaScript errors.</a> 
            <ul> 
             <li><a href="#install-the-modules">Install the Modules.</a></li> 
             <li><a href="#generate-a-eslintrc-json">Generate a <code>.eslintrc.json</code>.</a></li> 
             <li><a href="#tweak-eslintrc-json">Tweak <code>.eslintrc.json</code>.</a></li> 
             <li><a href="#update-rollup-config-js-1">Update <code>rollup.config.js</code>.</a></li> 
             <li><a href="#check-the-console-output">Check the console output.</a></li> 
            </ul></li> 
           <li><a href="#step-4-add-plugins-to-handle-non-es-modules">Step 4: Add plugins to handle non-ES modules.</a> 
            <ul> 
             <li><a href="#add-a-node-module-as-a-dependency">Add a Node module as a dependency.</a></li> 
             <li><a href="#install-the-modules-1">Install the modules.</a></li> 
             <li><a href="#update-rollup-config-js-2">Update <code>rollup.config.js</code>.</a></li> 
             <li><a href="#check-the-console-output-1">Check the console output.</a></li> 
            </ul></li> 
           <li><a href="#step-5-add-a-plugin-to-replace-environment-variables">Step 5: Add a plugin to replace environment variables.</a> 
            <ul> 
             <li><a href="#add-an-env-based-conditional-in-main-js">Add an <code>ENV</code>-based conditional in <code>main.js</code>.</a></li> 
             <li><a href="#install-the-modules-2">Install the modules.</a></li> 
            </ul></li> 
           <li><a href="#update-rollup-config-js-3">Update <code>rollup.config.js</code>.</a> 
            <ul> 
             <li><a href="#check-the-results">Check the results.</a></li> 
            </ul></li> 
           <li><a href="#step-6-add-uglifyjs-to-compress-and-minify-our-generated-script">Step 6: Add UglifyJS to compress and minify our generated script.</a> 
            <ul> 
             <li><a href="#install-the-plugin">Install the plugin.</a></li> 
             <li><a href="#update-rollup-config-js-4">Update <code>rollup.config.js</code>.</a></li> 
             <li><a href="#check-the-minified-bundle">Check the minified bundle.</a></li> 
            </ul></li> 
          </ul></li> 
         <li><a href="#coming-up-next">Coming Up Next</a></li> 
         <li><a href="#further-reading">Further Reading</a></li> 
        </ul></li> 
      </ul> 
     </nav>
    </aside>
    <article class="article__content article__content--build-tools">
     <section class="article__video">
      <amp-youtube data-videoid="ICYLOZuFMz8" data-param-listtype="playlist" data-param-list="PLz8Iz-Fnk_eRM5oTjUdn2CQ7lPf-zmhVD" width="480" height="270" layout="responsive"></amp-youtube>
     </section> 
     <p>This week, we’re going to build our first project using <a href="http://rollupjs.org/">Rollup</a>, which is a build tool for bundling JavaScript (and stylesheets, but we’ll get to that next week).</p> 
     <p>By the end of this tutorial, we’ll have Rollup configured to:</p> 
     <ul> 
      <li>combine our scripts,</li> 
      <li>remove unused code,</li> 
      <li>transpile it to work with older browsers,</li> 
      <li>support the use of Node modules in the browser,</li> 
      <li>work with environment variables, and</li> 
      <li>compress and minify our code for the smallest possible file size.</li> 
     </ul> 
     <h2 id="prerequisites">Prerequisites</h2> 
     <ul> 
      <li>This will make more sense if you know at least a little bit of JavaScript.</li> 
      <li>Initial familiarity with <a href="https://github.com/getify/You-Dont-Know-JS/blob/master/es6%20%26%20beyond/ch3.md#modules">ES2015 modules</a> doesn’t hurt, either.</li> 
      <li>You’ll need <code>npm</code> installed on your machine. (Don’t have it? <a href="https://nodejs.org/">Install Node.js here.</a>)</li> 
     </ul> 
     <h2 id="series-navigation">Series Navigation</h2> 
     <ul> 
      <li><a href="https://code.lengstorf.com/learn-rollup-js/">Part I: How to Use Rollup to Process and Bundle JavaScript Files</a> &lt;— you are here</li> 
      <li><a href="https://code.lengstorf.com/learn-rollup-css/">Part II: How to Use Rollup to Process and Bundle Stylesheets</a></li> 
      <li><a href="https://code.lengstorf.com/learn-rollup-css/#livereload">Part III: How to Use Rollup to Watch and Live Reload Files During Development</a></li> 
     </ul> 
     <h2 id="what-is-rollup">What Is Rollup?</h2> 
     <p>In their own words:</p> 
     <blockquote> 
      <p>Rollup is a next-generation JavaScript module bundler. Author your app or library using ES2015 modules, then efficiently bundle them up into a single file for use in browsers and Node.js.</p> 
     </blockquote> 
     <p>It’s similar to <a href="http://browserify.org/">Browserify</a> and <a href="https://webpack.github.io">webpack</a>.</p> 
     <p>You could also call Rollup a build tool, which would put it in the company of things like <a href="http://gruntjs.com/">Grunt</a> and <a href="https://github.com/gulpjs/gulp">Gulp</a>. However, it’s important to note that while you can use Grunt and Gulp to handle tasks like creating JavaScript bundles, those tools would use something like Rollup, Browserify, or webpack under the hood.</p> 
     <h3 id="why-should-you-care-about-rollup">Why should you care about Rollup?</h3> 
     <p>What makes Rollup exciting, though, is its ability to keep files small. This gets pretty nerdy, so the <strong>tl;dr</strong> version is this: compared to the other tools for creating JavaScript bundles, Rollup will almost always create a smaller, faster bundle.</p> 
     <p>This happens because Rollup is based on ES2015 modules, which are more efficient than CommonJS modules, which are what webpack and Browserify use. It’s also much easier for Rollup to remove unused code from modules using something called <em>tree-shaking</em>, which basically just means only the code we actually need is included in the final bundle.</p> 
     <p>Tree-shaking becomes really important when we’re including third-party tools or frameworks that have dozens of functions and methods available. If we’re only using one or two — think <a href="https://lodash.com/">lodash</a> or <a href="https://jquery.com/">jQuery</a> — there’s a <em>lot</em> of wasted overhead in loading the rest of the library.</p> 
     <p>Browserify and webpack will end up including a lot of unused code right now. But Rollup doesn’t —&nbsp;it’ll only bring in what we’re actually using.</p> 
     <aside class="article__aside">
      <p><strong>UPDATE (2016-08-22):</strong> To clarify, Rollup can only do tree-shaking on ES modules. CommonJS modules — which both lodash and jQuery are at the time of writing — cannot be tree-shaken. However, tree-shaking is <em>not</em> the only speed/performance benefit of Rollup. See <a href="https://www.reddit.com/r/javascript/comments/4yprc5/how_to_bundle_javascript_with_rollup_stepbystep/d6qzgzm">Rich Harris’s explanation</a> and <a href="https://www.reddit.com/r/javascript/comments/4yprc5/how_to_bundle_javascript_with_rollup_stepbystep/d6qzmgh?context=3">Nolan Lawson’s added info</a> for more information.</p> 
     </aside> 
     <p>And that’s <em>huge</em>.</p> 
     <aside class="article__aside">
      <p><strong>NOTE:</strong> Due in part to Rollup’s efficiency, <a href="http://www.2ality.com/2015/12/webpack-tree-shaking.html">webpack 2 is going to include tree-shaking</a>.</p> 
     </aside> 
     <h2 id="part-i-how-to-use-rollup-to-process-and-bundle-javascript-files">Part I: How to Use Rollup to Process and Bundle JavaScript Files</h2> 
     <p>To show how effective Rollup is, let’s walk through the process of building an extremely simple project that uses Rollup to bundle JavaScript.</p> 
     <h3 id="step-0-create-a-project-with-javascript-and-css-to-be-compiled">Step 0: Create a project with JavaScript and CSS to be compiled.</h3> 
     <p>In order to get started, we need to have some code to work with. For this tutorial, we’ll be working with a small app, available on <a href="https://github.com/jlengstorf/learn-rollup">GitHub</a>.</p> 
     <p>The folder structure looks like this:</p> 
     <div class="highlight">
      <pre><code class="language-text" data-lang="text"><span></span>learn-rollup/
??? build/
?   ??? index.html
??? src/
?   ??? scripts/
?   ?   ??? modules/
?   ?   ?   ??? mod1.js
?   ?   ?   ??? mod2.js
?   ?   ??? main.js
?   ??? styles/
?       ??? main.css
??? package.json
</code></pre>
     </div> 
     <p>You can install the app we’ll be working with during this tutorial by running the following command into your terminal.</p> 
     <div class="highlight">
      <pre><code class="language-bash" data-lang="bash"><span></span><span class="c1"># Move to the folder where you keep your dev projects.</span>
<span class="nb">cd</span> /path/to/your/projects

<span class="c1"># Clone the starter branch of the app from GitHub.</span>
git clone -b step-0 --single-branch https://github.com/jlengstorf/learn-rollup.git

<span class="c1"># The files are downloaded to /path/to/your/projects/learn-rollup/</span>
</code></pre>
     </div> 
     <aside class="article__aside">
      <p><strong>NOTE:</strong> If you don’t clone the repo, make sure to copy the contents of <code>build/index.html</code> into your own code. The HTML isn’t discussed in this tutorial.</p> 
     </aside> 
     <h3 id="step-1-install-rollup-and-create-a-configuration-file">Step 1: Install Rollup and create a configuration file.</h3> 
     <p>To get started, install Rollup with the following command:</p> 
     <div class="highlight">
      <pre><code class="language-sh" data-lang="sh"><span></span>npm install --save-dev rollup
</code></pre>
     </div> 
     <p>Next, create a new file called <code>rollup.config.js</code> in the <code>learn-rollup</code> folder. Inside, add the following.</p> 
     <div class="highlight">
      <pre><code class="language-js" data-lang="js"><span></span><span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">entry</span><span class="o">:</span> <span class="s1">'src/scripts/main.js'</span><span class="p">,</span>
  <span class="nx">dest</span><span class="o">:</span> <span class="s1">'build/js/main.min.js'</span><span class="p">,</span>
  <span class="nx">format</span><span class="o">:</span> <span class="s1">'iife'</span><span class="p">,</span>
  <span class="nx">sourceMap</span><span class="o">:</span> <span class="s1">'inline'</span><span class="p">,</span>
<span class="p">};</span>
</code></pre>
     </div> 
     <p>Let’s talk about what each of these configuration options actually does:</p> 
     <ul> 
      <li><code>entry</code> — this is the file we want Rollup to process. In most apps, this would be the main JavaScript file, which initializes everything and actually starts the show.</li> 
      <li><code>dest</code> — this is the location where the processed scripts should be saved.</li> 
      <li><code>format</code> — Rollup supports several output formats. Since we’re running in the browser, we want to use an <a href="http://benalman.com/news/2010/11/immediately-invoked-function-expression/">immediately-invoked function expression</a> (IIFE).<sup class="footnote-ref" id="fnref:complicated"><a rel="footnote" href="#fn:complicated">1</a></sup></li> 
      <li><code>sourceMap</code>&nbsp;— it’s extremely helpful for debugging to provide a sourcemap. This option adds a sourcemap inside the generated file, which keeps things simple.</li> 
     </ul> 
     <aside class="article__aside">
      <p><strong>NOTE:</strong> For the other <code>format</code> options and why you might need them, see <a href="https://github.com/rollup/rollup/wiki/JavaScript-API#format">Rollup’s wiki</a>.</p> 
     </aside> 
     <h4 id="test-the-rollup-configuration">Test the Rollup configuration.</h4> 
     <p>Once we’ve created the config file, we can test that everything is working by running the following command in our terminal:</p> 
     <div class="highlight">
      <pre><code class="language-bash" data-lang="bash"><span></span>./node_modules/.bin/rollup -c
</code></pre>
     </div> 
     <p>This will create a new folder called <code>build</code> in your project, with a <code>js</code> subfolder that contains our generated <code>main.min.js</code> file.</p> 
     <p>We can see that the bundle was created properly by opening <code>build/index.html</code> in our browser:</p> 
     <figure class="figure figure--center">
      <div class="figure__image-wrap">
       <amp-img class="figure__image" src="https://code.lengstorf.com/images/learn-rollup-01@2x.jpg" srcset="https://code.lengstorf.com/images/learn-rollup-01-300w.jpg 300w, https://code.lengstorf.com/images/learn-rollup-01-600w.jpg 600w, https://code.lengstorf.com/images/learn-rollup-01.jpg 750w, https://code.lengstorf.com/images/learn-rollup-01@2x.jpg 1500w" sizes="(min-width: 750px) 750px, 100vw" alt="" attribution="" width="750" height="454"></amp-img>
      </div>
      <figcaption class="figure__caption">
        How our example project looks after step 01. 
      </figcaption>
     </figure> 
     <aside class="article__aside">
      <p><strong>NOTE:</strong> At this stage, only modern browsers will work without errors. To get this working with older browsers that don’t support ES2015/ES6, we need to add some plugins.</p> 
     </aside> 
     <h4 id="look-at-the-bundled-output">Look at the Bundled Output</h4> 
     <p>What makes Rollup powerful is the fact that it uses “tree-shaking”, which leaves out unused code in the modules we reference. For example, in <code>src/scripts/modules/mod1.js</code>, there’s a function called <code>sayGoodbyeTo()</code> that isn’t used in our app — and since it’s never used, Rollup doesn’t include it in our bundle:</p> 
     <div class="highlight">
      <pre><code class="language-js" data-lang="js"><span></span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
<span class="s1">'use strict'</span><span class="p">;</span>

<span class="cm">/**</span>
<span class="cm"> * Says hello.</span>
<span class="cm"> * @param {String} name a name</span>
<span class="cm"> * @return {String} a greeting for `name`</span>
<span class="cm"> */</span>
<span class="kd">function</span> <span class="nx">sayHelloTo</span><span class="p">(</span> <span class="nx">name</span> <span class="p">)</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">toSay</span> <span class="o">=</span> <span class="sb">`Hello, </span><span class="si">${</span><span class="nx">name</span><span class="si">}</span><span class="sb">!`</span><span class="p">;</span>

  <span class="k">return</span> <span class="nx">toSay</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * Adds all the values in an array.</span>
<span class="cm"> * @param {Array} arr an array of numbers</span>
<span class="cm"> * @return {Number} the sum of all the array values</span>
<span class="cm"> */</span>
<span class="kr">const</span> <span class="nx">addArray</span> <span class="o">=</span> <span class="nx">arr</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kr">const</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>

  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">};</span>

<span class="c1">// Import a couple modules for testing.</span>
<span class="c1">// Run some functions from our imported modules.</span>
<span class="kr">const</span> <span class="nx">result1</span> <span class="o">=</span> <span class="nx">sayHelloTo</span><span class="p">(</span><span class="s1">'Jason'</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">result2</span> <span class="o">=</span> <span class="nx">addArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]);</span>

<span class="c1">// Print the results on the page.</span>
<span class="kr">const</span> <span class="nx">printTarget</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'debug__output'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>

<span class="nx">printTarget</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="sb">`sayHelloTo('Jason') =&gt; </span><span class="si">${</span><span class="nx">result1</span><span class="si">}</span><span class="err">\</span><span class="sb">n</span><span class="err">\</span><span class="sb">n`</span>
<span class="nx">printTarget</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">+=</span> <span class="sb">`addArray([1, 2, 3, 4]) =&gt; </span><span class="si">${</span><span class="nx">result2</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>

<span class="p">}());</span>
<span class="c1">//# sourceMappingURL=data:application/json;charset=utf-8;base64,...</span>
</code></pre>
     </div> 
     <p>In other build tools that’s not always the case, and bundles can get <em>really</em> large if we include everything inside a bigger library like <a href="https://lodash.com/">lodash</a> just to reference one or two functions.</p> 
     <p>For example, using <a href="https://webpack.github.io">webpack</a>, the <code>sayGoodbyeTo()</code> function is included, and the resulting bundle is more than double the size of what Rollup generates.<sup class="footnote-ref" id="fnref:sizes"><a rel="footnote" href="#fn:sizes">2</a></sup></p> 
     <h3 id="step-2-set-up-babel-so-we-can-use-new-javascript-features-now">Step 2: Set up Babel so we can use new JavaScript features now.</h3> 
     <p>At this point, we’ve got a code bundle that will work in modern browsers, but it’ll break if the browser is even a couple versions old in some cases — that’s not ideal.</p> 
     <p>Fortunately, <a href="https://babeljs.io">Babel</a> has us covered. This project <a href="https://scotch.io/tutorials/javascript-transpilers-what-they-are-why-we-need-them">transpiles</a> new features of JavaScript (<a href="https://github.com/getify/You-Dont-Know-JS/blob/master/es6%20%26%20beyond/ch1.md">ES6/ES2015 and so on</a>) into ES5, which will run on virtually any browser that’s still used today.</p> 
     <p>If you’ve never used Babel, your life as a developer is about to change forever. Having access to the new features of JavaScript makes the language simpler, cleaner, and more pleasant in general.</p> 
     <p>So let’s make that part of our Rollup process so we don’t have to think about it.</p> 
     <h4 id="install-the-necessary-modules">Install the necessary modules.</h4> 
     <p>First, we need to install the <a href="https://github.com/rollup/rollup-plugin-babel">Babel Rollup plugin</a> and the <a href="https://www.npmjs.com/package/babel-preset-es2015">appropriate Babel preset</a>.</p> 
     <div class="highlight">
      <pre><code class="language-sh" data-lang="sh"><span></span><span class="c1"># Install Rollup’s Babel plugin.</span>
npm install --save-dev rollup-plugin-babel

<span class="c1"># Install the Babel preset for transpiling ES2015.</span>
npm install --save-dev babel-preset-es2015

<span class="c1"># Install Babel’s external helpers for module support.</span>
npm install --save-dev babel-plugin-external-helpers
</code></pre>
     </div> 
     <aside class="article__aside">
      <p><strong>NOTE:</strong> A Babel preset is a collection of Babel plugins that tell Babel what we actually want to transpile</p> 
     </aside> 
     <h4 id="create-a-babelrc">Create a <code>.babelrc</code>.</h4> 
     <p>Next, create a new file called <code>.babelrc</code> in your project’s root directory (<code>learn-rollup/</code>). Inside, add the following JSON:</p> 
     <div class="highlight">
      <pre><code class="language-json" data-lang="json"><span></span><span class="p">{</span>
  <span class="nt">"presets"</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">[</span>
      <span class="s2">"es2015"</span><span class="p">,</span>
      <span class="p">{</span>
        <span class="nt">"modules"</span><span class="p">:</span> <span class="kc">false</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">],</span>
  <span class="nt">"plugins"</span><span class="p">:</span> <span class="p">[</span>
    <span class="s2">"external-helpers"</span>
  <span class="p">]</span>
<span class="p">}</span>
</code></pre>
     </div> 
     <p>This tells Babel which preset it should use during transpiling.</p> 
     <aside class="article__aside">
      <p><strong>NOTE:</strong> In older versions of npm (&lt; <code>v2.15.11</code>), you may see an error with the <code>es2015-rollup</code> preset. If you can’t update npm, see <a href="https://github.com/jlengstorf/learn-rollup/issues/2">this issue</a> for an alternative <code>.babelrc</code> configuration.</p> 
     </aside> 
     <aside class="article__aside">
      <p><strong>UPDATE (2016-11-13):</strong> In the video, <code>.babelrc</code> uses an older (outdated) configuration. <a href="https://github.com/jlengstorf/learn-rollup/pull/17">See this pull request for configuration changes</a>, and <a href="https://github.com/jlengstorf/learn-rollup/pull/37">this one for the changes to <code>package.json</code></a>.</p> 
     </aside> 
     <h4 id="update-rollup-config-js">Update <code>rollup.config.js</code>.</h4> 
     <p>To make this actually do stuff, we need to update <code>rollup.config.js</code>.</p> 
     <p>Inside, we <code>import</code> the Babel plugin, then add it to a new configuration property called <code>plugins</code>, which will hold an array of plugins.</p> 
     <div class="highlight">
      <pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Rollup plugins</span>
<span class="kr">import</span> <span class="nx">babel</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-babel'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">entry</span><span class="o">:</span> <span class="s1">'src/scripts/main.js'</span><span class="p">,</span>
  <span class="nx">dest</span><span class="o">:</span> <span class="s1">'build/js/main.min.js'</span><span class="p">,</span>
  <span class="nx">format</span><span class="o">:</span> <span class="s1">'iife'</span><span class="p">,</span>
  <span class="nx">sourceMap</span><span class="o">:</span> <span class="s1">'inline'</span><span class="p">,</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
    <span class="nx">babel</span><span class="p">({</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="s1">'node_modules/**'</span><span class="p">,</span>
    <span class="p">}),</span>
  <span class="p">],</span>
<span class="p">};</span>
</code></pre>
     </div> 
     <p>In order to avoid transpiling third-party scripts, we set an <code>exclude</code> config property to ignore the <code>node_modules</code> directory.</p> 
     <h4 id="check-the-bundle-output">Check the bundle output.</h4> 
     <p>With everything installed and configured, we can rebuild the bundle:</p> 
     <div class="highlight">
      <pre><code class="language-bash" data-lang="bash"><span></span>./node_modules/.bin/rollup -c
</code></pre>
     </div> 
     <p>When we look at the output, it looks <em>mostly</em> the same. But there are a few key differences: for example, look at the <code>addArray()</code> function:</p> 
     <div class="highlight">
      <pre><code class="language-js" data-lang="js"><span></span><span class="kd">var</span> <span class="nx">addArray</span> <span class="o">=</span> <span class="kd">function</span> <span class="nx">addArray</span><span class="p">(</span><span class="nx">arr</span><span class="p">)</span> <span class="p">{</span>
  <span class="kd">var</span> <span class="nx">result</span> <span class="o">=</span> <span class="nx">arr</span><span class="p">.</span><span class="nx">reduce</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">a</span><span class="p">,</span> <span class="nx">b</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nx">a</span> <span class="o">+</span> <span class="nx">b</span><span class="p">;</span>
  <span class="p">},</span> <span class="mi">0</span><span class="p">);</span>

  <span class="k">return</span> <span class="nx">result</span><span class="p">;</span>
<span class="p">};</span>
</code></pre>
     </div> 
     <p>See how Babel converted the <a href="https://strongloop.com/strongblog/an-introduction-to-javascript-es6-arrow-functions/">fat-arrow function</a> (<code>arr.reduce((a, b) =&gt; a + b, 0)</code>)to a regular function?</p> 
     <p>That’s transpiling in action: the result is the same, but the code is now supported back to IE9.</p> 
     <aside class="article__aside">
      <p><strong>IMPORTANT:</strong> Babel also offers <a href="https://babeljs.io/docs/usage/polyfill/"><code>babel-polyfill</code></a>, which makes things like <code>Array.prototype.reduce()</code> available in IE8 and earlier where possible.</p> 
     </aside> 
     <h3 id="step-3-add-eslint-to-check-for-common-javascript-errors">Step 3: Add ESLint to check for common JavaScript errors.</h3> 
     <p>It’s always a good idea to use a linter for your code, because it enforces consistent coding practices and helps catch tricky bugs like missing brackets or parentheses.</p> 
     <p>For this project, we’ll be using <a href="http://eslint.org/">ESLint</a>.</p> 
     <h4 id="install-the-modules">Install the Modules.</h4> 
     <p>In order to use ESLint, we’ll want to install the <a href="https://github.com/TrySound/rollup-plugin-eslint">ESLint Rollup plugin</a>:</p> 
     <div class="highlight">
      <pre><code class="language-sh" data-lang="sh"><span></span>npm install --save-dev rollup-plugin-eslint
</code></pre>
     </div> 
     <h4 id="generate-a-eslintrc-json">Generate a <code>.eslintrc.json</code>.</h4> 
     <p>To make sure we only get errors we want, we need to configure ESLint first. Fortunately, we can automatically generate most of this configuration by running the following command:</p> 
     <div class="highlight">
      <pre><code class="language-text" data-lang="text"><span></span>$ ./node_modules/.bin/eslint --init
? How would you like to configure ESLint? Answer questions about your style
? Are you using ECMAScript 6 features? Yes
? Are you using ES6 modules? Yes
? Where will your code run? Browser
? Do you use CommonJS? No
? Do you use JSX? No
? What style of indentation do you use? Spaces
? What quotes do you use for strings? Single
? What line endings do you use? Unix
? Do you require semicolons? Yes
? What format do you want your config file to be in? JSON
Successfully created .eslintrc.json file in /Users/jlengstorf/dev/code.lengstorf.com/projects/learn-rollup
</code></pre>
     </div> 
     <p>If you answer the questions as shown above, you’ll get the following output in <code>.eslintrc.json</code>:</p> 
     <div class="highlight">
      <pre><code class="language-json" data-lang="json"><span></span><span class="p">{</span>
  <span class="nt">"env"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"browser"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">"es6"</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">},</span>
  <span class="nt">"extends"</span><span class="p">:</span> <span class="s2">"eslint:recommended"</span><span class="p">,</span>
  <span class="nt">"parserOptions"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"sourceType"</span><span class="p">:</span> <span class="s2">"module"</span>
  <span class="p">},</span>
  <span class="nt">"rules"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"indent"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"error"</span><span class="p">,</span>
      <span class="mi">4</span>
    <span class="p">],</span>
    <span class="nt">"linebreak-style"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"error"</span><span class="p">,</span>
      <span class="s2">"unix"</span>
    <span class="p">],</span>
    <span class="nt">"quotes"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"error"</span><span class="p">,</span>
      <span class="s2">"single"</span>
    <span class="p">],</span>
    <span class="nt">"semi"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"error"</span><span class="p">,</span>
      <span class="s2">"always"</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
     </div> 
     <h4 id="tweak-eslintrc-json">Tweak <code>.eslintrc.json</code>.</h4> 
     <p>However, we need to make a couple adjustments to avoid errors for our project:</p> 
     <ol> 
      <li>We’re using 2 spaces instead of 4.</li> 
      <li>We will use a global variable called <code>ENV</code> later, so we need to whitelist that.</li> 
     </ol> 
     <p>Make the following adjustments — the <code>globals</code> property and the adjustment to the <code>indent</code> property — to your <code>.eslintrc.json</code>:</p> 
     <div class="highlight">
      <pre><code class="language-json" data-lang="json"><span></span><span class="p">{</span>
  <span class="nt">"env"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"browser"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nt">"es6"</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">},</span>
  <span class="nt">"globals"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"ENV"</span><span class="p">:</span> <span class="kc">true</span>
  <span class="p">},</span>
  <span class="nt">"extends"</span><span class="p">:</span> <span class="s2">"eslint:recommended"</span><span class="p">,</span>
  <span class="nt">"parserOptions"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"sourceType"</span><span class="p">:</span> <span class="s2">"module"</span>
  <span class="p">},</span>
  <span class="nt">"rules"</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">"indent"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"error"</span><span class="p">,</span>
      <span class="mi">2</span>
    <span class="p">],</span>
    <span class="nt">"linebreak-style"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"error"</span><span class="p">,</span>
      <span class="s2">"unix"</span>
    <span class="p">],</span>
    <span class="nt">"quotes"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"error"</span><span class="p">,</span>
      <span class="s2">"single"</span>
    <span class="p">],</span>
    <span class="nt">"semi"</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">"error"</span><span class="p">,</span>
      <span class="s2">"always"</span>
    <span class="p">]</span>
  <span class="p">}</span>
<span class="p">}</span>
</code></pre>
     </div> 
     <h4 id="update-rollup-config-js-1">Update <code>rollup.config.js</code>.</h4> 
     <p>Next, <code>import</code> the ESLint plugin and add it to the Rollup configuration:</p> 
     <div class="highlight">
      <pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Rollup plugins</span>
<span class="kr">import</span> <span class="nx">babel</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-babel'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">eslint</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-eslint'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">entry</span><span class="o">:</span> <span class="s1">'src/scripts/main.js'</span><span class="p">,</span>
  <span class="nx">dest</span><span class="o">:</span> <span class="s1">'build/js/main.min.js'</span><span class="p">,</span>
  <span class="nx">format</span><span class="o">:</span> <span class="s1">'iife'</span><span class="p">,</span>
  <span class="nx">sourceMap</span><span class="o">:</span> <span class="s1">'inline'</span><span class="p">,</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
    <span class="nx">eslint</span><span class="p">({</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="p">[</span>
        <span class="s1">'src/styles/**'</span><span class="p">,</span>
      <span class="p">]</span>
    <span class="p">}),</span>
    <span class="nx">babel</span><span class="p">({</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="s1">'node_modules/**'</span><span class="p">,</span>
    <span class="p">}),</span>
  <span class="p">],</span>
<span class="p">};</span>
</code></pre>
     </div> 
     <h4 id="check-the-console-output">Check the console output.</h4> 
     <p>At first, when we run <code>./node_modules/.bin/rollup -c</code>, nothing seems to be happening. That’s because as it stands, the app’s code passes the linter without issues.</p> 
     <p>But if we introduce an issue — say removing a semicolon — we’ll see how ESLint helps:</p> 
     <div class="highlight">
      <pre><code class="language-text" data-lang="text"><span></span>$ ./node_modules/.bin/rollup -c

/Users/jlengstorf/dev/code.lengstorf.com/projects/learn-rollup/src/scripts/main.js
  12:64  error  Missing semicolon  semi

? 1 problem (1 error, 0 warnings)
</code></pre>
     </div> 
     <p>Something that has the potential to introduce a mystery bug is now pointed out instantly, including the file, line, and column where the issue is happening.</p> 
     <p>While this won’t eliminate all of our problems with debugging, it goes a long way toward squashing bugs that are due to obvious typos and oversights.<sup class="footnote-ref" id="fnref:hours"><a rel="footnote" href="#fn:hours">3</a></sup></p> 
     <h3 id="step-4-add-plugins-to-handle-non-es-modules">Step 4: Add plugins to handle non-ES modules.</h3> 
     <p>This is important if any of your dependencies use Node-style modules. Without it, you’ll get errors about <code>require</code>.</p> 
     <h4 id="add-a-node-module-as-a-dependency">Add a Node module as a dependency.</h4> 
     <p>It would be easy to bang through this sample project without referencing a third-party module, but that’s not going to cut it in real projects. So, in the interest of making our Rollup setup <em>actually useful</em>, let’s make sure we can also reference third-party modules in our code.</p> 
     <p>For simplicity, we’ll add a simple logger to our code using the <a href="https://www.npmjs.com/package/debug"><code>debug</code></a> package. Start by installing it:</p> 
     <div class="highlight">
      <pre><code class="language-bash" data-lang="bash"><span></span>npm install --save debug
</code></pre>
     </div> 
     <aside class="article__aside">
      <p><strong>NOTE:</strong> Since this will be referenced in the main project, it’s important to use <code>--save</code>, which will avoid an error in production environments where the <code>devDependencies</code> won’t be installed.</p> 
     </aside> 
     <p>Then, inside <code>src/scripts/main.js</code>, let’s add some simple logging:</p> 
     <div class="highlight">
      <pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Import a couple modules for testing.</span>
<span class="kr">import</span> <span class="p">{</span> <span class="nx">sayHelloTo</span> <span class="p">}</span> <span class="nx">from</span> <span class="s1">'./modules/mod1'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">addArray</span> <span class="nx">from</span> <span class="s1">'./modules/mod2'</span><span class="p">;</span>

<span class="c1">// Import a logger for easier debugging.</span>
<span class="kr">import</span> <span class="nx">debug</span> <span class="nx">from</span> <span class="s1">'debug'</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">log</span> <span class="o">=</span> <span class="nx">debug</span><span class="p">(</span><span class="s1">'app:log'</span><span class="p">);</span>

<span class="c1">// Enable the logger.</span>
<span class="nx">debug</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="s1">'*'</span><span class="p">);</span>
<span class="nx">log</span><span class="p">(</span><span class="s1">'Logging is enabled!'</span><span class="p">);</span>

<span class="c1">// Run some functions from our imported modules.</span>
<span class="kr">const</span> <span class="nx">result1</span> <span class="o">=</span> <span class="nx">sayHelloTo</span><span class="p">(</span><span class="s1">'Jason'</span><span class="p">);</span>
<span class="kr">const</span> <span class="nx">result2</span> <span class="o">=</span> <span class="nx">addArray</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]);</span>

<span class="c1">// Print the results on the page.</span>
<span class="kr">const</span> <span class="nx">printTarget</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByClassName</span><span class="p">(</span><span class="s1">'debug__output'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>

<span class="nx">printTarget</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">=</span> <span class="sb">`sayHelloTo('Jason') =&gt; </span><span class="si">${</span><span class="nx">result1</span><span class="si">}</span><span class="err">\</span><span class="sb">n</span><span class="err">\</span><span class="sb">n`</span><span class="p">;</span>
<span class="nx">printTarget</span><span class="p">.</span><span class="nx">innerText</span> <span class="o">+=</span> <span class="sb">`addArray([1, 2, 3, 4]) =&gt; </span><span class="si">${</span><span class="nx">result2</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
</code></pre>
     </div> 
     <p>So far so good, but when we run rollup we get a warning:</p> 
     <div class="highlight">
      <pre><code class="language-text" data-lang="text"><span></span>$ ./node_modules/.bin/rollup -c
Treating 'debug' as external dependency
No name was provided for external module 'debug' in options.globals – guessing 'debug'
</code></pre>
     </div> 
     <p>And if we check our <code>index.html</code> again, we can see that a <code>ReferenceError</code> was thrown for <code>debug</code>:</p> 
     <figure class="figure figure--center">
      <div class="figure__image-wrap">
       <amp-img class="figure__image" src="https://code.lengstorf.com/images/learn-rollup-02@2x.jpg" srcset="https://code.lengstorf.com/images/learn-rollup-02-300w.jpg 300w, https://code.lengstorf.com/images/learn-rollup-02-600w.jpg 600w, https://code.lengstorf.com/images/learn-rollup-02.jpg 750w, https://code.lengstorf.com/images/learn-rollup-02@2x.jpg 1500w" sizes="(min-width: 750px) 750px, 100vw" alt="" attribution="" width="750" height="454"></amp-img>
      </div>
      <figcaption class="figure__caption">
        By default, third-party Node modules won’t load properly with Rollup. 
      </figcaption>
     </figure> 
     <p>Well, shit. That didn’t work at all.</p> 
     <p>This happens because Node modules use <a href="http://wiki.commonjs.org/wiki/Modules/1.1">CommonJS</a>, which isn’t compatible with Rollup out of the box. To solve this, we need to add a couple plugins for handling Node dependencies and CommonJS modules.</p> 
     <h4 id="install-the-modules-1">Install the modules.</h4> 
     <p>To work around this problem, we’re going to add two plugins to Rollup:</p> 
     <ol> 
      <li><a href="https://github.com/rollup/rollup-plugin-node-resolve"><code>rollup-plugin-node-resolve</code></a>, which allows us to load third-party modules in <code>node_modules</code>.</li> 
      <li><a href="https://github.com/rollup/rollup-plugin-commonjs"><code>rollup-plugin-commonjs</code></a>, which coverts CommonJS modules to ES6, which stops them from breaking Rollup.</li> 
     </ol> 
     <p>Install both plugins with the following command:</p> 
     <div class="highlight">
      <pre><code class="language-sh" data-lang="sh"><span></span>npm install --save-dev rollup-plugin-node-resolve rollup-plugin-commonjs
</code></pre>
     </div> 
     <h4 id="update-rollup-config-js-2">Update <code>rollup.config.js</code>.</h4> 
     <p>Next, <code>import</code> and add the plugins to the Rollup config:</p> 
     <div class="highlight">
      <pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Rollup plugins</span>
<span class="kr">import</span> <span class="nx">babel</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-babel'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">eslint</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-eslint'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">resolve</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-node-resolve'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">commonjs</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-commonjs'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">entry</span><span class="o">:</span> <span class="s1">'src/scripts/main.js'</span><span class="p">,</span>
  <span class="nx">dest</span><span class="o">:</span> <span class="s1">'build/js/main.min.js'</span><span class="p">,</span>
  <span class="nx">format</span><span class="o">:</span> <span class="s1">'iife'</span><span class="p">,</span>
  <span class="nx">sourceMap</span><span class="o">:</span> <span class="s1">'inline'</span><span class="p">,</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
    <span class="nx">resolve</span><span class="p">({</span>
      <span class="nx">jsnext</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">main</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">browser</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">}),</span>
    <span class="nx">commonjs</span><span class="p">(),</span>
    <span class="nx">eslint</span><span class="p">({</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="p">[</span>
        <span class="s1">'src/styles/**'</span><span class="p">,</span>
      <span class="p">]</span>
    <span class="p">}),</span>
    <span class="nx">babel</span><span class="p">({</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="s1">'node_modules/**'</span><span class="p">,</span>
    <span class="p">}),</span>
  <span class="p">],</span>
<span class="p">};</span>
</code></pre>
     </div> 
     <aside class="article__aside">
      <p><strong>NOTE:</strong> The <code>jsnext</code> property is part of an effort to <a href="https://github.com/rollup/rollup/wiki/jsnext:main">ease the migration to ES2015 modules for Node packages</a>. The <code>main</code> and <code>browser</code> properties help the plugin decide which files should be used for the bundle.</p> 
     </aside> 
     <h4 id="check-the-console-output-1">Check the console output.</h4> 
     <p>Rebuild the bundle with <code>./node_modules/.bin/rollup -c</code>, then check the browser again to see the output:</p> 
     <figure class="figure figure--center">
      <div class="figure__image-wrap">
       <amp-img class="figure__image" src="https://code.lengstorf.com/images/learn-rollup-03@2x.jpg" srcset="https://code.lengstorf.com/images/learn-rollup-03-300w.jpg 300w, https://code.lengstorf.com/images/learn-rollup-03-600w.jpg 600w, https://code.lengstorf.com/images/learn-rollup-03.jpg 750w, https://code.lengstorf.com/images/learn-rollup-03@2x.jpg 1500w" sizes="(min-width: 750px) 750px, 100vw" alt="" attribution="" width="750" height="454"></amp-img>
      </div>
      <figcaption class="figure__caption">
        Success! Our logs show up now. 
      </figcaption>
     </figure> 
     <h3 id="step-5-add-a-plugin-to-replace-environment-variables">Step 5: Add a plugin to replace environment variables.</h3> 
     <p>Environment variables add a lot of power to our development flow, and give us the ability to do things such as turning logging off and on, injecting dev-only scripts, and more.</p> 
     <p>So let’s make sure Rollup will enable us to use them.</p> 
     <h4 id="add-an-env-based-conditional-in-main-js">Add an <code>ENV</code>-based conditional in <code>main.js</code>.</h4> 
     <p>Let’s make use of an environment variable and only enable our logging script if we’re not in <code>production</code> mode. In <code>src/scripts/main.js</code>, let’s change the way our <code>log()</code> is initialized:</p> 
     <div class="highlight">
      <pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Import a logger for easier debugging.</span>
<span class="kr">import</span> <span class="nx">debug</span> <span class="nx">from</span> <span class="s1">'debug'</span><span class="p">;</span>
<span class="kr">const</span> <span class="nx">log</span> <span class="o">=</span> <span class="nx">debug</span><span class="p">(</span><span class="s1">'app:log'</span><span class="p">);</span>

<span class="c1">// The logger should only be disabled if we’re not in production.</span>
<span class="k">if</span> <span class="p">(</span><span class="nx">ENV</span> <span class="o">!==</span> <span class="s1">'production'</span><span class="p">)</span> <span class="p">{</span>

  <span class="c1">// Enable the logger.</span>
  <span class="nx">debug</span><span class="p">.</span><span class="nx">enable</span><span class="p">(</span><span class="s1">'*'</span><span class="p">);</span>
  <span class="nx">log</span><span class="p">(</span><span class="s1">'Logging is enabled!'</span><span class="p">);</span>
<span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
  <span class="nx">debug</span><span class="p">.</span><span class="nx">disable</span><span class="p">();</span>
<span class="p">}</span>
</code></pre>
     </div> 
     <p>However, after we rebuild our bundle (<code>./node_modules/.bin/rollup -c</code>) and check the browser, we can see that this gives us a <code>ReferenceError</code> for <code>ENV</code>.</p> 
     <p>That shouldn’t be surprising, though, because we haven’t defined it anywhere. But if we try something like <code>ENV=production ./node_modules/.bin/rollup -c</code>, it still doesn’t work. This is because setting an environment variable that way only makes it available to Rollup, not to the bundle created by Rollup.</p> 
     <p>We’ll need to use a plugin to pass our environment variables into the bundle.</p> 
     <h4 id="install-the-modules-2">Install the modules.</h4> 
     <p>Start by installing <a href="https://github.com/rollup/rollup-plugin-replace"><code>rollup-plugin-replace</code></a>, which is essentially just a find-and-replace utility. It can do a lot of things, but for our purposes we’ll have it simply find an occurrence of an environment variable and replace it with the actual value (e.g. all occurrences of <code>ENV</code> would be replaced with <code>"production"</code> in the bundle).</p> 
     <div class="highlight">
      <pre><code class="language-sh" data-lang="sh"><span></span>npm install --save-dev rollup-plugin-replace
</code></pre>
     </div> 
     <h3 id="update-rollup-config-js-3">Update <code>rollup.config.js</code>.</h3> 
     <p>Inside <code>rollup.config.js</code>, let’s <code>import</code> the plugin and add it to our list of plugins.</p> 
     <p>The configuration is pretty straightforward: we can just add a list of <code>key: value</code> pairs, where the <code>key</code> is the string to replace, and the <code>value</code> is what it should be replaced with.</p> 
     <div class="highlight">
      <pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Rollup plugins</span>
<span class="kr">import</span> <span class="nx">babel</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-babel'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">eslint</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-eslint'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">resolve</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-node-resolve'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">commonjs</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-commonjs'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">replace</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-replace'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">entry</span><span class="o">:</span> <span class="s1">'src/scripts/main.js'</span><span class="p">,</span>
  <span class="nx">dest</span><span class="o">:</span> <span class="s1">'build/js/main.min.js'</span><span class="p">,</span>
  <span class="nx">format</span><span class="o">:</span> <span class="s1">'iife'</span><span class="p">,</span>
  <span class="nx">sourceMap</span><span class="o">:</span> <span class="s1">'inline'</span><span class="p">,</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
    <span class="nx">resolve</span><span class="p">({</span>
      <span class="nx">jsnext</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">main</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">browser</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">}),</span>
    <span class="nx">commonjs</span><span class="p">(),</span>
    <span class="nx">eslint</span><span class="p">({</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="p">[</span>
        <span class="s1">'src/styles/**'</span><span class="p">,</span>
      <span class="p">]</span>
    <span class="p">}),</span>
    <span class="nx">babel</span><span class="p">({</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="s1">'node_modules/**'</span><span class="p">,</span>
    <span class="p">}),</span>
    <span class="nx">replace</span><span class="p">({</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="s1">'node_modules/**'</span><span class="p">,</span>
      <span class="nx">ENV</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">||</span> <span class="s1">'development'</span><span class="p">),</span>
    <span class="p">}),</span>
  <span class="p">],</span>
<span class="p">};</span>
</code></pre>
     </div> 
     <p>In our configuration, we’re going to find every occurence of <code>ENV</code> and replace it with <em>either</em> the value of <code>process.env.NODE_ENV</code> — the conventional way of setting the environment in Node apps —&nbsp;or “development”. We use <code>JSON.stringify()</code> to make sure the value is wrapped in double quotes, since <code>ENV</code> is not.</p> 
     <p>To make sure we don’t cause issues with third-party code, we also set the <code>exclude</code> property to ignore our <code>node_modules</code> directory and all the packages it contains. (Thanks to <a href="https://github.com/jlengstorf/learn-rollup/issues/3">@wesleycoder for the heads-up on this</a>.)</p> 
     <h4 id="check-the-results">Check the results.</h4> 
     <p>To start, rebuild the bundle and check the browser. The console log should show up, just like before. That’s good — that means our default value was applied.</p> 
     <p>To see where the power comes in, let’s run the command in <code>production</code> mode:</p> 
     <div class="highlight">
      <pre><code class="language-sh" data-lang="sh"><span></span><span class="nv">NODE_ENV</span><span class="o">=</span>production ./node_modules/.bin/rollup -c
</code></pre>
     </div> 
     <aside class="article__aside">
      <p><strong>NOTE:</strong> On Windows, use <code>SET NODE_ENV=production ./node_modules/.bin/rollup -c</code> to avoid an error setting environment variables. If you have issues with that command, see <a href="https://github.com/jlengstorf/learn-rollup/issues/30">this issue</a> for additional information.</p> 
     </aside> 
     <p>When we reload the browser, there’s nothing logged to the console:</p> 
     <figure class="figure figure--center">
      <div class="figure__image-wrap">
       <amp-img class="figure__image" src="https://code.lengstorf.com/images/learn-rollup-04@2x.jpg" srcset="https://code.lengstorf.com/images/learn-rollup-04-300w.jpg 300w, https://code.lengstorf.com/images/learn-rollup-04-600w.jpg 600w, https://code.lengstorf.com/images/learn-rollup-04.jpg 750w, https://code.lengstorf.com/images/learn-rollup-04@2x.jpg 1500w" sizes="(min-width: 750px) 750px, 100vw" alt="" attribution="" width="750" height="454"></amp-img>
      </div>
      <figcaption class="figure__caption">
        Using an environment variable disables logging with no code changes. 
      </figcaption>
     </figure> 
     <h3 id="step-6-add-uglifyjs-to-compress-and-minify-our-generated-script">Step 6: Add UglifyJS to compress and minify our generated script.</h3> 
     <p>The last JavaScript step we’ll go through in this tutorial is adding UglifyJS to minify and compress the bundle. This can <em>hugely</em> reduce the size of a bundle by removing comments, shortening variable names, and otherwise mangling the hell out of the code — which makes it more or less unreadable for humans, but much more efficient to deliver over a network.</p> 
     <h4 id="install-the-plugin">Install the plugin.</h4> 
     <p>We’ll be using <a href="https://github.com/mishoo/UglifyJS2/">UglifyJS</a> to compress the bundle, by way of <a href="https://github.com/TrySound/rollup-plugin-uglify"><code>rollup-plugin-uglify</code></a>.</p> 
     <p>Install it with the following:</p> 
     <div class="highlight">
      <pre><code class="language-sh" data-lang="sh"><span></span>npm install --save-dev rollup-plugin-uglify
</code></pre>
     </div> 
     <h4 id="update-rollup-config-js-4">Update <code>rollup.config.js</code>.</h4> 
     <p>Next, let’s add Uglify to our Rollup config. However, for legibility during development, let’s make uglification a production-only feature:</p> 
     <div class="highlight">
      <pre><code class="language-js" data-lang="js"><span></span><span class="c1">// Rollup plugins</span>
<span class="kr">import</span> <span class="nx">babel</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-babel'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">eslint</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-eslint'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">resolve</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-node-resolve'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">commonjs</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-commonjs'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">replace</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-replace'</span><span class="p">;</span>
<span class="kr">import</span> <span class="nx">uglify</span> <span class="nx">from</span> <span class="s1">'rollup-plugin-uglify'</span><span class="p">;</span>

<span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
  <span class="nx">entry</span><span class="o">:</span> <span class="s1">'src/scripts/main.js'</span><span class="p">,</span>
  <span class="nx">dest</span><span class="o">:</span> <span class="s1">'build/js/main.min.js'</span><span class="p">,</span>
  <span class="nx">format</span><span class="o">:</span> <span class="s1">'iife'</span><span class="p">,</span>
  <span class="nx">sourceMap</span><span class="o">:</span> <span class="s1">'inline'</span><span class="p">,</span>
  <span class="nx">plugins</span><span class="o">:</span> <span class="p">[</span>
    <span class="nx">resolve</span><span class="p">({</span>
      <span class="nx">jsnext</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">main</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
      <span class="nx">browser</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="p">}),</span>
    <span class="nx">commonjs</span><span class="p">(),</span>
    <span class="nx">eslint</span><span class="p">({</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="p">[</span>
        <span class="s1">'src/styles/**'</span><span class="p">,</span>
      <span class="p">]</span>
    <span class="p">}),</span>
    <span class="nx">babel</span><span class="p">({</span>
      <span class="nx">exclude</span><span class="o">:</span> <span class="s1">'node_modules/**'</span><span class="p">,</span>
    <span class="p">}),</span>
    <span class="nx">replace</span><span class="p">({</span>
      <span class="nx">ENV</span><span class="o">:</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">||</span> <span class="s1">'development'</span><span class="p">),</span>
    <span class="p">}),</span>
    <span class="p">(</span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">NODE_ENV</span> <span class="o">===</span> <span class="s1">'production'</span> <span class="o">&amp;&amp;</span> <span class="nx">uglify</span><span class="p">()),</span>
  <span class="p">],</span>
<span class="p">};</span>
</code></pre>
     </div> 
     <p>We’re using something called <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Logical_Operators#Short-Circuit_Evaluation">short-circuit evaluation</a>, which is a common (though <a href="http://stackoverflow.com/questions/5049006/using-s-short-circuiting-as-an-if-statement">debatably evil</a>) shortcut for conditionally setting a value.<sup class="footnote-ref" id="fnref:short-circuit"><a rel="footnote" href="#fn:short-circuit">4</a></sup></p> 
     <p>In our case, we’re only loading <code>uglify()</code> if <code>NODE_ENV</code> is set to “production”.</p> 
     <h4 id="check-the-minified-bundle">Check the minified bundle.</h4> 
     <p>With the configuration saved, let’s run Rollup with <code>NODE_ENV</code> in production:</p> 
     <div class="highlight">
      <pre><code class="language-sh" data-lang="sh"><span></span><span class="nv">NODE_ENV</span><span class="o">=</span>production ./node_modules/.bin/rollup -c
</code></pre>
     </div> 
     <aside class="article__aside">
      <p><strong>NOTE:</strong> On Windows, use <code>SET NODE_ENV=production ./node_modules/.bin/rollup -c</code> to avoid an error setting environment variables.</p> 
     </aside> 
     <p>The output isn’t pretty, but it’s <em>much</em> smaller. Here’s a screenshot of what <code>build/js/main.mind.js</code> looks like now:</p> 
     <figure class="figure figure--center">
      <div class="figure__image-wrap">
       <amp-img class="figure__image" src="https://code.lengstorf.com/images/learn-rollup-05@2x.jpg" srcset="https://code.lengstorf.com/images/learn-rollup-05-300w.jpg 300w, https://code.lengstorf.com/images/learn-rollup-05-600w.jpg 600w, https://code.lengstorf.com/images/learn-rollup-05.jpg 750w, https://code.lengstorf.com/images/learn-rollup-05@2x.jpg 1500w" sizes="(min-width: 750px) 750px, 100vw" alt="" attribution="" width="750" height="454"></amp-img>
      </div>
      <figcaption class="figure__caption">
        Uglified code definitely trades looks for efficiency. 
      </figcaption>
     </figure> 
     <p>Before, our bundle was ~42KB. After running it through UglifyJS, it’s down to ~29KB — we just saved over 30% on file size with no additional effort.</p> 
     <h2 id="coming-up-next">Coming Up Next</h2> 
     <p>In the next installment of this series, we’ll look at handling stylesheets through Rollup using <a href="https://github.com/postcss/postcss">PostCSS</a>, as well as adding live reloading so we can see our changes near-instantaneously as we make them.</p> 
     <h2 id="further-reading">Further Reading</h2> 
     <ul> 
      <li><a href="https://nolanlawson.com/2016/08/15/the-cost-of-small-modules/">The cost of small modules</a> — this is the article that got me interested in Rollup, because it shows some significant advantages of Rollup over webpack and Browserify.</li> 
      <li><a href="http://rollupjs.org/guide/">Rollup’s getting started guide</a></li> 
      <li><a href="https://github.com/rollup/rollup/wiki/Command-Line-Interface">Rollup’s CLI docs</a></li> 
      <li><a href="https://github.com/rollup/rollup/wiki/Plugins">A list of Rollup plugins</a></li> 
     </ul> 
     <div class="footnotes"> 
      <hr> 
      <ol> 
       <li id="fn:complicated">This is a fairly complex concept to understand, so don’t stress if it doesn’t make total sense. In a nutshell, we want our code to be inside its own scope, which prevents conflicts with other scripts. An IIFE is a <a href="http://skilldrick.co.uk/2011/04/closures-explained-with-javascript/">closure</a> that contains our code in its own scope. <a class="footnote-return" href="#fnref:complicated">?</a></li> 
       <li id="fn:sizes">It’s important to keep in mind, though, that when we’re dealing with such a small example app it doesn’t take much to double a file size. The comparison at this point is ~3KB vs. ~8KB. <a class="footnote-return" href="#fnref:sizes">?</a></li> 
       <li id="fn:hours">And as someone who has previously spent —&nbsp;<em>ahem</em> — numerous <em>hours</em> chasing bugs that ended up being something as silly as a misspelled variable name, it’s hard to overstate the efficiency boost that working with a linter provides. <a class="footnote-return" href="#fnref:hours">?</a></li> 
       <li id="fn:short-circuit">For example, it’s pretty common to see this used to assign default values (e.g. <code>var foo = maybeThisExists || 'default';</code>). <a class="footnote-return" href="#fnref:short-circuit">?</a></li> 
      </ol> 
     </div> 
     <section class="article__discussion">
      <h2 class="article__discussion-heading">Questions? Ideas? Spotted a Bug?</h2>
      <p class="article__discussion-text">The code in this article is hosted on GitHub. You can <a href="https://github.com/jlengstorf/learn-rollup">fork the repo</a> to modify or test it, <a href="https://github.com/jlengstorf/learn-rollup/issues">open an issue</a> to report bugs, or <a href="https://github.com/jlengstorf/learn-rollup/compare">create a pull request</a> to suggest improvements or modifications.</p>
     </section>
    </article>
    <footer class="article__footer footer">
     <div class="footer__meta">
      <amp-img class="footer__image" src="https://code.lengstorf.com/images/jason-lengstorf.jpg" srcset="https://code.lengstorf.com/images/jason-lengstorf.jpg 1x, https://code.lengstorf.com/images/jason-lengstorf@2x.jpg 2x" attribution="paint with stars photography" width="125" height="125"></amp-img>
      <div class="footer__links">
       <nav class="footer__links-nav">
        <a class="footer__link" href="https://twitter.com/jlengstorf">
         <svg class="footer__icon footer__icon--twitter" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 30 30">
          <path fill-rule="evenodd" d="M30 8c-1.2.5-2.4.8-3.7 1 1.3-.8 2.3-2 2.7-3.4-1.2.7-2.5 1.2-4 1.4-1-1-2.6-2-4.3-2-3.4 0-6.2 3-6.2 6.2 0 .5 0 1 .2 1.4C9.7 12.4 5 10 2 6.2c-.4 1-.7 2-.7 3 0 2.2 1 4 2.7 5.2-1 0-2-.3-2.8-.8 0 3 2 5.6 5 6-.6.3-1 .3-1.7.3-.4 0-.8 0-1-.2C4 22.3 6.4 24 9 24c-2 1.7-4.7 2.7-7.5 2.7H0c2.7 1.7 6 2.7 9.4 2.7 11.3 0 17.4-9.4 17.4-17.5v-1c1.2-.7 2.2-1.8 3-3z"></path>
         </svg></a> 
        <a class="footer__link" href="https://facebook.com/jlengstorf">
         <svg class="footer__icon footer__icon--facebook" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 30 30">
          <path fill-rule="evenodd" d="M11 5.8v4H8V15h3v15h6.2V15h4.2s.4-2.4.5-5H17V6.4c0-.5.7-1.2 1.4-1.2H22V0h-4.6C11 0 11 5 11 5.8z"></path>
         </svg></a> 
        <a class="footer__link" href="https://github.com/jlengstorf">
         <svg class="footer__icon footer__icon--github" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 30 30">
          <path fill-rule="evenodd" d="M15 0C6.7 0 0 6.7 0 15c0 6.6 4.3 12.2 10.3 14.2.7.2 1-.3 1-.7V26c-4.2 1-5-2-5-2-.8-1.8-1.8-2.2-1.8-2.2-1.3-1 0-1 0-1 1.7 0 2.4 1.6 2.4 1.6 1.3 2.3 3.5 1.6 4.3 1.2 0-1 .5-1.6 1-2-3.4-.3-7-1.6-7-7.4 0-1.6.7-3 1.7-4-.2-.4-.7-2 0-4 0 0 1.4-.4 4.2 1.6 1.2-.4 2.5-.5 3.8-.5 1.3 0 2.6 0 3.8.5 2.8-2 4-1.6 4-1.6 1 2 .4 3.6.2 4 1 1 1.6 2.4 1.6 4 0 5.8-3.5 7-7 7.4.7.5 1 1.4 1 2.8v4c0 .5.4 1 1.2.8 6-2 10.2-7.6 10.2-14.2 0-8.3-6.7-15-15-15"></path>
         </svg></a>
       </nav>
      </div>
     </div>
     <div class="footer__bio">
      <h3 class="footer__heading">Jason Lengstorf is a developer, designer, author, speaker, and traveler.</h3>
      <div class="footer__worked-with">
       <p class="footer__worked-with-lede">I’ve worked with great companies, including:</p>
       <amp-img class="footer__worked-with-image" src="https://code.lengstorf.com/images/worked-with-dark.png" srcset="https://code.lengstorf.com/images/worked-with-dark.png 1x, https://code.lengstorf.com/images/worked-with-dark@2x.png 2x" width="300" height="19"></amp-img>
      </div>
      <div class="footer__blurb">
       <p>Like so many of my generation, I’ve dedicated my life to learning a skill that’ll be worth jack shit when the zombies get here. Until then, I’ll be figuring out new ways to move lights in the box in exchange for social status and food money.</p>
       <p>You can <a href="https://code.lengstorf.com/hire-me/">hire me as a designer, developer, or a trainer</a> — I can show you how to build it, teach your team how to build it faster, or build it for you.</p>
       <p>I also write about non-code things at <a href="https://lengstorf.com/">lengstorf.com</a>.</p>
      </div>
     </div>
    </footer>
   </article>
  </main>
  <footer class="site-footer">
   <nav class="site-footer__nav">
    <a class="site-footer__nav-link" href="https://code.lengstorf.com/" title="Jason Lengstorf on code">Home</a> 
    <a class="site-footer__nav-link" href="https://code.lengstorf.com/category/front-end/" title="">Front-End</a> 
    <a class="site-footer__nav-link" href="https://code.lengstorf.com/category/api/" title="">APIs</a> 
    <a class="site-footer__nav-link" href="https://code.lengstorf.com/category/build-tools/" title="">Build Tools</a> 
    <a class="site-footer__nav-link" href="https://code.lengstorf.com/category/devops/" title="">DevOps</a> 
    <a class="site-footer__nav-link" href="https://code.lengstorf.com/category/cms/" title="">CMS</a> 
    <a class="site-footer__nav-link" href="https://code.lengstorf.com/hire-me/" title="">Hire Me</a> 
    <a class="site-footer__nav-link" href="https://lengstorf.com/contact/" title="">Contact</a> 
   </nav>
   <p class="site-footer__credits">All content © <a href="https://code.lengstorf.com/">Jason Lengstorf</a>.</p>
  </footer>
 </body>
</html>